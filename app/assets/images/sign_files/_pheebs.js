var ph=window.ph||{};ph.R=ph.R||{};(function(){var logError=function(errorMessage,url,lineNumber,errorType){(new Image).src=["/favicon.ico?type=js."+(errorType||"common"),"message="+escape(errorMessage),"source="+escape(url+":"+lineNumber),"place="+escape(location)].join("&amp;")};ph.logError=function(errorMessage,errorType){logError(errorMessage,null,null,errorType)};window.onerror=function(errorMessage,url,lineNumber,errorType){if(errorMessage==="Script error."&&url==""&&lineNumber==0){return}logError(errorMessage,url,lineNumber,errorType)}})();(function(){var goodErrors=["image not found","image is blocked","user not found","ask password","access denied","no album contents","album not found","validate"];if(typeof window==="undefined"){module.exports={goodErrors:goodErrors}}else{ph.common=ph.common||{};ph.common.goodErrors=goodErrors}})();(function(){var modules={};modules["map"]={url:"//api-maps.yandex.ru/2.0-stable/?load=package.standard&lang=ru-ru",load:function(promise){ymaps.ready(function(){promise.resolve()})}};modules["share"]={url:"//yastatic.net/share/share"};modules["ads"]={url:"//an.yandex.ru/system/context_test",beforeLoad:function(promise){var w=window;var n="yandexContextAsyncCallbacks";w[n]=w[n]||[];w[n].push(function(){promise.resolve()})},load:function(){}};modules["clipboard"]={url:function(){return ns.router.url("/js/vendor/zeroclipboard.min")},load:function(promise,ZeroClipboard){window.ZeroClipboard=ZeroClipboard;ph.initClipboard(ZeroClipboard,promise)}};modules["metrika"]={url:"//mc.yandex.ru/metrika/watch",beforeLoad:function(promise){var w=window;var n="yandex_metrika_callbacks";w[n]=w[n]||[];w[n].push(function(){promise.resolve()})},load:function(){}};modules["aviary"]={url:"/next/js/vendor/feather",load:function(promise){return(new ph.Editor).init().pipe(promise)}};var initModules=function(){var hash={};for(var moduleName in modules){var url=modules[moduleName].url;if(typeof url==="function"){url=url()}hash[moduleName]=url}require.config({paths:hash,waitSeconds:40})};var loadModule=function(moduleName){var module=modules[moduleName];if(!module.promise){var promise=module.promise=new no.Promise;if(module.beforeLoad){module.beforeLoad(promise)}var loadCallback=module.load||function(promise){promise.resolve()};require([moduleName],function(loadedObject){loadCallback(promise,loadedObject)})}return module.promise};ph.initModules=initModules;ph.loadModule=loadModule})();(function(){var utils={};utils.endsWith=function(str,suffix){return str.length>=suffix.length&&str.substring(str.length-suffix.length)===suffix};utils.escape=function(str){return ns.entityify(str)};utils.nl2br=function(str){var _br="<br/>";var _str=str.replace(/\n/g,_br);if(utils.endsWith(_str,_br)){_str+=_br}return _str};utils.moveCaretToEnd=function(element){if(typeof element.selectionStart=="number"){element.selectionStart=element.selectionEnd=element.value.length}else if(typeof element.createTextRange!="undefined"){element.focus();var range=element.createTextRange();range.collapse(false);range.select()}};utils.getIndexOfLastChild=function(comments,id){var resultIndex=null;var selfIndex=null;var element;comments.forEach(function(model,index){element=model.getData();if(element.parentId===id){resultIndex=utils.getIndexOfLastChild(comments,element.id)}if(element.id===id){selfIndex=index}});return resultIndex||selfIndex};utils.parseDate=function(date){var parts=date.split("-");return new Date(parseInt(parts[0],10),parseInt(parts[1],10)-1,parseInt(parts[2],10))};utils.timestamp=function(date){return Math.floor(+(date||new Date)/1e3)};utils.nc=function(){return+new Date};utils.deBouncer=function($,cf,of,interval){var debounce=function(func,threshold,execAsap){var timeout;return function debounced(){var obj=this,args=arguments;function delayed(){if(!execAsap){func.apply(obj,args)}timeout=null}if(timeout){clearTimeout(timeout)}else if(execAsap){func.apply(obj,args)}timeout=setTimeout(delayed,threshold||interval)}};jQuery.fn[cf]=function(fn){return fn?this.bind(of,debounce(fn)):this.trigger(cf)}};utils.lazyCallback=function(timeout,callback,aggregate){var timer=null;var value=null;callback=callback||function(){};aggregate=aggregate||function(){};return function(){value=aggregate(value,arguments);if(timer){return}callback(value);value=null;timer=setTimeout(function(){callback(value);value=null;timer=null},timeout)}};utils.generateUrl=function(page,params){params=params||ns.page.current.params;var authorLogin=params["author-login"];var albumId=params["album-id"];var imageId=params["image-id"];var _page=params["page"]?"?p="+params["page"]:"";switch(page){case"album":if(albumId){return"/"+["users",authorLogin,"album",albumId].join("/")+_page}return null;case"photo-edit":return"/"+["users",authorLogin,"edit",imageId].join("/");case"user-profile":return"/"+["users",authorLogin].join("/");case"rights":return"/rights.xml";case"user-tag":var url="/"+["users",authorLogin,"tags",encodeURIComponent(params["tag"])].join("/");if(params["p"]){url+="?p="+params["p"]}return url;case"contest":return"/contest.xml?id="+params["contest-id"];case"top":return"/top";case"calendar":if(params["date"]){return"/calendar?date="+params["date"]}return"/calendar";case"oferta":var queryString="";if(params&&params.retpath){queryString="?retpath="+encodeURIComponent(params.retpath)}return"/oferta.xml"+queryString;case"search":return"/search.xml?"+$.param(ph.params.oldSearchParams(params));case"photo-old":return this._generateOldPhotoUrl(params);case"editor-photo":if(authorLogin&&imageId){return"/models/?img=true&"+$.param(utils.pick(params,["author-login","image-id","size"]))+"&_="+utils.nc()}return"";case"stat":return"/stat/"+params.join("/")+"?_="+utils.nc();default:return ns.router.generateUrl(page,params)}};utils._generateOldPhotoUrl=function(params){var context=params["context"]||"album";var _base="/"+["users",params["author-login"],"view",params["image-id"]].join("/");var _page=params["page"]?"?p="+params["page"]:"";switch(context){case"album":return _base+_page;case"top":case"calendar":return"/"+context+_base+_page;case"tag":return"/"+["users",params["author-login"],"tags",params["tag"],"view",params["image-id"]].join("/")+_page;case"contest":return"/contest/"+params["contest-id"]+_base+_page;case"search":if(params["tags"]==1){return"/"+[params["chastity"]==1?"tag":"tags",params["search-text"],"users",params["author-login"],"view",params["image-id"]].join("/")+_page}var searchParams=ph.params.oldSearchParams(params);var _url="/search";if(searchParams.text){_url+="/"+encodeURIComponent(searchParams.text);delete searchParams.text;return _url+_base+"?"+$.param(searchParams)}else{delete searchParams.text;return _url+_base+"?"+$.param(searchParams)}break;default:ns.assert.fail("ph.utils",'Unknown context "%s"',context)}};utils.fullUrl=function(url){var loc=window.location;return loc.protocol+"//"+loc.host+url};utils.render=function(json,mode,module){return yr.run(module||"main",json,mode)};utils.cssValue=function($node,prop){return parseInt($node.css(prop),10)};utils.once=function(obj,name,handler){var cleanup=function(){obj.off(name,handler);obj.off(cleanup)};obj.on(name,handler);obj.on(name,cleanup)};utils.sizes={xxxs:50,xxs:75,xs:100,s:150,m:300,l:500,xl:800,xxl:1024,xxxl:1280,orig:99999};utils.getSizeName=function(size){if(size<=50)return"xxxs";if(size<=75)return"xxs";if(size<=100)return"xs";if(size<=150)return"s";if(size<=300)return"m";if(size<=500)return"l";if(size<=800)return"xl";if(size<=1024)return"xxl";if(size<=1280)return"xxxl";if(size<=1600)return"x4l";if(size<=2560)return"x5l";return(size||0)===0?"NOIMAGE":"orig"};utils.getClosestSize=function(imageData,dimentions){var sizes={xxxs:50,xxs:75,xs:100,s:150,m:300,l:500,xl:800,xxl:1024,xxxl:99999};var sizesAvailable=[];if(dimentions.width==-1||dimentions.height==-1){return null}if(!imageData.sizes){return null}for(var size in sizes){var hasCurrentSize=!!imageData.sizes[size];if(hasCurrentSize){sizesAvailable.push(size)}if(hasCurrentSize&&(dimentions.width<imageData.sizes[size].width||dimentions.height<imageData.sizes[size].height)){return{name:sizes[size],value:imageData.sizes[size],sizeName:size}}}if(sizesAvailable.length>0){var sizeName=sizesAvailable[sizesAvailable.length-1];return{name:sizes[sizeName],value:imageData.sizes[sizeName],sizeName:sizeName}}else{return null}};utils.pick=function(obj,props,strict){props=props||[];if(typeof props==="string"){props=[props]}var result={};for(var i=0;i<props.length;i++){var pname=props[i];if(pname in obj){result[pname]=obj[pname]}else if(strict){ns.assert.fail("utils.pick",'Property "%s" is missing',pname)}}return result};utils.transformParams=function(params,props){props=props||{};var result={};for(var p in props){var pname=props[p][0];var pdefault=props[p][1];if(pname in params){result[p]=params[pname]}else if(typeof pdefault!=="undefined"){result[p]=pdefault}}return result};utils.matchParams=function(a,b,list){a=a||{};b=b||{};for(var i=0;i<list.length;i++){if(a[list[i]]!=b[list[i]]){return false}}return true};var re_edit_url=/\/(edit[\/?]|edit$)/;var re_edit_url2=/\-edit\.xml/;var re_next_url=/\/next\//;var re_view_url=/\/view\//;var hostname=window.location.hostname||"fotki.yandex.ru";utils.isReferrerUsableForContext=function(referrer){return!!referrer&&referrer.indexOf(hostname)>=0&&!(referrer.match(re_edit_url)||referrer.match(re_edit_url2)||referrer.match(re_next_url)||referrer.match(re_view_url))};var re_all_dots=/\./g;utils.normalizeLogin=function(login){return login.toLowerCase().replace(re_all_dots,"-")};utils.getOldFotkiContextUrl=function(params){var context=params["context"]||"album";switch(context){case"calendar":case"top":case"contest":case"album":return ph.utils.generateUrl(context,params);case"tag":return utils.generateUrl("user-tag",{"author-login":params["author-login"],tag:params["tag"],p:params["page"]});case"search":return ph.utils.generateUrl("search",params);default:ns.assert.fail("ph.utils",'Unknown context "%s"',context);break}};utils.uniq=function(ar,key){var keys={};var result=[];for(var i=0;i<ar.length;i++){var item=ar[i];var k=key(ar[i]);if(!keys[k]){keys[k]=true;result.push(item)}}return result};utils.getShareLink=function(photoData){ns.assert(photoData,"ph.utils","Photo not specified for generating share link");var _params=no.extend({},ns.page.current.params,{"author-login":photoData.author.login,"album-id":photoData.albumId,"image-id":photoData.imageId});return ph.utils.fullUrl(ph.utils.generateUrl("photo-old",_params))};utils.getShareLinkBlogCode=function(photoData){ns.assert(photoData,"ph.utils","Photo not specified for generating share link");var context=ns.page.current.params.context||"";var _params=no.extend({},ns.page.current.params,{context:context==="search"?"album":context,"author-login":photoData.author.login,"album-id":photoData.albumId,"image-id":photoData.imageId});return ph.utils.fullUrl(ph.utils.generateUrl("photo-old",_params))};utils.groupMedals=function(photoMoreData){var medals=[];if(!photoMoreData){return medals}var contests=photoMoreData.contestBindings&&photoMoreData.contestBindings.contestBinding||[];if(photoMoreData.podDate){medals.push({type:"photoofday",date:utils.parseDate(photoMoreData.podDate).getTime()})}if(photoMoreData.inTopFrom){medals.push({type:"top",date:utils.parseDate(photoMoreData.inTopFrom).getTime()})}for(var i=0;i<contests.length;i++){var contest=contests[i];if(contest.imageStatus==="rejected"){continue}var medal={type:"contest",id:no.jpath(".contest.contestId",contest),state:no.jpath(".contest.state",contest),status:contest.imageStatus,name:no.jpath(".contest.name",contest),date:no.jpath(".contest.startDate",contest),votingStartDate:no.jpath(".contest.votingStartDate",contest),votingFinishDate:no.jpath(".contest.votingFinishDate",contest),place:no.jpath(".rating.place",contest)};if(medal.state!=="finished"){medals.unshift(medal)}else{medals.push(medal)}}return medals};utils.destroyBlocks=function(view){view.$node.find("*[data-nb]").each(function(i,node){var block;if(nb.hasBlock(node)){block=nb.block(node);if(block){block.destroy()}}})};utils.imgOnLoad=function($element,callback){$element.one("load",callback);if($element[0].complete===true||$element[0].readyState==4||$element[0].readyState=="complete"||$element[0].readyState=="loaded"){$element.trigger("load")}};utils.appendParams=function(url,params){var hash="";var query="";var baseUrl=url||"";var hashIndex=baseUrl.indexOf("#");if(hashIndex>=0){hash=baseUrl.substring(hashIndex);baseUrl=baseUrl.substring(0,hashIndex)}var queryIndex=baseUrl.indexOf("?");if(queryIndex>=0){query=baseUrl.substring(queryIndex+1);baseUrl=baseUrl.substring(0,queryIndex)}for(var pName in params){if(query){query+="&"+pName+"="+params[pName]}else{query+=pName+"="+params[pName]}}return baseUrl+(query?"?"+query:"")+(hash?hash:"")};utils.formatDateRelative=function(milliseconds){var date=window.moment(milliseconds);var currentDate=window.moment();if(currentDate.isSame(date,"day")){return date.calendar()}else if(currentDate.isSame(date,"year")){return date.format("D MMMM")}return date.format("D MMMM YYYY")};utils.plural=function(num,f0,f1,f3,f5){var placeholder="$0";num=isNaN(parseInt(num,10))?0:num;if(num===0){return f0.replace(placeholder,num)}var lastNumber=num%10;var lastNumbers=num%100;var result="";if(lastNumber===1&&lastNumbers!==11){result=f1}else if(lastNumber>1&&lastNumber<5&&(lastNumbers<10||lastNumbers>20)){result=f3}else{result=f5}return result.replace(placeholder,num)};utils.getAvatarUrl=function(uid){return"https://upics.yandex.net/"+(uid?uid:0)+"/normal"};ph.utils=utils})();(function(){var ActionContext=function(promise,options){this.promise=promise;this.options=options;this.init()};ActionContext.prototype.init=function(){var that=this;this.page=no.extend({},ns.page.current);this.pageUrl=ns.page.currentUrl;this._listenToPageLeave();this.promise.done(function(){that.destroy()})};ActionContext.prototype.destroy=function(){if(this._pageLeaveHandler){ns.events.off("ns-page-before-load",this._pageLeaveHandler);this._pageLeaveHandler=null}};ActionContext.prototype._listenToPageLeave=function(){var that=this;this._pageLeaveHandler=function(){that.pageLeft=true};ph.utils.once(ns.events,"ns-page-before-load",this._pageLeaveHandler)};ph.ActionContext=ActionContext})();(function(){var optionsDefaults={check:function(){return true},done:function(){},fail:function(){}};var actions={};actions.createContext=function(error,model){var promise=new no.Promise;var context=new ph.ActionContext(promise);if(model){context.model=model}if(error){context.error=error}return context};actions.do=function(modelId,params,options){options=no.extend({},optionsDefaults,options||{});var promise=new no.Promise;var context=new ph.ActionContext(promise,options);promise.done(function(model){context.model=model;options.done(context)});promise.fail(function(details){context.model=details.model;context.error=details.error;if(details.model&&!details.error){context.error=details.model.getError()}options.fail(context)});var requestPromise=ns.request(modelId,params);requestPromise.done(function(models){if(!models||!models.length||!options.check(models[0])){promise.reject({model:models[0]});return}var model=models[0];var error=model.getError();if(error){promise.reject({model:model,error:error});return}promise.resolve(models[0])});requestPromise.fail(function(error){promise.reject({error:error})})};actions.get=actions.do;actions.redrawView=function(context,view){view.invalidate();return actions.redraw(context)};actions.redraw=function(context){if(context.pageUrl===ns.page.currentUrl){return ns.page.go(context.pageUrl,"preserve")}else{return no.Promise.rejected()}};actions.restorePage=function(context){return context&&context.pageLeft?ns.page.go(context.pageUrl):no.Promise.resolved()};ph.actions=actions})();(function(){var errorReasonAborted="Server returned no data";var isOk=function(model){return no.jpath(".result",model.getData())==="ok"};var wrapError=function(error,errorName){error=error||{};if(!errorName){if(error.reason===errorReasonAborted||error.name==="cancelled"){errorName="aborted"}else{errorName="cannot edit"}}return{name:errorName,details:error["name"]||"operation failed"}};var ImageEditTask=function(photo,actions,ticket,beforeEditCallback,metrikaCountCallback){ns.assert(beforeEditCallback,"image-edit-task","beforeEditCallback not specified");ns.assert(metrikaCountCallback,"image-edit-task","metrikaCountCallback not specified");this.photo=photo;this.actions=actions;this.ticket=ticket;this.beforeEditCallback=beforeEditCallback;this.metrikaCountCallback=metrikaCountCallback;this.params=photo.params;this.statusRetries=3;this.tooLongTimeout=2*60*1e3;this.statusPingTimeout=700;this.promise=null;this.done=false;this.failed=false};ImageEditTask.prototype.run=function(){var that=this;if(this.promise){return this.promise}var promise=this.promise=new no.Promise;var beforeEditPromise=new no.Promise;var editPromise=new no.Promise;this.beforeEdit().pipe(beforeEditPromise);beforeEditPromise.fail(function(error){promise.reject(wrapError(error))});beforeEditPromise.done(function(){that.startEdit().pipe(editPromise);that.initTooLongTimeout(promise)});editPromise.fail(function(error){promise.reject(wrapError(error))});editPromise.done(function(){that.pingStatus()});return this.promise};ImageEditTask.prototype.beforeEdit=function(){var that=this;var promise=new no.Promise;var metrikaCountCallback=this.metrikaCountCallback;ph.actions.do("do-image-before-edit",{ticket:this.ticket,"image-id":this.params["image-id"],actions:this.actions},{check:isOk,done:function(context){var askUser=context.model.get(".willDropAreas");if(askUser){that.beforeEditCallback(promise);promise.done(function(){metrikaCountCallback(true)});promise.fail(function(){metrikaCountCallback(false)})}else{promise.resolve(context);metrikaCountCallback(null)}},fail:function(context){promise.reject(context.error)}});return promise};ImageEditTask.prototype.startEdit=function(){var promise=new no.Promise;ph.actions.do("do-image-edit",{ticket:this.ticket,"image-id":this.params["image-id"],actions:this.actions},{check:isOk,done:function(context){promise.resolve(context)},fail:function(context){promise.reject(context.error)}});return promise};ImageEditTask.prototype.pingStatus=function(){var that=this;var promise=this.promise;if(this.failed||this.done){return}setTimeout(function(){ph.actions.do("do-image-edit-status",{ticket:that.ticket,"image-id":that.params["image-id"]},{check:function(model){return!!model.get(".name")},done:function(context){var status=context.model.get(".name");if(status==="ERROR"){promise.reject(wrapError(null,"error"));return}if(status==="IN_PROGRESS"){that.pingStatus();return}if(status==="FINISHED"){promise.resolve()}promise.reject(wrapError(null,"uknown status"))},fail:function(context){if(that.statusRetries--<=0){promise.reject(wrapError(context.error,"status check failed"))}else{that.pingStatus()}}})},this.statusPingTimeout)};ImageEditTask.prototype.initTooLongTimeout=function(promise){var that=this;var timer=setTimeout(function(){promise.reject(wrapError(null,"timeout"))},this.tooLongTimeout);promise.always(function(){if(timer){clearTimeout(timer);timer=null}});promise.done(function(){that.done=true});promise.fail(function(){that.failed=true})};ph.ImageEditTask=ImageEditTask})();(function(t,e){if(typeof define==="function"&&define.amd){define(e)}else if(typeof exports==="object"){module.exports=e()}else{t.returnExports=e()}})(this,function(){var t=Array.prototype;var e=Object.prototype;var r=Function.prototype;var n=String.prototype;var i=Number.prototype;var a=t.slice;var o=t.splice;var l=t.push;var u=t.unshift;var s=r.call;var f=e.toString;var c=function(t){return e.toString.call(t)==="[object Function]"};var h=function(t){return e.toString.call(t)==="[object RegExp]"};var p=function ve(t){return f.call(t)==="[object Array]"};var v=function ge(t){return f.call(t)==="[object String]"};var g=function ye(t){var e=f.call(t);var r=e==="[object Arguments]";if(!r){r=!p(t)&&t!==null&&typeof t==="object"&&typeof t.length==="number"&&t.length>=0&&c(t.callee)}return r};var y=Object.defineProperty&&function(){try{Object.defineProperty({},"x",{});return true}catch(t){return false}}();var d;if(y){d=function(t,e,r,n){if(!n&&e in t){return}Object.defineProperty(t,e,{configurable:true,enumerable:false,writable:true,value:r})}}else{d=function(t,e,r,n){if(!n&&e in t){return}t[e]=r}}var m=function(t,r,n){for(var i in r){if(e.hasOwnProperty.call(r,i)){d(t,i,r[i],n)}}};function w(t){t=+t;if(t!==t){t=0}else if(t!==0&&t!==1/0&&t!==-(1/0)){t=(t>0||-1)*Math.floor(Math.abs(t))}return t}function b(t){var e=typeof t;return t===null||e==="undefined"||e==="boolean"||e==="number"||e==="string"}function x(t){var e,r,n;if(b(t)){return t}r=t.valueOf;if(c(r)){e=r.call(t);if(b(e)){return e}}n=t.toString;if(c(n)){e=n.call(t);if(b(e)){return e}}throw new TypeError}var S=function(t){if(t==null){throw new TypeError("can't convert "+t+" to object")}return Object(t)};var O=function de(t){return t>>>0};function T(){}m(r,{bind:function me(t){var e=this;if(!c(e)){throw new TypeError("Function.prototype.bind called on incompatible "+e)}var r=a.call(arguments,1);var n=function(){if(this instanceof u){var n=e.apply(this,r.concat(a.call(arguments)));if(Object(n)===n){return n}return this}else{return e.apply(t,r.concat(a.call(arguments)))}};var i=Math.max(0,e.length-r.length);var o=[];for(var l=0;l<i;l++){o.push("$"+l)}var u=Function("binder","return function ("+o.join(",")+"){return binder.apply(this,arguments)}")(n);if(e.prototype){T.prototype=e.prototype;u.prototype=new T;T.prototype=null}return u}});var j=s.bind(e.hasOwnProperty);var E;var N;var I;var D;var _;if(_=j(e,"__defineGetter__")){E=s.bind(e.__defineGetter__);N=s.bind(e.__defineSetter__);I=s.bind(e.__lookupGetter__);D=s.bind(e.__lookupSetter__)}var M=function(){var t=[1,2];var e=t.splice();return t.length===2&&p(e)&&e.length===0}();m(t,{splice:function we(t,e){if(arguments.length===0){return[]}else{return o.apply(this,arguments)}}},M);var F=function(){var e={};t.splice.call(e,0,0,1);return e.length===1}();m(t,{splice:function be(t,e){if(arguments.length===0){return[]}var r=arguments;this.length=Math.max(w(this.length),0);if(arguments.length>0&&typeof e!=="number"){r=a.call(arguments);if(r.length<2){r.push(this.length-t)}else{r[1]=w(e)}}return o.apply(this,r)}},!F);var R=[].unshift(0)!==1;m(t,{unshift:function(){u.apply(this,arguments);return this.length}},R);m(Array,{isArray:p});var k=Object("a");var C=k[0]!=="a"||!(0 in k);var U=function xe(t){var e=true;var r=true;if(t){t.call("foo",function(t,r,n){if(typeof n!=="object"){e=false}});t.call([1],function(){"use strict";r=typeof this==="string"},"x")}return!!t&&e&&r};m(t,{forEach:function Se(t){var e=S(this),r=C&&v(this)?this.split(""):e,n=arguments[1],i=-1,a=r.length>>>0;if(!c(t)){throw new TypeError}while(++i<a){if(i in r){t.call(n,r[i],i,e)}}}},!U(t.forEach));m(t,{map:function Oe(t){var e=S(this),r=C&&v(this)?this.split(""):e,n=r.length>>>0,i=Array(n),a=arguments[1];if(!c(t)){throw new TypeError(t+" is not a function")}for(var o=0;o<n;o++){if(o in r){i[o]=t.call(a,r[o],o,e)}}return i}},!U(t.map));m(t,{filter:function Te(t){var e=S(this),r=C&&v(this)?this.split(""):e,n=r.length>>>0,i=[],a,o=arguments[1];if(!c(t)){throw new TypeError(t+" is not a function")}for(var l=0;l<n;l++){if(l in r){a=r[l];if(t.call(o,a,l,e)){i.push(a)}}}return i}},!U(t.filter));m(t,{every:function je(t){var e=S(this),r=C&&v(this)?this.split(""):e,n=r.length>>>0,i=arguments[1];if(!c(t)){throw new TypeError(t+" is not a function")}for(var a=0;a<n;a++){if(a in r&&!t.call(i,r[a],a,e)){return false}}return true}},!U(t.every));m(t,{some:function Ee(t){var e=S(this),r=C&&v(this)?this.split(""):e,n=r.length>>>0,i=arguments[1];if(!c(t)){throw new TypeError(t+" is not a function")}for(var a=0;a<n;a++){if(a in r&&t.call(i,r[a],a,e)){return true}}return false}},!U(t.some));var A=false;if(t.reduce){A=typeof t.reduce.call("es5",function(t,e,r,n){return n})==="object"}m(t,{reduce:function Ne(t){var e=S(this),r=C&&v(this)?this.split(""):e,n=r.length>>>0;if(!c(t)){throw new TypeError(t+" is not a function")}if(!n&&arguments.length===1){throw new TypeError("reduce of empty array with no initial value")}var i=0;var a;if(arguments.length>=2){a=arguments[1]}else{do{if(i in r){a=r[i++];break}if(++i>=n){throw new TypeError("reduce of empty array with no initial value")}}while(true)}for(;i<n;i++){if(i in r){a=t.call(void 0,a,r[i],i,e)}}return a}},!A);var P=false;if(t.reduceRight){P=typeof t.reduceRight.call("es5",function(t,e,r,n){return n})==="object"}m(t,{reduceRight:function Ie(t){var e=S(this),r=C&&v(this)?this.split(""):e,n=r.length>>>0;if(!c(t)){throw new TypeError(t+" is not a function")}if(!n&&arguments.length===1){throw new TypeError("reduceRight of empty array with no initial value")}var i,a=n-1;if(arguments.length>=2){i=arguments[1]}else{do{if(a in r){i=r[a--];break}if(--a<0){throw new TypeError("reduceRight of empty array with no initial value")}}while(true)}if(a<0){return i}do{if(a in r){i=t.call(void 0,i,r[a],a,e)}}while(a--);return i}},!P);var Z=Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1;m(t,{indexOf:function De(t){var e=C&&v(this)?this.split(""):S(this),r=e.length>>>0;if(!r){return-1}var n=0;if(arguments.length>1){n=w(arguments[1])}n=n>=0?n:Math.max(0,r+n);for(;n<r;n++){if(n in e&&e[n]===t){return n}}return-1}},Z);var J=Array.prototype.lastIndexOf&&[0,1].lastIndexOf(0,-3)!==-1;m(t,{lastIndexOf:function _e(t){var e=C&&v(this)?this.split(""):S(this),r=e.length>>>0;if(!r){return-1}var n=r-1;if(arguments.length>1){n=Math.min(n,w(arguments[1]))}n=n>=0?n:r-Math.abs(n);for(;n>=0;n--){if(n in e&&t===e[n]){return n}}return-1}},J);var z=!{toString:null}.propertyIsEnumerable("toString"),$=function(){}.propertyIsEnumerable("prototype"),G=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],B=G.length;m(Object,{keys:function Me(t){var e=c(t),r=g(t),n=t!==null&&typeof t==="object",i=n&&v(t);if(!n&&!e&&!r){throw new TypeError("Object.keys called on a non-object")}var a=[];var o=$&&e;if(i||r){for(var l=0;l<t.length;++l){a.push(String(l))}}else{for(var u in t){if(!(o&&u==="prototype")&&j(t,u)){a.push(String(u))}}}if(z){var s=t.constructor,f=s&&s.prototype===t;for(var h=0;h<B;h++){var p=G[h];if(!(f&&p==="constructor")&&j(t,p)){a.push(p)}}}return a}});var H=Object.keys&&function(){return Object.keys(arguments).length===2}(1,2);var L=Object.keys;m(Object,{keys:function Fe(e){if(g(e)){return L(t.slice.call(e))}else{return L(e)}}},!H);var X=-621987552e5;var Y="-000001";var q=Date.prototype.toISOString&&new Date(X).toISOString().indexOf(Y)===-1;m(Date.prototype,{toISOString:function Re(){var t,e,r,n,i;if(!isFinite(this)){throw new RangeError("Date.prototype.toISOString called on non-finite value.")}n=this.getUTCFullYear();i=this.getUTCMonth();n+=Math.floor(i/12);i=(i%12+12)%12;t=[i+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()];n=(n<0?"-":n>9999?"+":"")+("00000"+Math.abs(n)).slice(0<=n&&n<=9999?-4:-6);e=t.length;while(e--){r=t[e];if(r<10){t[e]="0"+r}}return n+"-"+t.slice(0,2).join("-")+"T"+t.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"}},q);var K=false;try{K=Date.prototype.toJSON&&new Date(NaN).toJSON()===null&&new Date(X).toJSON().indexOf(Y)!==-1&&Date.prototype.toJSON.call({toISOString:function(){return true}})}catch(Q){}if(!K){Date.prototype.toJSON=function ke(t){var e=Object(this),r=x(e),n;if(typeof r==="number"&&!isFinite(r)){return null}n=e.toISOString;if(typeof n!=="function"){throw new TypeError("toISOString property is not callable")}return n.call(e)}}var V=Date.parse("+033658-09-27T01:46:40.000Z")===1e15;var W=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"));var te=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(!Date.parse||te||W||!V){Date=function(t){function e(r,n,i,a,o,l,u){var s=arguments.length;if(this instanceof t){var f=s===1&&String(r)===r?new t(e.parse(r)):s>=7?new t(r,n,i,a,o,l,u):s>=6?new t(r,n,i,a,o,l):s>=5?new t(r,n,i,a,o):s>=4?new t(r,n,i,a):s>=3?new t(r,n,i):s>=2?new t(r,n):s>=1?new t(r):new t;f.constructor=e;return f}return t.apply(this,arguments)}var r=new RegExp("^"+"(\\d{4}|[+-]\\d{6})"+"(?:-(\\d{2})"+"(?:-(\\d{2})"+"(?:"+"T(\\d{2})"+":(\\d{2})"+"(?:"+":(\\d{2})"+"(?:(\\.\\d{1,}))?"+")?"+"("+"Z|"+"(?:"+"([-+])"+"(\\d{2})"+":(\\d{2})"+")"+")?)?)?)?"+"$");var n=[0,31,59,90,120,151,181,212,243,273,304,334,365];function i(t,e){var r=e>1?1:0;return n[e]+Math.floor((t-1969+r)/4)-Math.floor((t-1901+r)/100)+Math.floor((t-1601+r)/400)+365*(t-1970)}function a(e){return Number(new t(1970,0,1,0,0,0,e))}for(var o in t){e[o]=t[o]}e.now=t.now;e.UTC=t.UTC;e.prototype=t.prototype;e.prototype.constructor=e;e.parse=function l(e){var n=r.exec(e);if(n){var o=Number(n[1]),l=Number(n[2]||1)-1,u=Number(n[3]||1)-1,s=Number(n[4]||0),f=Number(n[5]||0),c=Number(n[6]||0),h=Math.floor(Number(n[7]||0)*1e3),p=Boolean(n[4]&&!n[8]),v=n[9]==="-"?1:-1,g=Number(n[10]||0),y=Number(n[11]||0),d;if(s<(f>0||c>0||h>0?24:25)&&f<60&&c<60&&h<1e3&&l>-1&&l<12&&g<24&&y<60&&u>-1&&u<i(o,l+1)-i(o,l)){d=((i(o,l)+u)*24+s+g*v)*60;d=((d+f+y*v)*60+c)*1e3+h;if(p){d=a(d)}if(-864e13<=d&&d<=864e13){return d}}return NaN}return t.parse.apply(this,arguments)};return e}(Date)}if(!Date.now){Date.now=function Ce(){return(new Date).getTime()}}var ee=i.toFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||0xde0b6b3a7640080.toFixed(0)!=="1000000000000000128");var re={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function Ue(t,e){var r=-1;while(++r<re.size){e+=t*re.data[r];re.data[r]=e%re.base;e=Math.floor(e/re.base)}},divide:function Ae(t){var e=re.size,r=0;while(--e>=0){r+=re.data[e];re.data[e]=Math.floor(r/t);r=r%t*re.base}},numToString:function Pe(){var t=re.size;var e="";while(--t>=0){if(e!==""||t===0||re.data[t]!==0){var r=String(re.data[t]);if(e===""){e=r}else{e+="0000000".slice(0,7-r.length)+r}}}return e},pow:function Ze(t,e,r){return e===0?r:e%2===1?Ze(t,e-1,r*t):Ze(t*t,e/2,r)},log:function Je(t){var e=0;while(t>=4096){e+=12;t/=4096}while(t>=2){e+=1;t/=2}return e}};m(i,{toFixed:function ze(t){var e,r,n,i,a,o,l,u;e=Number(t);e=e!==e?0:Math.floor(e);if(e<0||e>20){throw new RangeError("Number.toFixed called with invalid number of decimals")}r=Number(this);if(r!==r){return"NaN"}if(r<=-1e21||r>=1e21){return String(r)}n="";if(r<0){n="-";r=-r}i="0";if(r>1e-21){a=re.log(r*re.pow(2,69,1))-69;o=a<0?r*re.pow(2,-a,1):r/re.pow(2,a,1);o*=4503599627370496;a=52-a;if(a>0){re.multiply(0,o);l=e;while(l>=7){re.multiply(1e7,0);l-=7}re.multiply(re.pow(10,l,1),0);l=a-1;while(l>=23){re.divide(1<<23);l-=23}re.divide(1<<l);re.multiply(1,1);re.divide(2);i=re.numToString()}else{re.multiply(0,o);re.multiply(1<<-a,0);i=re.numToString()+"0.00000000000000000000".slice(2,2+e)}}if(e>0){u=i.length;if(u<=e){i=n+"0.0000000000000000000".slice(0,e-u+2)+i}else{i=n+i.slice(0,u-e)+"."+i.slice(u-e)}}else{i=n+i}return i}},ee);var ne=n.split;if("ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1){(function(){var e=/()??/.exec("")[1]===void 0;n.split=function(r,n){var i=this;if(r===void 0&&n===0){return[]}if(f.call(r)!=="[object RegExp]"){return ne.call(this,r,n)}var a=[],o=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.extended?"x":"")+(r.sticky?"y":""),l=0,u,s,c,h;r=new RegExp(r.source,o+"g");i+="";if(!e){u=new RegExp("^"+r.source+"$(?!\\s)",o)}n=n===void 0?-1>>>0:O(n);while(s=r.exec(i)){c=s.index+s[0].length;if(c>l){a.push(i.slice(l,s.index));if(!e&&s.length>1){s[0].replace(u,function(){for(var t=1;t<arguments.length-2;t++){if(arguments[t]===void 0){s[t]=void 0}}})}if(s.length>1&&s.index<i.length){t.push.apply(a,s.slice(1))}h=s[0].length;l=c;if(a.length>=n){break}}if(r.lastIndex===s.index){r.lastIndex++}}if(l===i.length){if(h||!r.test("")){a.push("")
}}else{a.push(i.slice(l))}return a.length>n?a.slice(0,n):a}})()}else if("0".split(void 0,0).length){n.split=function $e(t,e){if(t===void 0&&e===0){return[]}return ne.call(this,t,e)}}var ie=n.replace;var ae=function(){var t=[];"x".replace(/x(.)?/g,function(e,r){t.push(r)});return t.length===1&&typeof t[0]==="undefined"}();if(!ae){n.replace=function Ge(t,e){var r=c(e);var n=h(t)&&/\)[*?]/.test(t.source);if(!r||!n){return ie.call(this,t,e)}else{var i=function(r){var n=arguments.length;var i=t.lastIndex;t.lastIndex=0;var a=t.exec(r);t.lastIndex=i;a.push(arguments[n-2],arguments[n-1]);return e.apply(this,a)};return ie.call(this,t,i)}}}var oe=n.substr;var le="".substr&&"0b".substr(-1)!=="b";m(n,{substr:function Be(t,e){return oe.call(this,t<0?(t=this.length+t)<0?0:t:t,e)}},le);var ue="	\n\f\r   ᠎    "+"         　\u2028"+"\u2029﻿";var se="​";var fe="["+ue+"]";var ce=new RegExp("^"+fe+fe+"*");var he=new RegExp(fe+fe+"*$");var pe=n.trim&&(ue.trim()||!se.trim());m(n,{trim:function He(){if(this===void 0||this===null){throw new TypeError("can't convert "+this+" to object")}return String(this).replace(ce,"").replace(he,"")}},pe);if(parseInt(ue+"08")!==8||parseInt(ue+"0x16")!==22){parseInt=function(t){var e=/^0[xX]/;return function r(n,i){n=String(n).trim();if(!Number(i)){i=e.test(n)?16:10}return t(n,i)}}(parseInt)}});var yr={};(function(){yr.log=function(){};var modules={};var RE_AMP=/&/g;var RE_LT=/</g;var RE_GT=/>/g;var RE_QUOTE=/"/g;var RE_E_AMP=/&amp;/g;var RE_E_LT=/&lt;/g;var RE_E_GT=/&gt;/g;yr.text2xml=function(s){if(s==null){return""}return(""+s).replace(RE_AMP,"&amp;").replace(RE_LT,"&lt;").replace(RE_GT,"&gt;")};yr.xml2text=function(s){if(s==null){return""}return(""+s).replace(RE_E_LT,"<").replace(RE_E_GT,">").replace(RE_E_AMP,"&")};yr.text2attr=function(s){if(s==null){return""}return(""+s).replace(RE_AMP,"&amp;").replace(RE_QUOTE,"&quot;").replace(RE_LT,"&lt;").replace(RE_GT,"&gt;")};yr.xml2attr=function(s){if(s==null){return""}return(""+s).replace(RE_QUOTE,"&quot;").replace(RE_LT,"&lt;").replace(RE_GT,"&gt;")};yr.register=function(id,module){if(modules[id]){throw Error('Module "'+id+'" already exists')}var ids=module.imports||[];var imports=[module];for(var i=0,l=ids.length;i<l;i++){var module_=modules[ids[i]];if(!module_){throw Error('Module "'+ids[i]+"\" doesn't exist")}else{imports=imports.concat(module_.imports)}}module.imports=imports;modules[id]=module};yr.run=function(id,data,mode){mode=mode||"";var module=modules[id];if(!module){throw'Module "'+id+'" is undefined'}var doc=new Doc(data);var r=module.a(module,[doc.root],mode,{a:{}});return r};yr.join=function join(left,right){return left.concat(right)};yr.nodeValue=function nodeValue(node){var data=node.data;return typeof data==="object"?"":data};yr.nodeName=function nodeName(nodeset){var node=nodeset[0];return node?node.name:""};yr.simpleScalar=function simpleScalar(name,context){var data=context.data;if(!data){return""}if(name==="*"){for(var key in data){return yr.simpleScalar(key,context)}return""}var r=data[name];return typeof r!=="object"&&r||""};yr.simpleBoolean=function simpleBoolean(name,context){var data=context.data;if(!data){return false}if(name==="*"){for(var key in data){var r=yr.simpleBoolean(key,context);if(r){return true}}return false}var r=data[name];if(!r){return false}if(r instanceof Array){return r.length}return true};yr.nodeset2scalar=function nodeset2scalar(nodeset){if(!nodeset.length){return""}var data=nodeset[0].data;return typeof data=="object"?"":data};yr.nodeset2boolean=function nodeset2boolean(nodeset){if(!(nodeset&&nodeset.length>0)){return false}return!!nodeset[0].data};yr.nodeset2xml=function nodeset2xml(nodeset){return yr.scalar2xml(yr.nodeset2scalar(nodeset))};yr.nodeset2attrvalue=function nodeset2attrvalue(nodeset){return yr.scalar2attrvalue(yr.nodeset2scalar(nodeset))};yr.scalar2xml=yr.text2xml;yr.xml2scalar=yr.xml2text;yr.xml2attrvalue=yr.xml2attr;yr.scalar2attrvalue=yr.text2attr;yr.object2nodeset=function object2nodeset(object){return[new Doc(object).root]};yr.array2nodeset=function array2nodeset(array){var object={item:array};return[new Doc(object).root]};yr.cmpSN=function cmpSN(left,right){for(var i=0,l=right.length;i<l;i++){if(left==yr.nodeValue(right[i])){return true}}return false};yr.cmpNN=function cmpNN(left,right){var m=right.length;if(m===0){return false}if(m===1){return yr.cmpSN(yr.nodeValue(right[0]),left)}var values=[];var rv=yr.nodeValue(right[0]);for(var i=0,l=left.length;i<l;i++){var lv=yr.nodeValue(left[i]);if(lv==rv){return true}values[i]=lv}for(var j=1;j<m;j++){rv=yr.nodeValue(right[j]);for(var i=0,l=left.length;i<l;i++){if(values[i]==rv){return true}}}return false};yr.shortTags={br:true,col:true,embed:true,hr:true,img:true,input:true,link:true,meta:true,param:true,wbr:true};yr.closeAttrs=function closeAttrs(a){var name=a.s;if(name){var r="";var attrs=a.a;for(var attr in attrs){r+=" "+attr+'="'+attrs[attr].quote()+'"'}r+=yr.shortTags[name]?"/>":">";a.s=null;return r}return""};yr.copyAttrs=function copyAttrs(to,from){for(var key in from){to[key]=from[key]}};yr.scalarAttr=function(s){this.s=s==null?"":""+s};yr.scalarAttr.prototype.quote=function(){return yr.text2attr(this.s)};function quoteAmp(s){return s.replace(/&/g,"&amp;")}yr.scalarAttr.prototype.addxml=function(xml){return new yr.xmlAttr(quoteAmp(this.s)+xml)};yr.scalarAttr.prototype.addscalar=function(xml){return new yr.scalarAttr(this.s+xml)};yr.xmlAttr=function(s){this.s=s==null?"":""+s};yr.xmlAttr.prototype.quote=function(){return yr.xml2attr(this.s)};yr.xmlAttr.prototype.addscalar=function(scalar){return new yr.xmlAttr(this.s+quoteAmp(scalar))};yr.slice=function(s,from,to){s=""+s;return to?s.slice(from,to):s.slice(from)};yr.exists=function(nodeset){return nodeset.length>0};yr.grep=function(nodeset,predicate){var r=[];for(var index=0,count=nodeset.length;index<count;index++){var node=nodeset[index];if(predicate(node,index,count)){r.push(node)}}return r};yr.byIndex=function(nodeset,i){return nodeset.slice(i,i+1)};yr.sort=function(nodes,by,desc){var values=[];for(var i=0,l=nodes.length;i<l;i++){var node=nodes[i];var value=by(node,i,l);values.push({node:node,value:value})}var greater=desc?-1:+1;var less=desc?+1:-1;var sorted=values.sort(function(a,b){var va=a.value;var vb=b.value;if(va<vb){return less}if(va>vb){return greater}return 0});var r=[];for(var i=0,l=sorted.length;i<l;i++){r.push(sorted[i].node)}return r};yr.nodeset2data=function(nodes){var l=nodes.length;if(l===0){return""}if(l===1){return nodes[0].data}var data=[];for(var i=0;i<l;i++){data.push(nodes[i].data)}return data};yr.externals={};var Module=function(){};Module.prototype.a=function applyValue(M,nodeset,mode,a0){var r="";var args;if(arguments.length>4){args=Array.prototype.slice.call(arguments,4)}var imports=M.imports;for(var i0=0,l0=nodeset.length;i0<l0;i0++){var c0=nodeset[i0];var found=false;var module;var i2=0;var l2=imports.length;var template;while(!found&&i2<l2){module=imports[i2++];var names=module.matcher[mode];if(names){var templates=names[c0.name]||names["*"];if(templates){var i3=0;var l3=templates.length;while(!found&&i3<l3){var tid=templates[i3++];template=module[tid];var selector=template.j;if(selector){if(module.matched(selector,template.a,c0,i0,l0)){found=tid}}else{var selectors=template.s;var abs=template.a;for(var i4=0,l4=selectors.length;i4<l4;i4++){if(module.matched(selectors[i4],abs[i4],c0,i0,l0)){found=tid;break}}}}}}}if(found){if(args){r+=template.apply(M,[M,c0,i0,l0,a0].concat(args))}else{r+=template(M,c0,i0,l0,a0)}}}return r};Module.prototype.matched=function matched(jpath,abs,c0,i0,l0){if(jpath===1){return!c0.parent}var l=jpath.length;var i=l-2;while(i>=0){if(!c0){return false}var step=jpath[i];switch(step){case 0:var name=jpath[i+1];if(name!=="*"&&name!==c0.name){return false}c0=c0.parent;break;case 2:case 4:var predicate=jpath[i+1];if(!predicate(this,c0,i0,l0)){return false}break}i-=2}if(abs&&c0.parent){return false}return true};Module.prototype.s=function selectN(jpath,node){return this.n(jpath,[node])};Module.prototype.n=function selectNs(jpath,nodeset){var current=nodeset;var m=current.length;var result;for(var i=0,n=jpath.length;i<n;i+=2){result=[];var type=jpath[i];var step=jpath[i+1];switch(type){case 0:for(var j=0;j<m;j++){yr.selectNametest(step,current[j],result)}break;case 1:for(var j=0;j<m;j++){var k=0;var node=current[j];while(k<step&&node){node=node.parent;k++}if(node){result.push(node)}}break;case 2:for(var j=0;j<m;j++){var node=current[j];if(step(this,node,j,m)){result.push(node)}}break;case 3:var node=current[step];result=node?[node]:[];break;case 4:if(m>0){var node=current[0];if(step(this,node.doc.root,0,1)){result=result.concat(current)}}}current=result;m=current.length;if(!m){return[]}}return result};yr.selectNametest=function selectNametest(step,context,result){var data=context.data;if(!data||typeof data!=="object"){return result}if(step==="*"){if(data instanceof Array){for(var i=0,l=data.length;i<l;i++){yr.selectNametest(i,context,result)}}else{for(step in data){yr.selectNametest(step,context,result)}}return result}data=data[step];if(data===undefined){return result}var doc=context.doc;if(data instanceof Array){for(var i=0,l=data.length;i<l;i++){result.push({data:data[i],parent:context,name:step,doc:doc})}}else{result.push({data:data,parent:context,name:step,doc:doc})}return result};yr.document=function(nodeset){var doc;if(!nodeset.length){doc=new Doc({})}else{doc=new Doc(nodeset[0].data)}return[doc.root]};yr.subnode=function(name,data,context){var doc=context.doc;if(data instanceof Array){var nodeset=[];for(var i=0,l=data.length;i<l;i++){nodeset.push({data:data[i],name:name,parent:context,doc:doc})}return nodeset}return[{data:data,name:name,parent:context,doc:doc}]};Module.prototype.v=function vars(id,c0){var vars=c0.doc._vars;var value=vars[id];if(value===undefined){var var_=this.findSymbol(id);value=typeof var_==="function"?var_(this,c0,0,1):var_;vars[id]=value}return value};Module.prototype.f=function funcs(id,c0,i0,l0,v0){var func=this.findSymbol(id);if(arguments.length>5){var args=Array.prototype.slice.call(arguments);args[0]=this;return func.apply(this,args)}if(v0!==undefined){return func(this,c0,i0,l0,v0)}return func(this,c0,i0,l0)};Module.prototype.k=function keys(id,use,c0,multiple){var keys=c0.doc._keys;var key=this.findSymbol(id);var cache=keys[id];if(!cache){cache=this._initKey(key,id,use,c0)}var values=cache.values;var nodes=cache.nodes;var that=this;if(multiple){var r;if(cache.xml){r="";for(var i=0,l=use.length;i<l;i++){var c0=use[i];r+=getValue(yr.nodeValue(c0))}}else{r=[];for(var i=0,l=use.length;i<l;i++){var c0=use[i];r=r.concat(getValue(yr.nodeValue(c0)))}}return r}else{var value=values[use];if(value===undefined){value=getValue(use)}return value}function getValue(use){var nodes_=nodes[use];var r;if(cache.xml){r="";if(nodes_){for(var i=0,l=nodes_.length;i<l;i++){var node=nodes_[i];r+=key.b(that,node.c,node.i,node.l,{})}}}else{r=[];if(nodes_){for(var i=0,l=nodes_.length;i<l;i++){var node=nodes_[i];r=r.concat(key.b(that,node.c,node.i,node.l))}}}values[use]=r;return r}};Module.prototype._initKey=function(key,id,use,c0){var keys=c0.doc._keys;var cache=keys[id]={};cache.xml=key.bt==="xml";var matched=key.n(this,c0);var nodes=cache.nodes={};if(key.ut==="nodeset"){for(var i0=0,l0=matched.length;i0<l0;i0++){var c1=matched[i0];var use_=key.u(this,c1,i0,l0);for(var j=0,m=use_.length;j<m;j++){store(yr.nodeValue(use_[j]),{c:c1,i:i0,l:l0})}}}else{for(var i0=0,l0=matched.length;i0<l0;i0++){var c1=matched[i0];var use_=key.u(this,c1,i0,l0);store(use_,{c:c1,i:i0,l:l0})}}cache.values={};return cache;function store(key,info){var items=nodes[key];if(!items){items=nodes[key]=[]}items.push(info)}};Module.prototype.findSymbol=function(id){var imports=this.imports;for(var i=0,l=imports.length;i<l;i++){var module=imports[i];var symbol=module[id];if(symbol!==undefined){return symbol}}};function Doc(data){if(data instanceof Array){data={item:data}}this.root={data:data,parent:null,name:"",doc:this};this._vars={};this._keys={}}yr.Module=Module})();if(typeof window==="undefined"&&typeof module!=="undefined"){module.exports=yr}(function(window,document){"use strict";var keyboardAllowed=typeof Element!=="undefined"&&"ALLOW_KEYBOARD_INPUT"in Element,fn=function(){var val,valLength;var fnMap=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];var i=0;var l=fnMap.length;var ret={};for(;i<l;i++){val=fnMap[i];if(val&&val[1]in document){for(i=0,valLength=val.length;i<valLength;i++){ret[fnMap[0][i]]=val[i]}return ret}}return false}(),screenfull={request:function(elem){var request=fn.requestFullscreen;elem=elem||document.documentElement;if(/5\.1[\.\d]* Safari/.test(navigator.userAgent)){elem[request]()}else{elem[request](keyboardAllowed&&Element.ALLOW_KEYBOARD_INPUT)}},exit:function(){document[fn.exitFullscreen]()},toggle:function(elem){if(this.isFullscreen){this.exit()}else{this.request(elem)}},onchange:function(){},onerror:function(){},raw:fn};if(!fn){window.screenfull=false;return}Object.defineProperties(screenfull,{isFullscreen:{get:function(){return!!document[fn.fullscreenElement]}},element:{enumerable:true,get:function(){return document[fn.fullscreenElement]}},enabled:{enumerable:true,get:function(){return!!document[fn.fullscreenEnabled]}}});document.addEventListener(fn.fullscreenchange,function(e){screenfull.onchange.call(screenfull,e)});document.addEventListener(fn.fullscreenerror,function(e){screenfull.onerror.call(screenfull,e)});window.screenfull=screenfull})(window,document);(function(a){function b(a,b){return function(c){return i(a.call(this,c),b)}}function c(a,b){return function(c){return this.lang().ordinal(a.call(this,c),b)}}function d(){}function e(a){u(a),g(this,a)}function f(a){var b=o(a),c=b.year||0,d=b.month||0,e=b.week||0,f=b.day||0,g=b.hour||0,h=b.minute||0,i=b.second||0,j=b.millisecond||0;this._input=a,this._milliseconds=+j+1e3*i+6e4*h+36e5*g,this._days=+f+7*e,this._months=+d+12*c,this._data={},this._bubble()}function g(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function h(a){return 0>a?Math.ceil(a):Math.floor(a)}function i(a,b){for(var c=a+"";c.length<b;)c="0"+c;return c}function j(a,b,c,d){var e,f,g=b._milliseconds,h=b._days,i=b._months;g&&a._d.setTime(+a._d+g*c),(h||i)&&(e=a.minute(),f=a.hour()),h&&a.date(a.date()+h*c),i&&a.month(a.month()+i*c),g&&!d&&bb.updateOffset(a),(h||i)&&(a.minute(e),a.hour(f))}function k(a){return"[object Array]"===Object.prototype.toString.call(a)}function l(a){return"[object Date]"===Object.prototype.toString.call(a)||a instanceof Date}function m(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;e>d;d++)(c&&a[d]!==b[d]||!c&&q(a[d])!==q(b[d]))&&g++;return g+f}function n(a){if(a){var b=a.toLowerCase().replace(/(.)s$/,"$1");a=Kb[a]||Lb[b]||b}return a}function o(a){var b,c,d={};for(c in a)a.hasOwnProperty(c)&&(b=n(c),b&&(d[b]=a[c]));return d}function p(b){var c,d;if(0===b.indexOf("week"))c=7,d="day";else{if(0!==b.indexOf("month"))return;c=12,d="month"}bb[b]=function(e,f){var g,h,i=bb.fn._lang[b],j=[];if("number"==typeof e&&(f=e,e=a),h=function(a){var b=bb().utc().set(d,a);return i.call(bb.fn._lang,b,e||"")},null!=f)return h(f);for(g=0;c>g;g++)j.push(h(g));return j}}function q(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=b>=0?Math.floor(b):Math.ceil(b)),c}function r(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function s(a){return t(a)?366:365}function t(a){return 0===a%4&&0!==a%100||0===a%400}function u(a){var b;a._a&&-2===a._pf.overflow&&(b=a._a[gb]<0||a._a[gb]>11?gb:a._a[hb]<1||a._a[hb]>r(a._a[fb],a._a[gb])?hb:a._a[ib]<0||a._a[ib]>23?ib:a._a[jb]<0||a._a[jb]>59?jb:a._a[kb]<0||a._a[kb]>59?kb:a._a[lb]<0||a._a[lb]>999?lb:-1,a._pf._overflowDayOfYear&&(fb>b||b>hb)&&(b=hb),a._pf.overflow=b)}function v(a){a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function w(a){return null==a._isValid&&(a._isValid=!isNaN(a._d.getTime())&&a._pf.overflow<0&&!a._pf.empty&&!a._pf.invalidMonth&&!a._pf.nullInput&&!a._pf.invalidFormat&&!a._pf.userInvalidated,a._strict&&(a._isValid=a._isValid&&0===a._pf.charsLeftOver&&0===a._pf.unusedTokens.length)),a._isValid}function x(a){return a?a.toLowerCase().replace("_","-"):a}function y(a,b){return b.abbr=a,mb[a]||(mb[a]=new d),mb[a].set(b),mb[a]}function z(a){delete mb[a]}function A(a){var b,c,d,e,f=0,g=function(a){if(!mb[a]&&nb)try{require("./lang/"+a)}catch(b){}return mb[a]};if(!a)return bb.fn._lang;if(!k(a)){if(c=g(a))return c;a=[a]}for(;f<a.length;){for(e=x(a[f]).split("-"),b=e.length,d=x(a[f+1]),d=d?d.split("-"):null;b>0;){if(c=g(e.slice(0,b).join("-")))return c;if(d&&d.length>=b&&m(e,d,!0)>=b-1)break;b--}f++}return bb.fn._lang}function B(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function C(a){var b,c,d=a.match(rb);for(b=0,c=d.length;c>b;b++)d[b]=Pb[d[b]]?Pb[d[b]]:B(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function D(a,b){return a.isValid()?(b=E(b,a.lang()),Mb[b]||(Mb[b]=C(b)),Mb[b](a)):a.lang().invalidDate()}function E(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(sb.lastIndex=0;d>=0&&sb.test(a);)a=a.replace(sb,c),sb.lastIndex=0,d-=1;return a}function F(a,b){var c;switch(a){case"DDDD":return vb;case"YYYY":case"GGGG":case"gggg":return wb;case"YYYYY":case"GGGGG":case"ggggg":return xb;case"S":case"SS":case"SSS":case"DDD":return ub;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return zb;case"a":case"A":return A(b._l)._meridiemParse;case"X":return Cb;case"Z":case"ZZ":return Ab;case"T":return Bb;case"SSSS":return yb;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"ww":case"W":case"WW":case"e":case"E":return tb;default:return c=new RegExp(N(M(a.replace("\\","")),"i"))}}function G(a){var b=(Ab.exec(a)||[])[0],c=(b+"").match(Hb)||["-",0,0],d=+(60*c[1])+q(c[2]);return"+"===c[0]?-d:d}function H(a,b,c){var d,e=c._a;switch(a){case"M":case"MM":null!=b&&(e[gb]=q(b)-1);break;case"MMM":case"MMMM":d=A(c._l).monthsParse(b),null!=d?e[gb]=d:c._pf.invalidMonth=b;break;case"D":case"DD":null!=b&&(e[hb]=q(b));break;case"DDD":case"DDDD":null!=b&&(c._dayOfYear=q(b));break;case"YY":e[fb]=q(b)+(q(b)>68?1900:2e3);break;case"YYYY":case"YYYYY":e[fb]=q(b);break;case"a":case"A":c._isPm=A(c._l).isPM(b);break;case"H":case"HH":case"h":case"hh":e[ib]=q(b);break;case"m":case"mm":e[jb]=q(b);break;case"s":case"ss":e[kb]=q(b);break;case"S":case"SS":case"SSS":case"SSSS":e[lb]=q(1e3*("0."+b));break;case"X":c._d=new Date(1e3*parseFloat(b));break;case"Z":case"ZZ":c._useUTC=!0,c._tzm=G(b);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":a=a.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":a=a.substr(0,2),b&&(c._w=c._w||{},c._w[a]=b)}}function I(a){var b,c,d,e,f,g,h,i,j,k,l=[];if(!a._d){for(d=K(a),a._w&&null==a._a[hb]&&null==a._a[gb]&&(f=function(b){return b?b.length<3?parseInt(b,10)>68?"19"+b:"20"+b:b:null==a._a[fb]?bb().weekYear():a._a[fb]},g=a._w,null!=g.GG||null!=g.W||null!=g.E?h=X(f(g.GG),g.W||1,g.E,4,1):(i=A(a._l),j=null!=g.d?T(g.d,i):null!=g.e?parseInt(g.e,10)+i._week.dow:0,k=parseInt(g.w,10)||1,null!=g.d&&j<i._week.dow&&k++,h=X(f(g.gg),k,j,i._week.doy,i._week.dow)),a._a[fb]=h.year,a._dayOfYear=h.dayOfYear),a._dayOfYear&&(e=null==a._a[fb]?d[fb]:a._a[fb],a._dayOfYear>s(e)&&(a._pf._overflowDayOfYear=!0),c=S(e,0,a._dayOfYear),a._a[gb]=c.getUTCMonth(),a._a[hb]=c.getUTCDate()),b=0;3>b&&null==a._a[b];++b)a._a[b]=l[b]=d[b];for(;7>b;b++)a._a[b]=l[b]=null==a._a[b]?2===b?1:0:a._a[b];l[ib]+=q((a._tzm||0)/60),l[jb]+=q((a._tzm||0)%60),a._d=(a._useUTC?S:R).apply(null,l)}}function J(a){var b;a._d||(b=o(a._i),a._a=[b.year,b.month,b.day,b.hour,b.minute,b.second,b.millisecond],I(a))}function K(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function L(a){a._a=[],a._pf.empty=!0;var b,c,d,e,f,g=A(a._l),h=""+a._i,i=h.length,j=0;for(d=E(a._f,g).match(rb)||[],b=0;b<d.length;b++)e=d[b],c=(F(e,a).exec(h)||[])[0],c&&(f=h.substr(0,h.indexOf(c)),f.length>0&&a._pf.unusedInput.push(f),h=h.slice(h.indexOf(c)+c.length),j+=c.length),Pb[e]?(c?a._pf.empty=!1:a._pf.unusedTokens.push(e),H(e,c,a)):a._strict&&!c&&a._pf.unusedTokens.push(e);a._pf.charsLeftOver=i-j,h.length>0&&a._pf.unusedInput.push(h),a._isPm&&a._a[ib]<12&&(a._a[ib]+=12),a._isPm===!1&&12===a._a[ib]&&(a._a[ib]=0),I(a),u(a)}function M(a){return a.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e})}function N(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function O(a){var b,c,d,e,f;if(0===a._f.length)return a._pf.invalidFormat=!0,a._d=new Date(0/0),void 0;for(e=0;e<a._f.length;e++)f=0,b=g({},a),v(b),b._f=a._f[e],L(b),w(b)&&(f+=b._pf.charsLeftOver,f+=10*b._pf.unusedTokens.length,b._pf.score=f,(null==d||d>f)&&(d=f,c=b));g(a,c||b)}function P(a){var b,c=a._i,d=Db.exec(c);if(d){for(a._pf.iso=!0,b=4;b>0;b--)if(d[b]){a._f=Fb[b-1]+(d[6]||" ");break}for(b=0;4>b;b++)if(Gb[b][1].exec(c)){a._f+=Gb[b][0];break}Ab.exec(c)&&(a._f+="Z"),L(a)}else a._d=new Date(c)}function Q(b){var c=b._i,d=ob.exec(c);c===a?b._d=new Date:d?b._d=new Date(+d[1]):"string"==typeof c?P(b):k(c)?(b._a=c.slice(0),I(b)):l(c)?b._d=new Date(+c):"object"==typeof c?J(b):b._d=new Date(c)}function R(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return 1970>a&&h.setFullYear(a),h}function S(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a&&b.setUTCFullYear(a),b}function T(a,b){if("string"==typeof a)if(isNaN(a)){if(a=b.weekdaysParse(a),"number"!=typeof a)return null}else a=parseInt(a,10);return a}function U(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function V(a,b,c){var d=eb(Math.abs(a)/1e3),e=eb(d/60),f=eb(e/60),g=eb(f/24),h=eb(g/365),i=45>d&&["s",d]||1===e&&["m"]||45>e&&["mm",e]||1===f&&["h"]||22>f&&["hh",f]||1===g&&["d"]||25>=g&&["dd",g]||45>=g&&["M"]||345>g&&["MM",eb(g/30)]||1===h&&["y"]||["yy",h];return i[2]=b,i[3]=a>0,i[4]=c,U.apply({},i)}function W(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),e-7>f&&(f+=7),d=bb(a).add("d",f),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function X(a,b,c,d,e){var f,g,h=new Date(Date.UTC(a,0)).getUTCDay();return c=null!=c?c:e,f=e-h+(h>d?7:0),g=7*(b-1)+(c-e)+f+1,{year:g>0?a:a-1,dayOfYear:g>0?g:s(a-1)+g}}function Y(a){var b=a._i,c=a._f;return"undefined"==typeof a._pf&&v(a),null===b?bb.invalid({nullInput:!0}):("string"==typeof b&&(a._i=b=A().preparse(b)),bb.isMoment(b)?(a=g({},b),a._d=new Date(+b._d)):c?k(c)?O(a):L(a):Q(a),new e(a))}function Z(a,b){bb.fn[a]=bb.fn[a+"s"]=function(a){var c=this._isUTC?"UTC":"";return null!=a?(this._d["set"+c+b](a),bb.updateOffset(this),this):this._d["get"+c+b]()}}function $(a){bb.duration.fn[a]=function(){return this._data[a]}}function _(a,b){bb.duration.fn["as"+a]=function(){return+this/b}}function ab(a){var b=!1,c=bb;"undefined"==typeof ender&&(this.moment=a?function(){return!b&&console&&console.warn&&(b=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),c.apply(null,arguments)}:bb)}for(var bb,cb,db="2.4.0",eb=Math.round,fb=0,gb=1,hb=2,ib=3,jb=4,kb=5,lb=6,mb={},nb="undefined"!=typeof module&&module.exports,ob=/^\/?Date\((\-?\d+)/i,pb=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,qb=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,rb=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,sb=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,tb=/\d\d?/,ub=/\d{1,3}/,vb=/\d{3}/,wb=/\d{1,4}/,xb=/[+\-]?\d{1,6}/,yb=/\d+/,zb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ab=/Z|[\+\-]\d\d:?\d\d/i,Bb=/T/i,Cb=/[\+\-]?\d+(\.\d{1,3})?/,Db=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d:?\d\d|Z)?)?$/,Eb="YYYY-MM-DDTHH:mm:ssZ",Fb=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],Gb=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Hb=/([\+\-]|\d\d)/gi,Ib="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),Jb={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},Kb={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Lb={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Mb={},Nb="DDD w W M D d".split(" "),Ob="M D H h m s w W".split(" "),Pb={M:function(){return this.month()+1},MMM:function(a){return this.lang().monthsShort(this,a)},MMMM:function(a){return this.lang().months(this,a)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(a){return this.lang().weekdaysMin(this,a)},ddd:function(a){return this.lang().weekdaysShort(this,a)},dddd:function(a){return this.lang().weekdays(this,a)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return i(this.year()%100,2)},YYYY:function(){return i(this.year(),4)},YYYYY:function(){return i(this.year(),5)},gg:function(){return i(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return i(this.weekYear(),5)},GG:function(){return i(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return i(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return q(this.milliseconds()/100)},SS:function(){return i(q(this.milliseconds()/10),2)},SSS:function(){return i(this.milliseconds(),3)},SSSS:function(){return i(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+i(q(a/60),2)+":"+i(q(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+i(q(10*a/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}},Qb=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Nb.length;)cb=Nb.pop(),Pb[cb+"o"]=c(Pb[cb],cb);for(;Ob.length;)cb=Ob.pop(),Pb[cb+cb]=b(Pb[cb],2);for(Pb.DDDD=b(Pb.DDD,3),g(d.prototype,{set:function(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(a){return this._months[a.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(a){return this._monthsShort[a.month()]},monthsParse:function(a){var b,c,d;for(this._monthsParse||(this._monthsParse=[]),b=0;12>b;b++)if(this._monthsParse[b]||(c=bb.utc([2e3,b]),d="^"+this.months(c,"")+"|^"+this.monthsShort(c,""),this._monthsParse[b]=new RegExp(d.replace(".",""),"i")),this._monthsParse[b].test(a))return b},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(a){return this._weekdays[a.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(a){return this._weekdaysShort[a.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(a){return this._weekdaysMin[a.day()]},weekdaysParse:function(a){var b,c,d;for(this._weekdaysParse||(this._weekdaysParse=[]),b=0;7>b;b++)if(this._weekdaysParse[b]||(c=bb([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(a){var b=this._longDateFormat[a];return!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a]=b),b},isPM:function(a){return"p"===(a+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendar[a];return"function"==typeof c?c.apply(b):c},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)},pastFuture:function(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)},ordinal:function(a){return this._ordinal.replace("%d",a)},_ordinal:"%d",preparse:function(a){return a},postformat:function(a){return a},week:function(a){return W(a,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),bb=function(b,c,d,e){return"boolean"==typeof d&&(e=d,d=a),Y({_i:b,_f:c,_l:d,_strict:e,_isUTC:!1})},bb.utc=function(b,c,d,e){var f;return"boolean"==typeof d&&(e=d,d=a),f=Y({_useUTC:!0,_isUTC:!0,_l:d,_i:b,_f:c,_strict:e}).utc()},bb.unix=function(a){return bb(1e3*a)},bb.duration=function(a,b){var c,d,e,g=bb.isDuration(a),h="number"==typeof a,i=g?a._input:h?{}:a,j=null;return h?b?i[b]=a:i.milliseconds=a:(j=pb.exec(a))?(c="-"===j[1]?-1:1,i={y:0,d:q(j[hb])*c,h:q(j[ib])*c,m:q(j[jb])*c,s:q(j[kb])*c,ms:q(j[lb])*c}):(j=qb.exec(a))&&(c="-"===j[1]?-1:1,e=function(a){var b=a&&parseFloat(a.replace(",","."));return(isNaN(b)?0:b)*c},i={y:e(j[2]),M:e(j[3]),d:e(j[4]),h:e(j[5]),m:e(j[6]),s:e(j[7]),w:e(j[8])}),d=new f(i),g&&a.hasOwnProperty("_lang")&&(d._lang=a._lang),d},bb.version=db,bb.defaultFormat=Eb,bb.updateOffset=function(){},bb.lang=function(a,b){var c;return a?(b?y(x(a),b):null===b?(z(a),a="en"):mb[a]||A(a),c=bb.duration.fn._lang=bb.fn._lang=A(a),c._abbr):bb.fn._lang._abbr},bb.langData=function(a){return a&&a._lang&&a._lang._abbr&&(a=a._lang._abbr),A(a)},bb.isMoment=function(a){return a instanceof e},bb.isDuration=function(a){return a instanceof f},cb=Qb.length-1;cb>=0;--cb)p(Qb[cb]);for(bb.normalizeUnits=function(a){return n(a)},bb.invalid=function(a){var b=bb.utc(0/0);return null!=a?g(b._pf,a):b._pf.userInvalidated=!0,b},bb.parseZone=function(a){return bb(a).parseZone()},g(bb.fn=e.prototype,{clone:function(){return bb(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")
},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return D(bb(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var a=this;return[a.year(),a.month(),a.date(),a.hours(),a.minutes(),a.seconds(),a.milliseconds()]},isValid:function(){return w(this)},isDSTShifted:function(){return this._a?this.isValid()&&m(this._a,(this._isUTC?bb.utc(this._a):bb(this._a)).toArray())>0:!1},parsingFlags:function(){return g({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(a){var b=D(this,a||bb.defaultFormat);return this.lang().postformat(b)},add:function(a,b){var c;return c="string"==typeof a?bb.duration(+b,a):bb.duration(a,b),j(this,c,1),this},subtract:function(a,b){var c;return c="string"==typeof a?bb.duration(+b,a):bb.duration(a,b),j(this,c,-1),this},diff:function(a,b,c){var d,e,f=this._isUTC?bb(a).zone(this._offset||0):bb(a).local(),g=6e4*(this.zone()-f.zone());return b=n(b),"year"===b||"month"===b?(d=432e5*(this.daysInMonth()+f.daysInMonth()),e=12*(this.year()-f.year())+(this.month()-f.month()),e+=(this-bb(this).startOf("month")-(f-bb(f).startOf("month")))/d,e-=6e4*(this.zone()-bb(this).startOf("month").zone()-(f.zone()-bb(f).startOf("month").zone()))/d,"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:h(e)},from:function(a,b){return bb.duration(this.diff(a)).lang(this.lang()._abbr).humanize(!b)},fromNow:function(a){return this.from(bb(),a)},calendar:function(){var a=this.diff(bb().zone(this.zone()).startOf("day"),"days",!0),b=-6>a?"sameElse":-1>a?"lastWeek":0>a?"lastDay":1>a?"sameDay":2>a?"nextDay":7>a?"nextWeek":"sameElse";return this.format(this.lang().calendar(b,this))},isLeapYear:function(){return t(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=T(a,this.lang()),this.add({d:a-b})):b},month:function(a){var b,c=this._isUTC?"UTC":"";return null!=a?"string"==typeof a&&(a=this.lang().monthsParse(a),"number"!=typeof a)?this:(b=this.date(),this.date(1),this._d["set"+c+"Month"](a),this.date(Math.min(b,this.daysInMonth())),bb.updateOffset(this),this):this._d["get"+c+"Month"]()},startOf:function(a){switch(a=n(a)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a?this.weekday(0):"isoWeek"===a&&this.isoWeekday(1),this},endOf:function(a){return a=n(a),this.startOf(a).add("isoWeek"===a?"week":a,1).subtract("ms",1)},isAfter:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)>+bb(a).startOf(b)},isBefore:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)<+bb(a).startOf(b)},isSame:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)===+bb(a).startOf(b)},min:function(a){return a=bb.apply(null,arguments),this>a?this:a},max:function(a){return a=bb.apply(null,arguments),a>this?this:a},zone:function(a){var b=this._offset||0;return null==a?this._isUTC?b:this._d.getTimezoneOffset():("string"==typeof a&&(a=G(a)),Math.abs(a)<16&&(a=60*a),this._offset=a,this._isUTC=!0,b!==a&&j(this,bb.duration(b-a,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(a){return a=a?bb(a).zone():0,0===(this.zone()-a)%60},daysInMonth:function(){return r(this.year(),this.month())},dayOfYear:function(a){var b=eb((bb(this).startOf("day")-bb(this).startOf("year"))/864e5)+1;return null==a?b:this.add("d",a-b)},weekYear:function(a){var b=W(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==a?b:this.add("y",a-b)},isoWeekYear:function(a){var b=W(this,1,4).year;return null==a?b:this.add("y",a-b)},week:function(a){var b=this.lang().week(this);return null==a?b:this.add("d",7*(a-b))},isoWeek:function(a){var b=W(this,1,4).week;return null==a?b:this.add("d",7*(a-b))},weekday:function(a){var b=(this.day()+7-this.lang()._week.dow)%7;return null==a?b:this.add("d",a-b)},isoWeekday:function(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)},get:function(a){return a=n(a),this[a]()},set:function(a,b){return a=n(a),"function"==typeof this[a]&&this[a](b),this},lang:function(b){return b===a?this._lang:(this._lang=A(b),this)}}),cb=0;cb<Ib.length;cb++)Z(Ib[cb].toLowerCase().replace(/s$/,""),Ib[cb]);Z("year","FullYear"),bb.fn.days=bb.fn.day,bb.fn.months=bb.fn.month,bb.fn.weeks=bb.fn.week,bb.fn.isoWeeks=bb.fn.isoWeek,bb.fn.toJSON=bb.fn.toISOString,g(bb.duration.fn=f.prototype,{_bubble:function(){var a,b,c,d,e=this._milliseconds,f=this._days,g=this._months,i=this._data;i.milliseconds=e%1e3,a=h(e/1e3),i.seconds=a%60,b=h(a/60),i.minutes=b%60,c=h(b/60),i.hours=c%24,f+=h(c/24),i.days=f%30,g+=h(f/30),i.months=g%12,d=h(g/12),i.years=d},weeks:function(){return h(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*q(this._months/12)},humanize:function(a){var b=+this,c=V(b,!a,this.lang());return a&&(c=this.lang().pastFuture(b,c)),this.lang().postformat(c)},add:function(a,b){var c=bb.duration(a,b);return this._milliseconds+=c._milliseconds,this._days+=c._days,this._months+=c._months,this._bubble(),this},subtract:function(a,b){var c=bb.duration(a,b);return this._milliseconds-=c._milliseconds,this._days-=c._days,this._months-=c._months,this._bubble(),this},get:function(a){return a=n(a),this[a.toLowerCase()+"s"]()},as:function(a){return a=n(a),this["as"+a.charAt(0).toUpperCase()+a.slice(1)+"s"]()},lang:bb.fn.lang,toIsoString:function(){var a=Math.abs(this.years()),b=Math.abs(this.months()),c=Math.abs(this.days()),d=Math.abs(this.hours()),e=Math.abs(this.minutes()),f=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||f?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(f?f+"S":""):"P0D"}});for(cb in Jb)Jb.hasOwnProperty(cb)&&(_(cb,Jb[cb]),$(cb.toLowerCase()));_("Weeks",6048e5),bb.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},bb.lang("en",{ordinal:function(a){var b=a%10,c=1===q(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),function(a){a(bb)}(function(a){return a.lang("ar-ma",{months:"يناير_فبراير_مارس_أبريل_ماي_يونيو_يوليوز_غشت_شتنبر_أكتوبر_نونبر_دجنبر".split("_"),monthsShort:"يناير_فبراير_مارس_أبريل_ماي_يونيو_يوليوز_غشت_شتنبر_أكتوبر_نونبر_دجنبر".split("_"),weekdays:"الأحد_الإتنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"احد_اتنين_ثلاثاء_اربعاء_خميس_جمعة_سبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[اليوم على الساعة] LT",nextDay:"[غدا على الساعة] LT",nextWeek:"dddd [على الساعة] LT",lastDay:"[أمس على الساعة] LT",lastWeek:"dddd [على الساعة] LT",sameElse:"L"},relativeTime:{future:"في %s",past:"منذ %s",s:"ثوان",m:"دقيقة",mm:"%d دقائق",h:"ساعة",hh:"%d ساعات",d:"يوم",dd:"%d أيام",M:"شهر",MM:"%d أشهر",y:"سنة",yy:"%d سنوات"},week:{dow:6,doy:12}})}),function(a){a(bb)}(function(a){return a.lang("ar",{months:"يناير/ كانون الثاني_فبراير/ شباط_مارس/ آذار_أبريل/ نيسان_مايو/ أيار_يونيو/ حزيران_يوليو/ تموز_أغسطس/ آب_سبتمبر/ أيلول_أكتوبر/ تشرين الأول_نوفمبر/ تشرين الثاني_ديسمبر/ كانون الأول".split("_"),monthsShort:"يناير/ كانون الثاني_فبراير/ شباط_مارس/ آذار_أبريل/ نيسان_مايو/ أيار_يونيو/ حزيران_يوليو/ تموز_أغسطس/ آب_سبتمبر/ أيلول_أكتوبر/ تشرين الأول_نوفمبر/ تشرين الثاني_ديسمبر/ كانون الأول".split("_"),weekdays:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[اليوم على الساعة] LT",nextDay:"[غدا على الساعة] LT",nextWeek:"dddd [على الساعة] LT",lastDay:"[أمس على الساعة] LT",lastWeek:"dddd [على الساعة] LT",sameElse:"L"},relativeTime:{future:"في %s",past:"منذ %s",s:"ثوان",m:"دقيقة",mm:"%d دقائق",h:"ساعة",hh:"%d ساعات",d:"يوم",dd:"%d أيام",M:"شهر",MM:"%d أشهر",y:"سنة",yy:"%d سنوات"},week:{dow:6,doy:12}})}),function(a){a(bb)}(function(a){return a.lang("bg",{months:"януари_февруари_март_април_май_юни_юли_август_септември_октомври_ноември_декември".split("_"),monthsShort:"янр_фев_мар_апр_май_юни_юли_авг_сеп_окт_ное_дек".split("_"),weekdays:"неделя_понеделник_вторник_сряда_четвъртък_петък_събота".split("_"),weekdaysShort:"нед_пон_вто_сря_чет_пет_съб".split("_"),weekdaysMin:"нд_пн_вт_ср_чт_пт_сб".split("_"),longDateFormat:{LT:"H:mm",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Днес в] LT",nextDay:"[Утре в] LT",nextWeek:"dddd [в] LT",lastDay:"[Вчера в] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[В изминалата] dddd [в] LT";case 1:case 2:case 4:case 5:return"[В изминалия] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"след %s",past:"преди %s",s:"няколко секунди",m:"минута",mm:"%d минути",h:"час",hh:"%d часа",d:"ден",dd:"%d дни",M:"месец",MM:"%d месеца",y:"година",yy:"%d години"},ordinal:function(a){var b=a%10,c=a%100;return 0===a?a+"-ев":0===c?a+"-ен":c>10&&20>c?a+"-ти":1===b?a+"-ви":2===b?a+"-ри":7===b||8===b?a+"-ми":a+"-ти"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(b){function c(a,b,c){var d={mm:"munutenn",MM:"miz",dd:"devezh"};return a+" "+f(d[c],a)}function d(a){switch(e(a)){case 1:case 3:case 4:case 5:case 9:return a+" bloaz";default:return a+" vloaz"}}function e(a){return a>9?e(a%10):a}function f(a,b){return 2===b?g(a):a}function g(b){var c={m:"v",b:"v",d:"z"};return c[b.charAt(0)]===a?b:c[b.charAt(0)]+b.substring(1)}return b.lang("br",{months:"Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),longDateFormat:{LT:"h[e]mm A",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY LT",LLLL:"dddd, D [a viz] MMMM YYYY LT"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warc'hoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dec'h da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s 'zo",s:"un nebeud segondennoù",m:"ur vunutenn",mm:c,h:"un eur",hh:"%d eur",d:"un devezh",dd:c,M:"ur miz",MM:c,y:"ur bloaz",yy:d},ordinal:function(a){var b=1===a?"añ":"vet";return a+b},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mjesec":2===a||3===a||4===a?"mjeseca":"mjeseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}return a.lang("bs",{months:"januar_februar_mart_april_maj_juni_juli_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),weekdays:"nedjelja_ponedjeljak_utorak_srijeda_četvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._čet._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_če_pe_su".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jučer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prošlu] dddd [u] LT";case 6:return"[prošle] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[prošli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:b,mm:b,h:b,hh:b,d:"dan",dd:b,M:"mjesec",MM:b,y:"godinu",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("ca",{months:"Gener_Febrer_Març_Abril_Maig_Juny_Juliol_Agost_Setembre_Octubre_Novembre_Desembre".split("_"),monthsShort:"Gen._Febr._Mar._Abr._Mai._Jun._Jul._Ag._Set._Oct._Nov._Des.".split("_"),weekdays:"Diumenge_Dilluns_Dimarts_Dimecres_Dijous_Divendres_Dissabte".split("_"),weekdaysShort:"Dg._Dl._Dt._Dc._Dj._Dv._Ds.".split("_"),weekdaysMin:"Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[demà a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"fa %s",s:"uns segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},ordinal:"%dº",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a){return a>1&&5>a&&1!==~~(a/10)}function c(a,c,d,e){var f=a+" ";switch(d){case"s":return c||e?"pár vteřin":"pár vteřinami";case"m":return c?"minuta":e?"minutu":"minutou";case"mm":return c||e?f+(b(a)?"minuty":"minut"):f+"minutami";break;case"h":return c?"hodina":e?"hodinu":"hodinou";case"hh":return c||e?f+(b(a)?"hodiny":"hodin"):f+"hodinami";break;case"d":return c||e?"den":"dnem";case"dd":return c||e?f+(b(a)?"dny":"dní"):f+"dny";break;case"M":return c||e?"měsíc":"měsícem";case"MM":return c||e?f+(b(a)?"měsíce":"měsíců"):f+"měsíci";break;case"y":return c||e?"rok":"rokem";case"yy":return c||e?f+(b(a)?"roky":"let"):f+"lety"}}var d="leden_únor_březen_duben_květen_červen_červenec_srpen_září_říjen_listopad_prosinec".split("_"),e="led_úno_bře_dub_kvě_čvn_čvc_srp_zář_říj_lis_pro".split("_");return a.lang("cs",{months:d,monthsShort:e,monthsParse:function(a,b){var c,d=[];for(c=0;12>c;c++)d[c]=new RegExp("^"+a[c]+"$|^"+b[c]+"$","i");return d}(d,e),weekdays:"neděle_pondělí_úterý_středa_čtvrtek_pátek_sobota".split("_"),weekdaysShort:"ne_po_út_st_čt_pá_so".split("_"),weekdaysMin:"ne_po_út_st_čt_pá_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd D. MMMM YYYY LT"},calendar:{sameDay:"[dnes v] LT",nextDay:"[zítra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v neděli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve středu v] LT";case 4:return"[ve čtvrtek v] LT";case 5:return"[v pátek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[včera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou neděli v] LT";case 1:case 2:return"[minulé] dddd [v] LT";case 3:return"[minulou středu v] LT";case 4:case 5:return"[minulý] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"před %s",s:c,m:c,mm:c,h:c,hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("cv",{months:"кăрлач_нарăс_пуш_ака_май_çĕртме_утă_çурла_авăн_юпа_чӳк_раштав".split("_"),monthsShort:"кăр_нар_пуш_ака_май_çĕр_утă_çур_ав_юпа_чӳк_раш".split("_"),weekdays:"вырсарникун_тунтикун_ытларикун_юнкун_кĕçнерникун_эрнекун_шăматкун".split("_"),weekdaysShort:"выр_тун_ытл_юн_кĕç_эрн_шăм".split("_"),weekdaysMin:"вр_тн_ыт_юн_кç_эр_шм".split("_"),longDateFormat:{LT:"HH:mm",L:"DD-MM-YYYY",LL:"YYYY [çулхи] MMMM [уйăхĕн] D[-мĕшĕ]",LLL:"YYYY [çулхи] MMMM [уйăхĕн] D[-мĕшĕ], LT",LLLL:"dddd, YYYY [çулхи] MMMM [уйăхĕн] D[-мĕшĕ], LT"},calendar:{sameDay:"[Паян] LT [сехетре]",nextDay:"[Ыран] LT [сехетре]",lastDay:"[Ĕнер] LT [сехетре]",nextWeek:"[Çитес] dddd LT [сехетре]",lastWeek:"[Иртнĕ] dddd LT [сехетре]",sameElse:"L"},relativeTime:{future:function(a){var b=/сехет$/i.exec(a)?"рен":/çул$/i.exec(a)?"тан":"ран";return a+b},past:"%s каялла",s:"пĕр-ик çеккунт",m:"пĕр минут",mm:"%d минут",h:"пĕр сехет",hh:"%d сехет",d:"пĕр кун",dd:"%d кун",M:"пĕр уйăх",MM:"%d уйăх",y:"пĕр çул",yy:"%d çул"},ordinal:"%d-мĕш",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn &#244;l",s:"ychydig eiliadau",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},ordinal:function(a){var b=a,c="",d=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"];return b>20?c=40===b||50===b||60===b||80===b||100===b?"fed":"ain":b>0&&(c=d[b]),a+c},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"søndag_mandag_tirsdag_onsdag_torsdag_fredag_lørdag".split("_"),weekdaysShort:"søn_man_tir_ons_tor_fre_lør".split("_"),weekdaysMin:"sø_ma_ti_on_to_fr_lø".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D. MMMM, YYYY LT"},calendar:{sameDay:"[I dag kl.] LT",nextDay:"[I morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[I går kl.] LT",lastWeek:"[sidste] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"få sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en måned",MM:"%d måneder",y:"et år",yy:"%d år"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a,b,c){var d={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[a+" Tage",a+" Tagen"],M:["ein Monat","einem Monat"],MM:[a+" Monate",a+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[a+" Jahre",a+" Jahren"]};return b?d[c][0]:d[c][1]}return a.lang("de",{months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),longDateFormat:{LT:"H:mm [Uhr]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Heute um] LT",sameElse:"L",nextDay:"[Morgen um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gestern um] LT",lastWeek:"[letzten] dddd [um] LT"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:b,mm:"%d Minuten",h:b,hh:"%d Stunden",d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("el",{monthsNominativeEl:"Ιανουάριος_Φεβρουάριος_Μάρτιος_Απρίλιος_Μάιος_Ιούνιος_Ιούλιος_Αύγουστος_Σεπτέμβριος_Οκτώβριος_Νοέμβριος_Δεκέμβριος".split("_"),monthsGenitiveEl:"Ιανουαρίου_Φεβρουαρίου_Μαρτίου_Απριλίου_Μαΐου_Ιουνίου_Ιουλίου_Αυγούστου_Σεπτεμβρίου_Οκτωβρίου_Νοεμβρίου_Δεκεμβρίου".split("_"),months:function(a,b){return/D/.test(b.substring(0,b.indexOf("MMMM")))?this._monthsGenitiveEl[a.month()]:this._monthsNominativeEl[a.month()]},monthsShort:"Ιαν_Φεβ_Μαρ_Απρ_Μαϊ_Ιουν_Ιουλ_Αυγ_Σεπ_Οκτ_Νοε_Δεκ".split("_"),weekdays:"Κυριακή_Δευτέρα_Τρίτη_Τετάρτη_Πέμπτη_Παρασκευή_Σάββατο".split("_"),weekdaysShort:"Κυρ_Δευ_Τρι_Τετ_Πεμ_Παρ_Σαβ".split("_"),weekdaysMin:"Κυ_Δε_Τρ_Τε_Πε_Πα_Σα".split("_"),meridiem:function(a,b,c){return a>11?c?"μμ":"ΜΜ":c?"πμ":"ΠΜ"},longDateFormat:{LT:"h:mm A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendarEl:{sameDay:"[Σήμερα {}] LT",nextDay:"[Αύριο {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[Χθες {}] LT",lastWeek:"[την προηγούμενη] dddd [{}] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendarEl[a],d=b&&b.hours();return c.replace("{}",1===d%12?"στη":"στις")},relativeTime:{future:"σε %s",past:"%s πριν",s:"δευτερόλεπτα",m:"ένα λεπτό",mm:"%d λεπτά",h:"μία ώρα",hh:"%d ώρες",d:"μία μέρα",dd:"%d μέρες",M:"ένας μήνας",MM:"%d μήνες",y:"ένας χρόνος",yy:"%d χρόνια"},ordinal:function(a){return a+"η"},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"YYYY-MM-DD",LL:"D MMMM, YYYY",LLL:"D MMMM, YYYY LT",LLLL:"dddd, D MMMM, YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}})}),function(a){a(bb)}(function(a){return a.lang("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_aŭgusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aŭg_sep_okt_nov_dec".split("_"),weekdays:"Dimanĉo_Lundo_Mardo_Merkredo_Ĵaŭdo_Vendredo_Sabato".split("_"),weekdaysShort:"Dim_Lun_Mard_Merk_Ĵaŭ_Ven_Sab".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Ĵa_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"D[-an de] MMMM, YYYY",LLL:"D[-an de] MMMM, YYYY LT",LLLL:"dddd, [la] D[-an de] MMMM, YYYY LT"},meridiem:function(a,b,c){return a>11?c?"p.t.m.":"P.T.M.":c?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodiaŭ je] LT",nextDay:"[Morgaŭ je] LT",nextWeek:"dddd [je] LT",lastDay:"[Hieraŭ je] LT",lastWeek:"[pasinta] dddd [je] LT",sameElse:"L"},relativeTime:{future:"je %s",past:"antaŭ %s",s:"sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"},ordinal:"%da",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:"ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mi_Ju_Vi_Sá".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[mañana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:"%dº",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a,b,c,d){return d||b?"paari sekundi":"paar sekundit"}return a.lang("et",{months:"jaanuar_veebruar_märts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_märts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"pühapäev_esmaspäev_teisipäev_kolmapäev_neljapäev_reede_laupäev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Täna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Järgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s pärast",past:"%s tagasi",s:b,m:"minut",mm:"%d minutit",h:"tund",hh:"%d tundi",d:"päev",dd:"%d päeva",M:"kuu",MM:"%d kuud",y:"aasta",yy:"%d aastat"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] LT",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] LT",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] LT",llll:"ddd, YYYY[ko] MMM D[a] LT"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){var b={1:"۱",2:"۲",3:"۳",4:"۴",5:"۵",6:"۶",7:"۷",8:"۸",9:"۹",0:"۰"},c={"۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9","۰":"0"};return a.lang("fa",{months:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),monthsShort:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),weekdays:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysShort:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysMin:"ی_د_س_چ_پ_ج_ش".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},meridiem:function(a){return 12>a?"قبل از ظهر":"بعد از ظهر"},calendar:{sameDay:"[امروز ساعت] LT",nextDay:"[فردا ساعت] LT",nextWeek:"dddd [ساعت] LT",lastDay:"[دیروز ساعت] LT",lastWeek:"dddd [پیش] [ساعت] LT",sameElse:"L"},relativeTime:{future:"در %s",past:"%s پیش",s:"چندین ثانیه",m:"یک دقیقه",mm:"%d دقیقه",h:"یک ساعت",hh:"%d ساعت",d:"یک روز",dd:"%d روز",M:"یک ماه",MM:"%d ماه",y:"یک سال",yy:"%d سال"},preparse:function(a){return a.replace(/[۰-۹]/g,function(a){return c[a]}).replace(/،/g,",")},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]}).replace(/,/g,"،")},ordinal:"%dم",week:{dow:6,doy:12}})}),function(a){a(bb)}(function(a){function b(a,b,d,e){var f="";switch(d){case"s":return e?"muutaman sekunnin":"muutama sekunti";case"m":return e?"minuutin":"minuutti";case"mm":f=e?"minuutin":"minuuttia";break;case"h":return e?"tunnin":"tunti";case"hh":f=e?"tunnin":"tuntia";break;case"d":return e?"päivän":"päivä";case"dd":f=e?"päivän":"päivää";break;case"M":return e?"kuukauden":"kuukausi";case"MM":f=e?"kuukauden":"kuukautta";break;case"y":return e?"vuoden":"vuosi";case"yy":f=e?"vuoden":"vuotta"}return f=c(a,e)+" "+f}function c(a,b){return 10>a?b?e[a]:d[a]:a}var d="nolla yksi kaksi kolme neljä viisi kuusi seitsemän kahdeksan yhdeksän".split(" "),e=["nolla","yhden","kahden","kolmen","neljän","viiden","kuuden",d[7],d[8],d[9]];return a.lang("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_kesäkuu_heinäkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kesä_heinä_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] LT",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] LT",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] LT",llll:"ddd, Do MMM YYYY, [klo] LT"},calendar:{sameDay:"[tänään] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s päästä",past:"%s sitten",s:b,m:b,mm:b,h:b,hh:b,d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("fo",{months:"januar_februar_mars_apríl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mánadagur_týsdagur_mikudagur_hósdagur_fríggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mán_týs_mik_hós_frí_ley".split("_"),weekdaysMin:"su_má_tý_mi_hó_fr_le".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D. MMMM, YYYY LT"},calendar:{sameDay:"[Í dag kl.] LT",nextDay:"[Í morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[Í gjár kl.] LT",lastWeek:"[síðstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s síðani",s:"fá sekund",m:"ein minutt",mm:"%d minuttir",h:"ein tími",hh:"%d tímar",d:"ein dagur",dd:"%d dagar",M:"ein mánaði",MM:"%d mánaðir",y:"eitt ár",yy:"%d ár"},ordinal:"%d.",week:{dow:1,doy:4}})
}),function(a){a(bb)}(function(a){return a.lang("fr-ca",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(a){return a+(1===a?"er":"")}})}),function(a){a(bb)}(function(a){return a.lang("fr",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(a){return a+(1===a?"er":"")},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("gl",{months:"Xaneiro_Febreiro_Marzo_Abril_Maio_Xuño_Xullo_Agosto_Setembro_Outubro_Novembro_Decembro".split("_"),monthsShort:"Xan._Feb._Mar._Abr._Mai._Xuñ._Xul._Ago._Set._Out._Nov._Dec.".split("_"),weekdays:"Domingo_Luns_Martes_Mércores_Xoves_Venres_Sábado".split("_"),weekdaysShort:"Dom._Lun._Mar._Mér._Xov._Ven._Sáb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mé_Xo_Ve_Sá".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"ás":"á")+"] LT"},nextDay:function(){return"[mañá "+(1!==this.hours()?"ás":"á")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"ás":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"á":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"ás":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(a){return"uns segundos"===a?"nuns segundos":"en "+a},past:"hai %s",s:"uns segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},ordinal:"%dº",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("he",{months:"ינואר_פברואר_מרץ_אפריל_מאי_יוני_יולי_אוגוסט_ספטמבר_אוקטובר_נובמבר_דצמבר".split("_"),monthsShort:"ינו׳_פבר׳_מרץ_אפר׳_מאי_יוני_יולי_אוג׳_ספט׳_אוק׳_נוב׳_דצמ׳".split("_"),weekdays:"ראשון_שני_שלישי_רביעי_חמישי_שישי_שבת".split("_"),weekdaysShort:"א׳_ב׳_ג׳_ד׳_ה׳_ו׳_ש׳".split("_"),weekdaysMin:"א_ב_ג_ד_ה_ו_ש".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [ב]MMMM YYYY",LLL:"D [ב]MMMM YYYY LT",LLLL:"dddd, D [ב]MMMM YYYY LT",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY LT",llll:"ddd, D MMM YYYY LT"},calendar:{sameDay:"[היום ב־]LT",nextDay:"[מחר ב־]LT",nextWeek:"dddd [בשעה] LT",lastDay:"[אתמול ב־]LT",lastWeek:"[ביום] dddd [האחרון בשעה] LT",sameElse:"L"},relativeTime:{future:"בעוד %s",past:"לפני %s",s:"מספר שניות",m:"דקה",mm:"%d דקות",h:"שעה",hh:function(a){return 2===a?"שעתיים":a+" שעות"},d:"יום",dd:function(a){return 2===a?"יומיים":a+" ימים"},M:"חודש",MM:function(a){return 2===a?"חודשיים":a+" חודשים"},y:"שנה",yy:function(a){return 2===a?"שנתיים":a+" שנים"}}})}),function(a){a(bb)}(function(a){var b={1:"१",2:"२",3:"३",4:"४",5:"५",6:"६",7:"७",8:"८",9:"९",0:"०"},c={"१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9","०":"0"};return a.lang("hi",{months:"जनवरी_फ़रवरी_मार्च_अप्रैल_मई_जून_जुलाई_अगस्त_सितम्बर_अक्टूबर_नवम्बर_दिसम्बर".split("_"),monthsShort:"जन._फ़र._मार्च_अप्रै._मई_जून_जुल._अग._सित._अक्टू._नव._दिस.".split("_"),weekdays:"रविवार_सोमवार_मंगलवार_बुधवार_गुरूवार_शुक्रवार_शनिवार".split("_"),weekdaysShort:"रवि_सोम_मंगल_बुध_गुरू_शुक्र_शनि".split("_"),weekdaysMin:"र_सो_मं_बु_गु_शु_श".split("_"),longDateFormat:{LT:"A h:mm बजे",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[आज] LT",nextDay:"[कल] LT",nextWeek:"dddd, LT",lastDay:"[कल] LT",lastWeek:"[पिछले] dddd, LT",sameElse:"L"},relativeTime:{future:"%s में",past:"%s पहले",s:"कुछ ही क्षण",m:"एक मिनट",mm:"%d मिनट",h:"एक घंटा",hh:"%d घंटे",d:"एक दिन",dd:"%d दिन",M:"एक महीने",MM:"%d महीने",y:"एक वर्ष",yy:"%d वर्ष"},preparse:function(a){return a.replace(/[१२३४५६७८९०]/g,function(a){return c[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]})},meridiem:function(a){return 4>a?"रात":10>a?"सुबह":17>a?"दोपहर":20>a?"शाम":"रात"},week:{dow:0,doy:6}})}),function(a){a(bb)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mjesec":2===a||3===a||4===a?"mjeseca":"mjeseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}return a.lang("hr",{months:"sječanj_veljača_ožujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_"),monthsShort:"sje._vel._ožu._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),weekdays:"nedjelja_ponedjeljak_utorak_srijeda_četvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._čet._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_če_pe_su".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jučer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prošlu] dddd [u] LT";case 6:return"[prošle] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[prošli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:b,mm:b,h:b,hh:b,d:"dan",dd:b,M:"mjesec",MM:b,y:"godinu",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){function b(a,b,c,d){var e=a;switch(c){case"s":return d||b?"néhány másodperc":"néhány másodperce";case"m":return"egy"+(d||b?" perc":" perce");case"mm":return e+(d||b?" perc":" perce");case"h":return"egy"+(d||b?" óra":" órája");case"hh":return e+(d||b?" óra":" órája");case"d":return"egy"+(d||b?" nap":" napja");case"dd":return e+(d||b?" nap":" napja");case"M":return"egy"+(d||b?" hónap":" hónapja");case"MM":return e+(d||b?" hónap":" hónapja");case"y":return"egy"+(d||b?" év":" éve");case"yy":return e+(d||b?" év":" éve")}return""}function c(a){return(a?"":"[múlt] ")+"["+d[this.day()]+"] LT[-kor]"}var d="vasárnap hétfőn kedden szerdán csütörtökön pénteken szombaton".split(" ");return a.lang("hu",{months:"január_február_március_április_május_június_július_augusztus_szeptember_október_november_december".split("_"),monthsShort:"jan_feb_márc_ápr_máj_jún_júl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasárnap_hétfő_kedd_szerda_csütörtök_péntek_szombat".split("_"),weekdaysShort:"vas_hét_kedd_sze_csüt_pén_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D., LT",LLLL:"YYYY. MMMM D., dddd LT"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return c.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return c.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s múlva",past:"%s",s:b,m:b,mm:b,h:b,hh:b,d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] LT",LLLL:"dddd, D MMMM YYYY [pukul] LT"},meridiem:function(a){return 11>a?"pagi":15>a?"siang":19>a?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){function b(a){return 11===a%100?!0:1===a%10?!1:!0}function c(a,c,d,e){var f=a+" ";switch(d){case"s":return c||e?"nokkrar sekúndur":"nokkrum sekúndum";case"m":return c?"mínúta":"mínútu";case"mm":return b(a)?f+(c||e?"mínútur":"mínútum"):c?f+"mínúta":f+"mínútu";case"hh":return b(a)?f+(c||e?"klukkustundir":"klukkustundum"):f+"klukkustund";case"d":return c?"dagur":e?"dag":"degi";case"dd":return b(a)?c?f+"dagar":f+(e?"daga":"dögum"):c?f+"dagur":f+(e?"dag":"degi");case"M":return c?"mánuður":e?"mánuð":"mánuði";case"MM":return b(a)?c?f+"mánuðir":f+(e?"mánuði":"mánuðum"):c?f+"mánuður":f+(e?"mánuð":"mánuði");case"y":return c||e?"ár":"ári";case"yy":return b(a)?f+(c||e?"ár":"árum"):f+(c||e?"ár":"ári")}}return a.lang("is",{months:"janúar_febrúar_mars_apríl_maí_júní_júlí_ágúst_september_október_nóvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_maí_jún_júl_ágú_sep_okt_nóv_des".split("_"),weekdays:"sunnudagur_mánudagur_þriðjudagur_miðvikudagur_fimmtudagur_föstudagur_laugardagur".split("_"),weekdaysShort:"sun_mán_þri_mið_fim_fös_lau".split("_"),weekdaysMin:"Su_Má_Þr_Mi_Fi_Fö_La".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] LT",LLLL:"dddd, D. MMMM YYYY [kl.] LT"},calendar:{sameDay:"[í dag kl.] LT",nextDay:"[á morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[í gær kl.] LT",lastWeek:"[síðasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s síðan",s:c,m:c,mm:c,h:"klukkustund",hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("it",{months:"Gennaio_Febbraio_Marzo_Aprile_Maggio_Giugno_Luglio_Agosto_Settembre_Ottobre_Novembre_Dicembre".split("_"),monthsShort:"Gen_Feb_Mar_Apr_Mag_Giu_Lug_Ago_Set_Ott_Nov_Dic".split("_"),weekdays:"Domenica_Lunedì_Martedì_Mercoledì_Giovedì_Venerdì_Sabato".split("_"),weekdaysShort:"Dom_Lun_Mar_Mer_Gio_Ven_Sab".split("_"),weekdaysMin:"D_L_Ma_Me_G_V_S".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:"[lo scorso] dddd [alle] LT",sameElse:"L"},relativeTime:{future:function(a){return(/^[0-9].+$/.test(a)?"tra":"in")+" "+a},past:"%s fa",s:"secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:"%dº",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("ja",{months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),longDateFormat:{LT:"Ah時m分",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日LT",LLLL:"YYYY年M月D日LT dddd"},meridiem:function(a){return 12>a?"午前":"午後"},calendar:{sameDay:"[今日] LT",nextDay:"[明日] LT",nextWeek:"[来週]dddd LT",lastDay:"[昨日] LT",lastWeek:"[前週]dddd LT",sameElse:"L"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}})}),function(a){a(bb)}(function(a){function b(a,b){var c={nominative:"იანვარი_თებერვალი_მარტი_აპრილი_მაისი_ივნისი_ივლისი_აგვისტო_სექტემბერი_ოქტომბერი_ნოემბერი_დეკემბერი".split("_"),accusative:"იანვარს_თებერვალს_მარტს_აპრილის_მაისს_ივნისს_ივლისს_აგვისტს_სექტემბერს_ოქტომბერს_ნოემბერს_დეკემბერს".split("_")},d=/D[oD] *MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function c(a,b){var c={nominative:"კვირა_ორშაბათი_სამშაბათი_ოთხშაბათი_ხუთშაბათი_პარასკევი_შაბათი".split("_"),accusative:"კვირას_ორშაბათს_სამშაბათს_ოთხშაბათს_ხუთშაბათს_პარასკევს_შაბათს".split("_")},d=/(წინა|შემდეგ)/.test(b)?"accusative":"nominative";return c[d][a.day()]}return a.lang("ka",{months:b,monthsShort:"იან_თებ_მარ_აპრ_მაი_ივნ_ივლ_აგვ_სექ_ოქტ_ნოე_დეკ".split("_"),weekdays:c,weekdaysShort:"კვი_ორშ_სამ_ოთხ_ხუთ_პარ_შაბ".split("_"),weekdaysMin:"კვ_ორ_სა_ოთ_ხუ_პა_შა".split("_"),longDateFormat:{LT:"h:mm A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[დღეს] LT[-ზე]",nextDay:"[ხვალ] LT[-ზე]",lastDay:"[გუშინ] LT[-ზე]",nextWeek:"[შემდეგ] dddd LT[-ზე]",lastWeek:"[წინა] dddd LT-ზე",sameElse:"L"},relativeTime:{future:function(a){return/(წამი|წუთი|საათი|წელი)/.test(a)?a.replace(/ი$/,"ში"):a+"ში"},past:function(a){return/(წამი|წუთი|საათი|დღე|თვე)/.test(a)?a.replace(/(ი|ე)$/,"ის წინ"):/წელი/.test(a)?a.replace(/წელი$/,"წლის წინ"):void 0},s:"რამდენიმე წამი",m:"წუთი",mm:"%d წუთი",h:"საათი",hh:"%d საათი",d:"დღე",dd:"%d დღე",M:"თვე",MM:"%d თვე",y:"წელი",yy:"%d წელი"},ordinal:function(a){return 0===a?a:1===a?a+"-ლი":20>a||100>=a&&0===a%20||0===a%100?"მე-"+a:a+"-ე"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("ko",{months:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),monthsShort:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),weekdays:"일요일_월요일_화요일_수요일_목요일_금요일_토요일".split("_"),weekdaysShort:"일_월_화_수_목_금_토".split("_"),weekdaysMin:"일_월_화_수_목_금_토".split("_"),longDateFormat:{LT:"A h시 mm분",L:"YYYY.MM.DD",LL:"YYYY년 MMMM D일",LLL:"YYYY년 MMMM D일 LT",LLLL:"YYYY년 MMMM D일 dddd LT"},meridiem:function(a){return 12>a?"오전":"오후"},calendar:{sameDay:"오늘 LT",nextDay:"내일 LT",nextWeek:"dddd LT",lastDay:"어제 LT",lastWeek:"지난주 dddd LT",sameElse:"L"},relativeTime:{future:"%s 후",past:"%s 전",s:"몇초",ss:"%d초",m:"일분",mm:"%d분",h:"한시간",hh:"%d시간",d:"하루",dd:"%d일",M:"한달",MM:"%d달",y:"일년",yy:"%d년"},ordinal:"%d일"})}),function(a){a(bb)}(function(a){function b(a,b,c,d){return b?"kelios sekundės":d?"kelių sekundžių":"kelias sekundes"}function c(a,b,c,d){return b?e(c)[0]:d?e(c)[1]:e(c)[2]}function d(a){return 0===a%10||a>10&&20>a}function e(a){return h[a].split("_")}function f(a,b,f,g){var h=a+" ";return 1===a?h+c(a,b,f[0],g):b?h+(d(a)?e(f)[1]:e(f)[0]):g?h+e(f)[1]:h+(d(a)?e(f)[1]:e(f)[2])}function g(a,b){var c=-1===b.indexOf("dddd LT"),d=i[a.weekday()];return c?d:d.substring(0,d.length-2)+"į"}var h={m:"minutė_minutės_minutę",mm:"minutės_minučių_minutes",h:"valanda_valandos_valandą",hh:"valandos_valandų_valandas",d:"diena_dienos_dieną",dd:"dienos_dienų_dienas",M:"mėnuo_mėnesio_mėnesį",MM:"mėnesiai_mėnesių_mėnesius",y:"metai_metų_metus",yy:"metai_metų_metus"},i="pirmadienis_antradienis_trečiadienis_ketvirtadienis_penktadienis_šeštadienis_sekmadienis".split("_");return a.lang("lt",{months:"sausio_vasario_kovo_balandžio_gegužės_biržėlio_liepos_rugpjūčio_rugsėjo_spalio_lapkričio_gruodžio".split("_"),monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:g,weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_Šeš".split("_"),weekdaysMin:"S_P_A_T_K_Pn_Š".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], LT [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, LT [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], LT [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, LT [val.]"},calendar:{sameDay:"[Šiandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Praėjusį] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prieš %s",s:b,m:c,mm:f,h:c,hh:f,d:c,dd:f,M:c,MM:f,y:c,yy:f},ordinal:function(a){return a+"-oji"},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a,b,c){var d=a.split("_");return c?1===b%10&&11!==b?d[2]:d[3]:1===b%10&&11!==b?d[0]:d[1]}function c(a,c,e){return a+" "+b(d[e],a,c)}var d={mm:"minūti_minūtes_minūte_minūtes",hh:"stundu_stundas_stunda_stundas",dd:"dienu_dienas_diena_dienas",MM:"mēnesi_mēnešus_mēnesis_mēneši",yy:"gadu_gadus_gads_gadi"};return a.lang("lv",{months:"janvāris_februāris_marts_aprīlis_maijs_jūnijs_jūlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jūn_jūl_aug_sep_okt_nov_dec".split("_"),weekdays:"svētdiena_pirmdiena_otrdiena_trešdiena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, LT",LLLL:"YYYY. [gada] D. MMMM, dddd, LT"},calendar:{sameDay:"[Šodien pulksten] LT",nextDay:"[Rīt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagājušā] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"%s vēlāk",past:"%s agrāk",s:"dažas sekundes",m:"minūti",mm:c,h:"stundu",hh:c,d:"dienu",dd:c,M:"mēnesi",MM:c,y:"gadu",yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("ml",{months:"ജനുവരി_ഫെബ്രുവരി_മാർച്ച്_ഏപ്രിൽ_മേയ്_ജൂൺ_ജൂലൈ_ഓഗസ്റ്റ്_സെപ്റ്റംബർ_ഒക്ടോബർ_നവംബർ_ഡിസംബർ".split("_"),monthsShort:"ജനു._ഫെബ്രു._മാർ._ഏപ്രി._മേയ്_ജൂൺ_ജൂലൈ._ഓഗ._സെപ്റ്റ._ഒക്ടോ._നവം._ഡിസം.".split("_"),weekdays:"ഞായറാഴ്ച_തിങ്കളാഴ്ച_ചൊവ്വാഴ്ച_ബുധനാഴ്ച_വ്യാഴാഴ്ച_വെള്ളിയാഴ്ച_ശനിയാഴ്ച".split("_"),weekdaysShort:"ഞായർ_തിങ്കൾ_ചൊവ്വ_ബുധൻ_വ്യാഴം_വെള്ളി_ശനി".split("_"),weekdaysMin:"ഞാ_തി_ചൊ_ബു_വ്യാ_വെ_ശ".split("_"),longDateFormat:{LT:"A h:mm -നു",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[ഇന്ന്] LT",nextDay:"[നാളെ] LT",nextWeek:"dddd, LT",lastDay:"[ഇന്നലെ] LT",lastWeek:"[കഴിഞ്ഞ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s കഴിഞ്ഞ്",past:"%s മുൻപ്",s:"അൽപ നിമിഷങ്ങൾ",m:"ഒരു മിനിറ്റ്",mm:"%d മിനിറ്റ്",h:"ഒരു മണിക്കൂർ",hh:"%d മണിക്കൂർ",d:"ഒരു ദിവസം",dd:"%d ദിവസം",M:"ഒരു മാസം",MM:"%d മാസം",y:"ഒരു വർഷം",yy:"%d വർഷം"},meridiem:function(a){return 4>a?"രാത്രി":12>a?"രാവിലെ":17>a?"ഉച്ച കഴിഞ്ഞ്":20>a?"വൈകുന്നേരം":"രാത്രി"}})}),function(a){a(bb)}(function(a){var b={1:"१",2:"२",3:"३",4:"४",5:"५",6:"६",7:"७",8:"८",9:"९",0:"०"},c={"१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9","०":"0"};return a.lang("mr",{months:"जानेवारी_फेब्रुवारी_मार्च_एप्रिल_मे_जून_जुलै_ऑगस्ट_सप्टेंबर_ऑक्टोबर_नोव्हेंबर_डिसेंबर".split("_"),monthsShort:"जाने._फेब्रु._मार्च._एप्रि._मे._जून._जुलै._ऑग._सप्टें._ऑक्टो._नोव्हें._डिसें.".split("_"),weekdays:"रविवार_सोमवार_मंगळवार_बुधवार_गुरूवार_शुक्रवार_शनिवार".split("_"),weekdaysShort:"रवि_सोम_मंगळ_बुध_गुरू_शुक्र_शनि".split("_"),weekdaysMin:"र_सो_मं_बु_गु_शु_श".split("_"),longDateFormat:{LT:"A h:mm वाजता",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[आज] LT",nextDay:"[उद्या] LT",nextWeek:"dddd, LT",lastDay:"[काल] LT",lastWeek:"[मागील] dddd, LT",sameElse:"L"},relativeTime:{future:"%s नंतर",past:"%s पूर्वी",s:"सेकंद",m:"एक मिनिट",mm:"%d मिनिटे",h:"एक तास",hh:"%d तास",d:"एक दिवस",dd:"%d दिवस",M:"एक महिना",MM:"%d महिने",y:"एक वर्ष",yy:"%d वर्षे"},preparse:function(a){return a.replace(/[१२३४५६७८९०]/g,function(a){return c[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]})},meridiem:function(a){return 4>a?"रात्री":10>a?"सकाळी":17>a?"दुपारी":20>a?"सायंकाळी":"रात्री"},week:{dow:0,doy:6}})}),function(a){a(bb)}(function(a){return a.lang("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] LT",LLLL:"dddd, D MMMM YYYY [pukul] LT"},meridiem:function(a){return 11>a?"pagi":15>a?"tengahari":19>a?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),weekdays:"søndag_mandag_tirsdag_onsdag_torsdag_fredag_lørdag".split("_"),weekdaysShort:"sø._ma._ti._on._to._fr._lø.".split("_"),weekdaysMin:"sø_ma_ti_on_to_fr_lø".split("_"),longDateFormat:{LT:"H.mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] LT",LLLL:"dddd D. MMMM YYYY [kl.] LT"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i går kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"for %s siden",s:"noen sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en måned",MM:"%d måneder",y:"ett år",yy:"%d år"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){var b={1:"१",2:"२",3:"३",4:"४",5:"५",6:"६",7:"७",8:"८",9:"९",0:"०"},c={"१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9","०":"0"};return a.lang("ne",{months:"जनवरी_फेब्रुवरी_मार्च_अप्रिल_मई_जुन_जुलाई_अगष्ट_सेप्टेम्बर_अक्टोबर_नोभेम्बर_डिसेम्बर".split("_"),monthsShort:"जन._फेब्रु._मार्च_अप्रि._मई_जुन_जुलाई._अग._सेप्ट._अक्टो._नोभे._डिसे.".split("_"),weekdays:"आइतबार_सोमबार_मङ्गलबार_बुधबार_बिहिबार_शुक्रबार_शनिबार".split("_"),weekdaysShort:"आइत._सोम._मङ्गल._बुध._बिहि._शुक्र._शनि.".split("_"),weekdaysMin:"आइ._सो._मङ्_बु._बि._शु._श.".split("_"),longDateFormat:{LT:"Aको h:mm बजे",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},preparse:function(a){return a.replace(/[१२३४५६७८९०]/g,function(a){return c[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]})},meridiem:function(a){return 3>a?"राती":10>a?"बिहान":15>a?"दिउँसो":18>a?"बेलुका":20>a?"साँझ":"राती"},calendar:{sameDay:"[आज] LT",nextDay:"[भोली] LT",nextWeek:"[आउँदो] dddd[,] LT",lastDay:"[हिजो] LT",lastWeek:"[गएको] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%sमा",past:"%s अगाडी",s:"केही समय",m:"एक मिनेट",mm:"%d मिनेट",h:"एक घण्टा",hh:"%d घण्टा",d:"एक दिन",dd:"%d दिन",M:"एक महिना",MM:"%d महिना",y:"एक बर्ष",yy:"%d बर्ष"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){var b="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),c="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_");return a.lang("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(a,d){return/-MMM-/.test(d)?c[a.month()]:b[a.month()]},weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"Zo_Ma_Di_Wo_Do_Vr_Za".split("_"),longDateFormat:{LT:"HH:mm",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"één minuut",mm:"%d minuten",h:"één uur",hh:"%d uur",d:"één dag",dd:"%d dagen",M:"één maand",MM:"%d maanden",y:"één jaar",yy:"%d jaar"},ordinal:function(a){return a+(1===a||8===a||a>=20?"ste":"de")},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sundag_måndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mån_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_må_ty_on_to_fr_lø".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I går klokka] LT",lastWeek:"[Føregående] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"for %s siden",s:"noen sekund",m:"ett minutt",mm:"%d minutt",h:"en time",hh:"%d timar",d:"en dag",dd:"%d dagar",M:"en månad",MM:"%d månader",y:"ett år",yy:"%d år"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a){return 5>a%10&&a%10>1&&1!==~~(a/10)}function c(a,c,d){var e=a+" ";switch(d){case"m":return c?"minuta":"minutę";case"mm":return e+(b(a)?"minuty":"minut");case"h":return c?"godzina":"godzinę";case"hh":return e+(b(a)?"godziny":"godzin");case"MM":return e+(b(a)?"miesiące":"miesięcy");case"yy":return e+(b(a)?"lata":"lat")}}var d="styczeń_luty_marzec_kwiecień_maj_czerwiec_lipiec_sierpień_wrzesień_październik_listopad_grudzień".split("_"),e="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_września_października_listopada_grudnia".split("_");return a.lang("pl",{months:function(a,b){return/D MMMM/.test(b)?e[a.month()]:d[a.month()]},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_paź_lis_gru".split("_"),weekdays:"niedziela_poniedziałek_wtorek_środa_czwartek_piątek_sobota".split("_"),weekdaysShort:"nie_pon_wt_śr_czw_pt_sb".split("_"),weekdaysMin:"N_Pn_Wt_Śr_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Dziś o] LT",nextDay:"[Jutro o] LT",nextWeek:"[W] dddd [o] LT",lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zeszłą niedzielę o] LT";case 3:return"[W zeszłą środę o] LT";case 6:return"[W zeszłą sobotę o] LT";default:return"[W zeszły] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:c,mm:c,h:c,hh:c,d:"1 dzień",dd:"%d dni",M:"miesiąc",MM:c,y:"rok",yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("pt-br",{months:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Terça-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sábado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb".split("_"),weekdaysMin:"Dom_2ª_3ª_4ª_5ª_6ª_Sáb".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:"[Hoje às] LT",nextDay:"[Amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[Ontem às] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[Último] dddd [às] LT":"[Última] dddd [às] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrás",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinal:"%dº"})}),function(a){a(bb)}(function(a){return a.lang("pt",{months:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Terça-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sábado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb".split("_"),weekdaysMin:"Dom_2ª_3ª_4ª_5ª_6ª_Sáb".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:"[Hoje às] LT",nextDay:"[Amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[Ontem às] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[Último] dddd [às] LT":"[Última] dddd [às] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrás",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinal:"%dº",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("ro",{months:"Ianuarie_Februarie_Martie_Aprilie_Mai_Iunie_Iulie_August_Septembrie_Octombrie_Noiembrie_Decembrie".split("_"),monthsShort:"Ian_Feb_Mar_Apr_Mai_Iun_Iul_Aug_Sep_Oct_Noi_Dec".split("_"),weekdays:"Duminică_Luni_Marţi_Miercuri_Joi_Vineri_Sâmbătă".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sâm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_Sâ".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mâine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s în urmă",s:"câteva secunde",m:"un minut",mm:"%d minute",h:"o oră",hh:"%d ore",d:"o zi",dd:"%d zile",M:"o lună",MM:"%d luni",y:"un an",yy:"%d ani"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){function b(a,b){var c=a.split("_");return 1===b%10&&11!==b%100?c[0]:b%10>=2&&4>=b%10&&(10>b%100||b%100>=20)?c[1]:c[2]}function c(a,c,d){var e={mm:"минута_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"};return"m"===d?c?"минута":"минуту":a+" "+b(e[d],+a)}function d(a,b){var c={nominative:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),accusative:"января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_")},d=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function e(a,b){var c={nominative:"янв_фев_мар_апр_май_июнь_июль_авг_сен_окт_ноя_дек".split("_"),accusative:"янв_фев_мар_апр_мая_июня_июля_авг_сен_окт_ноя_дек".split("_")},d=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function f(a,b){var c={nominative:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),accusative:"воскресенье_понедельник_вторник_среду_четверг_пятницу_субботу".split("_")},d=/\[ ?[Вв] ?(?:прошлую|следующую)? ?\] ?dddd/.test(b)?"accusative":"nominative";return c[d][a.day()]}return a.lang("ru",{months:d,monthsShort:e,weekdays:f,weekdaysShort:"вс_пн_вт_ср_чт_пт_сб".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),monthsParse:[/^янв/i,/^фев/i,/^мар/i,/^апр/i,/^ма[й|я]/i,/^июн/i,/^июл/i,/^авг/i,/^сен/i,/^окт/i,/^ноя/i,/^дек/i],longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., LT",LLLL:"dddd, D MMMM YYYY г., LT"},calendar:{sameDay:"[Сегодня в] LT",nextDay:"[Завтра в] LT",lastDay:"[Вчера в] LT",nextWeek:function(){return 2===this.day()?"[Во] dddd [в] LT":"[В] dddd [в] LT"},lastWeek:function(){switch(this.day()){case 0:return"[В прошлое] dddd [в] LT";
case 1:case 2:case 4:return"[В прошлый] dddd [в] LT";case 3:case 5:case 6:return"[В прошлую] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:c,mm:c,h:"час",hh:c,d:"день",dd:c,M:"месяц",MM:c,y:"год",yy:c},meridiem:function(a){return 4>a?"ночи":12>a?"утра":17>a?"дня":"вечера"},ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":return a+"-й";case"D":return a+"-го";case"w":case"W":return a+"-я";default:return a}},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){function b(a){return a>1&&5>a}function c(a,c,d,e){var f=a+" ";switch(d){case"s":return c||e?"pár sekúnd":"pár sekundami";case"m":return c?"minúta":e?"minútu":"minútou";case"mm":return c||e?f+(b(a)?"minúty":"minút"):f+"minútami";break;case"h":return c?"hodina":e?"hodinu":"hodinou";case"hh":return c||e?f+(b(a)?"hodiny":"hodín"):f+"hodinami";break;case"d":return c||e?"deň":"dňom";case"dd":return c||e?f+(b(a)?"dni":"dní"):f+"dňami";break;case"M":return c||e?"mesiac":"mesiacom";case"MM":return c||e?f+(b(a)?"mesiace":"mesiacov"):f+"mesiacmi";break;case"y":return c||e?"rok":"rokom";case"yy":return c||e?f+(b(a)?"roky":"rokov"):f+"rokmi"}}var d="január_február_marec_apríl_máj_jún_júl_august_september_október_november_december".split("_"),e="jan_feb_mar_apr_máj_jún_júl_aug_sep_okt_nov_dec".split("_");return a.lang("sk",{months:d,monthsShort:e,monthsParse:function(a,b){var c,d=[];for(c=0;12>c;c++)d[c]=new RegExp("^"+a[c]+"$|^"+b[c]+"$","i");return d}(d,e),weekdays:"nedeľa_pondelok_utorok_streda_štvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_št_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_št_pi_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd D. MMMM YYYY LT"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeľu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo štvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[včera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulú nedeľu o] LT";case 1:case 2:return"[minulý] dddd [o] LT";case 3:return"[minulú stredu o] LT";case 4:case 5:return"[minulý] dddd [o] LT";case 6:return"[minulú sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:c,m:c,mm:c,h:c,hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"ena minuta":"eno minuto";case"mm":return d+=1===a?"minuta":2===a?"minuti":3===a||4===a?"minute":"minut";case"h":return b?"ena ura":"eno uro";case"hh":return d+=1===a?"ura":2===a?"uri":3===a||4===a?"ure":"ur";case"dd":return d+=1===a?"dan":"dni";case"MM":return d+=1===a?"mesec":2===a?"meseca":3===a||4===a?"mesece":"mesecev";case"yy":return d+=1===a?"leto":2===a?"leti":3===a||4===a?"leta":"let"}}return a.lang("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),weekdays:"nedelja_ponedeljek_torek_sreda_četrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._čet._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_če_pe_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[včeraj ob] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[prejšnja] dddd [ob] LT";case 1:case 2:case 4:case 5:return"[prejšnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"čez %s",past:"%s nazaj",s:"nekaj sekund",m:b,mm:b,h:b,hh:b,d:"en dan",dd:b,M:"en mesec",MM:b,y:"eno leto",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nëntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nën_Dhj".split("_"),weekdays:"E Diel_E Hënë_E Marte_E Mërkure_E Enjte_E Premte_E Shtunë".split("_"),weekdaysShort:"Die_Hën_Mar_Mër_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_Më_E_P_Sh".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Sot në] LT",nextDay:"[Neser në] LT",nextWeek:"dddd [në] LT",lastDay:"[Dje në] LT",lastWeek:"dddd [e kaluar në] LT",sameElse:"L"},relativeTime:{future:"në %s",past:"%s me parë",s:"disa seconda",m:"një minut",mm:"%d minutea",h:"një orë",hh:"%d orë",d:"një ditë",dd:"%d ditë",M:"një muaj",MM:"%d muaj",y:"një vit",yy:"%d vite"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"söndag_måndag_tisdag_onsdag_torsdag_fredag_lördag".split("_"),weekdaysShort:"sön_mån_tis_ons_tor_fre_lör".split("_"),weekdaysMin:"sö_må_ti_on_to_fr_lö".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igår] LT",nextWeek:"dddd LT",lastWeek:"[Förra] dddd[en] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"för %s sedan",s:"några sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en månad",MM:"%d månader",y:"ett år",yy:"%d år"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"e":1===b?"a":2===b?"a":3===b?"e":"e";return a+c},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("th",{months:"มกราคม_กุมภาพันธ์_มีนาคม_เมษายน_พฤษภาคม_มิถุนายน_กรกฎาคม_สิงหาคม_กันยายน_ตุลาคม_พฤศจิกายน_ธันวาคม".split("_"),monthsShort:"มกรา_กุมภา_มีนา_เมษา_พฤษภา_มิถุนา_กรกฎา_สิงหา_กันยา_ตุลา_พฤศจิกา_ธันวา".split("_"),weekdays:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัสบดี_ศุกร์_เสาร์".split("_"),weekdaysShort:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัส_ศุกร์_เสาร์".split("_"),weekdaysMin:"อา._จ._อ._พ._พฤ._ศ._ส.".split("_"),longDateFormat:{LT:"H นาฬิกา m นาที",L:"YYYY/MM/DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY เวลา LT",LLLL:"วันddddที่ D MMMM YYYY เวลา LT"},meridiem:function(a){return 12>a?"ก่อนเที่ยง":"หลังเที่ยง"},calendar:{sameDay:"[วันนี้ เวลา] LT",nextDay:"[พรุ่งนี้ เวลา] LT",nextWeek:"dddd[หน้า เวลา] LT",lastDay:"[เมื่อวานนี้ เวลา] LT",lastWeek:"[วัน]dddd[ที่แล้ว เวลา] LT",sameElse:"L"},relativeTime:{future:"อีก %s",past:"%sที่แล้ว",s:"ไม่กี่วินาที",m:"1 นาที",mm:"%d นาที",h:"1 ชั่วโมง",hh:"%d ชั่วโมง",d:"1 วัน",dd:"%d วัน",M:"1 เดือน",MM:"%d เดือน",y:"1 ปี",yy:"%d ปี"}})}),function(a){a(bb)}(function(a){return a.lang("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM DD, YYYY LT"},calendar:{sameDay:"[Ngayon sa] LT",nextDay:"[Bukas sa] LT",nextWeek:"dddd [sa] LT",lastDay:"[Kahapon sa] LT",lastWeek:"dddd [huling linggo] LT",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},ordinal:function(a){return a},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){var b={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'üncü",4:"'üncü",100:"'üncü",6:"'ncı",9:"'uncu",10:"'uncu",30:"'uncu",60:"'ıncı",90:"'ıncı"};return a.lang("tr",{months:"Ocak_Şubat_Mart_Nisan_Mayıs_Haziran_Temmuz_Ağustos_Eylül_Ekim_Kasım_Aralık".split("_"),monthsShort:"Oca_Şub_Mar_Nis_May_Haz_Tem_Ağu_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Salı_Çarşamba_Perşembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_Çar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_Ça_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[bugün saat] LT",nextDay:"[yarın saat] LT",nextWeek:"[haftaya] dddd [saat] LT",lastDay:"[dün] LT",lastWeek:"[geçen hafta] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s önce",s:"birkaç saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gün",dd:"%d gün",M:"bir ay",MM:"%d ay",y:"bir yıl",yy:"%d yıl"},ordinal:function(a){if(0===a)return a+"'ıncı";var c=a%10,d=a%100-c,e=a>=100?100:null;return a+(b[c]||b[d]||b[e])},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("tzm-la",{months:"innayr_brˤayrˤ_marˤsˤ_ibrir_mayyw_ywnyw_ywlywz_ɣwšt_šwtanbir_ktˤwbrˤ_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brˤayrˤ_marˤsˤ_ibrir_mayyw_ywnyw_ywlywz_ɣwšt_šwtanbir_ktˤwbrˤ_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiḍyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiḍyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiḍyas".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",m:"minuḍ",mm:"%d minuḍ",h:"saɛa",hh:"%d tassaɛin",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}})}),function(a){a(bb)}(function(a){return a.lang("tzm",{months:"ⵉⵏⵏⴰⵢⵔ_ⴱⵕⴰⵢⵕ_ⵎⴰⵕⵚ_ⵉⴱⵔⵉⵔ_ⵎⴰⵢⵢⵓ_ⵢⵓⵏⵢⵓ_ⵢⵓⵍⵢⵓⵣ_ⵖⵓⵛⵜ_ⵛⵓⵜⴰⵏⴱⵉⵔ_ⴽⵟⵓⴱⵕ_ⵏⵓⵡⴰⵏⴱⵉⵔ_ⴷⵓⵊⵏⴱⵉⵔ".split("_"),monthsShort:"ⵉⵏⵏⴰⵢⵔ_ⴱⵕⴰⵢⵕ_ⵎⴰⵕⵚ_ⵉⴱⵔⵉⵔ_ⵎⴰⵢⵢⵓ_ⵢⵓⵏⵢⵓ_ⵢⵓⵍⵢⵓⵣ_ⵖⵓⵛⵜ_ⵛⵓⵜⴰⵏⴱⵉⵔ_ⴽⵟⵓⴱⵕ_ⵏⵓⵡⴰⵏⴱⵉⵔ_ⴷⵓⵊⵏⴱⵉⵔ".split("_"),weekdays:"ⴰⵙⴰⵎⴰⵙ_ⴰⵢⵏⴰⵙ_ⴰⵙⵉⵏⴰⵙ_ⴰⴽⵔⴰⵙ_ⴰⴽⵡⴰⵙ_ⴰⵙⵉⵎⵡⴰⵙ_ⴰⵙⵉⴹⵢⴰⵙ".split("_"),weekdaysShort:"ⴰⵙⴰⵎⴰⵙ_ⴰⵢⵏⴰⵙ_ⴰⵙⵉⵏⴰⵙ_ⴰⴽⵔⴰⵙ_ⴰⴽⵡⴰⵙ_ⴰⵙⵉⵎⵡⴰⵙ_ⴰⵙⵉⴹⵢⴰⵙ".split("_"),weekdaysMin:"ⴰⵙⴰⵎⴰⵙ_ⴰⵢⵏⴰⵙ_ⴰⵙⵉⵏⴰⵙ_ⴰⴽⵔⴰⵙ_ⴰⴽⵡⴰⵙ_ⴰⵙⵉⵎⵡⴰⵙ_ⴰⵙⵉⴹⵢⴰⵙ".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[ⴰⵙⴷⵅ ⴴ] LT",nextDay:"[ⴰⵙⴽⴰ ⴴ] LT",nextWeek:"dddd [ⴴ] LT",lastDay:"[ⴰⵚⴰⵏⵜ ⴴ] LT",lastWeek:"dddd [ⴴ] LT",sameElse:"L"},relativeTime:{future:"ⴷⴰⴷⵅ ⵙ ⵢⴰⵏ %s",past:"ⵢⴰⵏ %s",s:"ⵉⵎⵉⴽ",m:"ⵎⵉⵏⵓⴺ",mm:"%d ⵎⵉⵏⵓⴺ",h:"ⵙⴰⵄⴰ",hh:"%d ⵜⴰⵙⵙⴰⵄⵉⵏ",d:"ⴰⵙⵙ",dd:"%d oⵙⵙⴰⵏ",M:"ⴰⵢoⵓⵔ",MM:"%d ⵉⵢⵢⵉⵔⵏ",y:"ⴰⵙⴳⴰⵙ",yy:"%d ⵉⵙⴳⴰⵙⵏ"},week:{dow:6,doy:12}})}),function(a){a(bb)}(function(a){function b(a,b){var c=a.split("_");return 1===b%10&&11!==b%100?c[0]:b%10>=2&&4>=b%10&&(10>b%100||b%100>=20)?c[1]:c[2]}function c(a,c,d){var e={mm:"хвилина_хвилини_хвилин",hh:"година_години_годин",dd:"день_дні_днів",MM:"місяць_місяці_місяців",yy:"рік_роки_років"};return"m"===d?c?"хвилина":"хвилину":"h"===d?c?"година":"годину":a+" "+b(e[d],+a)}function d(a,b){var c={nominative:"січень_лютий_березень_квітень_травень_червень_липень_серпень_вересень_жовтень_листопад_грудень".split("_"),accusative:"січня_лютого_березня_квітня_травня_червня_липня_серпня_вересня_жовтня_листопада_грудня".split("_")},d=/D[oD]? *MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function e(a,b){var c={nominative:"неділя_понеділок_вівторок_середа_четвер_п’ятниця_субота".split("_"),accusative:"неділю_понеділок_вівторок_середу_четвер_п’ятницю_суботу".split("_"),genitive:"неділі_понеділка_вівторка_середи_четверга_п’ятниці_суботи".split("_")},d=/(\[[ВвУу]\]) ?dddd/.test(b)?"accusative":/\[?(?:минулої|наступної)? ?\] ?dddd/.test(b)?"genitive":"nominative";return c[d][a.day()]}function f(a){return function(){return a+"о"+(11===this.hours()?"б":"")+"] LT"}}return a.lang("uk",{months:d,monthsShort:"січ_лют_бер_квіт_трав_черв_лип_серп_вер_жовт_лист_груд".split("_"),weekdays:e,weekdaysShort:"нд_пн_вт_ср_чт_пт_сб".split("_"),weekdaysMin:"нд_пн_вт_ср_чт_пт_сб".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY р.",LLL:"D MMMM YYYY р., LT",LLLL:"dddd, D MMMM YYYY р., LT"},calendar:{sameDay:f("[Сьогодні "),nextDay:f("[Завтра "),lastDay:f("[Вчора "),nextWeek:f("[У] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return f("[Минулої] dddd [").call(this);case 1:case 2:case 4:return f("[Минулого] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:"за %s",past:"%s тому",s:"декілька секунд",m:c,mm:c,h:"годину",hh:c,d:"день",dd:c,M:"місяць",MM:c,y:"рік",yy:c},meridiem:function(a){return 4>a?"ночі":12>a?"ранку":17>a?"дня":"вечора"},ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":case"w":case"W":return a+"-й";case"D":return a+"-го";default:return a}},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("uz",{months:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),monthsShort:"янв_фев_мар_апр_май_июн_июл_авг_сен_окт_ноя_дек".split("_"),weekdays:"Якшанба_Душанба_Сешанба_Чоршанба_Пайшанба_Жума_Шанба".split("_"),weekdaysShort:"Якш_Душ_Сеш_Чор_Пай_Жум_Шан".split("_"),weekdaysMin:"Як_Ду_Се_Чо_Па_Жу_Ша".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"D MMMM YYYY, dddd LT"},calendar:{sameDay:"[Бугун соат] LT [да]",nextDay:"[Эртага] LT [да]",nextWeek:"dddd [куни соат] LT [да]",lastDay:"[Кеча соат] LT [да]",lastWeek:"[Утган] dddd [куни соат] LT [да]",sameElse:"L"},relativeTime:{future:"Якин %s ичида",past:"Бир неча %s олдин",s:"фурсат",m:"бир дакика",mm:"%d дакика",h:"бир соат",hh:"%d соат",d:"бир кун",dd:"%d кун",M:"бир ой",MM:"%d ой",y:"бир йил",yy:"%d йил"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("vn",{months:"tháng 1_tháng 2_tháng 3_tháng 4_tháng 5_tháng 6_tháng 7_tháng 8_tháng 9_tháng 10_tháng 11_tháng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),weekdays:"chủ nhật_thứ hai_thứ ba_thứ tư_thứ năm_thứ sáu_thứ bảy".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM [năm] YYYY",LLL:"D MMMM [năm] YYYY LT",LLLL:"dddd, D MMMM [năm] YYYY LT",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY LT",llll:"ddd, D MMM YYYY LT"},calendar:{sameDay:"[Hôm nay lúc] LT",nextDay:"[Ngày mai lúc] LT",nextWeek:"dddd [tuần tới lúc] LT",lastDay:"[Hôm qua lúc] LT",lastWeek:"dddd [tuần rồi lúc] LT",sameElse:"L"},relativeTime:{future:"%s tới",past:"%s trước",s:"vài giây",m:"một phút",mm:"%d phút",h:"một giờ",hh:"%d giờ",d:"một ngày",dd:"%d ngày",M:"một tháng",MM:"%d tháng",y:"một năm",yy:"%d năm"},ordinal:function(a){return a},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah点mm",L:"YYYY年MMMD日",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日LT",LLLL:"YYYY年MMMD日ddddLT",l:"YYYY年MMMD日",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日LT",llll:"YYYY年MMMD日ddddLT"},meridiem:function(a,b){var c=100*a+b;return 600>c?"凌晨":900>c?"早上":1130>c?"上午":1230>c?"中午":1800>c?"下午":"晚上"},calendar:{sameDay:function(){return 0===this.minutes()?"[今天]Ah[点整]":"[今天]LT"},nextDay:function(){return 0===this.minutes()?"[明天]Ah[点整]":"[明天]LT"},lastDay:function(){return 0===this.minutes()?"[昨天]Ah[点整]":"[昨天]LT"},nextWeek:function(){var b,c;return b=a().startOf("week"),c=this.unix()-b.unix()>=604800?"[下]":"[本]",0===this.minutes()?c+"dddAh点整":c+"dddAh点mm"},lastWeek:function(){var b,c;return b=a().startOf("week"),c=this.unix()<b.unix()?"[上]":"[本]",0===this.minutes()?c+"dddAh点整":c+"dddAh点mm"},sameElse:"L"},ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"日";case"M":return a+"月";case"w":case"W":return a+"周";default:return a}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1分钟",mm:"%d分钟",h:"1小时",hh:"%d小时",d:"1天",dd:"%d天",M:"1个月",MM:"%d个月",y:"1年",yy:"%d年"},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("zh-tw",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah點mm",L:"YYYY年MMMD日",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日LT",LLLL:"YYYY年MMMD日ddddLT",l:"YYYY年MMMD日",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日LT",llll:"YYYY年MMMD日ddddLT"},meridiem:function(a,b){var c=100*a+b;return 900>c?"早上":1130>c?"上午":1230>c?"中午":1800>c?"下午":"晚上"},calendar:{sameDay:"[今天]LT",nextDay:"[明天]LT",nextWeek:"[下]ddddLT",lastDay:"[昨天]LT",lastWeek:"[上]ddddLT",sameElse:"L"},ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"日";case"M":return a+"月";case"w":case"W":return a+"週";default:return a}},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"一分鐘",mm:"%d分鐘",h:"一小時",hh:"%d小時",d:"一天",dd:"%d天",M:"一個月",MM:"%d個月",y:"一年",yy:"%d年"}})}),bb.lang("en"),nb?(module.exports=bb,ab(!0)):"function"==typeof define&&define.amd?define("moment",function(b,c,d){return d.config().noGlobal!==!0&&ab(d.config().noGlobal===a),bb}):ab()}).call(this);(function($,document,undefined){var pluses=/\+/g;function raw(s){return s}function decoded(s){return unRfc2068(decodeURIComponent(s.replace(pluses," ")))}function unRfc2068(value){if(value.indexOf('"')===0){value=value.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}return value}function fromJSON(value){return config.json?JSON.parse(value):value}var config=$.cookie=function(key,value,options){if(value!==undefined){options=$.extend({},config.defaults,options);if(value===null){options.expires=-1}if(typeof options.expires==="number"){var days=options.expires,t=options.expires=new Date;t.setDate(t.getDate()+days)}value=config.json?JSON.stringify(value):String(value);return document.cookie=[encodeURIComponent(key),"=",config.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")}var decode=config.raw?raw:decoded;var cookies=document.cookie.split("; ");var result=key?null:{};for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split("=");var name=decode(parts.shift());var cookie=decode(parts.join("="));if(key&&key===name){result=fromJSON(cookie);break}if(!key){result[name]=fromJSON(cookie)}}return result};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)!==null){$.cookie(key,null,options);return true}return false}})(jQuery,document);(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else if(typeof exports==="object"){module.exports=factory}else{factory(jQuery)}})(function($){var toFix=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],toBind="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],slice=Array.prototype.slice,nullLowestDeltaTimeout,lowestDelta;if($.event.fixHooks){for(var i=toFix.length;i;){$.event.fixHooks[toFix[--i]]=$.event.mouseHooks}}var special=$.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener){for(var i=toBind.length;i;){this.addEventListener(toBind[--i],handler,false)}}else{this.onmousewheel=handler}$.data(this,"mousewheel-line-height",special.getLineHeight(this));$.data(this,"mousewheel-page-height",special.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var i=toBind.length;i;){this.removeEventListener(toBind[--i],handler,false)}}else{this.onmousewheel=null}$.removeData(this,"mousewheel-line-height");$.removeData(this,"mousewheel-page-height")},getLineHeight:function(elem){var $elem=$(elem),$parent=$elem["offsetParent"in $.fn?"offsetParent":"parent"]();if(!$parent.length){$parent=$("body")}return parseInt($parent.css("fontSize"),10)||parseInt($elem.css("fontSize"),10)||16},getPageHeight:function(elem){return $(elem).height()},settings:{adjustOldDeltas:true,normalizeOffset:true}};$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")},unmousewheel:function(fn){return this.unbind("mousewheel",fn)}});function handler(event){var orgEvent=event||window.event,args=slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,absDelta=0,offsetX=0,offsetY=0;event=$.event.fix(orgEvent);event.type="mousewheel";if("detail"in orgEvent){deltaY=orgEvent.detail*-1}if("wheelDelta"in orgEvent){deltaY=orgEvent.wheelDelta}if("wheelDeltaY"in orgEvent){deltaY=orgEvent.wheelDeltaY}if("wheelDeltaX"in orgEvent){deltaX=orgEvent.wheelDeltaX*-1}if("axis"in orgEvent&&orgEvent.axis===orgEvent.HORIZONTAL_AXIS){deltaX=deltaY*-1;deltaY=0}delta=deltaY===0?deltaX:deltaY;if("deltaY"in orgEvent){deltaY=orgEvent.deltaY*-1;delta=deltaY}if("deltaX"in orgEvent){deltaX=orgEvent.deltaX;if(deltaY===0){delta=deltaX*-1}}if(deltaY===0&&deltaX===0){return}if(orgEvent.deltaMode===1){var lineHeight=$.data(this,"mousewheel-line-height");delta*=lineHeight;deltaY*=lineHeight;deltaX*=lineHeight}else if(orgEvent.deltaMode===2){var pageHeight=$.data(this,"mousewheel-page-height");delta*=pageHeight;deltaY*=pageHeight;deltaX*=pageHeight}absDelta=Math.max(Math.abs(deltaY),Math.abs(deltaX));if(!lowestDelta||absDelta<lowestDelta){lowestDelta=absDelta;if(shouldAdjustOldDeltas(orgEvent,absDelta)){lowestDelta/=40}}if(shouldAdjustOldDeltas(orgEvent,absDelta)){delta/=40;deltaX/=40;deltaY/=40}delta=Math[delta>=1?"floor":"ceil"](delta/lowestDelta);deltaX=Math[deltaX>=1?"floor":"ceil"](deltaX/lowestDelta);deltaY=Math[deltaY>=1?"floor":"ceil"](deltaY/lowestDelta);if(special.settings.normalizeOffset&&this.getBoundingClientRect){var boundingRect=this.getBoundingClientRect();offsetX=event.clientX-boundingRect.left;offsetY=event.clientY-boundingRect.top}event.deltaX=deltaX;event.deltaY=deltaY;event.deltaFactor=lowestDelta;event.offsetX=offsetX;event.offsetY=offsetY;event.deltaMode=0;args.unshift(event,delta,deltaX,deltaY);if(nullLowestDeltaTimeout){clearTimeout(nullLowestDeltaTimeout)}nullLowestDeltaTimeout=setTimeout(nullLowestDelta,200);return($.event.dispatch||$.event.handle).apply(this,args)}function nullLowestDelta(){lowestDelta=null}function shouldAdjustOldDeltas(orgEvent,absDelta){return special.settings.adjustOldDeltas&&orgEvent.type==="mousewheel"&&absDelta%120===0}});!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.React=t()}}(function(){return function t(e,n,o){function r(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return r(n?n:t)},c,c.exports,t,e,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(t,e){"use strict";var n=t("./focusNode"),o={componentDidMount:function(){this.props.autoFocus&&n(this.getDOMNode())}};e.exports=o},{"./focusNode":110}],2:[function(t,e){var n=t("./invariant"),o={addClass:function(t,e){return n(!/\s/.test(e)),e&&(t.classList?t.classList.add(e):o.hasClass(t,e)||(t.className=t.className+" "+e)),t},removeClass:function(t,e){return n(!/\s/.test(e)),e&&(t.classList?t.classList.remove(e):o.hasClass(t,e)&&(t.className=t.className.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,""))),t},conditionClass:function(t,e,n){return(n?o.addClass:o.removeClass)(t,e)},hasClass:function(t,e){return n(!/\s/.test(e)),t.classList?!!e&&t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1}};e.exports=o},{"./invariant":122}],3:[function(t,e){"use strict";function n(t,e){return t+e.charAt(0).toUpperCase()+e.substring(1)}var o={columnCount:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},r=["Webkit","ms","Moz","O"];Object.keys(o).forEach(function(t){r.forEach(function(e){o[n(e,t)]=o[t]})});var i={background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}},a={isUnitlessNumber:o,shorthandPropertyExpansions:i};e.exports=a},{}],4:[function(t,e){"use strict";var n=t("./CSSProperty"),o=t("./dangerousStyleValue"),r=t("./escapeTextForBrowser"),i=t("./hyphenate"),a=t("./memoizeStringOnly"),s=a(function(t){return r(i(t))}),u={createMarkupForStyles:function(t){var e="";for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];null!=r&&(e+=s(n)+":",e+=o(n,r)+";")}return e||null},setValueForStyles:function(t,e){var r=t.style;for(var i in e)if(e.hasOwnProperty(i)){var a=o(i,e[i]);if(a)r[i]=a;else{var s=n.shorthandPropertyExpansions[i];if(s)for(var u in s)r[u]="";else r[i]=""}}}};e.exports=u},{"./CSSProperty":3,"./dangerousStyleValue":105,"./escapeTextForBrowser":108,"./hyphenate":120,"./memoizeStringOnly":130}],5:[function(t,e){"use strict";function n(t){return"SELECT"===t.nodeName||"INPUT"===t.nodeName&&"file"===t.type}function o(t){var e=M.getPooled(b.change,S,t);C.accumulateTwoPhaseDispatches(e),R.batchedUpdates(r,e)}function r(t){y.enqueueEvents(t),y.processEventQueue()}function i(t,e){O=t,S=e,O.attachEvent("onchange",o)}function a(){O&&(O.detachEvent("onchange",o),O=null,S=null)}function s(t,e,n){return t===T.topChange?n:void 0}function u(t,e,n){t===T.topFocus?(a(),i(e,n)):t===T.topBlur&&a()}function c(t,e){O=t,S=e,N=t.value,I=Object.getOwnPropertyDescriptor(t.constructor.prototype,"value"),Object.defineProperty(O,"value",A),O.attachEvent("onpropertychange",p)}function l(){O&&(delete O.value,O.detachEvent("onpropertychange",p),O=null,S=null,N=null,I=null)}function p(t){if("value"===t.propertyName){var e=t.srcElement.value;e!==N&&(N=e,o(t))}}function d(t,e,n){return t===T.topInput?n:void 0}function h(t,e,n){t===T.topFocus?(l(),c(e,n)):t===T.topBlur&&l()}function f(t){return t!==T.topSelectionChange&&t!==T.topKeyUp&&t!==T.topKeyDown||!O||O.value===N?void 0:(N=O.value,S)}function m(t){return"INPUT"===t.nodeName&&("checkbox"===t.type||"radio"===t.type)}function v(t,e,n){return t===T.topClick?n:void 0}var g=t("./EventConstants"),y=t("./EventPluginHub"),C=t("./EventPropagators"),E=t("./ExecutionEnvironment"),R=t("./ReactUpdates"),M=t("./SyntheticEvent"),D=t("./isEventSupported"),x=t("./isTextInputElement"),P=t("./keyOf"),T=g.topLevelTypes,b={change:{phasedRegistrationNames:{bubbled:P({onChange:null}),captured:P({onChangeCapture:null})},dependencies:[T.topBlur,T.topChange,T.topClick,T.topFocus,T.topInput,T.topKeyDown,T.topKeyUp,T.topSelectionChange]}},O=null,S=null,N=null,I=null,_=!1;E.canUseDOM&&(_=D("change")&&(!("documentMode"in document)||document.documentMode>8));var w=!1;E.canUseDOM&&(w=D("input")&&(!("documentMode"in document)||document.documentMode>9));var A={get:function(){return I.get.call(this)},set:function(t){N=""+t,I.set.call(this,t)}},k={eventTypes:b,extractEvents:function(t,e,o,r){var i,a;if(n(e)?_?i=s:a=u:x(e)?w?i=d:(i=f,a=h):m(e)&&(i=v),i){var c=i(t,e,o);if(c){var l=M.getPooled(b.change,c,r);return C.accumulateTwoPhaseDispatches(l),l}}a&&a(t,e,o)}};e.exports=k},{"./EventConstants":15,"./EventPluginHub":17,"./EventPropagators":20,"./ExecutionEnvironment":21,"./ReactUpdates":78,"./SyntheticEvent":86,"./isEventSupported":123,"./isTextInputElement":125,"./keyOf":129}],6:[function(t,e){"use strict";var n=0,o={createReactRootIndex:function(){return n++}};e.exports=o},{}],7:[function(t,e){"use strict";function n(t){switch(t){case g.topCompositionStart:return C.compositionStart;case g.topCompositionEnd:return C.compositionEnd;case g.topCompositionUpdate:return C.compositionUpdate}}function o(t,e){return t===g.topKeyDown&&e.keyCode===f}function r(t,e){switch(t){case g.topKeyUp:return-1!==h.indexOf(e.keyCode);case g.topKeyDown:return e.keyCode!==f;case g.topKeyPress:case g.topMouseDown:case g.topBlur:return!0;default:return!1}}function i(t){this.root=t,this.startSelection=c.getSelection(t),this.startValue=this.getText()}var a=t("./EventConstants"),s=t("./EventPropagators"),u=t("./ExecutionEnvironment"),c=t("./ReactInputSelection"),l=t("./SyntheticCompositionEvent"),p=t("./getTextContentAccessor"),d=t("./keyOf"),h=[9,13,27,32],f=229,m=u.canUseDOM&&"CompositionEvent"in window,v=!m||"documentMode"in document&&document.documentMode>8,g=a.topLevelTypes,y=null,C={compositionEnd:{phasedRegistrationNames:{bubbled:d({onCompositionEnd:null}),captured:d({onCompositionEndCapture:null})},dependencies:[g.topBlur,g.topCompositionEnd,g.topKeyDown,g.topKeyPress,g.topKeyUp,g.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:d({onCompositionStart:null}),captured:d({onCompositionStartCapture:null})},dependencies:[g.topBlur,g.topCompositionStart,g.topKeyDown,g.topKeyPress,g.topKeyUp,g.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:d({onCompositionUpdate:null}),captured:d({onCompositionUpdateCapture:null})},dependencies:[g.topBlur,g.topCompositionUpdate,g.topKeyDown,g.topKeyPress,g.topKeyUp,g.topMouseDown]}};i.prototype.getText=function(){return this.root.value||this.root[p()]},i.prototype.getData=function(){var t=this.getText(),e=this.startSelection.start,n=this.startValue.length-this.startSelection.end;return t.substr(e,t.length-n-e)};var E={eventTypes:C,extractEvents:function(t,e,a,u){var c,p;if(m?c=n(t):y?r(t,u)&&(c=C.compositionEnd):o(t,u)&&(c=C.compositionStart),v&&(y||c!==C.compositionStart?c===C.compositionEnd&&y&&(p=y.getData(),y=null):y=new i(e)),c){var d=l.getPooled(c,a,u);return p&&(d.data=p),s.accumulateTwoPhaseDispatches(d),d}}};e.exports=E},{"./EventConstants":15,"./EventPropagators":20,"./ExecutionEnvironment":21,"./ReactInputSelection":54,"./SyntheticCompositionEvent":84,"./getTextContentAccessor":118,"./keyOf":129}],8:[function(t,e){"use strict";function n(t,e,n){var o=t.childNodes;o[n]!==e&&(e.parentNode===t&&t.removeChild(e),n>=o.length?t.appendChild(e):t.insertBefore(e,o[n]))}var o,r=t("./Danger"),i=t("./ReactMultiChildUpdateTypes"),a=t("./getTextContentAccessor"),s=a();o="textContent"===s?function(t,e){t.textContent=e}:function(t,e){for(;t.firstChild;)t.removeChild(t.firstChild);if(e){var n=t.ownerDocument||document;t.appendChild(n.createTextNode(e))}};var u={dangerouslyReplaceNodeWithMarkup:r.dangerouslyReplaceNodeWithMarkup,updateTextContent:o,processUpdates:function(t,e){for(var a,s=null,u=null,c=0;a=t[c];c++)if(a.type===i.MOVE_EXISTING||a.type===i.REMOVE_NODE){var l=a.fromIndex,p=a.parentNode.childNodes[l],d=a.parentID;s=s||{},s[d]=s[d]||[],s[d][l]=p,u=u||[],u.push(p)}var h=r.dangerouslyRenderMarkup(e);if(u)for(var f=0;f<u.length;f++)u[f].parentNode.removeChild(u[f]);for(var m=0;a=t[m];m++)switch(a.type){case i.INSERT_MARKUP:n(a.parentNode,h[a.markupIndex],a.toIndex);break;case i.MOVE_EXISTING:n(a.parentNode,s[a.parentID][a.fromIndex],a.toIndex);break;case i.TEXT_CONTENT:o(a.parentNode,a.textContent);
break;case i.REMOVE_NODE:}}};e.exports=u},{"./Danger":11,"./ReactMultiChildUpdateTypes":61,"./getTextContentAccessor":118}],9:[function(t,e){"use strict";var n=t("./invariant"),o={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_POSITIVE_NUMERIC_VALUE:16,injectDOMPropertyConfig:function(t){var e=t.Properties||{},r=t.DOMAttributeNames||{},a=t.DOMPropertyNames||{},s=t.DOMMutationMethods||{};t.isCustomAttribute&&i._isCustomAttributeFunctions.push(t.isCustomAttribute);for(var u in e){n(!i.isStandardName[u]),i.isStandardName[u]=!0;var c=u.toLowerCase();i.getPossibleStandardName[c]=u;var l=r[u];l&&(i.getPossibleStandardName[l]=u),i.getAttributeName[u]=l||c,i.getPropertyName[u]=a[u]||u;var p=s[u];p&&(i.getMutationMethod[u]=p);var d=e[u];i.mustUseAttribute[u]=d&o.MUST_USE_ATTRIBUTE,i.mustUseProperty[u]=d&o.MUST_USE_PROPERTY,i.hasSideEffects[u]=d&o.HAS_SIDE_EFFECTS,i.hasBooleanValue[u]=d&o.HAS_BOOLEAN_VALUE,i.hasPositiveNumericValue[u]=d&o.HAS_POSITIVE_NUMERIC_VALUE,n(!i.mustUseAttribute[u]||!i.mustUseProperty[u]),n(i.mustUseProperty[u]||!i.hasSideEffects[u]),n(!i.hasBooleanValue[u]||!i.hasPositiveNumericValue[u])}}},r={},i={ID_ATTRIBUTE_NAME:"data-reactid",isStandardName:{},getPossibleStandardName:{},getAttributeName:{},getPropertyName:{},getMutationMethod:{},mustUseAttribute:{},mustUseProperty:{},hasSideEffects:{},hasBooleanValue:{},hasPositiveNumericValue:{},_isCustomAttributeFunctions:[],isCustomAttribute:function(t){for(var e=0;e<i._isCustomAttributeFunctions.length;e++){var n=i._isCustomAttributeFunctions[e];if(n(t))return!0}return!1},getDefaultValueForProperty:function(t,e){var n,o=r[t];return o||(r[t]=o={}),e in o||(n=document.createElement(t),o[e]=n[e]),o[e]},injection:o};e.exports=i},{"./invariant":122}],10:[function(t,e){"use strict";function n(t,e){return null==e||o.hasBooleanValue[t]&&!e||o.hasPositiveNumericValue[t]&&(isNaN(e)||1>e)}var o=t("./DOMProperty"),r=t("./escapeTextForBrowser"),i=t("./memoizeStringOnly"),a=(t("./warning"),i(function(t){return r(t)+'="'})),s={createMarkupForID:function(t){return a(o.ID_ATTRIBUTE_NAME)+r(t)+'"'},createMarkupForProperty:function(t,e){if(o.isStandardName[t]){if(n(t,e))return"";var i=o.getAttributeName[t];return o.hasBooleanValue[t]?r(i):a(i)+r(e)+'"'}return o.isCustomAttribute(t)?null==e?"":a(t)+r(e)+'"':null},setValueForProperty:function(t,e,r){if(o.isStandardName[e]){var i=o.getMutationMethod[e];if(i)i(t,r);else if(n(e,r))this.deleteValueForProperty(t,e);else if(o.mustUseAttribute[e])t.setAttribute(o.getAttributeName[e],""+r);else{var a=o.getPropertyName[e];o.hasSideEffects[e]&&t[a]===r||(t[a]=r)}}else o.isCustomAttribute(e)&&(null==r?t.removeAttribute(o.getAttributeName[e]):t.setAttribute(e,""+r))},deleteValueForProperty:function(t,e){if(o.isStandardName[e]){var n=o.getMutationMethod[e];if(n)n(t,void 0);else if(o.mustUseAttribute[e])t.removeAttribute(o.getAttributeName[e]);else{var r=o.getPropertyName[e],i=o.getDefaultValueForProperty(t.nodeName,r);o.hasSideEffects[e]&&t[r]===i||(t[r]=i)}}else o.isCustomAttribute(e)&&t.removeAttribute(e)}};e.exports=s},{"./DOMProperty":9,"./escapeTextForBrowser":108,"./memoizeStringOnly":130,"./warning":144}],11:[function(t,e){"use strict";function n(t){return t.substring(1,t.indexOf(" "))}var o=t("./ExecutionEnvironment"),r=t("./createNodesFromMarkup"),i=t("./emptyFunction"),a=t("./getMarkupWrap"),s=t("./invariant"),u=/^(<[^ \/>]+)/,c="data-danger-index",l={dangerouslyRenderMarkup:function(t){s(o.canUseDOM);for(var e,l={},p=0;p<t.length;p++)s(t[p]),e=n(t[p]),e=a(e)?e:"*",l[e]=l[e]||[],l[e][p]=t[p];var d=[],h=0;for(e in l)if(l.hasOwnProperty(e)){var f=l[e];for(var m in f)if(f.hasOwnProperty(m)){var v=f[m];f[m]=v.replace(u,"$1 "+c+'="'+m+'" ')}var g=r(f.join(""),i);for(p=0;p<g.length;++p){var y=g[p];y.hasAttribute&&y.hasAttribute(c)&&(m=+y.getAttribute(c),y.removeAttribute(c),s(!d.hasOwnProperty(m)),d[m]=y,h+=1)}}return s(h===d.length),s(d.length===t.length),d},dangerouslyReplaceNodeWithMarkup:function(t,e){s(o.canUseDOM),s(e),s("html"!==t.tagName.toLowerCase());var n=r(e,i)[0];t.parentNode.replaceChild(n,t)}};e.exports=l},{"./ExecutionEnvironment":21,"./createNodesFromMarkup":102,"./emptyFunction":106,"./getMarkupWrap":115,"./invariant":122}],12:[function(t,e){"use strict";var n=t("./DOMProperty"),o=n.injection.MUST_USE_ATTRIBUTE,r=n.injection.MUST_USE_PROPERTY,i=n.injection.HAS_BOOLEAN_VALUE,a=n.injection.HAS_SIDE_EFFECTS,s=n.injection.HAS_POSITIVE_NUMERIC_VALUE,u={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,accessKey:null,action:null,allowFullScreen:o|i,allowTransparency:o,alt:null,async:i,autoComplete:null,autoPlay:i,cellPadding:null,cellSpacing:null,charSet:o,checked:r|i,className:r,cols:o|s,colSpan:null,content:null,contentEditable:null,contextMenu:o,controls:r|i,crossOrigin:null,data:null,dateTime:o,defer:i,dir:null,disabled:o|i,download:null,draggable:null,encType:null,form:o,formNoValidate:i,frameBorder:o,height:o,hidden:o|i,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:r,label:null,lang:null,list:null,loop:r|i,max:null,maxLength:o,mediaGroup:null,method:null,min:null,multiple:r|i,muted:r|i,name:null,noValidate:i,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:r|i,rel:null,required:i,role:o,rows:o|s,rowSpan:null,sandbox:null,scope:null,scrollLeft:r,scrollTop:r,seamless:o|i,selected:r|i,size:o|s,span:s,spellCheck:null,src:null,srcDoc:r,srcSet:null,step:null,style:null,tabIndex:null,target:null,title:null,type:null,value:r|a,width:o,wmode:o,autoCapitalize:null,autoCorrect:null,property:null,cx:o,cy:o,d:o,fill:o,fx:o,fy:o,gradientTransform:o,gradientUnits:o,offset:o,points:o,r:o,rx:o,ry:o,spreadMethod:o,stopColor:o,stopOpacity:o,stroke:o,strokeLinecap:o,strokeWidth:o,textAnchor:o,transform:o,version:o,viewBox:o,x1:o,x2:o,x:o,y1:o,y2:o,y:o},DOMAttributeNames:{className:"class",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",htmlFor:"for",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeLinecap:"stroke-linecap",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"enctype",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};e.exports=u},{"./DOMProperty":9}],13:[function(t,e){"use strict";var n=t("./keyOf"),o=[n({ResponderEventPlugin:null}),n({SimpleEventPlugin:null}),n({TapEventPlugin:null}),n({EnterLeaveEventPlugin:null}),n({ChangeEventPlugin:null}),n({SelectEventPlugin:null}),n({CompositionEventPlugin:null}),n({AnalyticsEventPlugin:null}),n({MobileSafariClickEventPlugin:null})];e.exports=o},{"./keyOf":129}],14:[function(t,e){"use strict";var n=t("./EventConstants"),o=t("./EventPropagators"),r=t("./SyntheticMouseEvent"),i=t("./ReactMount"),a=t("./keyOf"),s=n.topLevelTypes,u=i.getFirstReactDOM,c={mouseEnter:{registrationName:a({onMouseEnter:null}),dependencies:[s.topMouseOut,s.topMouseOver]},mouseLeave:{registrationName:a({onMouseLeave:null}),dependencies:[s.topMouseOut,s.topMouseOver]}},l=[null,null],p={eventTypes:c,extractEvents:function(t,e,n,a){if(t===s.topMouseOver&&(a.relatedTarget||a.fromElement))return null;if(t!==s.topMouseOut&&t!==s.topMouseOver)return null;var p;if(e.window===e)p=e;else{var d=e.ownerDocument;p=d?d.defaultView||d.parentWindow:window}var h,f;if(t===s.topMouseOut?(h=e,f=u(a.relatedTarget||a.toElement)||p):(h=p,f=e),h===f)return null;var m=h?i.getID(h):"",v=f?i.getID(f):"",g=r.getPooled(c.mouseLeave,m,a);g.type="mouseleave",g.target=h,g.relatedTarget=f;var y=r.getPooled(c.mouseEnter,v,a);return y.type="mouseenter",y.target=f,y.relatedTarget=h,o.accumulateEnterLeaveDispatches(g,y,m,v),l[0]=g,l[1]=y,l}};e.exports=p},{"./EventConstants":15,"./EventPropagators":20,"./ReactMount":58,"./SyntheticMouseEvent":89,"./keyOf":129}],15:[function(t,e){"use strict";var n=t("./keyMirror"),o=n({bubbled:null,captured:null}),r=n({topBlur:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topReset:null,topScroll:null,topSelectionChange:null,topSubmit:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topWheel:null}),i={topLevelTypes:r,PropagationPhases:o};e.exports=i},{"./keyMirror":128}],16:[function(t,e){var n=t("./emptyFunction"),o={listen:function(t,e,n){return t.addEventListener?(t.addEventListener(e,n,!1),{remove:function(){t.removeEventListener(e,n,!1)}}):t.attachEvent?(t.attachEvent("on"+e,n),{remove:function(){t.detachEvent(e,n)}}):void 0},capture:function(t,e,o){return t.addEventListener?(t.addEventListener(e,o,!0),{remove:function(){t.removeEventListener(e,o,!0)}}):{remove:n}}};e.exports=o},{"./emptyFunction":106}],17:[function(t,e){"use strict";var n=t("./EventPluginRegistry"),o=t("./EventPluginUtils"),r=t("./ExecutionEnvironment"),i=t("./accumulate"),a=t("./forEachAccumulated"),s=t("./invariant"),u=(t("./isEventSupported"),t("./monitorCodeUse"),{}),c=null,l=function(t){if(t){var e=o.executeDispatch,r=n.getPluginModuleForEvent(t);r&&r.executeDispatch&&(e=r.executeDispatch),o.executeDispatchesInOrder(t,e),t.isPersistent()||t.constructor.release(t)}},p=null,d={injection:{injectMount:o.injection.injectMount,injectInstanceHandle:function(t){p=t},getInstanceHandle:function(){return p},injectEventPluginOrder:n.injectEventPluginOrder,injectEventPluginsByName:n.injectEventPluginsByName},eventNameDispatchConfigs:n.eventNameDispatchConfigs,registrationNameModules:n.registrationNameModules,putListener:function(t,e,n){s(r.canUseDOM),s(!n||"function"==typeof n);var o=u[e]||(u[e]={});o[t]=n},getListener:function(t,e){var n=u[e];return n&&n[t]},deleteListener:function(t,e){var n=u[e];n&&delete n[t]},deleteAllListeners:function(t){for(var e in u)delete u[e][t]},extractEvents:function(t,e,o,r){for(var a,s=n.plugins,u=0,c=s.length;c>u;u++){var l=s[u];if(l){var p=l.extractEvents(t,e,o,r);p&&(a=i(a,p))}}return a},enqueueEvents:function(t){t&&(c=i(c,t))},processEventQueue:function(){var t=c;c=null,a(t,l),s(!c)},__purge:function(){u={}},__getListenerBank:function(){return u}};e.exports=d},{"./EventPluginRegistry":18,"./EventPluginUtils":19,"./ExecutionEnvironment":21,"./accumulate":95,"./forEachAccumulated":111,"./invariant":122,"./isEventSupported":123,"./monitorCodeUse":135}],18:[function(t,e){"use strict";function n(){if(a)for(var t in s){var e=s[t],n=a.indexOf(t);if(i(n>-1),!u.plugins[n]){i(e.extractEvents),u.plugins[n]=e;var r=e.eventTypes;for(var c in r)i(o(r[c],e,c))}}}function o(t,e,n){i(!u.eventNameDispatchConfigs[n]),u.eventNameDispatchConfigs[n]=t;var o=t.phasedRegistrationNames;if(o){for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];r(s,e,n)}return!0}return t.registrationName?(r(t.registrationName,e,n),!0):!1}function r(t,e,n){i(!u.registrationNameModules[t]),u.registrationNameModules[t]=e,u.registrationNameDependencies[t]=e.eventTypes[n].dependencies}var i=t("./invariant"),a=null,s={},u={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(t){i(!a),a=Array.prototype.slice.call(t),n()},injectEventPluginsByName:function(t){var e=!1;for(var o in t)if(t.hasOwnProperty(o)){var r=t[o];s[o]!==r&&(i(!s[o]),s[o]=r,e=!0)}e&&n()},getPluginModuleForEvent:function(t){var e=t.dispatchConfig;if(e.registrationName)return u.registrationNameModules[e.registrationName]||null;for(var n in e.phasedRegistrationNames)if(e.phasedRegistrationNames.hasOwnProperty(n)){var o=u.registrationNameModules[e.phasedRegistrationNames[n]];if(o)return o}return null},_resetEventPlugins:function(){a=null;for(var t in s)s.hasOwnProperty(t)&&delete s[t];u.plugins.length=0;var e=u.eventNameDispatchConfigs;for(var n in e)e.hasOwnProperty(n)&&delete e[n];var o=u.registrationNameModules;for(var r in o)o.hasOwnProperty(r)&&delete o[r]}};e.exports=u},{"./invariant":122}],19:[function(t,e){"use strict";function n(t){return t===f.topMouseUp||t===f.topTouchEnd||t===f.topTouchCancel}function o(t){return t===f.topMouseMove||t===f.topTouchMove}function r(t){return t===f.topMouseDown||t===f.topTouchStart}function i(t,e){var n=t._dispatchListeners,o=t._dispatchIDs;if(Array.isArray(n))for(var r=0;r<n.length&&!t.isPropagationStopped();r++)e(t,n[r],o[r]);else n&&e(t,n,o)}function a(t,e,n){t.currentTarget=h.Mount.getNode(n);var o=e(t,n);return t.currentTarget=null,o}function s(t,e){i(t,e),t._dispatchListeners=null,t._dispatchIDs=null}function u(t){var e=t._dispatchListeners,n=t._dispatchIDs;if(Array.isArray(e)){for(var o=0;o<e.length&&!t.isPropagationStopped();o++)if(e[o](t,n[o]))return n[o]}else if(e&&e(t,n))return n;return null}function c(t){var e=t._dispatchListeners,n=t._dispatchIDs;d(!Array.isArray(e));var o=e?e(t,n):null;return t._dispatchListeners=null,t._dispatchIDs=null,o}function l(t){return!!t._dispatchListeners}var p=t("./EventConstants"),d=t("./invariant"),h={Mount:null,injectMount:function(t){h.Mount=t}},f=p.topLevelTypes,m={isEndish:n,isMoveish:o,isStartish:r,executeDirectDispatch:c,executeDispatch:a,executeDispatchesInOrder:s,executeDispatchesInOrderStopAtTrue:u,hasDispatches:l,injection:h,useTouchEvents:!1};e.exports=m},{"./EventConstants":15,"./invariant":122}],20:[function(t,e){"use strict";function n(t,e,n){var o=e.dispatchConfig.phasedRegistrationNames[n];return m(t,o)}function o(t,e,o){var r=e?f.bubbled:f.captured,i=n(t,o,r);i&&(o._dispatchListeners=d(o._dispatchListeners,i),o._dispatchIDs=d(o._dispatchIDs,t))}function r(t){t&&t.dispatchConfig.phasedRegistrationNames&&p.injection.getInstanceHandle().traverseTwoPhase(t.dispatchMarker,o,t)}function i(t,e,n){if(n&&n.dispatchConfig.registrationName){var o=n.dispatchConfig.registrationName,r=m(t,o);r&&(n._dispatchListeners=d(n._dispatchListeners,r),n._dispatchIDs=d(n._dispatchIDs,t))}}function a(t){t&&t.dispatchConfig.registrationName&&i(t.dispatchMarker,null,t)}function s(t){h(t,r)}function u(t,e,n,o){p.injection.getInstanceHandle().traverseEnterLeave(n,o,i,t,e)}function c(t){h(t,a)}var l=t("./EventConstants"),p=t("./EventPluginHub"),d=t("./accumulate"),h=t("./forEachAccumulated"),f=l.PropagationPhases,m=p.getListener,v={accumulateTwoPhaseDispatches:s,accumulateDirectDispatches:c,accumulateEnterLeaveDispatches:u};e.exports=v},{"./EventConstants":15,"./EventPluginHub":17,"./accumulate":95,"./forEachAccumulated":111}],21:[function(t,e){"use strict";var n="undefined"!=typeof window,o={canUseDOM:n,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:n&&(window.addEventListener||window.attachEvent),isInWorker:!n};e.exports=o},{}],22:[function(t,e){"use strict";var n=t("./ReactLink"),o=t("./ReactStateSetters"),r={linkState:function(t){return new n(this.state[t],o.createStateKeySetter(this,t))}};e.exports=r},{"./ReactLink":56,"./ReactStateSetters":73}],23:[function(t,e){"use strict";function n(t){u(null==t.props.checkedLink||null==t.props.valueLink)}function o(t){n(t),u(null==t.props.value&&null==t.props.onChange)}function r(t){n(t),u(null==t.props.checked&&null==t.props.onChange)}function i(t){this.props.valueLink.requestChange(t.target.value)}function a(t){this.props.checkedLink.requestChange(t.target.checked)}var s=t("./ReactPropTypes"),u=t("./invariant"),c=(t("./warning"),{Mixin:{propTypes:{value:function(){},checked:function(){},onChange:s.func}},getValue:function(t){return t.props.valueLink?(o(t),t.props.valueLink.value):t.props.value},getChecked:function(t){return t.props.checkedLink?(r(t),t.props.checkedLink.value):t.props.checked},getOnChange:function(t){return t.props.valueLink?(o(t),i):t.props.checkedLink?(r(t),a):t.props.onChange}});e.exports=c},{"./ReactPropTypes":67,"./invariant":122,"./warning":144}],24:[function(t,e){"use strict";var n=t("./EventConstants"),o=t("./emptyFunction"),r=n.topLevelTypes,i={eventTypes:null,extractEvents:function(t,e,n,i){if(t===r.topTouchStart){var a=i.target;a&&!a.onclick&&(a.onclick=o)}}};e.exports=i},{"./EventConstants":15,"./emptyFunction":106}],25:[function(t,e){"use strict";var n=t("./invariant"),o=function(t){var e=this;if(e.instancePool.length){var n=e.instancePool.pop();return e.call(n,t),n}return new e(t)},r=function(t,e){var n=this;if(n.instancePool.length){var o=n.instancePool.pop();return n.call(o,t,e),o}return new n(t,e)},i=function(t,e,n){var o=this;if(o.instancePool.length){var r=o.instancePool.pop();return o.call(r,t,e,n),r}return new o(t,e,n)},a=function(t,e,n,o,r){var i=this;if(i.instancePool.length){var a=i.instancePool.pop();return i.call(a,t,e,n,o,r),a}return new i(t,e,n,o,r)},s=function(t){var e=this;n(t instanceof e),t.destructor&&t.destructor(),e.instancePool.length<e.poolSize&&e.instancePool.push(t)},u=10,c=o,l=function(t,e){var n=t;return n.instancePool=[],n.getPooled=e||c,n.poolSize||(n.poolSize=u),n.release=s,n},p={addPoolingTo:l,oneArgumentPooler:o,twoArgumentPooler:r,threeArgumentPooler:i,fiveArgumentPooler:a};e.exports=p},{"./invariant":122}],26:[function(t,e){"use strict";var n=t("./DOMPropertyOperations"),o=t("./EventPluginUtils"),r=t("./ReactChildren"),i=t("./ReactComponent"),a=t("./ReactCompositeComponent"),s=t("./ReactContext"),u=t("./ReactCurrentOwner"),c=t("./ReactDOM"),l=t("./ReactDOMComponent"),p=t("./ReactDefaultInjection"),d=t("./ReactInstanceHandles"),h=t("./ReactMount"),f=t("./ReactMultiChild"),m=t("./ReactPerf"),v=t("./ReactPropTypes"),g=t("./ReactServerRendering"),y=t("./ReactTextComponent"),C=t("./onlyChild");p.inject();var E={Children:{map:r.map,forEach:r.forEach,only:C},DOM:c,PropTypes:v,initializeTouchEvents:function(t){o.useTouchEvents=t},createClass:a.createClass,constructAndRenderComponent:h.constructAndRenderComponent,constructAndRenderComponentByID:h.constructAndRenderComponentByID,renderComponent:m.measure("React","renderComponent",h.renderComponent),renderComponentToString:g.renderComponentToString,renderComponentToStaticMarkup:g.renderComponentToStaticMarkup,unmountComponentAtNode:h.unmountComponentAtNode,isValidClass:a.isValidClass,isValidComponent:i.isValidComponent,withContext:s.withContext,__internals:{Component:i,CurrentOwner:u,DOMComponent:l,DOMPropertyOperations:n,InstanceHandles:d,Mount:h,MultiChild:f,TextComponent:y}};E.version="0.10.0",e.exports=E},{"./DOMPropertyOperations":10,"./EventPluginUtils":19,"./ReactChildren":30,"./ReactComponent":31,"./ReactCompositeComponent":33,"./ReactContext":34,"./ReactCurrentOwner":35,"./ReactDOM":36,"./ReactDOMComponent":38,"./ReactDefaultInjection":48,"./ReactInstanceHandles":55,"./ReactMount":58,"./ReactMultiChild":60,"./ReactPerf":63,"./ReactPropTypes":67,"./ReactServerRendering":71,"./ReactTextComponent":74,"./onlyChild":138}],27:[function(t,e){"use strict";var n=t("./ReactMount"),o=t("./invariant"),r={getDOMNode:function(){return o(this.isMounted()),n.getNode(this._rootNodeID)}};e.exports=r},{"./ReactMount":58,"./invariant":122}],28:[function(t,e){"use strict";var n=t("./React"),o=t("./ReactTransitionGroup"),r=t("./ReactCSSTransitionGroupChild"),i=n.createClass({propTypes:{transitionName:n.PropTypes.string.isRequired,transitionEnter:n.PropTypes.bool,transitionLeave:n.PropTypes.bool},getDefaultProps:function(){return{transitionEnter:!0,transitionLeave:!0}},_wrapChild:function(t){return r({name:this.props.transitionName,enter:this.props.transitionEnter,leave:this.props.transitionLeave},t)},render:function(){return this.transferPropsTo(o({childFactory:this._wrapChild},this.props.children))}});e.exports=i},{"./React":26,"./ReactCSSTransitionGroupChild":29,"./ReactTransitionGroup":77}],29:[function(t,e){"use strict";var n=t("./React"),o=t("./CSSCore"),r=t("./ReactTransitionEvents"),i=t("./onlyChild"),a=17,s=n.createClass({transition:function(t,e){var n=this.getDOMNode(),i=this.props.name+"-"+t,a=i+"-active",s=function(){o.removeClass(n,i),o.removeClass(n,a),r.removeEndEventListener(n,s),e&&e()};r.addEndEventListener(n,s),o.addClass(n,i),this.queueClass(a)},queueClass:function(t){return this.classNameQueue.push(t),this.props.runNextTick?void this.props.runNextTick(this.flushClassNameQueue):void(this.timeout||(this.timeout=setTimeout(this.flushClassNameQueue,a)))},flushClassNameQueue:function(){this.isMounted()&&this.classNameQueue.forEach(o.addClass.bind(o,this.getDOMNode())),this.classNameQueue.length=0,this.timeout=null},componentWillMount:function(){this.classNameQueue=[]},componentWillUnmount:function(){this.timeout&&clearTimeout(this.timeout)},componentWillEnter:function(t){this.props.enter?this.transition("enter",t):t()},componentWillLeave:function(t){this.props.leave?this.transition("leave",t):t()},render:function(){return i(this.props.children)}});e.exports=s},{"./CSSCore":2,"./React":26,"./ReactTransitionEvents":76,"./onlyChild":138}],30:[function(t,e){"use strict";function n(t,e){this.forEachFunction=t,this.forEachContext=e}function o(t,e,n,o){var r=t;r.forEachFunction.call(r.forEachContext,e,o)}function r(t,e,r){if(null==t)return t;var i=n.getPooled(e,r);l(t,o,i),n.release(i)}function i(t,e,n){this.mapResult=t,this.mapFunction=e,this.mapContext=n}function a(t,e,n,o){var r=t,i=r.mapResult,a=r.mapFunction.call(r.mapContext,e,o);c(!i.hasOwnProperty(n)),i[n]=a}function s(t,e,n){if(null==t)return t;var o={},r=i.getPooled(o,e,n);return l(t,a,r),i.release(r),o}var u=t("./PooledClass"),c=t("./invariant"),l=t("./traverseAllChildren"),p=u.twoArgumentPooler,d=u.threeArgumentPooler;u.addPoolingTo(n,p),u.addPoolingTo(i,d);var h={forEach:r,map:s};e.exports=h},{"./PooledClass":25,"./invariant":122,"./traverseAllChildren":142}],31:[function(t,e){"use strict";var n=t("./ReactCurrentOwner"),o=t("./ReactOwner"),r=t("./ReactUpdates"),i=t("./invariant"),a=t("./keyMirror"),s=t("./merge"),u=(t("./monitorCodeUse"),a({MOUNTED:null,UNMOUNTED:null})),c=!1,l=null,p=null,d={injection:{injectEnvironment:function(t){i(!c),p=t.mountImageIntoNode,l=t.unmountIDFromEnvironment,d.BackendIDOperations=t.BackendIDOperations,d.ReactReconcileTransaction=t.ReactReconcileTransaction,c=!0}},isValidComponent:function(t){if(!t||!t.type||!t.type.prototype)return!1;var e=t.type.prototype;return"function"==typeof e.mountComponentIntoNode&&"function"==typeof e.receiveComponent},LifeCycle:u,BackendIDOperations:null,ReactReconcileTransaction:null,Mixin:{isMounted:function(){return this._lifeCycleState===u.MOUNTED},setProps:function(t,e){this.replaceProps(s(this._pendingProps||this.props,t),e)},replaceProps:function(t,e){i(this.isMounted()),i(0===this._mountDepth),this._pendingProps=t,r.enqueueUpdate(this,e)},construct:function(t,e){this.props=t||{},this._owner=n.current,this._lifeCycleState=u.UNMOUNTED,this._pendingProps=null,this._pendingCallbacks=null,this._pendingOwner=this._owner;var o=arguments.length-1;if(1===o)this.props.children=e;else if(o>1){for(var r=Array(o),i=0;o>i;i++)r[i]=arguments[i+1];this.props.children=r}},mountComponent:function(t,e,n){i(!this.isMounted());var r=this.props;null!=r.ref&&o.addComponentAsRefTo(this,r.ref,this._owner),this._rootNodeID=t,this._lifeCycleState=u.MOUNTED,this._mountDepth=n},unmountComponent:function(){i(this.isMounted());var t=this.props;null!=t.ref&&o.removeComponentAsRefFrom(this,t.ref,this._owner),l(this._rootNodeID),this._rootNodeID=null,this._lifeCycleState=u.UNMOUNTED},receiveComponent:function(t,e){i(this.isMounted()),this._pendingOwner=t._owner,this._pendingProps=t.props,this._performUpdateIfNecessary(e)},performUpdateIfNecessary:function(){var t=d.ReactReconcileTransaction.getPooled();t.perform(this._performUpdateIfNecessary,this,t),d.ReactReconcileTransaction.release(t)},_performUpdateIfNecessary:function(t){if(null!=this._pendingProps){var e=this.props,n=this._owner;this.props=this._pendingProps,this._owner=this._pendingOwner,this._pendingProps=null,this.updateComponent(t,e,n)}},updateComponent:function(t,e,n){var r=this.props;(this._owner!==n||r.ref!==e.ref)&&(null!=e.ref&&o.removeComponentAsRefFrom(this,e.ref,n),null!=r.ref&&o.addComponentAsRefTo(this,r.ref,this._owner))},mountComponentIntoNode:function(t,e,n){var o=d.ReactReconcileTransaction.getPooled();o.perform(this._mountComponentIntoNode,this,t,e,o,n),d.ReactReconcileTransaction.release(o)},_mountComponentIntoNode:function(t,e,n,o){var r=this.mountComponent(t,n,0);p(r,e,o)},isOwnedBy:function(t){return this._owner===t},getSiblingByRef:function(t){var e=this._owner;return e&&e.refs?e.refs[t]:null}}};e.exports=d},{"./ReactCurrentOwner":35,"./ReactOwner":62,"./ReactUpdates":78,"./invariant":122,"./keyMirror":128,"./merge":131,"./monitorCodeUse":135}],32:[function(t,e){"use strict";var n=t("./ReactDOMIDOperations"),o=t("./ReactMarkupChecksum"),r=t("./ReactMount"),i=t("./ReactPerf"),a=t("./ReactReconcileTransaction"),s=t("./getReactRootElementInContainer"),u=t("./invariant"),c=1,l=9,p={ReactReconcileTransaction:a,BackendIDOperations:n,unmountIDFromEnvironment:function(t){r.purgeID(t)},mountImageIntoNode:i.measure("ReactComponentBrowserEnvironment","mountImageIntoNode",function(t,e,n){if(u(e&&(e.nodeType===c||e.nodeType===l)),n){if(o.canReuseMarkup(t,s(e)))return;u(e.nodeType!==l)}u(e.nodeType!==l),e.innerHTML=t})};e.exports=p},{"./ReactDOMIDOperations":40,"./ReactMarkupChecksum":57,"./ReactMount":58,"./ReactPerf":63,"./ReactReconcileTransaction":69,"./getReactRootElementInContainer":117,"./invariant":122}],33:[function(t,e){"use strict";function n(t,e){for(var n in e)e.hasOwnProperty(n)&&R("function"==typeof e[n])}function o(t,e){var n=S[e];_.hasOwnProperty(e)&&R(n===b.OVERRIDE_BASE),t.hasOwnProperty(e)&&R(n===b.DEFINE_MANY||n===b.DEFINE_MANY_MERGED)}function r(t){var e=t._compositeLifeCycleState;R(t.isMounted()||e===I.MOUNTING),R(e!==I.RECEIVING_STATE),R(e!==I.UNMOUNTING)}function i(t,e){R(!l(e)),R(!p.isValidComponent(e));var n=t.componentConstructor,r=n.prototype;for(var i in e){var a=e[i];if(e.hasOwnProperty(i))if(o(r,i),N.hasOwnProperty(i))N[i](t,a);else{var s=i in S,d=i in r,h=a&&a.__reactDontBind,f="function"==typeof a,m=f&&!s&&!d&&!h;m?(r.__reactAutoBindMap||(r.__reactAutoBindMap={}),r.__reactAutoBindMap[i]=a,r[i]=a):r[i]=d?S[i]===b.DEFINE_MANY_MERGED?u(r[i],a):c(r[i],a):a}}}function a(t,e){if(e)for(var n in e){var o=e[n];if(!e.hasOwnProperty(n))return;var r=n in t,i=o;if(r){var a=t[n],s=typeof a,u=typeof o;R("function"===s&&"function"===u),i=c(a,o)}t[n]=i,t.componentConstructor[n]=i}}function s(t,e){return R(t&&e&&"object"==typeof t&&"object"==typeof e),P(e,function(e,n){R(void 0===t[n]),t[n]=e}),t}function u(t,e){return function(){var n=t.apply(this,arguments),o=e.apply(this,arguments);return null==n?o:null==o?n:s(n,o)}}function c(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function l(t){return t instanceof Function&&"componentConstructor"in t&&t.componentConstructor instanceof Function}var p=t("./ReactComponent"),d=t("./ReactContext"),h=t("./ReactCurrentOwner"),f=t("./ReactErrorUtils"),m=t("./ReactOwner"),v=t("./ReactPerf"),g=t("./ReactPropTransferer"),y=t("./ReactPropTypeLocations"),C=(t("./ReactPropTypeLocationNames"),t("./ReactUpdates")),E=t("./instantiateReactComponent"),R=t("./invariant"),M=t("./keyMirror"),D=t("./merge"),x=t("./mixInto"),P=(t("./monitorCodeUse"),t("./objMap")),T=t("./shouldUpdateReactComponent"),b=(t("./warning"),M({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null})),O=[],S={mixins:b.DEFINE_MANY,statics:b.DEFINE_MANY,propTypes:b.DEFINE_MANY,contextTypes:b.DEFINE_MANY,childContextTypes:b.DEFINE_MANY,getDefaultProps:b.DEFINE_MANY_MERGED,getInitialState:b.DEFINE_MANY_MERGED,getChildContext:b.DEFINE_MANY_MERGED,render:b.DEFINE_ONCE,componentWillMount:b.DEFINE_MANY,componentDidMount:b.DEFINE_MANY,componentWillReceiveProps:b.DEFINE_MANY,shouldComponentUpdate:b.DEFINE_ONCE,componentWillUpdate:b.DEFINE_MANY,componentDidUpdate:b.DEFINE_MANY,componentWillUnmount:b.DEFINE_MANY,updateComponent:b.OVERRIDE_BASE},N={displayName:function(t,e){t.componentConstructor.displayName=e},mixins:function(t,e){if(e)for(var n=0;n<e.length;n++)i(t,e[n])},childContextTypes:function(t,e){var o=t.componentConstructor;n(o,e,y.childContext),o.childContextTypes=D(o.childContextTypes,e)},contextTypes:function(t,e){var o=t.componentConstructor;n(o,e,y.context),o.contextTypes=D(o.contextTypes,e)},propTypes:function(t,e){var o=t.componentConstructor;n(o,e,y.prop),o.propTypes=D(o.propTypes,e)},statics:function(t,e){a(t,e)}},I=M({MOUNTING:null,UNMOUNTING:null,RECEIVING_PROPS:null,RECEIVING_STATE:null}),_={construct:function(){p.Mixin.construct.apply(this,arguments),m.Mixin.construct.apply(this,arguments),this.state=null,this._pendingState=null,this.context=null,this._currentContext=d.current,this._pendingContext=null,this._descriptor=null,this._compositeLifeCycleState=null},toJSON:function(){return{type:this.type,props:this.props}},isMounted:function(){return p.Mixin.isMounted.call(this)&&this._compositeLifeCycleState!==I.MOUNTING},mountComponent:v.measure("ReactCompositeComponent","mountComponent",function(t,e,n){p.Mixin.mountComponent.call(this,t,e,n),this._compositeLifeCycleState=I.MOUNTING,this.context=this._processContext(this._currentContext),this._defaultProps=this.getDefaultProps?this.getDefaultProps():null,this.props=this._processProps(this.props),this.__reactAutoBindMap&&this._bindAutoBindMethods(),this.state=this.getInitialState?this.getInitialState():null,R("object"==typeof this.state&&!Array.isArray(this.state)),this._pendingState=null,this._pendingForceUpdate=!1,this.componentWillMount&&(this.componentWillMount(),this._pendingState&&(this.state=this._pendingState,this._pendingState=null)),this._renderedComponent=E(this._renderValidatedComponent()),this._compositeLifeCycleState=null;var o=this._renderedComponent.mountComponent(t,e,n+1);return this.componentDidMount&&e.getReactMountReady().enqueue(this,this.componentDidMount),o}),unmountComponent:function(){this._compositeLifeCycleState=I.UNMOUNTING,this.componentWillUnmount&&this.componentWillUnmount(),this._compositeLifeCycleState=null,this._defaultProps=null,this._renderedComponent.unmountComponent(),this._renderedComponent=null,p.Mixin.unmountComponent.call(this)},setState:function(t,e){R("object"==typeof t||null==t),this.replaceState(D(this._pendingState||this.state,t),e)},replaceState:function(t,e){r(this),this._pendingState=t,C.enqueueUpdate(this,e)},_processContext:function(t){var e=null,n=this.constructor.contextTypes;if(n){e={};for(var o in n)e[o]=t[o]}return e},_processChildContext:function(t){var e=this.getChildContext&&this.getChildContext();if(this.constructor.displayName||"ReactCompositeComponent",e){R("object"==typeof this.constructor.childContextTypes);for(var n in e)R(n in this.constructor.childContextTypes);return D(t,e)}return t},_processProps:function(t){var e=D(t),n=this._defaultProps;for(var o in n)"undefined"==typeof e[o]&&(e[o]=n[o]);return e},_checkPropTypes:function(t,e,n){var o=this.constructor.displayName;for(var r in t)t.hasOwnProperty(r)&&t[r](e,r,o,n)},performUpdateIfNecessary:function(){var t=this._compositeLifeCycleState;t!==I.MOUNTING&&t!==I.RECEIVING_PROPS&&p.Mixin.performUpdateIfNecessary.call(this)},_performUpdateIfNecessary:function(t){if(null!=this._pendingProps||null!=this._pendingState||null!=this._pendingContext||this._pendingForceUpdate){var e=this._pendingContext||this._currentContext,n=this._processContext(e);this._pendingContext=null;var o=this.props;null!=this._pendingProps&&(o=this._processProps(this._pendingProps),this._pendingProps=null,this._compositeLifeCycleState=I.RECEIVING_PROPS,this.componentWillReceiveProps&&this.componentWillReceiveProps(o,n)),this._compositeLifeCycleState=I.RECEIVING_STATE;var r=this._pendingOwner,i=this._pendingState||this.state;
this._pendingState=null;try{this._pendingForceUpdate||!this.shouldComponentUpdate||this.shouldComponentUpdate(o,i,n)?(this._pendingForceUpdate=!1,this._performComponentUpdate(o,r,i,e,n,t)):(this.props=o,this._owner=r,this.state=i,this._currentContext=e,this.context=n)}finally{this._compositeLifeCycleState=null}}},_performComponentUpdate:function(t,e,n,o,r,i){var a=this.props,s=this._owner,u=this.state,c=this.context;this.componentWillUpdate&&this.componentWillUpdate(t,n,r),this.props=t,this._owner=e,this.state=n,this._currentContext=o,this.context=r,this.updateComponent(i,a,s,u,c),this.componentDidUpdate&&i.getReactMountReady().enqueue(this,this.componentDidUpdate.bind(this,a,u,c))},receiveComponent:function(t,e){t!==this._descriptor&&(this._descriptor=t,this._pendingContext=t._currentContext,p.Mixin.receiveComponent.call(this,t,e))},updateComponent:v.measure("ReactCompositeComponent","updateComponent",function(t,e,n){p.Mixin.updateComponent.call(this,t,e,n);var o=this._renderedComponent,r=this._renderValidatedComponent();if(T(o,r))o.receiveComponent(r,t);else{var i=this._rootNodeID,a=o._rootNodeID;o.unmountComponent(),this._renderedComponent=E(r);var s=this._renderedComponent.mountComponent(i,t,this._mountDepth+1);p.BackendIDOperations.dangerouslyReplaceNodeWithMarkupByID(a,s)}}),forceUpdate:function(t){var e=this._compositeLifeCycleState;R(this.isMounted()||e===I.MOUNTING),R(e!==I.RECEIVING_STATE&&e!==I.UNMOUNTING),this._pendingForceUpdate=!0,C.enqueueUpdate(this,t)},_renderValidatedComponent:v.measure("ReactCompositeComponent","_renderValidatedComponent",function(){var t,e=d.current;d.current=this._processChildContext(this._currentContext),h.current=this;try{t=this.render()}finally{d.current=e,h.current=null}return R(p.isValidComponent(t)),t}),_bindAutoBindMethods:function(){for(var t in this.__reactAutoBindMap)if(this.__reactAutoBindMap.hasOwnProperty(t)){var e=this.__reactAutoBindMap[t];this[t]=this._bindAutoBindMethod(f.guard(e,this.constructor.displayName+"."+t))}},_bindAutoBindMethod:function(t){var e=this,n=function(){return t.apply(e,arguments)};return n}},w=function(){};x(w,p.Mixin),x(w,m.Mixin),x(w,g.Mixin),x(w,_);var A={LifeCycle:I,Base:w,createClass:function(t){var e=function(){};e.prototype=new w,e.prototype.constructor=e;var n=e,o=function(){var t=new n;return t.construct.apply(t,arguments),t};o.componentConstructor=e,e.ConvenienceConstructor=o,o.originalSpec=t,O.forEach(i.bind(null,o)),i(o,t),R(e.prototype.render),o.type=e,e.prototype.type=e;for(var r in S)e.prototype[r]||(e.prototype[r]=null);return o},isValidClass:l,injection:{injectMixin:function(t){O.push(t)}}};e.exports=A},{"./ReactComponent":31,"./ReactContext":34,"./ReactCurrentOwner":35,"./ReactErrorUtils":49,"./ReactOwner":62,"./ReactPerf":63,"./ReactPropTransferer":64,"./ReactPropTypeLocationNames":65,"./ReactPropTypeLocations":66,"./ReactUpdates":78,"./instantiateReactComponent":121,"./invariant":122,"./keyMirror":128,"./merge":131,"./mixInto":134,"./monitorCodeUse":135,"./objMap":136,"./shouldUpdateReactComponent":140,"./warning":144}],34:[function(t,e){"use strict";var n=t("./merge"),o={current:{},withContext:function(t,e){var r,i=o.current;o.current=n(i,t);try{r=e()}finally{o.current=i}return r}};e.exports=o},{"./merge":131}],35:[function(t,e){"use strict";var n={current:null};e.exports=n},{}],36:[function(t,e){"use strict";function n(t,e){var n=function(){};n.prototype=new o(t,e),n.prototype.constructor=n,n.displayName=t;var r=function(){var t=new n;return t.construct.apply(t,arguments),t};return r.type=n,n.prototype.type=n,n.ConvenienceConstructor=r,r.componentConstructor=n,r}var o=t("./ReactDOMComponent"),r=t("./mergeInto"),i=t("./objMapKeyVal"),a=i({a:!1,abbr:!1,address:!1,area:!0,article:!1,aside:!1,audio:!1,b:!1,base:!0,bdi:!1,bdo:!1,big:!1,blockquote:!1,body:!1,br:!0,button:!1,canvas:!1,caption:!1,cite:!1,code:!1,col:!0,colgroup:!1,data:!1,datalist:!1,dd:!1,del:!1,details:!1,dfn:!1,div:!1,dl:!1,dt:!1,em:!1,embed:!0,fieldset:!1,figcaption:!1,figure:!1,footer:!1,form:!1,h1:!1,h2:!1,h3:!1,h4:!1,h5:!1,h6:!1,head:!1,header:!1,hr:!0,html:!1,i:!1,iframe:!1,img:!0,input:!0,ins:!1,kbd:!1,keygen:!0,label:!1,legend:!1,li:!1,link:!0,main:!1,map:!1,mark:!1,menu:!1,menuitem:!1,meta:!0,meter:!1,nav:!1,noscript:!1,object:!1,ol:!1,optgroup:!1,option:!1,output:!1,p:!1,param:!0,pre:!1,progress:!1,q:!1,rp:!1,rt:!1,ruby:!1,s:!1,samp:!1,script:!1,section:!1,select:!1,small:!1,source:!0,span:!1,strong:!1,style:!1,sub:!1,summary:!1,sup:!1,table:!1,tbody:!1,td:!1,textarea:!1,tfoot:!1,th:!1,thead:!1,time:!1,title:!1,tr:!1,track:!0,u:!1,ul:!1,"var":!1,video:!1,wbr:!0,circle:!1,defs:!1,g:!1,line:!1,linearGradient:!1,path:!1,polygon:!1,polyline:!1,radialGradient:!1,rect:!1,stop:!1,svg:!1,text:!1},n),s={injectComponentClasses:function(t){r(a,t)}};a.injection=s,e.exports=a},{"./ReactDOMComponent":38,"./mergeInto":133,"./objMapKeyVal":137}],37:[function(t,e){"use strict";var n=t("./AutoFocusMixin"),o=t("./ReactBrowserComponentMixin"),r=t("./ReactCompositeComponent"),i=t("./ReactDOM"),a=t("./keyMirror"),s=i.button,u=a({onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0}),c=r.createClass({displayName:"ReactDOMButton",mixins:[n,o],render:function(){var t={};for(var e in this.props)!this.props.hasOwnProperty(e)||this.props.disabled&&u[e]||(t[e]=this.props[e]);return s(t,this.props.children)}});e.exports=c},{"./AutoFocusMixin":1,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./keyMirror":128}],38:[function(t,e){"use strict";function n(t){t&&(m(null==t.children||null==t.dangerouslySetInnerHTML),m(null==t.style||"object"==typeof t.style))}function o(t,e,n,o){var r=p.findReactContainerForID(t);if(r){var i=r.nodeType===x?r.ownerDocument:r;E(e,i)}o.getPutListenerQueue().enqueuePutListener(t,e,n)}function r(t,e){this._tagOpen="<"+t,this._tagClose=e?"":"</"+t+">",this.tagName=t.toUpperCase()}var i=t("./CSSPropertyOperations"),a=t("./DOMProperty"),s=t("./DOMPropertyOperations"),u=t("./ReactBrowserComponentMixin"),c=t("./ReactComponent"),l=t("./ReactEventEmitter"),p=t("./ReactMount"),d=t("./ReactMultiChild"),h=t("./ReactPerf"),f=t("./escapeTextForBrowser"),m=t("./invariant"),v=t("./keyOf"),g=t("./merge"),y=t("./mixInto"),C=l.deleteListener,E=l.listenTo,R=l.registrationNameModules,M={string:!0,number:!0},D=v({style:null}),x=1;r.Mixin={mountComponent:h.measure("ReactDOMComponent","mountComponent",function(t,e,o){return c.Mixin.mountComponent.call(this,t,e,o),n(this.props),this._createOpenTagMarkupAndPutListeners(e)+this._createContentMarkup(e)+this._tagClose}),_createOpenTagMarkupAndPutListeners:function(t){var e=this.props,n=this._tagOpen;for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];if(null!=a)if(R[r])o(this._rootNodeID,r,a,t);else{r===D&&(a&&(a=e.style=g(e.style)),a=i.createMarkupForStyles(a));var u=s.createMarkupForProperty(r,a);u&&(n+=" "+u)}}if(t.renderToStaticMarkup)return n+">";var c=s.createMarkupForID(this._rootNodeID);return n+" "+c+">"},_createContentMarkup:function(t){var e=this.props.dangerouslySetInnerHTML;if(null!=e){if(null!=e.__html)return e.__html}else{var n=M[typeof this.props.children]?this.props.children:null,o=null!=n?null:this.props.children;if(null!=n)return f(n);if(null!=o){var r=this.mountChildren(o,t);return r.join("")}}return""},receiveComponent:function(t,e){t!==this&&(n(t.props),c.Mixin.receiveComponent.call(this,t,e))},updateComponent:h.measure("ReactDOMComponent","updateComponent",function(t,e,n){c.Mixin.updateComponent.call(this,t,e,n),this._updateDOMProperties(e,t),this._updateDOMChildren(e,t)}),_updateDOMProperties:function(t,e){var n,r,i,s=this.props;for(n in t)if(!s.hasOwnProperty(n)&&t.hasOwnProperty(n))if(n===D){var u=t[n];for(r in u)u.hasOwnProperty(r)&&(i=i||{},i[r]="")}else R[n]?C(this._rootNodeID,n):(a.isStandardName[n]||a.isCustomAttribute(n))&&c.BackendIDOperations.deletePropertyByID(this._rootNodeID,n);for(n in s){var l=s[n],p=t[n];if(s.hasOwnProperty(n)&&l!==p)if(n===D)if(l&&(l=s.style=g(l)),p){for(r in p)p.hasOwnProperty(r)&&!l.hasOwnProperty(r)&&(i=i||{},i[r]="");for(r in l)l.hasOwnProperty(r)&&p[r]!==l[r]&&(i=i||{},i[r]=l[r])}else i=l;else R[n]?o(this._rootNodeID,n,l,e):(a.isStandardName[n]||a.isCustomAttribute(n))&&c.BackendIDOperations.updatePropertyByID(this._rootNodeID,n,l)}i&&c.BackendIDOperations.updateStylesByID(this._rootNodeID,i)},_updateDOMChildren:function(t,e){var n=this.props,o=M[typeof t.children]?t.children:null,r=M[typeof n.children]?n.children:null,i=t.dangerouslySetInnerHTML&&t.dangerouslySetInnerHTML.__html,a=n.dangerouslySetInnerHTML&&n.dangerouslySetInnerHTML.__html,s=null!=o?null:t.children,u=null!=r?null:n.children,l=null!=o||null!=i,p=null!=r||null!=a;null!=s&&null==u?this.updateChildren(null,e):l&&!p&&this.updateTextContent(""),null!=r?o!==r&&this.updateTextContent(""+r):null!=a?i!==a&&c.BackendIDOperations.updateInnerHTMLByID(this._rootNodeID,a):null!=u&&this.updateChildren(u,e)},unmountComponent:function(){this.unmountChildren(),l.deleteAllListeners(this._rootNodeID),c.Mixin.unmountComponent.call(this)}},y(r,c.Mixin),y(r,r.Mixin),y(r,d.Mixin),y(r,u),e.exports=r},{"./CSSPropertyOperations":4,"./DOMProperty":9,"./DOMPropertyOperations":10,"./ReactBrowserComponentMixin":27,"./ReactComponent":31,"./ReactEventEmitter":50,"./ReactMount":58,"./ReactMultiChild":60,"./ReactPerf":63,"./escapeTextForBrowser":108,"./invariant":122,"./keyOf":129,"./merge":131,"./mixInto":134}],39:[function(t,e){"use strict";var n=t("./ReactBrowserComponentMixin"),o=t("./ReactCompositeComponent"),r=t("./ReactDOM"),i=t("./ReactEventEmitter"),a=t("./EventConstants"),s=r.form,u=o.createClass({displayName:"ReactDOMForm",mixins:[n],render:function(){return this.transferPropsTo(s(null,this.props.children))},componentDidMount:function(){i.trapBubbledEvent(a.topLevelTypes.topReset,"reset",this.getDOMNode()),i.trapBubbledEvent(a.topLevelTypes.topSubmit,"submit",this.getDOMNode())}});e.exports=u},{"./EventConstants":15,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./ReactEventEmitter":50}],40:[function(t,e){"use strict";var n,o=t("./CSSPropertyOperations"),r=t("./DOMChildrenOperations"),i=t("./DOMPropertyOperations"),a=t("./ReactMount"),s=t("./ReactPerf"),u=t("./invariant"),c={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},l={updatePropertyByID:s.measure("ReactDOMIDOperations","updatePropertyByID",function(t,e,n){var o=a.getNode(t);u(!c.hasOwnProperty(e)),null!=n?i.setValueForProperty(o,e,n):i.deleteValueForProperty(o,e)}),deletePropertyByID:s.measure("ReactDOMIDOperations","deletePropertyByID",function(t,e,n){var o=a.getNode(t);u(!c.hasOwnProperty(e)),i.deleteValueForProperty(o,e,n)}),updateStylesByID:s.measure("ReactDOMIDOperations","updateStylesByID",function(t,e){var n=a.getNode(t);o.setValueForStyles(n,e)}),updateInnerHTMLByID:s.measure("ReactDOMIDOperations","updateInnerHTMLByID",function(t,e){var o=a.getNode(t);if(void 0===n){var r=document.createElement("div");r.innerHTML=" ",n=""===r.innerHTML}n&&o.parentNode.replaceChild(o,o),n&&e.match(/^[ \r\n\t\f]/)?(o.innerHTML=""+e,o.firstChild.deleteData(0,1)):o.innerHTML=e}),updateTextContentByID:s.measure("ReactDOMIDOperations","updateTextContentByID",function(t,e){var n=a.getNode(t);r.updateTextContent(n,e)}),dangerouslyReplaceNodeWithMarkupByID:s.measure("ReactDOMIDOperations","dangerouslyReplaceNodeWithMarkupByID",function(t,e){var n=a.getNode(t);r.dangerouslyReplaceNodeWithMarkup(n,e)}),dangerouslyProcessChildrenUpdates:s.measure("ReactDOMIDOperations","dangerouslyProcessChildrenUpdates",function(t,e){for(var n=0;n<t.length;n++)t[n].parentNode=a.getNode(t[n].parentID);r.processUpdates(t,e)})};e.exports=l},{"./CSSPropertyOperations":4,"./DOMChildrenOperations":8,"./DOMPropertyOperations":10,"./ReactMount":58,"./ReactPerf":63,"./invariant":122}],41:[function(t,e){"use strict";var n=t("./ReactBrowserComponentMixin"),o=t("./ReactCompositeComponent"),r=t("./ReactDOM"),i=t("./ReactEventEmitter"),a=t("./EventConstants"),s=r.img,u=o.createClass({displayName:"ReactDOMImg",tagName:"IMG",mixins:[n],render:function(){return s(this.props)},componentDidMount:function(){var t=this.getDOMNode();i.trapBubbledEvent(a.topLevelTypes.topLoad,"load",t),i.trapBubbledEvent(a.topLevelTypes.topError,"error",t)}});e.exports=u},{"./EventConstants":15,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./ReactEventEmitter":50}],42:[function(t,e){"use strict";var n=t("./AutoFocusMixin"),o=t("./DOMPropertyOperations"),r=t("./LinkedValueUtils"),i=t("./ReactBrowserComponentMixin"),a=t("./ReactCompositeComponent"),s=t("./ReactDOM"),u=t("./ReactMount"),c=t("./invariant"),l=t("./merge"),p=s.input,d={},h=a.createClass({displayName:"ReactDOMInput",mixins:[n,r.Mixin,i],getInitialState:function(){var t=this.props.defaultValue;return{checked:this.props.defaultChecked||!1,value:null!=t?t:null}},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var t=l(this.props);t.defaultChecked=null,t.defaultValue=null;var e=r.getValue(this);t.value=null!=e?e:this.state.value;var n=r.getChecked(this);return t.checked=null!=n?n:this.state.checked,t.onChange=this._handleChange,p(t,this.props.children)},componentDidMount:function(){var t=u.getID(this.getDOMNode());d[t]=this},componentWillUnmount:function(){var t=this.getDOMNode(),e=u.getID(t);delete d[e]},componentDidUpdate:function(){var t=this.getDOMNode();null!=this.props.checked&&o.setValueForProperty(t,"checked",this.props.checked||!1);var e=r.getValue(this);null!=e&&o.setValueForProperty(t,"value",""+e)},_handleChange:function(t){var e,n=r.getOnChange(this);n&&(this._isChanging=!0,e=n.call(this,t),this._isChanging=!1),this.setState({checked:t.target.checked,value:t.target.value});var o=this.props.name;if("radio"===this.props.type&&null!=o){for(var i=this.getDOMNode(),a=i;a.parentNode;)a=a.parentNode;for(var s=a.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),l=0,p=s.length;p>l;l++){var h=s[l];if(h!==i&&h.form===i.form){var f=u.getID(h);c(f);var m=d[f];c(m),m.setState({checked:!1})}}}return e}});e.exports=h},{"./AutoFocusMixin":1,"./DOMPropertyOperations":10,"./LinkedValueUtils":23,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./ReactMount":58,"./invariant":122,"./merge":131}],43:[function(t,e){"use strict";var n=t("./ReactBrowserComponentMixin"),o=t("./ReactCompositeComponent"),r=t("./ReactDOM"),i=(t("./warning"),r.option),a=o.createClass({displayName:"ReactDOMOption",mixins:[n],componentWillMount:function(){},render:function(){return i(this.props,this.props.children)}});e.exports=a},{"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./warning":144}],44:[function(t,e){"use strict";function n(t,e){null!=t[e]&&c(t.multiple?Array.isArray(t[e]):!Array.isArray(t[e]))}function o(t,e){var n,o,r,i=t.props.multiple,a=null!=e?e:t.state.value,s=t.getDOMNode().options;if(i)for(n={},o=0,r=a.length;r>o;++o)n[""+a[o]]=!0;else n=""+a;for(o=0,r=s.length;r>o;o++){var u=i?n.hasOwnProperty(s[o].value):s[o].value===n;u!==s[o].selected&&(s[o].selected=u)}}var r=t("./AutoFocusMixin"),i=t("./LinkedValueUtils"),a=t("./ReactBrowserComponentMixin"),s=t("./ReactCompositeComponent"),u=t("./ReactDOM"),c=t("./invariant"),l=t("./merge"),p=u.select,d=s.createClass({displayName:"ReactDOMSelect",mixins:[r,i.Mixin,a],propTypes:{defaultValue:n,value:n},getInitialState:function(){return{value:this.props.defaultValue||(this.props.multiple?[]:"")}},componentWillReceiveProps:function(t){!this.props.multiple&&t.multiple?this.setState({value:[this.state.value]}):this.props.multiple&&!t.multiple&&this.setState({value:this.state.value[0]})},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var t=l(this.props);return t.onChange=this._handleChange,t.value=null,p(t,this.props.children)},componentDidMount:function(){o(this,i.getValue(this))},componentDidUpdate:function(){var t=i.getValue(this);null!=t&&o(this,t)},_handleChange:function(t){var e,n=i.getOnChange(this);n&&(this._isChanging=!0,e=n.call(this,t),this._isChanging=!1);var o;if(this.props.multiple){o=[];for(var r=t.target.options,a=0,s=r.length;s>a;a++)r[a].selected&&o.push(r[a].value)}else o=t.target.value;return this.setState({value:o}),e}});e.exports=d},{"./AutoFocusMixin":1,"./LinkedValueUtils":23,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./invariant":122,"./merge":131}],45:[function(t,e){"use strict";function n(t){var e=document.selection,n=e.createRange(),o=n.text.length,r=n.duplicate();r.moveToElementText(t),r.setEndPoint("EndToStart",n);var i=r.text.length,a=i+o;return{start:i,end:a}}function o(t){var e=window.getSelection();if(0===e.rangeCount)return null;var n=e.anchorNode,o=e.anchorOffset,r=e.focusNode,i=e.focusOffset,a=e.getRangeAt(0),s=a.toString().length,u=a.cloneRange();u.selectNodeContents(t),u.setEnd(a.startContainer,a.startOffset);var c=u.toString().length,l=c+s,p=document.createRange();p.setStart(n,o),p.setEnd(r,i);var d=p.collapsed;return p.detach(),{start:d?l:c,end:d?c:l}}function r(t,e){var n,o,r=document.selection.createRange().duplicate();"undefined"==typeof e.end?(n=e.start,o=n):e.start>e.end?(n=e.end,o=e.start):(n=e.start,o=e.end),r.moveToElementText(t),r.moveStart("character",n),r.setEndPoint("EndToStart",r),r.moveEnd("character",o-n),r.select()}function i(t,e){var n=window.getSelection(),o=t[s()].length,r=Math.min(e.start,o),i="undefined"==typeof e.end?r:Math.min(e.end,o);if(!n.extend&&r>i){var u=i;i=r,r=u}var c=a(t,r),l=a(t,i);if(c&&l){var p=document.createRange();p.setStart(c.node,c.offset),n.removeAllRanges(),r>i?(n.addRange(p),n.extend(l.node,l.offset)):(p.setEnd(l.node,l.offset),n.addRange(p)),p.detach()}}var a=t("./getNodeForCharacterOffset"),s=t("./getTextContentAccessor"),u={getOffsets:function(t){var e=document.selection?n:o;return e(t)},setOffsets:function(t,e){var n=document.selection?r:i;n(t,e)}};e.exports=u},{"./getNodeForCharacterOffset":116,"./getTextContentAccessor":118}],46:[function(t,e){"use strict";var n=t("./AutoFocusMixin"),o=t("./DOMPropertyOperations"),r=t("./LinkedValueUtils"),i=t("./ReactBrowserComponentMixin"),a=t("./ReactCompositeComponent"),s=t("./ReactDOM"),u=t("./invariant"),c=t("./merge"),l=(t("./warning"),s.textarea),p=a.createClass({displayName:"ReactDOMTextarea",mixins:[n,r.Mixin,i],getInitialState:function(){var t=this.props.defaultValue,e=this.props.children;null!=e&&(u(null==t),Array.isArray(e)&&(u(e.length<=1),e=e[0]),t=""+e),null==t&&(t="");var n=r.getValue(this);return{initialValue:""+(null!=n?n:t),value:t}},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var t=c(this.props),e=r.getValue(this);return u(null==t.dangerouslySetInnerHTML),t.defaultValue=null,t.value=null!=e?e:this.state.value,t.onChange=this._handleChange,l(t,this.state.initialValue)},componentDidUpdate:function(){var t=r.getValue(this);if(null!=t){var e=this.getDOMNode();o.setValueForProperty(e,"value",""+t)}},_handleChange:function(t){var e,n=r.getOnChange(this);return n&&(this._isChanging=!0,e=n.call(this,t),this._isChanging=!1),this.setState({value:t.target.value}),e}});e.exports=p},{"./AutoFocusMixin":1,"./DOMPropertyOperations":10,"./LinkedValueUtils":23,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./invariant":122,"./merge":131,"./warning":144}],47:[function(t,e){"use strict";function n(){this.reinitializeTransaction()}var o=t("./ReactUpdates"),r=t("./Transaction"),i=t("./emptyFunction"),a=t("./mixInto"),s={initialize:i,close:function(){p.isBatchingUpdates=!1}},u={initialize:i,close:o.flushBatchedUpdates.bind(o)},c=[u,s];a(n,r.Mixin),a(n,{getTransactionWrappers:function(){return c}});var l=new n,p={isBatchingUpdates:!1,batchedUpdates:function(t,e){var n=p.isBatchingUpdates;p.isBatchingUpdates=!0,n?t(e):l.perform(t,null,e)}};e.exports=p},{"./ReactUpdates":78,"./Transaction":93,"./emptyFunction":106,"./mixInto":134}],48:[function(t,e){"use strict";function n(){o.EventEmitter.injectTopLevelCallbackCreator(f),o.EventPluginHub.injectEventPluginOrder(c),o.EventPluginHub.injectInstanceHandle(D),o.EventPluginHub.injectMount(x),o.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:b,EnterLeaveEventPlugin:l,ChangeEventPlugin:a,CompositionEventPlugin:u,MobileSafariClickEventPlugin:p,SelectEventPlugin:P}),o.DOM.injectComponentClasses({button:v,form:g,img:y,input:C,option:E,select:R,textarea:M,html:S(m.html),head:S(m.head),title:S(m.title),body:S(m.body)}),o.CompositeComponent.injectMixin(d),o.DOMProperty.injectDOMPropertyConfig(i),o.Updates.injectBatchingStrategy(O),o.RootIndex.injectCreateReactRootIndex(r.canUseDOM?s.createReactRootIndex:T.createReactRootIndex),o.Component.injectEnvironment(h)}var o=t("./ReactInjection"),r=t("./ExecutionEnvironment"),i=t("./DefaultDOMPropertyConfig"),a=t("./ChangeEventPlugin"),s=t("./ClientReactRootIndex"),u=t("./CompositionEventPlugin"),c=t("./DefaultEventPluginOrder"),l=t("./EnterLeaveEventPlugin"),p=t("./MobileSafariClickEventPlugin"),d=t("./ReactBrowserComponentMixin"),h=t("./ReactComponentBrowserEnvironment"),f=t("./ReactEventTopLevelCallback"),m=t("./ReactDOM"),v=t("./ReactDOMButton"),g=t("./ReactDOMForm"),y=t("./ReactDOMImg"),C=t("./ReactDOMInput"),E=t("./ReactDOMOption"),R=t("./ReactDOMSelect"),M=t("./ReactDOMTextarea"),D=t("./ReactInstanceHandles"),x=t("./ReactMount"),P=t("./SelectEventPlugin"),T=t("./ServerReactRootIndex"),b=t("./SimpleEventPlugin"),O=t("./ReactDefaultBatchingStrategy"),S=t("./createFullPageComponent");e.exports={inject:n}},{"./ChangeEventPlugin":5,"./ClientReactRootIndex":6,"./CompositionEventPlugin":7,"./DefaultDOMPropertyConfig":12,"./DefaultEventPluginOrder":13,"./EnterLeaveEventPlugin":14,"./ExecutionEnvironment":21,"./MobileSafariClickEventPlugin":24,"./ReactBrowserComponentMixin":27,"./ReactComponentBrowserEnvironment":32,"./ReactDOM":36,"./ReactDOMButton":37,"./ReactDOMForm":39,"./ReactDOMImg":41,"./ReactDOMInput":42,"./ReactDOMOption":43,"./ReactDOMSelect":44,"./ReactDOMTextarea":46,"./ReactDefaultBatchingStrategy":47,"./ReactEventTopLevelCallback":52,"./ReactInjection":53,"./ReactInstanceHandles":55,"./ReactMount":58,"./SelectEventPlugin":80,"./ServerReactRootIndex":81,"./SimpleEventPlugin":82,"./createFullPageComponent":101}],49:[function(t,e){"use strict";var n={guard:function(t){return t}};e.exports=n},{}],50:[function(t,e){"use strict";function n(t){return null==t[C]&&(t[C]=g++,m[t[C]]={}),m[t[C]]}function o(t,e,n){a.listen(n,e,E.TopLevelCallbackCreator.createTopLevelCallback(t))}function r(t,e,n){a.capture(n,e,E.TopLevelCallbackCreator.createTopLevelCallback(t))}var i=t("./EventConstants"),a=t("./EventListener"),s=t("./EventPluginHub"),u=t("./EventPluginRegistry"),c=t("./ExecutionEnvironment"),l=t("./ReactEventEmitterMixin"),p=t("./ViewportMetrics"),d=t("./invariant"),h=t("./isEventSupported"),f=t("./merge"),m={},v=!1,g=0,y={topBlur:"blur",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topScroll:"scroll",topSelectionChange:"selectionchange",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topWheel:"wheel"},C="_reactListenersID"+String(Math.random()).slice(2),E=f(l,{TopLevelCallbackCreator:null,injection:{injectTopLevelCallbackCreator:function(t){E.TopLevelCallbackCreator=t}},setEnabled:function(t){d(c.canUseDOM),E.TopLevelCallbackCreator&&E.TopLevelCallbackCreator.setEnabled(t)},isEnabled:function(){return!(!E.TopLevelCallbackCreator||!E.TopLevelCallbackCreator.isEnabled())},listenTo:function(t,e){for(var a=e,s=n(a),c=u.registrationNameDependencies[t],l=i.topLevelTypes,p=0,d=c.length;d>p;p++){var f=c[p];if(!s[f]){var m=l[f];m===l.topWheel?h("wheel")?o(l.topWheel,"wheel",a):h("mousewheel")?o(l.topWheel,"mousewheel",a):o(l.topWheel,"DOMMouseScroll",a):m===l.topScroll?h("scroll",!0)?r(l.topScroll,"scroll",a):o(l.topScroll,"scroll",window):m===l.topFocus||m===l.topBlur?(h("focus",!0)?(r(l.topFocus,"focus",a),r(l.topBlur,"blur",a)):h("focusin")&&(o(l.topFocus,"focusin",a),o(l.topBlur,"focusout",a)),s[l.topBlur]=!0,s[l.topFocus]=!0):y[f]&&o(m,y[f],a),s[f]=!0}}},ensureScrollValueMonitoring:function(){if(!v){var t=p.refreshScrollValues;a.listen(window,"scroll",t),a.listen(window,"resize",t),v=!0}},eventNameDispatchConfigs:s.eventNameDispatchConfigs,registrationNameModules:s.registrationNameModules,putListener:s.putListener,getListener:s.getListener,deleteListener:s.deleteListener,deleteAllListeners:s.deleteAllListeners,trapBubbledEvent:o,trapCapturedEvent:r});e.exports=E},{"./EventConstants":15,"./EventListener":16,"./EventPluginHub":17,"./EventPluginRegistry":18,"./ExecutionEnvironment":21,"./ReactEventEmitterMixin":51,"./ViewportMetrics":94,"./invariant":122,"./isEventSupported":123,"./merge":131}],51:[function(t,e){"use strict";function n(t){o.enqueueEvents(t),o.processEventQueue()}var o=t("./EventPluginHub"),r=t("./ReactUpdates"),i={handleTopLevel:function(t,e,i,a){var s=o.extractEvents(t,e,i,a);r.batchedUpdates(n,s)}};e.exports=i},{"./EventPluginHub":17,"./ReactUpdates":78}],52:[function(t,e){"use strict";function n(t){var e=u.getID(t),n=s.getReactRootIDFromNodeID(e),o=u.findReactContainerForID(n),r=u.getFirstReactDOM(o);return r}function o(t,e,o){for(var r=u.getFirstReactDOM(c(e))||window,i=r;i;)o.ancestors.push(i),i=n(i);for(var s=0,l=o.ancestors.length;l>s;s++){r=o.ancestors[s];var p=u.getID(r)||"";a.handleTopLevel(t,r,p,e)}}function r(){this.ancestors=[]}var i=t("./PooledClass"),a=t("./ReactEventEmitter"),s=t("./ReactInstanceHandles"),u=t("./ReactMount"),c=t("./getEventTarget"),l=t("./mixInto"),p=!0;l(r,{destructor:function(){this.ancestors.length=0}}),i.addPoolingTo(r);var d={setEnabled:function(t){p=!!t},isEnabled:function(){return p},createTopLevelCallback:function(t){return function(e){if(p){var n=r.getPooled();try{o(t,e,n)}finally{r.release(n)}}}}};e.exports=d},{"./PooledClass":25,"./ReactEventEmitter":50,"./ReactInstanceHandles":55,"./ReactMount":58,"./getEventTarget":114,"./mixInto":134}],53:[function(t,e){"use strict";var n=t("./DOMProperty"),o=t("./EventPluginHub"),r=t("./ReactComponent"),i=t("./ReactCompositeComponent"),a=t("./ReactDOM"),s=t("./ReactEventEmitter"),u=t("./ReactPerf"),c=t("./ReactRootIndex"),l=t("./ReactUpdates"),p={Component:r.injection,CompositeComponent:i.injection,DOMProperty:n.injection,EventPluginHub:o.injection,DOM:a.injection,EventEmitter:s.injection,Perf:u.injection,RootIndex:c.injection,Updates:l.injection};e.exports=p},{"./DOMProperty":9,"./EventPluginHub":17,"./ReactComponent":31,"./ReactCompositeComponent":33,"./ReactDOM":36,"./ReactEventEmitter":50,"./ReactPerf":63,"./ReactRootIndex":70,"./ReactUpdates":78}],54:[function(t,e){"use strict";function n(t){return r(document.documentElement,t)}var o=t("./ReactDOMSelection"),r=t("./containsNode"),i=t("./focusNode"),a=t("./getActiveElement"),s={hasSelectionCapabilities:function(t){return t&&("INPUT"===t.nodeName&&"text"===t.type||"TEXTAREA"===t.nodeName||"true"===t.contentEditable)},getSelectionInformation:function(){var t=a();return{focusedElem:t,selectionRange:s.hasSelectionCapabilities(t)?s.getSelection(t):null}},restoreSelection:function(t){var e=a(),o=t.focusedElem,r=t.selectionRange;e!==o&&n(o)&&(s.hasSelectionCapabilities(o)&&s.setSelection(o,r),i(o))},getSelection:function(t){var e;if("selectionStart"in t)e={start:t.selectionStart,end:t.selectionEnd};else if(document.selection&&"INPUT"===t.nodeName){var n=document.selection.createRange();n.parentElement()===t&&(e={start:-n.moveStart("character",-t.value.length),end:-n.moveEnd("character",-t.value.length)})}else e=o.getOffsets(t);return e||{start:0,end:0}},setSelection:function(t,e){var n=e.start,r=e.end;if("undefined"==typeof r&&(r=n),"selectionStart"in t)t.selectionStart=n,t.selectionEnd=Math.min(r,t.value.length);else if(document.selection&&"INPUT"===t.nodeName){var i=t.createTextRange();i.collapse(!0),i.moveStart("character",n),i.moveEnd("character",r-n),i.select()}else o.setOffsets(t,e)}};e.exports=s},{"./ReactDOMSelection":45,"./containsNode":98,"./focusNode":110,"./getActiveElement":112}],55:[function(t,e){"use strict";function n(t){return d+t.toString(36)}function o(t,e){return t.charAt(e)===d||e===t.length}function r(t){return""===t||t.charAt(0)===d&&t.charAt(t.length-1)!==d}function i(t,e){return 0===e.indexOf(t)&&o(e,t.length)}function a(t){return t?t.substr(0,t.lastIndexOf(d)):""}function s(t,e){if(p(r(t)&&r(e)),p(i(t,e)),t===e)return t;for(var n=t.length+h,a=n;a<e.length&&!o(e,a);a++);return e.substr(0,a)}function u(t,e){var n=Math.min(t.length,e.length);if(0===n)return"";for(var i=0,a=0;n>=a;a++)if(o(t,a)&&o(e,a))i=a;else if(t.charAt(a)!==e.charAt(a))break;var s=t.substr(0,i);return p(r(s)),s}function c(t,e,n,o,r,u){t=t||"",e=e||"",p(t!==e);var c=i(e,t);p(c||i(t,e));for(var l=0,d=c?a:s,h=t;;h=d(h,e)){var m;if(r&&h===t||u&&h===e||(m=n(h,c,o)),m===!1||h===e)break;p(l++<f)}}var l=t("./ReactRootIndex"),p=t("./invariant"),d=".",h=d.length,f=100,m={createReactRootID:function(){return n(l.createReactRootIndex())},createReactID:function(t,e){return t+e},getReactRootIDFromNodeID:function(t){if(t&&t.charAt(0)===d&&t.length>1){var e=t.indexOf(d,1);return e>-1?t.substr(0,e):t}return null},traverseEnterLeave:function(t,e,n,o,r){var i=u(t,e);i!==t&&c(t,i,n,o,!1,!0),i!==e&&c(i,e,n,r,!0,!1)},traverseTwoPhase:function(t,e,n){t&&(c("",t,e,n,!0,!1),c(t,"",e,n,!1,!0))},traverseAncestors:function(t,e,n){c("",t,e,n,!0,!1)},_getFirstCommonAncestorID:u,_getNextDescendantID:s,isAncestorIDOf:i,SEPARATOR:d};e.exports=m},{"./ReactRootIndex":70,"./invariant":122}],56:[function(t,e){"use strict";function n(t,e){this.value=t,this.requestChange=e}e.exports=n},{}],57:[function(t,e){"use strict";var n=t("./adler32"),o={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(t){var e=n(t);return t.replace(">"," "+o.CHECKSUM_ATTR_NAME+'="'+e+'">')},canReuseMarkup:function(t,e){var r=e.getAttribute(o.CHECKSUM_ATTR_NAME);r=r&&parseInt(r,10);var i=n(t);return i===r}};e.exports=o},{"./adler32":96}],58:[function(t,e){"use strict";function n(t){var e=v(t);return e&&S.getID(e)}function o(t){var e=r(t);if(e)if(M.hasOwnProperty(e)){var n=M[e];n!==t&&(y(!s(n,e)),M[e]=t)}else M[e]=t;return e}function r(t){return t&&t.getAttribute&&t.getAttribute(R)||""}function i(t,e){var n=r(t);n!==e&&delete M[n],t.setAttribute(R,e),M[e]=t}function a(t){return M.hasOwnProperty(t)&&s(M[t],t)||(M[t]=S.findReactNodeByID(t)),M[t]}function s(t,e){if(t){y(r(t)===e);var n=S.findReactContainerForID(e);if(n&&m(n,t))return!0}return!1}function u(t){delete M[t]}function c(t){var e=M[t];return e&&s(e,t)?void(O=e):!1}function l(t){O=null,h.traverseAncestors(t,c);var e=O;return O=null,e}var p=t("./DOMProperty"),d=t("./ReactEventEmitter"),h=t("./ReactInstanceHandles"),f=t("./ReactPerf"),m=t("./containsNode"),v=t("./getReactRootElementInContainer"),g=t("./instantiateReactComponent"),y=t("./invariant"),C=t("./shouldUpdateReactComponent"),E=h.SEPARATOR,R=p.ID_ATTRIBUTE_NAME,M={},D=1,x=9,P={},T={},b=[],O=null,S={totalInstantiationTime:0,totalInjectionTime:0,useTouchEvents:!1,_instancesByReactRootID:P,scrollMonitor:function(t,e){e()},_updateRootComponent:function(t,e,n,o){var r=e.props;return S.scrollMonitor(n,function(){t.replaceProps(r,o)}),t
},_registerComponent:function(t,e){y(e&&(e.nodeType===D||e.nodeType===x)),d.ensureScrollValueMonitoring();var n=S.registerContainer(e);return P[n]=t,n},_renderNewRootComponent:f.measure("ReactMount","_renderNewRootComponent",function(t,e,n){var o=g(t),r=S._registerComponent(o,e);return o.mountComponentIntoNode(r,e,n),o}),renderComponent:function(t,e,o){var r=P[n(e)];if(r){if(C(r,t))return S._updateRootComponent(r,t,e,o);S.unmountComponentAtNode(e)}var i=v(e),a=i&&S.isRenderedByReact(i),s=a&&!r,u=S._renderNewRootComponent(t,e,s);return o&&o.call(u),u},constructAndRenderComponent:function(t,e,n){return S.renderComponent(t(e),n)},constructAndRenderComponentByID:function(t,e,n){var o=document.getElementById(n);return y(o),S.constructAndRenderComponent(t,e,o)},registerContainer:function(t){var e=n(t);return e&&(e=h.getReactRootIDFromNodeID(e)),e||(e=h.createReactRootID()),T[e]=t,e},unmountComponentAtNode:function(t){var e=n(t),o=P[e];return o?(S.unmountComponentFromNode(o,t),delete P[e],delete T[e],!0):!1},unmountComponentFromNode:function(t,e){for(t.unmountComponent(),e.nodeType===x&&(e=e.documentElement);e.lastChild;)e.removeChild(e.lastChild)},findReactContainerForID:function(t){var e=h.getReactRootIDFromNodeID(t),n=T[e];return n},findReactNodeByID:function(t){var e=S.findReactContainerForID(t);return S.findComponentRoot(e,t)},isRenderedByReact:function(t){if(1!==t.nodeType)return!1;var e=S.getID(t);return e?e.charAt(0)===E:!1},getFirstReactDOM:function(t){for(var e=t;e&&e.parentNode!==e;){if(S.isRenderedByReact(e))return e;e=e.parentNode}return null},findComponentRoot:function(t,e){var n=b,o=0,r=l(e)||t;for(n[0]=r.firstChild,n.length=1;o<n.length;){for(var i,a=n[o++];a;){var s=S.getID(a);s?e===s?i=a:h.isAncestorIDOf(s,e)&&(n.length=o=0,n.push(a.firstChild)):n.push(a.firstChild),a=a.nextSibling}if(i)return n.length=0,i}n.length=0,y(!1)},getReactRootID:n,getID:o,setID:i,getNode:a,purgeID:u};e.exports=S},{"./DOMProperty":9,"./ReactEventEmitter":50,"./ReactInstanceHandles":55,"./ReactPerf":63,"./containsNode":98,"./getReactRootElementInContainer":117,"./instantiateReactComponent":121,"./invariant":122,"./shouldUpdateReactComponent":140}],59:[function(t,e){"use strict";function n(t){this._queue=t||null}var o=t("./PooledClass"),r=t("./mixInto");r(n,{enqueue:function(t,e){this._queue=this._queue||[],this._queue.push({component:t,callback:e})},notifyAll:function(){var t=this._queue;if(t){this._queue=null;for(var e=0,n=t.length;n>e;e++){var o=t[e].component,r=t[e].callback;r.call(o)}t.length=0}},reset:function(){this._queue=null},destructor:function(){this.reset()}}),o.addPoolingTo(n),e.exports=n},{"./PooledClass":25,"./mixInto":134}],60:[function(t,e){"use strict";function n(t,e,n){f.push({parentID:t,parentNode:null,type:c.INSERT_MARKUP,markupIndex:m.push(e)-1,textContent:null,fromIndex:null,toIndex:n})}function o(t,e,n){f.push({parentID:t,parentNode:null,type:c.MOVE_EXISTING,markupIndex:null,textContent:null,fromIndex:e,toIndex:n})}function r(t,e){f.push({parentID:t,parentNode:null,type:c.REMOVE_NODE,markupIndex:null,textContent:null,fromIndex:e,toIndex:null})}function i(t,e){f.push({parentID:t,parentNode:null,type:c.TEXT_CONTENT,markupIndex:null,textContent:e,fromIndex:null,toIndex:null})}function a(){f.length&&(u.BackendIDOperations.dangerouslyProcessChildrenUpdates(f,m),s())}function s(){f.length=0,m.length=0}var u=t("./ReactComponent"),c=t("./ReactMultiChildUpdateTypes"),l=t("./flattenChildren"),p=t("./instantiateReactComponent"),d=t("./shouldUpdateReactComponent"),h=0,f=[],m=[],v={Mixin:{mountChildren:function(t,e){var n=l(t),o=[],r=0;this._renderedChildren=n;for(var i in n){var a=n[i];if(n.hasOwnProperty(i)){var s=p(a);n[i]=s;var u=this._rootNodeID+i,c=s.mountComponent(u,e,this._mountDepth+1);s._mountIndex=r,o.push(c),r++}}return o},updateTextContent:function(t){h++;var e=!0;try{var n=this._renderedChildren;for(var o in n)n.hasOwnProperty(o)&&this._unmountChildByName(n[o],o);this.setTextContent(t),e=!1}finally{h--,h||(e?s():a())}},updateChildren:function(t,e){h++;var n=!0;try{this._updateChildren(t,e),n=!1}finally{h--,h||(n?s():a())}},_updateChildren:function(t,e){var n=l(t),o=this._renderedChildren;if(n||o){var r,i=0,a=0;for(r in n)if(n.hasOwnProperty(r)){var s=o&&o[r],u=n[r];if(d(s,u))this.moveChild(s,a,i),i=Math.max(s._mountIndex,i),s.receiveComponent(u,e),s._mountIndex=a;else{s&&(i=Math.max(s._mountIndex,i),this._unmountChildByName(s,r));var c=p(u);this._mountChildByNameAtIndex(c,r,a,e)}a++}for(r in o)!o.hasOwnProperty(r)||n&&n[r]||this._unmountChildByName(o[r],r)}},unmountChildren:function(){var t=this._renderedChildren;for(var e in t){var n=t[e];n.unmountComponent&&n.unmountComponent()}this._renderedChildren=null},moveChild:function(t,e,n){t._mountIndex<n&&o(this._rootNodeID,t._mountIndex,e)},createChild:function(t,e){n(this._rootNodeID,e,t._mountIndex)},removeChild:function(t){r(this._rootNodeID,t._mountIndex)},setTextContent:function(t){i(this._rootNodeID,t)},_mountChildByNameAtIndex:function(t,e,n,o){var r=this._rootNodeID+e,i=t.mountComponent(r,o,this._mountDepth+1);t._mountIndex=n,this.createChild(t,i),this._renderedChildren=this._renderedChildren||{},this._renderedChildren[e]=t},_unmountChildByName:function(t,e){u.isValidComponent(t)&&(this.removeChild(t),t._mountIndex=null,t.unmountComponent(),delete this._renderedChildren[e])}}};e.exports=v},{"./ReactComponent":31,"./ReactMultiChildUpdateTypes":61,"./flattenChildren":109,"./instantiateReactComponent":121,"./shouldUpdateReactComponent":140}],61:[function(t,e){"use strict";var n=t("./keyMirror"),o=n({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,TEXT_CONTENT:null});e.exports=o},{"./keyMirror":128}],62:[function(t,e){"use strict";var n=t("./emptyObject"),o=t("./invariant"),r={isValidOwner:function(t){return!(!t||"function"!=typeof t.attachRef||"function"!=typeof t.detachRef)},addComponentAsRefTo:function(t,e,n){o(r.isValidOwner(n)),n.attachRef(e,t)},removeComponentAsRefFrom:function(t,e,n){o(r.isValidOwner(n)),n.refs[e]===t&&n.detachRef(e)},Mixin:{construct:function(){this.refs=n},attachRef:function(t,e){o(e.isOwnedBy(this));var r=this.refs===n?this.refs={}:this.refs;r[t]=e},detachRef:function(t){delete this.refs[t]}}};e.exports=r},{"./emptyObject":107,"./invariant":122}],63:[function(t,e){"use strict";function n(t,e,n){return n}var o={enableMeasure:!1,storedMeasure:n,measure:function(t,e,n){return n},injection:{injectMeasure:function(t){o.storedMeasure=t}}};e.exports=o},{}],64:[function(t,e){"use strict";function n(t){return function(e,n,o){e[n]=e.hasOwnProperty(n)?t(e[n],o):o}}var o=t("./emptyFunction"),r=t("./invariant"),i=t("./joinClasses"),a=t("./merge"),s={children:o,className:n(i),key:o,ref:o,style:n(a)},u={TransferStrategies:s,mergeProps:function(t,e){var n=a(t);for(var o in e)if(e.hasOwnProperty(o)){var r=s[o];r&&s.hasOwnProperty(o)?r(n,o,e[o]):n.hasOwnProperty(o)||(n[o]=e[o])}return n},Mixin:{transferPropsTo:function(t){return r(t._owner===this),t.props=u.mergeProps(t.props,this.props),t}}};e.exports=u},{"./emptyFunction":106,"./invariant":122,"./joinClasses":127,"./merge":131}],65:[function(t,e){"use strict";var n={};e.exports=n},{}],66:[function(t,e){"use strict";var n=t("./keyMirror"),o=n({prop:null,context:null,childContext:null});e.exports=o},{"./keyMirror":128}],67:[function(t,e){"use strict";function n(t){switch(typeof t){case"number":case"string":return!0;case"object":if(Array.isArray(t))return t.every(n);if(f.isValidComponent(t))return!0;for(var e in t)if(!n(t[e]))return!1;return!0;default:return!1}}function o(t){var e=typeof t;return"object"===e&&Array.isArray(t)?"array":e}function r(){function t(){return!0}return h(t)}function i(t){function e(e,n){var r=o(n),i=r===t;return i}return h(e)}function a(t){function e(t,e){var o=n[e];return o}var n=m(t);return h(e)}function s(t){function e(e,n,r,i,a){var s=o(n),u="object"===s;if(u)for(var c in t){var l=t[c];if(l&&!l(n,c,i,a))return!1}return u}return h(e)}function u(t){function e(e,n){var o=n instanceof t;return o}return h(e)}function c(t){function e(e,n,o,r,i){var a=Array.isArray(n);if(a)for(var s=0;s<n.length;s++)if(!t(n,s,r,i))return!1;return a}return h(e)}function l(){function t(t,e){var o=n(e);return o}return h(t)}function p(){function t(t,e){var n=f.isValidComponent(e);return n}return h(t)}function d(t){return function(e,n,o,r){for(var i=!1,a=0;a<t.length;a++){var s=t[a];if("function"==typeof s.weak&&(s=s.weak),s(e,n,o,r)){i=!0;break}}return i}}function h(t){function e(e,n,o,r,i,a){var s=o[r];if(null!=s)return t(n,s,r,i||g,a);var u=!e;return u}var n=e.bind(null,!1,!0);return n.weak=e.bind(null,!1,!1),n.isRequired=e.bind(null,!0,!0),n.weak.isRequired=e.bind(null,!0,!1),n.isRequired.weak=n.weak.isRequired,n}var f=t("./ReactComponent"),m=(t("./ReactPropTypeLocationNames"),t("./warning"),t("./createObjectFrom")),v={array:i("array"),bool:i("boolean"),func:i("function"),number:i("number"),object:i("object"),string:i("string"),shape:s,oneOf:a,oneOfType:d,arrayOf:c,instanceOf:u,renderable:l(),component:p(),any:r()},g="<<anonymous>>";e.exports=v},{"./ReactComponent":31,"./ReactPropTypeLocationNames":65,"./createObjectFrom":103,"./warning":144}],68:[function(t,e){"use strict";function n(){this.listenersToPut=[]}var o=t("./PooledClass"),r=t("./ReactEventEmitter"),i=t("./mixInto");i(n,{enqueuePutListener:function(t,e,n){this.listenersToPut.push({rootNodeID:t,propKey:e,propValue:n})},putListeners:function(){for(var t=0;t<this.listenersToPut.length;t++){var e=this.listenersToPut[t];r.putListener(e.rootNodeID,e.propKey,e.propValue)}},reset:function(){this.listenersToPut.length=0},destructor:function(){this.reset()}}),o.addPoolingTo(n),e.exports=n},{"./PooledClass":25,"./ReactEventEmitter":50,"./mixInto":134}],69:[function(t,e){"use strict";function n(){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=a.getPooled(null),this.putListenerQueue=s.getPooled()}var o=t("./PooledClass"),r=t("./ReactEventEmitter"),i=t("./ReactInputSelection"),a=t("./ReactMountReady"),s=t("./ReactPutListenerQueue"),u=t("./Transaction"),c=t("./mixInto"),l={initialize:i.getSelectionInformation,close:i.restoreSelection},p={initialize:function(){var t=r.isEnabled();return r.setEnabled(!1),t},close:function(t){r.setEnabled(t)}},d={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},h={initialize:function(){this.putListenerQueue.reset()},close:function(){this.putListenerQueue.putListeners()}},f=[h,l,p,d],m={getTransactionWrappers:function(){return f},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){a.release(this.reactMountReady),this.reactMountReady=null,s.release(this.putListenerQueue),this.putListenerQueue=null}};c(n,u.Mixin),c(n,m),o.addPoolingTo(n),e.exports=n},{"./PooledClass":25,"./ReactEventEmitter":50,"./ReactInputSelection":54,"./ReactMountReady":59,"./ReactPutListenerQueue":68,"./Transaction":93,"./mixInto":134}],70:[function(t,e){"use strict";var n={injectCreateReactRootIndex:function(t){o.createReactRootIndex=t}},o={createReactRootIndex:null,injection:n};e.exports=o},{}],71:[function(t,e){"use strict";function n(t){c(r.isValidComponent(t)),c(!(2===arguments.length&&"function"==typeof arguments[1]));var e;try{var n=i.createReactRootID();return e=s.getPooled(!1),e.perform(function(){var o=u(t),r=o.mountComponent(n,e,0);return a.addChecksumToMarkup(r)},null)}finally{s.release(e)}}function o(t){c(r.isValidComponent(t));var e;try{var n=i.createReactRootID();return e=s.getPooled(!0),e.perform(function(){var o=u(t);return o.mountComponent(n,e,0)},null)}finally{s.release(e)}}var r=t("./ReactComponent"),i=t("./ReactInstanceHandles"),a=t("./ReactMarkupChecksum"),s=t("./ReactServerRenderingTransaction"),u=t("./instantiateReactComponent"),c=t("./invariant");e.exports={renderComponentToString:n,renderComponentToStaticMarkup:o}},{"./ReactComponent":31,"./ReactInstanceHandles":55,"./ReactMarkupChecksum":57,"./ReactServerRenderingTransaction":72,"./instantiateReactComponent":121,"./invariant":122}],72:[function(t,e){"use strict";function n(t){this.reinitializeTransaction(),this.renderToStaticMarkup=t,this.reactMountReady=r.getPooled(null),this.putListenerQueue=i.getPooled()}var o=t("./PooledClass"),r=t("./ReactMountReady"),i=t("./ReactPutListenerQueue"),a=t("./Transaction"),s=t("./emptyFunction"),u=t("./mixInto"),c={initialize:function(){this.reactMountReady.reset()},close:s},l={initialize:function(){this.putListenerQueue.reset()},close:s},p=[l,c],d={getTransactionWrappers:function(){return p},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){r.release(this.reactMountReady),this.reactMountReady=null,i.release(this.putListenerQueue),this.putListenerQueue=null}};u(n,a.Mixin),u(n,d),o.addPoolingTo(n),e.exports=n},{"./PooledClass":25,"./ReactMountReady":59,"./ReactPutListenerQueue":68,"./Transaction":93,"./emptyFunction":106,"./mixInto":134}],73:[function(t,e){"use strict";function n(t,e){var n={};return function(o){n[e]=o,t.setState(n)}}var o={createStateSetter:function(t,e){return function(n,o,r,i,a,s){var u=e.call(t,n,o,r,i,a,s);u&&t.setState(u)}},createStateKeySetter:function(t,e){var o=t.__keySetters||(t.__keySetters={});return o[e]||(o[e]=n(t,e))}};o.Mixin={createStateSetter:function(t){return o.createStateSetter(this,t)},createStateKeySetter:function(t){return o.createStateKeySetter(this,t)}},e.exports=o},{}],74:[function(t,e){"use strict";var n=t("./DOMPropertyOperations"),o=t("./ReactBrowserComponentMixin"),r=t("./ReactComponent"),i=t("./escapeTextForBrowser"),a=t("./mixInto"),s=function(t){this.construct({text:t})};s.ConvenienceConstructor=function(t){return new s(t.text)},a(s,r.Mixin),a(s,o),a(s,{mountComponent:function(t,e,o){r.Mixin.mountComponent.call(this,t,e,o);var a=i(this.props.text);return e.renderToStaticMarkup?a:"<span "+n.createMarkupForID(t)+">"+a+"</span>"},receiveComponent:function(t){var e=t.props;e.text!==this.props.text&&(this.props.text=e.text,r.BackendIDOperations.updateTextContentByID(this._rootNodeID,e.text))}}),s.type=s,s.prototype.type=s,e.exports=s},{"./DOMPropertyOperations":10,"./ReactBrowserComponentMixin":27,"./ReactComponent":31,"./escapeTextForBrowser":108,"./mixInto":134}],75:[function(t,e){"use strict";var n=t("./ReactChildren"),o={getChildMapping:function(t){return n.map(t,function(t){return t})},mergeChildMappings:function(t,e){function n(n){return e.hasOwnProperty(n)?e[n]:t[n]}t=t||{},e=e||{};var o={},r=[];for(var i in t)e[i]?r.length&&(o[i]=r,r=[]):r.push(i);var a,s={};for(var u in e){if(o[u])for(a=0;a<o[u].length;a++){var c=o[u][a];s[o[u][a]]=n(c)}s[u]=n(u)}for(a=0;a<r.length;a++)s[r[a]]=n(r[a]);return s}};e.exports=o},{"./ReactChildren":30}],76:[function(t,e){"use strict";function n(){var t=document.createElement("div"),e=t.style;for(var n in a){var o=a[n];for(var r in o)if(r in e){s.push(o[r]);break}}}function o(t,e,n){t.addEventListener(e,n,!1)}function r(t,e,n){t.removeEventListener(e,n,!1)}var i=t("./ExecutionEnvironment"),a={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},s=[];i.canUseDOM&&n();var u={addEndEventListener:function(t,e){return 0===s.length?void window.setTimeout(e,0):void s.forEach(function(n){o(t,n,e)})},removeEndEventListener:function(t,e){0!==s.length&&s.forEach(function(n){r(t,n,e)})}};e.exports=u},{"./ExecutionEnvironment":21}],77:[function(t,e){"use strict";var n=t("./React"),o=t("./ReactTransitionChildMapping"),r=t("./cloneWithProps"),i=t("./emptyFunction"),a=t("./merge"),s=n.createClass({propTypes:{component:n.PropTypes.func,childFactory:n.PropTypes.func},getDefaultProps:function(){return{component:n.DOM.span,childFactory:i.thatReturnsArgument}},getInitialState:function(){return{children:o.getChildMapping(this.props.children)}},componentWillReceiveProps:function(t){var e=o.getChildMapping(t.children),n=this.state.children;this.setState({children:o.mergeChildMappings(n,e)});var r;for(r in e)n.hasOwnProperty(r)||this.currentlyTransitioningKeys[r]||this.keysToEnter.push(r);for(r in n)e.hasOwnProperty(r)||this.currentlyTransitioningKeys[r]||this.keysToLeave.push(r)},componentWillMount:function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},componentDidUpdate:function(){var t=this.keysToEnter;this.keysToEnter=[],t.forEach(this.performEnter);var e=this.keysToLeave;this.keysToLeave=[],e.forEach(this.performLeave)},performEnter:function(t){this.currentlyTransitioningKeys[t]=!0;var e=this.refs[t];e.componentWillEnter?e.componentWillEnter(this._handleDoneEntering.bind(this,t)):this._handleDoneEntering(t)},_handleDoneEntering:function(t){var e=this.refs[t];e.componentDidEnter&&e.componentDidEnter(),delete this.currentlyTransitioningKeys[t];var n=o.getChildMapping(this.props.children);n.hasOwnProperty(t)||this.performLeave(t)},performLeave:function(t){this.currentlyTransitioningKeys[t]=!0;var e=this.refs[t];e.componentWillLeave?e.componentWillLeave(this._handleDoneLeaving.bind(this,t)):this._handleDoneLeaving(t)},_handleDoneLeaving:function(t){var e=this.refs[t];e.componentDidLeave&&e.componentDidLeave(),delete this.currentlyTransitioningKeys[t];var n=o.getChildMapping(this.props.children);if(n.hasOwnProperty(t))this.performEnter(t);else{var r=a(this.state.children);delete r[t],this.setState({children:r})}},render:function(){var t={};for(var e in this.state.children){var n=this.state.children[e];n&&(t[e]=r(this.props.childFactory(n),{ref:e}))}return this.transferPropsTo(this.props.component(null,t))}});e.exports=s},{"./React":26,"./ReactTransitionChildMapping":75,"./cloneWithProps":97,"./emptyFunction":106,"./merge":131}],78:[function(t,e){"use strict";function n(){c(p)}function o(t,e){n(),p.batchedUpdates(t,e)}function r(t,e){return t._mountDepth-e._mountDepth}function i(){l.sort(r);for(var t=0;t<l.length;t++){var e=l[t];if(e.isMounted()){var n=e._pendingCallbacks;if(e._pendingCallbacks=null,e.performUpdateIfNecessary(),n)for(var o=0;o<n.length;o++)n[o].call(e)}}}function a(){l.length=0}function s(t,e){return c(!e||"function"==typeof e),n(),p.isBatchingUpdates?(l.push(t),void(e&&(t._pendingCallbacks?t._pendingCallbacks.push(e):t._pendingCallbacks=[e]))):(t.performUpdateIfNecessary(),void(e&&e.call(t)))}var u=t("./ReactPerf"),c=t("./invariant"),l=[],p=null,d=u.measure("ReactUpdates","flushBatchedUpdates",function(){try{i()}finally{a()}}),h={injectBatchingStrategy:function(t){c(t),c("function"==typeof t.batchedUpdates),c("boolean"==typeof t.isBatchingUpdates),p=t}},f={batchedUpdates:o,enqueueUpdate:s,flushBatchedUpdates:d,injection:h};e.exports=f},{"./ReactPerf":63,"./invariant":122}],79:[function(t,e){"use strict";var n=t("./LinkedStateMixin"),o=t("./React"),r=t("./ReactCSSTransitionGroup"),i=t("./ReactTransitionGroup"),r=t("./ReactCSSTransitionGroup"),a=t("./cx"),s=t("./cloneWithProps"),u=t("./update");o.addons={LinkedStateMixin:n,CSSTransitionGroup:r,TransitionGroup:i,classSet:a,cloneWithProps:s,update:u},e.exports=o},{"./LinkedStateMixin":22,"./React":26,"./ReactCSSTransitionGroup":28,"./ReactTransitionGroup":77,"./cloneWithProps":97,"./cx":104,"./update":143}],80:[function(t,e){"use strict";function n(t){if("selectionStart"in t&&a.hasSelectionCapabilities(t))return{start:t.selectionStart,end:t.selectionEnd};if(document.selection){var e=document.selection.createRange();return{parentElement:e.parentElement(),text:e.text,top:e.boundingTop,left:e.boundingLeft}}var n=window.getSelection();return{anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}}function o(t){if(!g&&null!=f&&f==u()){var e=n(f);if(!v||!p(v,e)){v=e;var o=s.getPooled(h.select,m,t);return o.type="select",o.target=f,i.accumulateTwoPhaseDispatches(o),o}}}var r=t("./EventConstants"),i=t("./EventPropagators"),a=t("./ReactInputSelection"),s=t("./SyntheticEvent"),u=t("./getActiveElement"),c=t("./isTextInputElement"),l=t("./keyOf"),p=t("./shallowEqual"),d=r.topLevelTypes,h={select:{phasedRegistrationNames:{bubbled:l({onSelect:null}),captured:l({onSelectCapture:null})},dependencies:[d.topBlur,d.topContextMenu,d.topFocus,d.topKeyDown,d.topMouseDown,d.topMouseUp,d.topSelectionChange]}},f=null,m=null,v=null,g=!1,y={eventTypes:h,extractEvents:function(t,e,n,r){switch(t){case d.topFocus:(c(e)||"true"===e.contentEditable)&&(f=e,m=n,v=null);break;case d.topBlur:f=null,m=null,v=null;break;case d.topMouseDown:g=!0;break;case d.topContextMenu:case d.topMouseUp:return g=!1,o(r);case d.topSelectionChange:case d.topKeyDown:case d.topKeyUp:return o(r)}}};e.exports=y},{"./EventConstants":15,"./EventPropagators":20,"./ReactInputSelection":54,"./SyntheticEvent":86,"./getActiveElement":112,"./isTextInputElement":125,"./keyOf":129,"./shallowEqual":139}],81:[function(t,e){"use strict";var n=Math.pow(2,53),o={createReactRootIndex:function(){return Math.ceil(Math.random()*n)}};e.exports=o},{}],82:[function(t,e){"use strict";var n=t("./EventConstants"),o=t("./EventPluginUtils"),r=t("./EventPropagators"),i=t("./SyntheticClipboardEvent"),a=t("./SyntheticEvent"),s=t("./SyntheticFocusEvent"),u=t("./SyntheticKeyboardEvent"),c=t("./SyntheticMouseEvent"),l=t("./SyntheticDragEvent"),p=t("./SyntheticTouchEvent"),d=t("./SyntheticUIEvent"),h=t("./SyntheticWheelEvent"),f=t("./invariant"),m=t("./keyOf"),v=n.topLevelTypes,g={blur:{phasedRegistrationNames:{bubbled:m({onBlur:!0}),captured:m({onBlurCapture:!0})}},click:{phasedRegistrationNames:{bubbled:m({onClick:!0}),captured:m({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:m({onContextMenu:!0}),captured:m({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:m({onCopy:!0}),captured:m({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:m({onCut:!0}),captured:m({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:m({onDoubleClick:!0}),captured:m({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:m({onDrag:!0}),captured:m({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:m({onDragEnd:!0}),captured:m({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:m({onDragEnter:!0}),captured:m({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:m({onDragExit:!0}),captured:m({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:m({onDragLeave:!0}),captured:m({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:m({onDragOver:!0}),captured:m({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:m({onDragStart:!0}),captured:m({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:m({onDrop:!0}),captured:m({onDropCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:m({onFocus:!0}),captured:m({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:m({onInput:!0}),captured:m({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:m({onKeyDown:!0}),captured:m({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:m({onKeyPress:!0}),captured:m({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:m({onKeyUp:!0}),captured:m({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:m({onLoad:!0}),captured:m({onLoadCapture:!0})}},error:{phasedRegistrationNames:{bubbled:m({onError:!0}),captured:m({onErrorCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:m({onMouseDown:!0}),captured:m({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:m({onMouseMove:!0}),captured:m({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:m({onMouseOut:!0}),captured:m({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:m({onMouseOver:!0}),captured:m({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:m({onMouseUp:!0}),captured:m({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:m({onPaste:!0}),captured:m({onPasteCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:m({onReset:!0}),captured:m({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:m({onScroll:!0}),captured:m({onScrollCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:m({onSubmit:!0}),captured:m({onSubmitCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:m({onTouchCancel:!0}),captured:m({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:m({onTouchEnd:!0}),captured:m({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:m({onTouchMove:!0}),captured:m({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:m({onTouchStart:!0}),captured:m({onTouchStartCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:m({onWheel:!0}),captured:m({onWheelCapture:!0})}}},y={topBlur:g.blur,topClick:g.click,topContextMenu:g.contextMenu,topCopy:g.copy,topCut:g.cut,topDoubleClick:g.doubleClick,topDrag:g.drag,topDragEnd:g.dragEnd,topDragEnter:g.dragEnter,topDragExit:g.dragExit,topDragLeave:g.dragLeave,topDragOver:g.dragOver,topDragStart:g.dragStart,topDrop:g.drop,topError:g.error,topFocus:g.focus,topInput:g.input,topKeyDown:g.keyDown,topKeyPress:g.keyPress,topKeyUp:g.keyUp,topLoad:g.load,topMouseDown:g.mouseDown,topMouseMove:g.mouseMove,topMouseOut:g.mouseOut,topMouseOver:g.mouseOver,topMouseUp:g.mouseUp,topPaste:g.paste,topReset:g.reset,topScroll:g.scroll,topSubmit:g.submit,topTouchCancel:g.touchCancel,topTouchEnd:g.touchEnd,topTouchMove:g.touchMove,topTouchStart:g.touchStart,topWheel:g.wheel};for(var C in y)y[C].dependencies=[C];var E={eventTypes:g,executeDispatch:function(t,e,n){var r=o.executeDispatch(t,e,n);r===!1&&(t.stopPropagation(),t.preventDefault())},extractEvents:function(t,e,n,o){var m=y[t];if(!m)return null;var g;switch(t){case v.topInput:case v.topLoad:case v.topError:case v.topReset:case v.topSubmit:g=a;break;case v.topKeyDown:case v.topKeyPress:case v.topKeyUp:g=u;break;case v.topBlur:case v.topFocus:g=s;break;case v.topClick:if(2===o.button)return null;case v.topContextMenu:case v.topDoubleClick:case v.topMouseDown:case v.topMouseMove:case v.topMouseOut:case v.topMouseOver:case v.topMouseUp:g=c;break;case v.topDrag:case v.topDragEnd:case v.topDragEnter:case v.topDragExit:case v.topDragLeave:case v.topDragOver:case v.topDragStart:case v.topDrop:g=l;break;case v.topTouchCancel:case v.topTouchEnd:case v.topTouchMove:case v.topTouchStart:g=p;break;case v.topScroll:g=d;break;case v.topWheel:g=h;break;case v.topCopy:case v.topCut:case v.topPaste:g=i}f(g);var C=g.getPooled(m,n,o);return r.accumulateTwoPhaseDispatches(C),C}};e.exports=E},{"./EventConstants":15,"./EventPluginUtils":19,"./EventPropagators":20,"./SyntheticClipboardEvent":83,"./SyntheticDragEvent":85,"./SyntheticEvent":86,"./SyntheticFocusEvent":87,"./SyntheticKeyboardEvent":88,"./SyntheticMouseEvent":89,"./SyntheticTouchEvent":90,"./SyntheticUIEvent":91,"./SyntheticWheelEvent":92,"./invariant":122,"./keyOf":129}],83:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticEvent"),r={clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}};o.augmentClass(n,r),e.exports=n},{"./SyntheticEvent":86}],84:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticEvent"),r={data:null};o.augmentClass(n,r),e.exports=n},{"./SyntheticEvent":86}],85:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticMouseEvent"),r={dataTransfer:null};o.augmentClass(n,r),e.exports=n},{"./SyntheticMouseEvent":89}],86:[function(t,e){"use strict";function n(t,e,n){this.dispatchConfig=t,this.dispatchMarker=e,this.nativeEvent=n;var o=this.constructor.Interface;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];this[i]=a?a(n):n[i]}var s=null!=n.defaultPrevented?n.defaultPrevented:n.returnValue===!1;this.isDefaultPrevented=s?r.thatReturnsTrue:r.thatReturnsFalse,this.isPropagationStopped=r.thatReturnsFalse}var o=t("./PooledClass"),r=t("./emptyFunction"),i=t("./getEventTarget"),a=t("./merge"),s=t("./mergeInto"),u={type:null,target:i,currentTarget:r.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};s(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t.preventDefault?t.preventDefault():t.returnValue=!1,this.isDefaultPrevented=r.thatReturnsTrue},stopPropagation:function(){var t=this.nativeEvent;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,this.isPropagationStopped=r.thatReturnsTrue},persist:function(){this.isPersistent=r.thatReturnsTrue},isPersistent:r.thatReturnsFalse,destructor:function(){var t=this.constructor.Interface;for(var e in t)this[e]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),n.Interface=u,n.augmentClass=function(t,e){var n=this,r=Object.create(n.prototype);s(r,t.prototype),t.prototype=r,t.prototype.constructor=t,t.Interface=a(n.Interface,e),t.augmentClass=n.augmentClass,o.addPoolingTo(t,o.threeArgumentPooler)},o.addPoolingTo(n,o.threeArgumentPooler),e.exports=n},{"./PooledClass":25,"./emptyFunction":106,"./getEventTarget":114,"./merge":131,"./mergeInto":133}],87:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticUIEvent"),r={relatedTarget:null};o.augmentClass(n,r),e.exports=n},{"./SyntheticUIEvent":91}],88:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticUIEvent"),r=t("./getEventKey"),i={key:r,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,"char":null,charCode:null,keyCode:null,which:null};o.augmentClass(n,i),e.exports=n},{"./SyntheticUIEvent":91,"./getEventKey":113}],89:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticUIEvent"),r=t("./ViewportMetrics"),i={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,button:function(t){var e=t.button;return"which"in t?e:2===e?2:4===e?1:0},buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},pageX:function(t){return"pageX"in t?t.pageX:t.clientX+r.currentScrollLeft},pageY:function(t){return"pageY"in t?t.pageY:t.clientY+r.currentScrollTop}};o.augmentClass(n,i),e.exports=n},{"./SyntheticUIEvent":91,"./ViewportMetrics":94}],90:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticUIEvent"),r={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null};o.augmentClass(n,r),e.exports=n},{"./SyntheticUIEvent":91}],91:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticEvent"),r={view:null,detail:null};o.augmentClass(n,r),e.exports=n},{"./SyntheticEvent":86}],92:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticMouseEvent"),r={deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null};o.augmentClass(n,r),e.exports=n},{"./SyntheticMouseEvent":89}],93:[function(t,e){"use strict";var n=t("./invariant"),o={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this.timingMetrics||(this.timingMetrics={}),this.timingMetrics.methodInvocationTime=0,this.timingMetrics.wrapperInitTimes?this.timingMetrics.wrapperInitTimes.length=0:this.timingMetrics.wrapperInitTimes=[],this.timingMetrics.wrapperCloseTimes?this.timingMetrics.wrapperCloseTimes.length=0:this.timingMetrics.wrapperCloseTimes=[],this._isInTransaction=!1
},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(t,e,o,r,i,a,s,u){n(!this.isInTransaction());var c,l,p=Date.now();try{this._isInTransaction=!0,c=!0,this.initializeAll(0),l=t.call(e,o,r,i,a,s,u),c=!1}finally{var d=Date.now();this.methodInvocationTime+=d-p;try{if(c)try{this.closeAll(0)}catch(h){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return l},initializeAll:function(t){for(var e=this.transactionWrappers,n=this.timingMetrics.wrapperInitTimes,o=t;o<e.length;o++){var i=Date.now(),a=e[o];try{this.wrapperInitData[o]=r.OBSERVED_ERROR,this.wrapperInitData[o]=a.initialize?a.initialize.call(this):null}finally{var s=n[o],u=Date.now();if(n[o]=(s||0)+(u-i),this.wrapperInitData[o]===r.OBSERVED_ERROR)try{this.initializeAll(o+1)}catch(c){}}}},closeAll:function(t){n(this.isInTransaction());for(var e=this.transactionWrappers,o=this.timingMetrics.wrapperCloseTimes,i=t;i<e.length;i++){var a,s=e[i],u=Date.now(),c=this.wrapperInitData[i];try{a=!0,c!==r.OBSERVED_ERROR&&s.close&&s.close.call(this,c),a=!1}finally{var l=Date.now(),p=o[i];if(o[i]=(p||0)+(l-u),a)try{this.closeAll(i+1)}catch(d){}}}this.wrapperInitData.length=0}},r={Mixin:o,OBSERVED_ERROR:{}};e.exports=r},{"./invariant":122}],94:[function(t,e){"use strict";var n=t("./getUnboundedScrollPosition"),o={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(){var t=n(window);o.currentScrollLeft=t.x,o.currentScrollTop=t.y}};e.exports=o},{"./getUnboundedScrollPosition":119}],95:[function(t,e){"use strict";function n(t,e){if(o(null!=e),null==t)return e;var n=Array.isArray(t),r=Array.isArray(e);return n?t.concat(e):r?[t].concat(e):[t,e]}var o=t("./invariant");e.exports=n},{"./invariant":122}],96:[function(t,e){"use strict";function n(t){for(var e=1,n=0,r=0;r<t.length;r++)e=(e+t.charCodeAt(r))%o,n=(n+e)%o;return e|n<<16}var o=65521;e.exports=n},{}],97:[function(t,e){"use strict";function n(t,e){var n=o.mergeProps(e,t.props);return!n.hasOwnProperty(i)&&t.props.hasOwnProperty(i)&&(n.children=t.props.children),t.constructor.ConvenienceConstructor(n)}var o=t("./ReactPropTransferer"),r=t("./keyOf"),i=(t("./warning"),r({children:null}));e.exports=n},{"./ReactPropTransferer":64,"./keyOf":129,"./warning":144}],98:[function(t,e){function n(t,e){return t&&e?t===e?!0:o(t)?!1:o(e)?n(t,e.parentNode):t.contains?t.contains(e):t.compareDocumentPosition?!!(16&t.compareDocumentPosition(e)):!1:!1}var o=t("./isTextNode");e.exports=n},{"./isTextNode":126}],99:[function(t,e){function n(t,e,n,o,r,i){t=t||{};for(var a,s=[e,n,o,r,i],u=0;s[u];){a=s[u++];for(var c in a)t[c]=a[c];a.hasOwnProperty&&a.hasOwnProperty("toString")&&"undefined"!=typeof a.toString&&t.toString!==a.toString&&(t.toString=a.toString)}return t}e.exports=n},{}],100:[function(t,e){function n(t){return!!t&&("object"==typeof t||"function"==typeof t)&&"length"in t&&!("setInterval"in t)&&"number"!=typeof t.nodeType&&(Array.isArray(t)||"callee"in t||"item"in t)}function o(t){return n(t)?Array.isArray(t)?t.slice():r(t):[t]}var r=t("./toArray");e.exports=o},{"./toArray":141}],101:[function(t,e){"use strict";function n(t){var e=o.createClass({displayName:"ReactFullPageComponent"+(t.componentConstructor.displayName||""),componentWillUnmount:function(){r(!1)},render:function(){return this.transferPropsTo(t(null,this.props.children))}});return e}var o=t("./ReactCompositeComponent"),r=t("./invariant");e.exports=n},{"./ReactCompositeComponent":33,"./invariant":122}],102:[function(t,e){function n(t){var e=t.match(c);return e&&e[1].toLowerCase()}function o(t,e){var o=u;s(!!u);var r=n(t),c=r&&a(r);if(c){o.innerHTML=c[1]+t+c[2];for(var l=c[0];l--;)o=o.lastChild}else o.innerHTML=t;var p=o.getElementsByTagName("script");p.length&&(s(e),i(p).forEach(e));for(var d=i(o.childNodes);o.lastChild;)o.removeChild(o.lastChild);return d}var r=t("./ExecutionEnvironment"),i=t("./createArrayFrom"),a=t("./getMarkupWrap"),s=t("./invariant"),u=r.canUseDOM?document.createElement("div"):null,c=/^\s*<(\w+)/;e.exports=o},{"./ExecutionEnvironment":21,"./createArrayFrom":100,"./getMarkupWrap":115,"./invariant":122}],103:[function(t,e){function n(t,e){var n={},o=Array.isArray(e);"undefined"==typeof e&&(e=!0);for(var r=t.length;r--;)n[t[r]]=o?e[r]:e;return n}e.exports=n},{}],104:[function(t,e){function n(t){return"object"==typeof t?Object.keys(t).filter(function(e){return t[e]}).join(" "):Array.prototype.join.call(arguments," ")}e.exports=n},{}],105:[function(t,e){"use strict";function n(t,e){var n=null==e||"boolean"==typeof e||""===e;if(n)return"";var r=isNaN(e);return r||0===e||o.isUnitlessNumber[t]?""+e:e+"px"}var o=t("./CSSProperty");e.exports=n},{"./CSSProperty":3}],106:[function(t,e){function n(t){return function(){return t}}function o(){}var r=t("./copyProperties");r(o,{thatReturns:n,thatReturnsFalse:n(!1),thatReturnsTrue:n(!0),thatReturnsNull:n(null),thatReturnsThis:function(){return this},thatReturnsArgument:function(t){return t}}),e.exports=o},{"./copyProperties":99}],107:[function(t,e){"use strict";var n={};e.exports=n},{}],108:[function(t,e){"use strict";function n(t){return r[t]}function o(t){return(""+t).replace(i,n)}var r={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},i=/[&><"'\/]/g;e.exports=o},{}],109:[function(t,e){"use strict";function n(t,e,n){var o=t;r(!o.hasOwnProperty(n)),null!=e&&(o[n]=e)}function o(t){if(null==t)return t;var e={};return i(t,n,e),e}var r=t("./invariant"),i=t("./traverseAllChildren");e.exports=o},{"./invariant":122,"./traverseAllChildren":142}],110:[function(t,e){"use strict";function n(t){t.disabled||t.focus()}e.exports=n},{}],111:[function(t,e){"use strict";var n=function(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)};e.exports=n},{}],112:[function(t,e){function n(){try{return document.activeElement||document.body}catch(t){return document.body}}e.exports=n},{}],113:[function(t,e){"use strict";function n(t){return"key"in t?o[t.key]||t.key:r[t.which||t.keyCode]||"Unidentified"}var o={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},r={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};e.exports=n},{}],114:[function(t,e){"use strict";function n(t){var e=t.target||t.srcElement||window;return 3===e.nodeType?e.parentNode:e}e.exports=n},{}],115:[function(t,e){function n(t){return r(!!i),p.hasOwnProperty(t)||(t="*"),a.hasOwnProperty(t)||(i.innerHTML="*"===t?"<link />":"<"+t+"></"+t+">",a[t]=!i.firstChild),a[t]?p[t]:null}var o=t("./ExecutionEnvironment"),r=t("./invariant"),i=o.canUseDOM?document.createElement("div"):null,a={circle:!0,defs:!0,g:!0,line:!0,linearGradient:!0,path:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,text:!0},s=[1,'<select multiple="true">',"</select>"],u=[1,"<table>","</table>"],c=[3,"<table><tbody><tr>","</tr></tbody></table>"],l=[1,"<svg>","</svg>"],p={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:s,option:s,caption:u,colgroup:u,tbody:u,tfoot:u,thead:u,td:c,th:c,circle:l,defs:l,g:l,line:l,linearGradient:l,path:l,polygon:l,polyline:l,radialGradient:l,rect:l,stop:l,text:l};e.exports=n},{"./ExecutionEnvironment":21,"./invariant":122}],116:[function(t,e){"use strict";function n(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function o(t){for(;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}}function r(t,e){for(var r=n(t),i=0,a=0;r;){if(3==r.nodeType){if(a=i+r.textContent.length,e>=i&&a>=e)return{node:r,offset:e-i};i=a}r=n(o(r))}}e.exports=r},{}],117:[function(t,e){"use strict";function n(t){return t?t.nodeType===o?t.documentElement:t.firstChild:null}var o=9;e.exports=n},{}],118:[function(t,e){"use strict";function n(){return!r&&o.canUseDOM&&(r="textContent"in document.createElement("div")?"textContent":"innerText"),r}var o=t("./ExecutionEnvironment"),r=null;e.exports=n},{"./ExecutionEnvironment":21}],119:[function(t,e){"use strict";function n(t){return t===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:t.scrollLeft,y:t.scrollTop}}e.exports=n},{}],120:[function(t,e){function n(t){return t.replace(o,"-$1").toLowerCase()}var o=/([A-Z])/g;e.exports=n},{}],121:[function(t,e){"use strict";function n(t){return t._descriptor=t,t}t("./warning");e.exports=n},{"./warning":144}],122:[function(t,e){"use strict";var n=function(t){if(!t){var e=new Error("Minified exception occured; use the non-minified dev environment for the full error message and additional helpful warnings.");throw e.framesToPop=1,e}};e.exports=n},{}],123:[function(t,e){"use strict";function n(t,e){if(!r.canUseDOM||e&&!("addEventListener"in document))return!1;var n="on"+t,i=n in document;if(!i){var a=document.createElement("div");a.setAttribute(n,"return;"),i="function"==typeof a[n]}return!i&&o&&"wheel"===t&&(i=document.implementation.hasFeature("Events.wheel","3.0")),i}var o,r=t("./ExecutionEnvironment");r.canUseDOM&&(o=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0),e.exports=n},{"./ExecutionEnvironment":21}],124:[function(t,e){function n(t){return!(!t||!("function"==typeof Node?t instanceof Node:"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName))}e.exports=n},{}],125:[function(t,e){"use strict";function n(t){return t&&("INPUT"===t.nodeName&&o[t.type]||"TEXTAREA"===t.nodeName)}var o={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};e.exports=n},{}],126:[function(t,e){function n(t){return o(t)&&3==t.nodeType}var o=t("./isNode");e.exports=n},{"./isNode":124}],127:[function(t,e){"use strict";function n(t){t||(t="");var e,n=arguments.length;if(n>1)for(var o=1;n>o;o++)e=arguments[o],e&&(t+=" "+e);return t}e.exports=n},{}],128:[function(t,e){"use strict";var n=t("./invariant"),o=function(t){var e,o={};n(t instanceof Object&&!Array.isArray(t));for(e in t)t.hasOwnProperty(e)&&(o[e]=e);return o};e.exports=o},{"./invariant":122}],129:[function(t,e){var n=function(t){var e;for(e in t)if(t.hasOwnProperty(e))return e;return null};e.exports=n},{}],130:[function(t,e){"use strict";function n(t){var e={};return function(n){return e.hasOwnProperty(n)?e[n]:e[n]=t.call(this,n)}}e.exports=n},{}],131:[function(t,e){"use strict";var n=t("./mergeInto"),o=function(t,e){var o={};return n(o,t),n(o,e),o};e.exports=o},{"./mergeInto":133}],132:[function(t,e){"use strict";var n=t("./invariant"),o=t("./keyMirror"),r=36,i=function(t){return"object"!=typeof t||null===t},a={MAX_MERGE_DEPTH:r,isTerminal:i,normalizeMergeArg:function(t){return void 0===t||null===t?{}:t},checkMergeArrayArgs:function(t,e){n(Array.isArray(t)&&Array.isArray(e))},checkMergeObjectArgs:function(t,e){a.checkMergeObjectArg(t),a.checkMergeObjectArg(e)},checkMergeObjectArg:function(t){n(!i(t)&&!Array.isArray(t))},checkMergeLevel:function(t){n(r>t)},checkArrayStrategy:function(t){n(void 0===t||t in a.ArrayStrategies)},ArrayStrategies:o({Clobber:!0,IndexByIndex:!0})};e.exports=a},{"./invariant":122,"./keyMirror":128}],133:[function(t,e){"use strict";function n(t,e){if(r(t),null!=e){r(e);for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}var o=t("./mergeHelpers"),r=o.checkMergeObjectArg;e.exports=n},{"./mergeHelpers":132}],134:[function(t,e){"use strict";var n=function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&(t.prototype[n]=e[n])};e.exports=n},{}],135:[function(t,e){"use strict";function n(t){o(t&&!/[^a-z0-9_]/.test(t))}var o=t("./invariant");e.exports=n},{"./invariant":122}],136:[function(t,e){"use strict";function n(t,e,n){if(!t)return null;var o=0,r={};for(var i in t)t.hasOwnProperty(i)&&(r[i]=e.call(n,t[i],i,o++));return r}e.exports=n},{}],137:[function(t,e){"use strict";function n(t,e,n){if(!t)return null;var o=0,r={};for(var i in t)t.hasOwnProperty(i)&&(r[i]=e.call(n,i,t[i],o++));return r}e.exports=n},{}],138:[function(t,e){"use strict";function n(t){return r(o.isValidComponent(t)),t}var o=t("./ReactComponent"),r=t("./invariant");e.exports=n},{"./ReactComponent":31,"./invariant":122}],139:[function(t,e){"use strict";function n(t,e){if(t===e)return!0;var n;for(n in t)if(t.hasOwnProperty(n)&&(!e.hasOwnProperty(n)||t[n]!==e[n]))return!1;for(n in e)if(e.hasOwnProperty(n)&&!t.hasOwnProperty(n))return!1;return!0}e.exports=n},{}],140:[function(t,e){"use strict";function n(t,e){return t&&e&&t.constructor===e.constructor&&(t.props&&t.props.key)===(e.props&&e.props.key)&&t._owner===e._owner?!0:!1}e.exports=n},{}],141:[function(t,e){function n(t){var e=t.length;if(o(!Array.isArray(t)&&("object"==typeof t||"function"==typeof t)),o("number"==typeof e),o(0===e||e-1 in t),t.hasOwnProperty)try{return Array.prototype.slice.call(t)}catch(n){}for(var r=Array(e),i=0;e>i;i++)r[i]=t[i];return r}var o=t("./invariant");e.exports=n},{"./invariant":122}],142:[function(t,e){"use strict";function n(t){return d[t]}function o(t,e){return t&&t.props&&null!=t.props.key?i(t.props.key):e.toString(36)}function r(t){return(""+t).replace(h,n)}function i(t){return"$"+r(t)}function a(t,e,n){null!==t&&void 0!==t&&f(t,"",0,e,n)}var s=t("./ReactInstanceHandles"),u=t("./ReactTextComponent"),c=t("./invariant"),l=s.SEPARATOR,p=":",d={"=":"=0",".":"=1",":":"=2"},h=/[=.:]/g,f=function(t,e,n,r,a){var s=0;if(Array.isArray(t))for(var d=0;d<t.length;d++){var h=t[d],m=e+(e?p:l)+o(h,d),v=n+s;s+=f(h,m,v,r,a)}else{var g=typeof t,y=""===e,C=y?l+o(t,0):e;if(null==t||"boolean"===g)r(a,null,C,n),s=1;else if(t.type&&t.type.prototype&&t.type.prototype.mountComponentIntoNode)r(a,t,C,n),s=1;else if("object"===g){c(!t||1!==t.nodeType);for(var E in t)t.hasOwnProperty(E)&&(s+=f(t[E],e+(e?p:l)+i(E)+p+o(t[E],0),n+s,r,a))}else if("string"===g){var R=new u(t);r(a,R,C,n),s+=1}else if("number"===g){var M=new u(""+t);r(a,M,C,n),s+=1}}return s};e.exports=a},{"./ReactInstanceHandles":55,"./ReactTextComponent":74,"./invariant":122}],143:[function(t,e){"use strict";function n(t){return Array.isArray(t)?t.concat():t&&"object"==typeof t?i(new t.constructor,t):t}function o(t,e,n){s(Array.isArray(t));var o=e[n];s(Array.isArray(o))}function r(t,e){if(s("object"==typeof e),e.hasOwnProperty(p))return s(1===Object.keys(e).length),e[p];var a=n(t);if(e.hasOwnProperty(d)){var h=e[d];s(h&&"object"==typeof h),s(a&&"object"==typeof a),i(a,e[d])}e.hasOwnProperty(u)&&(o(t,e,u),e[u].forEach(function(t){a.push(t)})),e.hasOwnProperty(c)&&(o(t,e,c),e[c].forEach(function(t){a.unshift(t)})),e.hasOwnProperty(l)&&(s(Array.isArray(t)),s(Array.isArray(e[l])),e[l].forEach(function(t){s(Array.isArray(t)),a.splice.apply(a,t)}));for(var m in e)f[m]||(a[m]=r(t[m],e[m]));return a}var i=t("./copyProperties"),a=t("./keyOf"),s=t("./invariant"),u=a({$push:null}),c=a({$unshift:null}),l=a({$splice:null}),p=a({$set:null}),d=a({$merge:null}),h=[u,c,l,p,d],f={};h.forEach(function(t){f[t]=!0}),e.exports=r},{"./copyProperties":99,"./invariant":122,"./keyOf":129}],144:[function(t,e){"use strict";var n=t("./emptyFunction"),o=n;e.exports=o},{"./emptyFunction":106}]},{},[79])(79)});!function(t,e){function n(t,e,n){var r=t.children(),o=!1;t.empty();for(var i=0,d=r.length;d>i;i++){var l=r.eq(i);if(t.append(l),n&&t.append(n),a(t,e)){l.remove(),o=!0;break}n&&n.detach()}return o}function r(e,n,i,d,l){var s=!1,c="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",u="script";return e.contents().detach().each(function(){var f=this,h=t(f);if("undefined"==typeof f||3==f.nodeType&&0==t.trim(f.data).length)return!0;if(h.is(u))e.append(h);else{if(s)return!0;e.append(h),l&&e[e.is(c)?"after":"append"](l),a(i,d)&&(s=3==f.nodeType?o(h,n,i,d,l):r(h,n,i,d,l),s||(h.detach(),s=!0)),s||l&&l.detach()}}),s}function o(e,n,r,o,d){var c=e[0];if(!c)return!1;var f=s(c),h=-1!==f.indexOf(" ")?" ":"　",p="letter"==o.wrap?"":h,g=f.split(p),v=-1,w=-1,b=0,y=g.length-1;for(o.fallbackToLetter&&0==b&&0==y&&(p="",g=f.split(p),y=g.length-1);y>=b&&(0!=b||0!=y);){var m=Math.floor((b+y)/2);if(m==w)break;w=m,l(c,g.slice(0,w+1).join(p)+o.ellipsis),a(r,o)?(y=w,o.fallbackToLetter&&0==b&&0==y&&(p="",g=g[0].split(p),v=-1,w=-1,b=0,y=g.length-1)):(v=w,b=w)}if(-1==v||1==g.length&&0==g[0].length){var x=e.parent();e.detach();var T=d&&d.closest(x).length?d.length:0;x.contents().length>T?c=u(x.contents().eq(-1-T),n):(c=u(x,n,!0),T||x.detach()),c&&(f=i(s(c),o),l(c,f),T&&d&&t(c).parent().append(d))}else f=i(g.slice(0,v+1).join(p),o),l(c,f);return!0}function a(t,e){return t.innerHeight()>e.maxHeight}function i(e,n){for(;t.inArray(e.slice(-1),n.lastCharacter.remove)>-1;)e=e.slice(0,-1);return t.inArray(e.slice(-1),n.lastCharacter.noEllipsis)<0&&(e+=n.ellipsis),e}function d(t){return{width:t.innerWidth(),height:t.innerHeight()}}function l(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function s(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function c(t){do t=t.previousSibling;while(t&&1!==t.nodeType&&3!==t.nodeType);return t}function u(e,n,r){var o,a=e&&e[0];if(a){if(!r){if(3===a.nodeType)return a;if(t.trim(e.text()))return u(e.contents().last(),n)}for(o=c(a);!o;){if(e=e.parent(),e.is(n)||!e.length)return!1;o=c(e[0])}if(o)return u(t(o),n)}return!1}function f(e,n){return e?"string"==typeof e?(e=t(e,n),e.length?e:!1):e.jquery?e:!1:!1}function h(t){for(var e=t.innerHeight(),n=["paddingTop","paddingBottom"],r=0,o=n.length;o>r;r++){var a=parseInt(t.css(n[r]),10);isNaN(a)&&(a=0),e-=a}return e}if(!t.fn.dotdotdot){t.fn.dotdotdot=function(e){if(0==this.length)return t.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){t(this).dotdotdot(e)});var o=this;o.data("dotdotdot")&&o.trigger("destroy.dot"),o.data("dotdotdot-style",o.attr("style")||""),o.css("word-wrap","break-word"),"nowrap"===o.css("white-space")&&o.css("white-space","normal"),o.bind_events=function(){return o.bind("update.dot",function(e,d){e.preventDefault(),e.stopPropagation(),l.maxHeight="number"==typeof l.height?l.height:h(o),l.maxHeight+=l.tolerance,"undefined"!=typeof d&&(("string"==typeof d||d instanceof HTMLElement)&&(d=t("<div />").append(d).contents()),d instanceof t&&(i=d)),g=o.wrapInner('<div class="dotdotdot" />').children(),g.contents().detach().end().append(i.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var c=!1,u=!1;return s.afterElement&&(c=s.afterElement.clone(!0),c.show(),s.afterElement.detach()),a(g,l)&&(u="children"==l.wrap?n(g,l,c):r(g,o,g,l,c)),g.replaceWith(g.contents()),g=null,t.isFunction(l.callback)&&l.callback.call(o[0],u,i),s.isTruncated=u,u}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(o[0],s.isTruncated),s.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(o[0],i),i}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),o.unwatch().unbind_events().contents().detach().end().append(i).attr("style",o.data("dotdotdot-style")||"").data("dotdotdot",!1)}),o},o.unbind_events=function(){return o.unbind(".dot"),o},o.watch=function(){if(o.unwatch(),"window"==l.watch){var e=t(window),n=e.width(),r=e.height();e.bind("resize.dot"+s.dotId,function(){n==e.width()&&r==e.height()&&l.windowResizeFix||(n=e.width(),r=e.height(),u&&clearInterval(u),u=setTimeout(function(){o.trigger("update.dot")},100))})}else c=d(o),u=setInterval(function(){if(o.is(":visible")){var t=d(o);(c.width!=t.width||c.height!=t.height)&&(o.trigger("update.dot"),c=t)}},500);return o},o.unwatch=function(){return t(window).unbind("resize.dot"+s.dotId),u&&clearInterval(u),o};var i=o.contents(),l=t.extend(!0,{},t.fn.dotdotdot.defaults,e),s={},c={},u=null,g=null;return l.lastCharacter.remove instanceof Array||(l.lastCharacter.remove=t.fn.dotdotdot.defaultArrays.lastCharacter.remove),l.lastCharacter.noEllipsis instanceof Array||(l.lastCharacter.noEllipsis=t.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),s.afterElement=f(l.after,o),s.isTruncated=!1,s.dotId=p++,o.data("dotdotdot",!0).bind_events().trigger("update.dot"),l.watch&&o.watch(),o},t.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0},t.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}},t.fn.dotdotdot.debug=function(){};var p=1,g=t.fn.html;t.fn.html=function(n){return n!=e&&!t.isFunction(n)&&this.data("dotdotdot")?this.trigger("update",[n]):g.apply(this,arguments)};var v=t.fn.text;t.fn.text=function(n){return n!=e&&!t.isFunction(n)&&this.data("dotdotdot")?(n=t("<div />").text(n).html(),this.trigger("update",[n])):v.apply(this,arguments)}}}(jQuery);var no={};no.de=typeof window==="undefined";no.inherit=function(ctor,base,mixin){var F=function(){};F.prototype=base.prototype;var proto=ctor.prototype=new F;if(mixin){if(Array.isArray(mixin)){for(var i=0,l=mixin.length;i<l;i++){no.extend(proto,mixin[i])}}else{no.extend(proto,mixin)}}proto.super_=base.prototype;proto.constructor=ctor;return ctor};no.extend=function(dest){for(var i=1,l=arguments.length;i<l;i++){var src=arguments[i];for(var key in src){dest[key]=src[key]}}return dest};no.nop=function(){};no.true=function(){return true};no.false=function(){return false};no.value=function(value){return function(){return value}};no.logger=function(msg){if(msg){return function(){var args=[].slice.call(arguments);console.log.apply(null,[msg].concat(args))}}return console.log};if(no.de){no.next=function(callback){process.nextTick(callback)}}else{no.next=function(callback){setTimeout(callback,0)}}if(no.de){module.exports=no}var no=no||require("./no.base.js");if(no.de){module.exports=no}no.Events={};no.Events.on=function(name,handler){var handlers=this._noevents_handlers||(this._noevents_handlers={});(handlers[name]||(handlers[name]=[])).push(handler);return this};no.Events.off=function(name,handler){if(handler){var handlers=this._noevents_handlers&&this._noevents_handlers[name];if(handlers){var i=handlers.indexOf(handler);if(i!==-1){handlers.splice(i,1)}}}else{var handlers=this._noevents_handlers;if(handlers){if(name){delete handlers[name]}else{delete this._noevents_handlers}}}return this};no.Events.trigger=function(name,param1,param2){var handlers=this._noevents_handlers&&this._noevents_handlers[name];if(handlers){handlers=handlers.slice();var l=arguments.length;if(l===1){for(var i=0,l=handlers.length;i<l;i++){handlers[i].call(this,name)}}else if(l===2){for(var i=0,l=handlers.length;i<l;i++){handlers[i].call(this,name,param1)}}else if(l===3){for(var i=0,l=handlers.length;i<l;i++){handlers[i].call(this,name,param1,param2)}}else{for(var i=0,l=handlers.length;i<l;i++){handlers[i].apply(this,arguments)}}}return this};no.Events.atrigger=function(event,params){var that=this;no.next(function(){that.trigger(event,params)})};no.Events.forward=function(name,object){return this.on(name,function(e,params){object.trigger(e,params)})};var no=no||require("./no.base.js");no.Parser=function(rules,tokens){this._rules=rules;this._tokens=tokens||{}};no.Parser.prototype.start=function(input,id){this.input=input;this.p=0;this.s=input;var ast=this.parse(id);if(this.s){this.error("End of string expected")}return ast};no.Parser.prototype.parse=function(id,params){var rule=this._rules[id];var p=this.p;var ast=rule.call(this,params);ast._start=p;ast._end=this.p;ast._input=this.input;return ast};no.Parser.prototype.test=function(id){var token=this._tokens[id];if(token){var r=token.exec(this.s);return r&&r[0]}if(this.la(id.length)===id){return id}};no.Parser.prototype.match=function(id){var r=this.test(id);if(!r){this.error("Token "+id+" expected")}this.move(r.length);return r};no.Parser.prototype.la=function(n){return this.s.substr(0,n||1)};no.Parser.prototype.move=function(n){n||(n=1);this.s=this.s.substr(n);this.p+=n};no.Parser.prototype.skip=function(){var r=/^\s+/.exec(this.s);if(r){this.move(r[0].length)}};no.Parser.prototype.error=function(msg){throw Error(msg+" at "+this.p+": "+this.s)};var no=no||require("./no.base.js");if(no.de){require("./no.parser.js");module.exports=no}(function(){function JNode(data){this.data=data}JNode.prototype.empty=new JNodeset;JNode.prototype.isEmpty=function(){return false};JNode.prototype.nametest=function(name,result){var data=this.data;if(!data){return this.empty}if(Array.isArray(data)){result||(result=new JNodeset);for(var i=0;i<data.length;i++){new JNode(data[i]).nametest(name,result)}return result}var r=data[name];if(r===undefined){return this.empty}var node=new JNode(r);if(result){return result.push(node)}return node};JNode.prototype.startest=function(result){result||(result=new JNodeset);var data=this.data;if(Array.isArray(data)){for(var i=0;i<data.length;i++){new JNode(data[i]).startest(result)}}else{for(var key in data){this.nametest(key,result)}}return result};JNode.prototype.pred=function(filter,root,vars,funcs){var data=this.data;if(Array.isArray(data)){var result=new JNodeset;for(var i=0;i<data.length;i++){var node=new JNode(data[i]);if(filter(node,root,vars,funcs)){result.push(node)}}return result}return filter(this,root,vars,funcs)?this:this.empty};JNode.prototype.index=function(index,root,vars,funcs){var data=this.data;if(Array.isArray(data)){var r=data[index(this,root,vars,funcs)];return r!==undefined?new JNode(r).toNodeset():this.empty}return index===0?this:this.empty};JNode.prototype.toArray=function(){return[this.data]};JNode.prototype.toNodeset=function(){return(new JNodeset).push(this)};JNode.prototype.scalar=function(){var data=this.data;return typeof data==="object"?"":data};JNode.prototype.boolean=function(){var data=this.data;if(Array.isArray(data)){return data.length>0}return!!data};JNode.prototype.cmpN=function(nodeset){var data=this.data;if(Array.isArray(data)){for(var i=0;i<data.length;i++){if(cmpN(new JNode(data[i]),nodeset)){return true}}return false}return cmpN(this,nodeset)};function cmpN(node,nodeset){if(nodeset instanceof JNode){return cmpS(nodeset,node.scalar())}var nodes=nodeset.nodes;var value=node.scalar();for(var i=0;i<nodes.length;i++){if(value==nodes[i].scalar()){return true}}return false}JNode.prototype.cmpS=function(scalar){return cmpS(this,scalar)};function cmpS(node,scalar){var data=node.data;if(Array.isArray(data)){for(var i=0;i<data.length;i++){if(new JNode(data[i]).scalar()==scalar){return true}}return false}return node.scalar()==scalar}function JNodeset(){this.nodes=[]}JNodeset.prototype.empty=JNode.prototype.empty;JNodeset.prototype.isEmpty=function(){return!this.nodes.length};JNodeset.prototype.push=function(node){this.nodes.push(node);return this};JNodeset.prototype.nametest=function(name,result){var nodes=this.nodes;result||(result=new JNodeset);for(var i=0;i<nodes.length;i++){nodes[i].nametest(name,result)}return result};JNodeset.prototype.startest=function(result){var nodes=this.nodes;result||(result=new JNodeset);for(var i=0;i<nodes.length;i++){nodes[i].startest(result)}return result};JNodeset.prototype.pred=function(filter,root,vars,funcs){var nodes=this.nodes;var result=new JNodeset;for(var i=0;i<nodes.length;i++){var node=nodes[i];if(filter(node,root,vars,funcs)){result.push(node)}}return result};JNodeset.prototype.index=function(index){var node=this.nodes[index];if(node!==undefined){return(new JNodeset).push(node)}return this.empty};JNodeset.prototype.toArray=function(){var r=[];var nodes=this.nodes;for(var i=0;i<nodes.length;i++){r.push(nodes[i].data)}return r};JNodeset.prototype.scalar=function(){var nodes=this.nodes;return nodes.length?nodes[0].scalar():""};JNodeset.prototype.boolean=function(){var nodes=this.nodes;return nodes.length?nodes[0].boolean():false};JNodeset.prototype.cmpN=function(nodeset){var nodes=this.nodes;for(var i=0,l=nodes.length;i<l;i++){if(nodes[i].cmpN(nodeset)){return true}}return false};JNodeset.prototype.cmpS=function(scalar){var nodes=this.nodes;for(var i=0,l=nodes.length;i<l;i++){if(nodes[i].cmpS(scalar)){return true}}return false};no.JNode=JNode;no.JNodeset=JNodeset;var TYPE_SCALAR="scalar";var TYPE_NODESET="nodeset";var TYPE_BOOL="boolean";var BINOPS={"*":6,"/":6,"%":6,"+":5,"-":5,"<=":4,">=":4,"<":4,">":4,"==":3,"!=":3,"&&":2,"||":1};var tokens={};tokens.SELF=/^\.(?![a-zA-Z_*.[])/;tokens.ROOT=/^\/(?![.[])/;tokens.BINOP=/^(?:\+|-|\*|\/|%|==|!=|<=|>=|<|>|&&|\|\|)/;tokens.UNOP=/^(?:\+|-|!)/;tokens.DIGIT=/^[0-9]/;tokens.ID=/^[a-zA-Z_][a-zA-Z0-9-_]*/;tokens.NUMBER=/^[0-9]+(?:\.[0-9]+)?/;tokens.CHARS=/^[^"{}\\]+/;var rules={};rules.expr=function(){var ops=[];var args=[this.parse("unary")];this.skip();var op;var cp=0;while(op=this.test("BINOP")){this.move(op.length);this.skip();var p=BINOPS[op];if(p<=cp){reduce(p)}ops.unshift(op);args.unshift(this.parse("unary"));this.skip();cp=p}reduce(0);return args[0];function reduce(p){var op,left,right;while((op=ops[0])&&BINOPS[op]>=p){right=args.shift();left=args.shift();args.unshift({_id:"binop",_type:"+-*/%".indexOf(op)>-1?TYPE_SCALAR:TYPE_BOOL,_local:left._local||right._local,op:ops.shift(),left:left,right:right})}}};rules.unary=function(){var op;if(op=this.test("UNOP")){this.move();var expr=this.parse("unary");return{_id:"unop",_type:op==="!"?TYPE_BOOL:TYPE_SCALAR,_local:expr._local,op:op,expr:expr}}return this.parse("primary")};rules.primary=function(){var la=this.la();switch(la){case'"':return this.parse("string");case".":case"/":return this.parse("jpath");case"(":return this.parse("subexpr")}if(this.test("DIGIT")){return{_id:"number",_type:TYPE_SCALAR,value:this.match("NUMBER")}}var name=this.match("ID");if(this.test(".")){return{_id:"filter",_type:TYPE_NODESET,name:name,jpath:this.parse("jpath")}}if(this.test("(")){this.move();this.skip();var args=[];if(!this.test(")")){args.push(this.parse("expr"));this.skip();while(this.test(",")){this.move();this.skip();args.push(this.parse("expr"));this.skip()}}this.match(")");return{_id:"func",_type:TYPE_SCALAR,name:name,args:args}}return{_id:"var",_type:TYPE_NODESET,name:name}};rules.subexpr=function(){this.move();this.skip();var expr=this.parse("expr");this.skip();this.match(")");return{_id:"subexpr",_type:expr._type,_local:expr._local,expr:expr}};rules.jpath=function(){if(this.test("SELF")){this.move();return{_id:"self",_type:TYPE_NODESET,_local:true}}if(this.test("ROOT")){this.move();return{_id:"root",_type:TYPE_NODESET}}var abs;if(this.test("/")){this.move();abs=true}var steps=[];while(1){var la=this.la();if(la==="."){steps.push(this.parse("step"))}else if(la==="["){var pred=this.parse("pred");if(pred._id==="guard"){steps.unshift(pred)}else{steps.push(pred)}}else{break}}return{_id:"jpath",_type:TYPE_NODESET,_local:!abs,abs:abs,steps:steps}};rules.step=function(){this.move();var la=this.la();if(la==="["){return this.parse("pred")}if(la==="*"){this.move();return{_id:"star"}}return{_id:"nametest",nametest:this.match("ID")}};rules.pred=function(){this.move();this.skip();var expr=this.parse("expr");this.skip();this.match("]");var _id="index";if(expr._local){_id="pred"}else if(expr._type===TYPE_BOOL){_id="guard"}return{_id:_id,expr:expr}};rules.string=function(){this.match('"');var content=this.parse("string_content");this.match('"');return content};var disymbols={"{{":"{","}}":"}",'\\"':'"',"\\\\":"\\"};rules.string_content=function(){var parts=[];
var c;var str="";while(this.s){c=disymbols[this.la(2)];if(c){str+=c;this.move(2)}else{c=this.la();if(c==='"'){break}if(c==="\\"){str+=c;this.move()}else if(c==="{"){pushStr();this.move();this.skip();parts.push(this.parse("expr"));this.skip();this.match("}")}else{str+=this.match("CHARS")}}}pushStr();if(!parts.length){parts.push(stringLiteral(""))}return{_id:"string",_type:TYPE_SCALAR,value:parts};function pushStr(){if(str){parts.push(stringLiteral(str));str=""}}function stringLiteral(s){return{_id:"string_literal",_type:TYPE_SCALAR,value:s}}};var parser=new no.Parser(rules,tokens);var _cache={};no.jpath=function(expr,data,vars,funcs){return no.jpath.toScalar(no.jpath.expr(expr)(data,vars,funcs))};no.jpath.raw=function(expr,data,vars,funcs){return no.jpath.expr(expr)(data,vars,funcs)};no.jpath.scalar=function(expr){var compiled=no.jpath.expr(expr);return function(data,vars,funcs){return no.jpath.toScalar(compiled(data,vars,funcs))}};no.jpath.boolean=function(expr){var compiled=no.jpath.expr(expr);return function(data,vars,funcs){return no.jpath.toBoolean(compiled(data,vars,funcs))}};no.jpath.string=function(str){return compileString(str,"string_content")};no.jpath.expr=function(expr){var type=typeof expr;if(type==="string"){return compileString(expr,"expr")}if(expr&&type==="object"){return Array.isArray(expr)?compileArray(expr):compileObject(expr)}return function(){return expr}};no.jpath.toScalar=function(result){if(result instanceof JNode){return result.data}else if(result instanceof JNodeset){return result.isEmpty()?undefined:result.toArray()}else{return result}};no.jpath.toBoolean=function(result){if(result instanceof JNode||result instanceof JNodeset){return result.boolean()}else{return result}};function compileString(expr,id){var key=expr+"::"+id;var cached=_cache[key];if(!cached){cached=_cache[key]=compile(parser.start(expr,id))}return cached}function compileObject(obj){var items={};for(var key in obj){items[key]=no.jpath.expr(obj[key])}return function(data,vars,funcs){var r={};for(var key in items){r[key]=no.jpath.toScalar(items[key](data,vars,funcs))}return r}}function compileArray(arr){var items=[];var l=arr.length;for(var i=0;i<l;i++){items.push(no.jpath.expr(arr[i]))}return function(data,vars,funcs){var r=[];for(var i=0;i<l;i++){r.push(no.jpath.toScalar(items[i](data,vars,funcs)))}return r}}function compile(ast){var exprs=[];var p=ast._id==="jpath"?jpath2func(ast,exprs):expr2func(ast,exprs);var r="";for(var i=0;i<=p;i++){r+="function t"+i+"(node, root, vars, funcs) {\n"+exprs[i]+"\n}\n\n"}r+="return function(data, vars, funcs) {\nvar node = new no.JNode(data);\nreturn t"+p+"(node, node, vars, funcs);\n}\n";return Function("no",r)(no)}function expr2func(ast,exprs){var r="return ("+ast2js(ast,exprs)+");";return exprs.push(r)-1}function jpath2func(ast,exprs){var r="";if(ast.abs){r+="node = root;\n"}var steps=ast.steps;for(var i=0,l=steps.length;i<l;i++){var step=steps[i];var id=step._id;switch(id){case"nametest":r+='node = node.nametest("'+step.nametest+'");\n';break;case"star":r+="node = node.startest();\n";break;case"pred":case"index":step.expr._as=id==="pred"?TYPE_BOOL:TYPE_SCALAR;var p=expr2func(step.expr,exprs);r+="node = node."+id+"(t"+p+", root, vars, funcs);\n";break;case"guard":r+="if (!("+ast2js(step.expr,exprs)+")) { return node.empty; }\n";break}if(id!=="guard"){r+="if (node.isEmpty()) { return node.empty; }\n"}}r+="return node;";return exprs.push(r)-1}function ast2js(ast,exprs){var js;switch(ast._id){case"root":js="root";break;case"self":js="node";break;case"number":js=ast.value;break;case"string_literal":js=JSON.stringify(ast.value);break;case"string":js="("+ast.value.map(function(value){value._as=TYPE_SCALAR;return ast2js(value,exprs)}).join(" + ")+")";break;case"var":js='(new no.JNode(vars["'+ast.name+'"]))';break;case"func":js='funcs["'+ast.name+'"](';for(var i=0,l=ast.args.length;i<l;i++){var arg=ast.args[i];arg._as=TYPE_SCALAR;js+=i?",":"";js+=ast2js(arg,exprs)}js+=")";break;case"unop":ast.expr._as=ast.op==="!"?TYPE_BOOL:TYPE_SCALAR;js=ast.op+"("+ast2js(ast.expr,exprs)+")";break;case"binop":var l=ast.left;var r=ast.right;var lt=l._type;var rt=r._type;var op=ast.op;var as;switch(op){case"&&":case"||":if(lt===TYPE_BOOL&&rt===TYPE_BOOL){as=TYPE_BOOL}else{as=TYPE_SCALAR}break;case"==":case"!=":if(lt!==rt&&(lt===TYPE_BOOL||rt===TYPE_BOOL)){as=TYPE_BOOL}break;default:as=TYPE_SCALAR}if(as){l._as=r._as=as}var ljs=ast2js(l,exprs);var rjs=ast2js(r,exprs);if(op==="=="||op==="!="){if(lt===TYPE_NODESET||rt===TYPE_NODESET){if(lt===TYPE_SCALAR){var t=rjs;rjs=ljs;ljs=t}var type=lt===rt?"N":"S";js="("+ljs+").cmp"+type+"("+rjs+")"}if(js&&op==="!="){js="!("+js+")"}}if(js===undefined){js="("+ljs+" "+ast.op+" "+rjs+")"}break;case"subexpr":js="("+ast2js(ast.expr,exprs)+")";break;case"jpath":var p=jpath2func(ast,exprs);js="t"+p+"(node, root, vars, funcs)";break;case"filter":var p=jpath2func(ast.jpath,exprs);js="t"+p+'(new no.JNode(vars["'+ast.name+'"]), root, vars, funcs)';break}if(ast._as&&ast._as!==ast._type){if(ast._type===TYPE_NODESET){js="("+js+")."+ast._as+"()"}else if(ast._type===TYPE_SCALAR){js="!!("+js+")"}}return js}var _setters={};no.jpath.set=function(jpath,data,value){var compiled=_setters[jpath]||(_setters[jpath]=compileSetter(jpath));return compiled(data,value)};function compileSetter(jpath){var parts=jpath.split(".");var i=1;var l=parts.length-1;var body="var r = data; var t;";for(;i<l;i++){body+='t = r["'+parts[i]+'"];';body+='if (t == null) { t = r["'+parts[i]+'"] = {}; }';body+="r = t;"}body+='r["'+parts[i]+'"] = value;';body+="return data;";return new Function("data","value",body)}})();var no=no||require("./no.base.js");if(no.de){require("./no.events.js");module.exports=no}(function(){no.Promise=function(){this._init()};no.extend(no.Promise.prototype,no.Events);no.Promise.prototype._init=function(){this._dones=[];this._fails=[]};no.Promise.prototype.done=function(done){if(!this._rejected){if(this._resolved){done(this._result)}else{this._dones.push(done)}}return this};no.Promise.prototype.fail=function(fail){if(!this._resolved){if(this._rejected){fail(this._error)}else{this._fails.push(fail)}}return this};no.Promise.prototype.then=function(done,fail){this.done(done);this.fail(fail);return this};no.Promise.prototype.always=function(always){this.done(always);this.fail(always);return this};no.Promise.prototype.resolve=function(result){if(!(this._resolved||this._rejected)){this._resolved=true;this._result=result;var dones=this._dones;for(var i=0,l=dones.length;i<l;i++){dones[i](result)}this._dones=this._fails=null}return this};no.Promise.prototype.reject=function(error){if(!(this._rejected||this._resolved)){this._rejected=true;this._error=error;var elses=this._fails;for(var i=0,l=elses.length;i<l;i++){elses[i](error)}this._dones=this._fails=null}return this};no.Promise.prototype.pipe=function(promise){this.done(function(result){promise.resolve(result)});this.fail(function(error){promise.reject(error)});return this};no.Promise.wait=function(promises){if(Array.isArray(promises)){return wait_array(promises)}else{return wait_object(promises)}};function wait_object(object){var results={};var array=[];for(var key in object){(function(promise,key){promise.done(function(result){results[key]=result});array.push(promise)})(object[key],key)}var wait=new no.Promise;wait_array(array).done(function(){wait.resolve(results)}).fail(function(error){wait.reject(error)});return wait}function wait_array(array){var wait=new no.Promise;var results=[];var l=array.length;if(l===0){return wait.resolve(results)}var n=l;for(var i=0;i<l;i++){(function(promise,i){promise.done(function(result){results[i]=result;if(!--n){wait.resolve(results)}});promise.fail(function(error){wait.reject(error)})})(array[i],i)}return wait}no.promise=function(promises){if(promises){return no.Promise.wait(promises)}return new no.Promise};no.Promise.resolved=function(result){return(new no.Promise).resolve(result)};no.Promise.rejected=function(result){return(new no.Promise).reject(result)}})();var no=no||require("./no.base.js");no.array=function(value){if(value===undefined){return[]}return Array.isArray(value)?value:[value]};no.array.map=function(array,callback){var r=[];for(var i=0,l=array.length;i<l;i++){var value=callback(array[i],i);if(value!==undefined){r.push(value)}}return r};var no=no||require("./no.base.js");no.object={};no.object.map=function(object,callback){var r={};for(var key in object){var value=callback(object[key],key);if(value!==undefined){r[key]=value}}return r};var ns={};if(typeof window==="undefined"){module.exports=ns}ns.events=no.extend({},no.Events);ns.IS_TOUCH=Boolean("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch);ns.extendRecursive=function(dest,src){for(var key in src){var value=src[key];if(value instanceof Array){var ar=dest[key]=[];for(var j=0,m=value.length;j<m;j++){var item=value[j];ar[j]=typeof item==="object"?ns.extendRecursive({},item):item}}else if(typeof value==="object"){dest[key]=ns.extendRecursive({},value)}else{dest[key]=value}}return dest};ns.todo=function(){throw new Error("Unimplemented")};ns.parseQuery=function(s){var o={};s.split("&").forEach(function(chunk){var p=chunk.split("=");var name=p[0];if(name){var value=p[1];if(typeof value==="undefined"){value=""}else{try{value=decodeURIComponent(value)}catch(e){value="";ns.log.info("ns.parseQuery.invalid-param",{query:s,chunk:chunk})}}o[name]=value}});return o};ns.tmpl=function(json,mode,module){var result=yr.run(module||"main",json,mode);return ns.html2node(result)};ns.init=function(){ns.action.init();ns.router.init();ns.history.init();ns.initMainView()};ns.initMainView=function(){var mainView=ns.View.create("app");mainView._setNode(document.getElementById("app"));mainView.invalidate();ns.MAIN_VIEW=mainView};ns.transaction=function(cb){ns.page._stop=true;cb();ns.page._stop=false;ns.page.go(ns.page._lastUrl)};ns.assert=function(truthy,contextName,message){if(!truthy){ns.assert.fail.apply(this,Array.prototype.slice.call(arguments,1))}};ns.assert.fail=function(contextName,message){var messageArgs=Array.prototype.slice.call(arguments,2);for(var i=0;i<messageArgs.length;i++){message=message.replace("%s",messageArgs[i])}throw new Error("["+contextName+"] "+message)};ns.key=function(prefix,params){var key=prefix;params=params||{};for(var pName in params){key+="&"+pName+"="+params[pName]}return key};if(window["mocha"]){ns.clean=function(){ns.layout.undefine();ns.View.undefine();ns.Model.undefine();ns.request.clean();ns.router.undefine();ns.page.current={};ns.MAIN_VIEW=null}}(function(ns){ns.log={};ns.log.debug=function(str){};ns.log.info=function(name,data,longText){};ns.log.error=function(name,data,longText){};ns.log.exception=function(name,exception,data){}})(ns);ns.replaceNode=function(oldNode,newNode){oldNode.parentNode.replaceChild(newNode,oldNode)};ns.removeNode=function(node){var parent=node.parentNode;if(parent){parent.removeChild(node)}};ns.html2node=function(html){var div=document.createElement("div");div.innerHTML=html;return div.firstChild};if(typeof document!=="undefined"&&document.getElementsByClassName){ns.byClass=function(className,context){context=context||document;return context.getElementsByClassName(className)}}else{ns.byClass=function(className,context){context=context||document;return $(context).find("."+className)}}(function(ns){var ENTITYIFY_REGEXP=/[&<>"'\/]/g;var ENTITYIFY_REPLACER=function(){var chars={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};return function(c){return chars[c]}}();ns.entityify=function(s){return s.toString().replace(ENTITYIFY_REGEXP,ENTITYIFY_REPLACER)};var DEENTITYIFY_REGEXP=/&([^&;]+);/g;var DEENTITYIFY_REPLACER=function(){var chars={amp:"&",lt:"<",gt:">",quot:'"',"#x27":"'","#x2F":"/"};return function(a,b){return chars[b]||a}}();ns.deentityify=function(s){return s.replace(DEENTITYIFY_REGEXP,DEENTITYIFY_REPLACER)}})(ns);(function(){ns.history={};ns.history.init=function(){$(window).on("popstate",function(e){e.preventDefault();e.stopPropagation();ns.history.onpopstate(e)})};ns.history.pushState=function(url,title){if(isFunction(window.history.pushState)){window.history.pushState(null,title||ns.page.title(url),url)}};ns.history.replaceState=function(url,title){if(isFunction(window.history.replaceState)){window.history.replaceState(null,title||ns.page.title(url),url)}};ns.history.onpopstate=function(){ns.page.go("",true)};function isFunction(fn){return"function"==typeof fn}})();ns.object={};ns.object.clone=function(obj){if(obj&&typeof obj==="object"){var r;if(Array.isArray(obj)){r=[];for(var i=0;i<obj.length;i++){r.push(ns.object.clone(obj[i]))}}else{r={};for(var key in obj){r[key]=ns.object.clone(obj[key])}}return r}return obj};ns.object.isEmpty=function(obj){for(var key in obj){return false}return true};ns.object.isEqual=function(a,b){if(a===b){return true}if(a==null||b==null){return false}var ta=typeof a;var tb=typeof b;if(ta!==tb){return false}if(typeof a==="object"){for(var keyB in b){if(!(keyB in a)){return false}}for(var keyA in a){if(!ns.object.isEqual(a[keyA],b[keyA])){return false}}}else{return false}return true};ns.L={};ns.L.VIEW="view";ns.L.ASYNC="async";ns.L.BOX="box";ns.V={};ns.V.STATUS={NONE:"none",LOADING:"loading",OK:"ok",INVALID:"invalid"};ns.M={};ns.M.STATUS={ERROR:"error",NONE:"none",OK:"ok",INVALID:"invalid"};ns.R={NOT_APP_URL:"ns-router-not-app",NOT_FOUND:"not-found",REDIRECT:"ns-router-redirect"};ns.U={};ns.U.STATUS={MODELS:"models",EXPIRED:"expired"};ns.U.EXEC={GLOBAL:"global",ASYNC:"async",PARALLEL:"parallel"};ns.V.EVENTS={click:"click",dblclick:"dblclick",mousedown:"mousedown",mousemove:"mousemove",mouseup:"mouseup"};ns.V.DOM_EVENTS=["blur","change","input","click","dblclick","dragstart","dragenter","dragover","dragleave","drag","drop","dragend","focus","focusin","focusout","keydown","keypress","keyup","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","resize","scroll","submit"];ns.V.NS_EVENTS=["ns-view-async","ns-view-init","ns-view-htmlinit","ns-view-show","ns-view-repaint","ns-view-hide","ns-view-htmldestroy"];if(ns.IS_TOUCH){ns.V.DOM_EVENTS.push("swipe","swipeleft","swiperight","tap","touchstart","touchmove","touchend");ns.V.EVENTS={click:"tap",dblclick:"doubletap",mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"}}ns.http=function(url,params,options){options=no.extend({type:"POST",dataType:"json"},options||{});options.url=url;options.data=params;var promise=new no.Promise;$.ajax(options).done(function(data){promise.resolve(data)}).fail(function(jqXHR,textStatus,errorThrown){var error=errorThrown||textStatus||"unknown error";promise.resolve({error:error,xhr:jqXHR})});return promise};(function(ns,undefined){ns.action={};var _actions={};var _inited=false;var HREF_JS_REGEXP=/^\s*javascript:/i;var reHasNsActionClass=/\bns-action\b/;ns.action.define=function(id,action){if(id in _actions){throw new Error("[ns.action] Can't redefine '"+id+"'")}_actions[id]=action};ns.action.copy=function(existentAction,newAction){if(newAction in _actions){throw new Error("[ns.action] Can't redefine '"+newAction+"'")}if(!(existentAction in _actions)){throw new Error("[ns.action] '"+existentAction+"' is not defined")}_actions[newAction]=_actions[existentAction]};ns.action.run=function(id,params,node,event){var action=_actions[id];if(action){try{return action(id,params,node,event)}catch(e){ns.log.exception("action",e)}}};ns.action.getParams=function(node){var paramString=node.getAttribute("data-params");if(paramString&&paramString.charAt(0)==="{"){try{return JSON.parse(paramString)}catch(e){}}return{}};ns.action.init=function(){if(_inited){return}_inited=true;var $body=$("body");var selector="a, .ns-action";var events=[ns.V.EVENTS.click,ns.V.EVENTS.dblclick].join(" ");$body.on(events,selector,this._process)};ns.action._process=function(e){var target=e.currentTarget;var href=target.getAttribute("href");var action=e.type==="dblclick"?target.getAttribute("data-dblclick-action"):target.getAttribute("data-click-action");var returnValue=true;if(action&&action in _actions&&reHasNsActionClass.test(target.className)){returnValue=ns.action.run(action,ns.action.getParams(target),target,e)}else if(ns.V.EVENTS.click){if(!href){return true}if(HREF_JS_REGEXP.test(href)){return false}if(href.indexOf("conf:sip:")===0||href.indexOf("meet:sip:")===0){return true}if(target.hostname!=window.location.hostname){return true}if(target.getAttribute("target")!="_blank"){returnValue=ns.page.go(href);if(returnValue instanceof no.Promise){e.preventDefault();return true}}}return returnValue===undefined||returnValue instanceof no.Promise?false:returnValue}})(ns);ns.Box=function(id,params){this.id=id;this.params=params;this.views={};this.key=ns.View.getKey(id,params);this.node=null;this.active={};this._visible=false};ns.Box.prototype._getView=function(id,params){var key=ns.View.getKey(id,params);return this.views[key]};ns.Box.prototype._addView=function(id,params,type){var view=this._getView(id,params);if(!view){if(type===ns.L.BOX){view=new ns.Box(id,params)}else{view=ns.View.create(id,params,type===ns.L.ASYNC)}this.views[view.key]=view}return view};ns.Box.prototype._getDescendants=function(descs){var views=this.views;var active=this.active;descs.push(this);for(var id in active){var view=views[active[id]];descs.push(view);view._getDescendants(descs)}return descs};ns.Box.prototype._getRequestViews=function(updated,layout,params){for(var id in layout){var view=this._addView(id,params,layout[id].type);view._getRequestViews(updated,layout[id].views,params)}};ns.Box.prototype._getUpdateTree=function(tree,layout,params){if(this.isNone()){tree.views[this.id]=this._getViewTree(layout,params)}else{var views=this.views;for(var id in layout){var key=ns.View.getKey(id,params);views[key]._getUpdateTree(tree,layout[id].views,params)}}};ns.Box.prototype._getViewTree=function(layout,params){var tree={box:true,tree:{},views:{}};tree.tree[this.id]=true;var views=this.views;for(var id in layout){var key=ns.View.getKey(id,params);tree.views[id]=views[key]._getViewTree(layout[id].views,params)}return tree};ns.Box.prototype._updateHTML=function(node,layout,params,options,events){var oldNode;if(!this.node||!options.toplevel){var newNode=ns.byClass("ns-view-"+this.id,node)[0];if(newNode){oldNode=this.node;this.node=newNode}}if(!this.node){throw new Error("[ns.Box] Can't find node for '"+this.id+"'")}var views=this.views;var layoutActive={};for(var id in layout){var key=ns.View.getKey(id,params);layoutActive[id]=key;var view=views[key];var viewWasNone=view.isNone();view._updateHTML(node,layout[id].views,params,options,events);if(viewWasNone&&(view.isOk()||view.isLoading())){this.node.appendChild(view.node)}}var newActive={};for(var activeId in layoutActive){var activeKey=layoutActive[activeId];newActive[activeId]=activeKey}for(var key in this.views){var view=this.views[key];if(newActive[view.id]!==view.key){var descs=view._getDescendants([]);for(var i=0,l=descs.length;i<l;i++){if(descs[i]._hide()){events["ns-view-hide"].push(descs[i])}}if(oldNode&&oldNode.contains(view.node)){this.node.appendChild(view.node)}}}this.active=newActive;this._show()};ns.Box.prototype._show=function(){if(this._visible===false){this._showNode();this._visible=true}return false};ns.Box.prototype._hide=function(){if(this._visible===true){this._hideNode();this._visible=false}return false};ns.Box.prototype._hideNode=function(){this.node.className=this.node.className.replace(" ns-view-visible","")+" ns-view-hidden"};ns.Box.prototype._showNode=function(){this.node.className=this.node.className.replace(" ns-view-hidden","")+" ns-view-visible"};ns.Box.prototype.isOk=no.true;ns.Box.prototype.isLoading=no.false;ns.Box.prototype.isNone=function(){return!this.node};(function(){ns.Model=function(){};no.extend(ns.Model.prototype,no.Events);var _ctors={};var _infos={};var _cache={};var _keySuffix=0;ns.Model.prototype.STATUS=ns.M.STATUS;ns.Model.prototype._init=function(id,params,data){this.id=id;this.params=params;this._reset();this.info=ns.Model.info(id);this.key=ns.Model.key(id,params,this.info);this.setData(data);this._bindEvents()};ns.Model.prototype._reset=function(status){this.data=null;this.error=null;this.status=status||this.STATUS.NONE;this.retries=0;this._version=0};ns.Model.prototype._bindEvents=function(){for(var event in this.info.events){var callbacks=this.info.events[event];if(!Array.isArray(callbacks)){callbacks=[callbacks]}for(var i=0,j=callbacks.length;i<j;i++){this.on(event,this._prepareCallback(callbacks[i]))}}};ns.Model.prototype._prepareCallback=function(method){if(typeof method==="string"){method=this[method]}ns.assert(typeof method==="function","ns.Model","Can't find method '%s' in '%s'",method,this.id);return method};ns.Model.prototype.invalidate=function(){this._reset(this.STATUS.INVALID)};ns.Model.prototype.isValid=function(){return this.status===this.STATUS.OK};ns.Model.prototype.getData=function(){return this.data};ns.Model.prototype.get=function(jpath){var data=this.data;if(data){return no.jpath(jpath,data)}};ns.Model.prototype.select=function(jpath){var data=this.data;if(data){return no.jpath.raw(jpath,data).toArray()}return[]};ns.Model.prototype.set=function(jpath,value,options){var data=this.data;if(!this.isValid()||!data){return}no.jpath.set(jpath,data,value);this.touch();if(options&&options.silent){return}this.trigger("ns-model-changed",jpath);var parts=jpath.split(".");var l=parts.length;while(l>1){var _jpath=parts.slice(0,l).join(".");this.trigger("ns-model-changed"+_jpath,_jpath,jpath);l--}};ns.Model.prototype.setData=function(data,options){if(data&&this.needUpdateData(data)){this.data=this._beforeSetData(this.preprocessData(data));this.status=this.STATUS.OK;this.error=null;this.touch();var silent=options&&options.silent;if(!silent){this.trigger("ns-model-changed","","")}}return this};ns.Model.prototype.needUpdateData=function(data){return!!data};ns.Model.prototype.getError=function(){return this.error};ns.Model.prototype.setError=function(error){this.data=null;this.error=error;this.status=this.STATUS.ERROR};ns.Model.prototype._beforeSetData=function(data){return data};ns.Model.prototype.preprocessData=function(data){return data};ns.Model.prototype.getRequestParams=function(){return ns.Model._getKeyParams(this.id,this.params,this.info)};ns.Model.prototype.canRetry=function(){return!this.isDo()&&this.retries<3};ns.Model.prototype.extractData=function(result){if(result){return result.data}};ns.Model.prototype.extractError=function(result){if(result){return result.error}};ns.Model.prototype.isDo=function(){return this.info.isDo};ns.Model.prototype.getVersion=function(){return this._version};ns.Model.prototype.touch=function(){this._version++;this.trigger("ns-model-touched")};ns.Model.prototype.prepareRequest=function(requestID){this.requestID=requestID;this.retries++;this.promise=new no.Promise;return this};ns.Model.prototype.destroyWith=function(models){ns.Model.destroyWith(this,models)};ns.Model.get=function(id,params){var model=this._find(id,params);if(!model){var Ctor=_ctors[id];model=new Ctor;model._init(id,params);if(!model.isDo()){_cache[id][model.key]=model}}return model};ns.Model.getValid=function(id,params){var model=this._find(id,params);if(model&&model.isValid()){return model}return null};ns.Model._find=function(id,params){ns.assert(id in _infos,"ns.Model","'%s' is not defined",id);var key=ns.Model.key(id,params);return _cache[id][key]||null};ns.Model.destroy=function(model){if(model.isDo()){return}var id=model.id;var key=model.key;var cached=_cache[id][key];if(cached){model.trigger("ns-model-destroyed");model.invalidate()}};ns.Model.isValid=function(id,params){return!!ns.Model.getValid(id,params)};ns.Model.define=function(id,info,base){ns.assert(!(id in _infos),"ns.Model","Can't redefine '%s'",id);info=info||{};if(typeof info.isCollection=="undefined"){info.isCollection=!!info.split}if(!base){if(info.uniq){base=ns.ModelUniq}else if(info.isCollection){base=ns.ModelCollection}else{base=ns.Model}}var ctor=info.ctor||function(){};ctor=no.inherit(ctor,base,info.methods);_infos[id]=info;_ctors[id]=ctor;_cache[id]={};return ctor};ns.Model.info=function(id){var info=ns.Model.infoLite(id);if(info&&!info.ready){info.params=info.params||{};info.events=info.events||{};info.isDo=/^do-/.test(id);info.ready=true}return info};ns.Model.infoLite=function(id){var info=_infos[id];ns.assert(info,"ns.Model","'%s' is not defined",id);return info};ns.Model.key=function(id,params,info){info=info||ns.Model.info(id);ns.assert(info,"ns.Model",'Unknown model type "%s"',id);if(info.isDo){return"do-"+id+"-"+_keySuffix++}var keyPrefix="model="+id;var keyParams=ns.Model._getKeyParams(id,params,info);return ns.key(keyPrefix,keyParams)};ns.Model._getKeyParams=function(id,params,info){params=params||{};info=info||ns.Model.info(id);ns.assert(info,"ns.Model",'Unknown model type "%s"',id);if(typeof info.params==="function"){return info.params(params)}var defaults=info.params;var pNames=info.pNames||(info.pNames=Object.keys(info.params));var result={};for(var i=0,l=pNames.length;i<l;i++){var pName=pNames[i];var pValue=params[pName];pValue=pValue===undefined?defaults[pName]:pValue;if(pValue!=null){result[pName]=pValue}}return result};ns.Model.invalidate=function(id,filter){filter=filter||function(){return true};var models=_cache[id];for(var key in models){var model=models[key];if(filter(model)){model.invalidate()}}};ns.Model.destroyWith=function(targetModel,withModels){if(!Array.isArray(withModels)){withModels=[withModels]}for(var i=0,len=withModels.length;i<len;i++){var model=withModels[i];ns.assert(model instanceof ns.Model,"ns.Model","destroyWith called for '%s' while one of the withModels is not instance of ns.Model",targetModel.id);model.on("ns-model-destroyed",function(){ns.Model.destroy(targetModel)})}};ns.Model.isCollection=function(model){return(model.info||ns.Model.infoLite(model.id)).isCollection};ns.ModelUniq=function(){};no.inherit(ns.ModelUniq,ns.Model);ns.ModelUniq.prototype.__superInit=ns.ModelUniq.prototype._init;ns.ModelUniq.prototype._init=function(id){var info=ns.Model.info(id);info.events.changed=info.events.changed||[];var onchangedCallbacks=info.events.changed;var cb=function(){var that=this;var uniq=this.params[this.uniqName];if(!this.uniqCached){this.uniqCached={}}$.each(uniq,function(i,v){that.uniqCached[v]=true})};if(Array.isArray(onchangedCallbacks)){onchangedCallbacks.unshift(cb)}else{info.events.changed=[cb,info.events.changed]}this.__superInit.apply(this,arguments)};ns.ModelUniq.prototype._superIsValid=ns.Model.prototype.isValid;ns.ModelUniq.prototype.isValid=function(){if(this.key.indexOf("&"+this.uniqName+"=")==-1){return true}return this._superIsValid()};ns.ModelUniq.prototype.uniqName="";ns.ModelUniq.prototype.uniqPath="";ns.ModelUniq.prototype.uniqCached=null;ns.ModelUniq.prototype.uniq=function(params,cached){var that=this;var name=this.uniqName;var copy=$.extend({},params,true);if(!this.uniqCached){this.uniqCached={}}if(cached){for(var k in params){cached[k]=k==name?[]:params[k]}}copy[name]=$.map([].concat(copy[name]),function(v){if(that.uniqCached[v]){if(cached){cached[name].push(v)}return null}else{return v}});if(!copy[name].length){delete copy[name]}if(cached&&!cached[name].length){delete cached[name]}return copy};ns.ModelUniq.prototype.uniqFromKey=function(key){return((key.split(this.uniqName+"=")[1]||"").split("&")[0]||"").split(",")};ns.ModelUniq.prototype.uniqFromJSON=ns.todo;ns.ModelUniq.prototype.getData=function(params){var that=this;var path=this.uniqPath;var uniqs=[].concat(params[this.uniqName]);var data={};data[path]=[];var modelsCache=_cache[this.id];for(var key in modelsCache){var model=modelsCache[key];var arrKey=that.uniqFromKey(key);for(var i=0,j=uniqs.length;i<j;i++){if($.inArray(uniqs[i],arrKey)>-1){var value=that.uniqFromJSON(model.data,uniqs[i]);if(value){data[path].push(value)}uniqs.splice(i,1);i--}}}return data};if(window["mocha"]){ns.Model.undefine=function(id){if(id){delete _cache[id];delete _ctors[id];delete _infos[id]}else{_cache={};_ctors={};_infos={}}};ns.Model.privats=function(){return{_ctors:_ctors,_infos:_infos,_cache:_cache,_keySuffix:_keySuffix}};ns.Model.clearCaches=function(id){if(id){_cache[id]={}}else{for(var key in _cache){_cache[key]={}}}}}})();(function(){ns.ModelCollection=function(){};no.inherit(ns.ModelCollection,ns.Model);ns.ModelCollection.prototype._init=function(){ns.Model.prototype._init.apply(this,arguments);this._modelsEvents={}};ns.ModelCollection.prototype.getData=function(){if(this.isValid()){var jpathItems;if(this.info.split){jpathItems=this.info.split.items}else if(this.info.jpathItems){jpathItems=this.info.jpathItems}else{jpathItems=".items"}if(!this.data){this.data={}}no.jpath.set(jpathItems,this.data,[]);var items=no.jpath(jpathItems,this.data);this.models.forEach(function(model){items.push(model.getData())})}return this.data};ns.ModelCollection.prototype._reset=function(){ns.Model.prototype._reset.apply(this,arguments);this.clear()};ns.ModelCollection.prototype._beforeSetData=function(data){this.clear();var splitInfo=this.info.split;if(splitInfo){var items=no.jpath(splitInfo.items,data);var models=this._splitModels(items);this.insert(models)}return data};ns.ModelCollection.prototype._splitModels=function(items){var splitInfo=this.info.split;return items.map(function(item){var params={};for(var key in splitInfo.params){params[key]=no.jpath(splitInfo.params[key],item)}return ns.Model.get(splitInfo.model_id,params).setData(item)})};ns.ModelCollection.prototype._subscribeSplit=function(model){var that=this;var events=this._modelsEvents[model.key]||(this._modelsEvents[model.key]={});this._bindModel(model,"ns-model-changed",events,function(evt,jpath){that.onItemChanged(evt,model,jpath)});this._bindModel(model,"ns-model-touched",events,function(evt){that.onItemTouched(evt,model)});this._bindModel(model,"ns-model-destroyed",events,function(evt){that.onItemDestroyed(evt,model)})};ns.ModelCollection.prototype._bindModel=function(model,eventName,events,callback){model.on(eventName,callback);events[eventName]=callback};ns.ModelCollection.prototype.onItemChanged=function(evt,model,jpath){this.trigger("ns-model-changed",{model:model,jpath:jpath})};ns.ModelCollection.prototype.onItemTouched=function(){this._version++};ns.ModelCollection.prototype.onItemDestroyed=function(evt,model){this.remove(model)};ns.ModelCollection.prototype.getSelfVersion=function(){return this._versionSelf};ns.ModelCollection.prototype.touch=function(){ns.Model.prototype.touch.apply(this,arguments);this._versionSelf=this._version};ns.ModelCollection.prototype._unsubscribeSplit=function(model){if(model.key in this._modelsEvents){var events=this._modelsEvents[model.key];for(var eventName in events){model.off(eventName,events[eventName])}delete this._modelsEvents[model.key]}};ns.ModelCollection.prototype.clear=function(){if(this.models){var that=this;this.models.forEach(function(model){that._unsubscribeSplit(model)})}this.models=[]};ns.ModelCollection.prototype.insert=function(models,index){if(isNaN(index)){index=this.models.length}if(!Array.isArray(models)){models=[models]}var insertion=models.filter(function(model){return this.models.indexOf(model)===-1&&ns.Model.infoLite(model.id)},this);insertion.forEach(function(model,i){this.models.splice(index+i,0,model);this._subscribeSplit(model)},this);if(insertion.length>0){this.status=this.STATUS.OK;this.trigger("ns-model-insert",insertion);return true}return false};ns.ModelCollection.prototype.remove=function(models){var modelsRemoved=[];if(!Array.isArray(models)){models=[models]}models.forEach(function(modelOrIndex){var index;if(isNaN(modelOrIndex)){index=this.models.indexOf(modelOrIndex)}else{index=modelOrIndex}if(index>=0){var model=this.models[index];this._unsubscribeSplit(model);modelsRemoved.push(model);this.models.splice(index,1)}}.bind(this));if(modelsRemoved.length){this.trigger("ns-model-remove",modelsRemoved);return true}return false}})();(function(){ns.layout={};
var _pages={};var hasSpacesRE=/\s+/;ns.layout.define=function(id,layout,parent_id){if(_pages[id]){throw new Error("[ns.layout] Can't redefine '"+id+"'")}_pages[id]={layout:layout,parent_id:parent_id}};ns.layout.page=function(id,params){var raw=_pages[id];if(!raw){throw new Error("[ns.layout] '"+id+"' is not defined")}var layout=compile(raw.layout,params);if(raw.parent_id){var parent=ns.layout.page(raw.parent_id,params);layout=inherit(layout,parent)}return layout};function compile(layout,params){var t={};if(typeof layout==="string"){t[layout]=true;layout=t}else if(Array.isArray(layout)){for(var i=0,l=layout.length;i<l;i++){t[layout[i]]=true}layout=t}var result={};for(var raw_key in layout){var key=no.jpath.string(raw_key)(params);var raw_value=layout[raw_key];var value;switch(typeof raw_value){case"function":value=compile(raw_value(params),params);break;case"object":case"string":value=compile(raw_value,params);break;default:value={}}result[cleanKey(key)]={type:getViewType(key),views:value}}return result}function inherit(layout,parent){var result=ns.object.clone(parent);for(var key in layout){var parts=key.split(hasSpacesRE);var l=parts.length;if(getViewType(parts[l-1])!==ns.L.BOX){throw new Error("[ns.layout] Can't overwrite view layout '"+parts[l-1]+"'")}var lvalue=result;for(var i=0;i<l-1;i++){lvalue=lvalue[cleanKey(parts[i])].views;if(!lvalue){throw new Error('[no.layout] Path "'+parts.slice(0,i).join(" ")+'" is undefined in this layout and cannot be extended')}}lvalue[cleanKey(parts[l-1])]=layout[key]}return result}function getViewType(s){var lastChar=s.substr(-1);if(lastChar==="@"){return ns.L.BOX}else if(lastChar==="&"){return ns.L.ASYNC}return ns.L.VIEW}function cleanKey(key){if(hasSpacesRE.test(key)){return key}var ch=key.slice(-1);if(ch==="@"||ch==="&"){key=key.slice(0,-1)}return key}if(window["mocha"]){ns.layout.undefine=function(id){if(id){delete _pages[id]}else{_pages={}}}}})();(function(){ns.page={};ns.page.current={};ns.page.currentUrl=null;ns.page._stop=false;ns.page._lastUrl="";ns.page.go=function(url,action){if(!action){action="push"}else if(action===true){action="replace"}if(ns.page._stop){ns.page._lastUrl=url;return no.Promise.rejected("transaction")}url=url||ns.page.getCurrentUrl();if(!ns.page.block.check(url)){if(url!=ns.page.currentUrl){ns.history.replaceState(ns.page.currentUrl)}return no.Promise.rejected("block")}var route=ns.router(url);if(route.page===ns.R.REDIRECT){return ns.page.redirect(route.redirect)}if(route.page===ns.R.NOT_APP_URL){if(action==="replace"){window.location.replace(route.redirect)}else{window.location=route.redirect}return no.promise()}var layout=ns.layout.page(route.page,route.params);ns.events.trigger("ns-page-before-load",[ns.page.current,route],url);ns.page.current=route;ns.page.current.layout=layout;ns.page.currentUrl=url;if(action==="push"){ns.history.pushState(url)}else if(action==="replace"){ns.history.replaceState(url)}ns.page.history.push(url);document.title=ns.page.title(url);var update=new ns.Update(ns.MAIN_VIEW,layout,route.params);return update.start()};ns.page.redirect=function(url){ns.history.replaceState(url);return ns.page.go(url,true)};ns.page.title=function(url){return"NoScript app "+url};ns.page.block={checkers:[]};ns.page.block.add=function(fn){ns.page.block.checkers.push(fn);return this};ns.page.block.remove=function(fn){var index=ns.page.block.checkers.indexOf(fn);if(index>-1){ns.page.block.checkers.splice(index,1)}return this};ns.page.block.check=function(url){var checkers=ns.page.block.checkers;for(var i=0,j=checkers.length;i<j;i++){if(checkers[i](url)===false){return false}}return true};ns.page.getDefaultUrl=function(){return ns.router.url("/")};ns.page.getCurrentUrl=function(){return window.location.pathname+window.location.search};ns.page.history={};ns.page.history._current=null;ns.page.history._history=[];ns.page.history.push=function(url){var nsHistory=ns.page.history;if(nsHistory._current){if(nsHistory._current!==url){var prevPage=ns.page.history.getPrevious();if(prevPage==url){nsHistory._history.pop()}else{nsHistory._history.push(nsHistory._current)}}}nsHistory._current=url};ns.page.history.back=function(){var nsHistory=ns.page.history;var previousPage=nsHistory.getPrevious();if(previousPage){nsHistory._history.pop()}else{previousPage=ns.page.getDefaultUrl()}nsHistory._current=previousPage;return ns.page.go(previousPage)};ns.page.history.getPrevious=function(n){n=n||0;var history=ns.page.history._history;var l=history.length;return history[l-n-1]}})();(function(){ns.request=function(items,params,options){return ns.request.models(items2models(items,params),options)};ns.forcedRequest=function(items,params,options){options=options||{};options.forced=true;return ns.request.models(items2models(items,params),options)};ns.request.models=function(models,options){models=$.map(models,function(model){return model.getRequest?model.getRequest():model});var request=new Request(models,options);return request.start()};ns.request.requestParams={};ns.request.addRequestParams=function(params){no.extend(params,ns.request.requestParams)};ns.request.URL="/models/";ns.request.canProcessResponse=function(){return true};ns.request.Manager={STATUS:{LOADING:0,FAILED:1,DONE:2},_keys:{},add:function(model,requestId,forced){var REQUEST_STATUS=this.STATUS;var modelKey=model.key;var request=this._keys[modelKey];if(request){if(request.status===REQUEST_STATUS.LOADING){if(model.isDo()){return request.model}else{if(forced){request.model.requestID=requestId;return true}else{return request.model}}}else if(request.status===REQUEST_STATUS.FAILED){if(request.model.canRetry()){this._createRequest(model,requestId);return true}else{model.status=model.STATUS.ERROR;model.retries=0;this.done(model,true);return false}}else{model.retries=0;return false}}else{if(model.isValid()){if(forced&&model.requestID!==requestId){this._createRequest(model,requestId);return true}return false}else{this._createRequest(model,requestId);return true}}},done:function(model,force){var request=this._keys[model.key];if(request){if(model.isValid()||force){request.status=this.STATUS.DONE}else{request.status=this.STATUS.FAILED}}},clean:function(models){for(var i=0,j=models.length;i<j;i++){delete this._keys[models[i].key]}},_createRequest:function(model,requestId){this._keys[model.key]={status:this.STATUS.LOADING,model:model};model.prepareRequest(requestId)}};if(window["mocha"]){ns.request.clean=function(){ns.request.Manager._keys={}}}var REQUEST_ID=0;var Request=function(models,options){this.id=REQUEST_ID++;this.models=models;this.options=options||{};this.promise=new no.Promise};Request.prototype.start=function(){var loading=[];var requesting=[];var models=this.models;for(var i=0,l=models.length;i<l;i++){var model=models[i];var addRequest=ns.request.Manager.add(model,this.id,this.options.forced);if(addRequest===true){requesting.push(model)}else if(addRequest instanceof ns.Model){loading.push(model)}}this.request(loading,requesting);return this.promise};Request.prototype.request=function(loading,requesting){var all=[];var httpRequest;if(requesting.length){var params=models2params(requesting);var modelsNames=requesting.map(models2name);ns.request.addRequestParams(params);httpRequest=ns.http(ns.request.URL+"?_m="+modelsNames.join(","),params,{type:"POST"});all=all.concat(requesting.map(model2Promise))}if(loading.length){all=all.concat(loading.map(model2Promise))}if(all.length){var that=this;if(httpRequest){httpRequest.then(function(r){if(ns.request.canProcessResponse(r)!==false){if(requesting.length){that.extract(requesting,r)}}})}no.Promise.wait(all).then(this.start.bind(this))}else{ns.request.Manager.clean(this.models);this.promise.resolve(this.models)}};Request.prototype.extract=function(models,response){var results=response&&response.models||[];for(var i=0,l=models.length;i<l;i++){var model=models[i];var result=results[i];if(model.requestID>this.id){continue}var data;var error;if(!result){error={id:"NO_DATA",reason:"Server returned no data"}}else{data=model.extractData(result);if(!data){error=model.extractError(result);if(!error){error={id:"INVALID_FORMAT",reason:"response should contain result or error"}}}}if(data){model.setData(data)}else{model.setError(error)}ns.request.Manager.done(model);model.promise.resolve()}};function models2params(models){var params={};for(var i=0,l=models.length;i<l;i++){var suffix="."+i;var model=models[i];params["_model"+suffix]=model.id;var mParams=model.getRequestParams();for(var name in mParams){params[name+suffix]=mParams[name]}}return params}function normalizeItems(items,params){var _items=[];for(var i=0,l=items.length;i<l;i++){_items.push({id:items[i],params:params})}return _items}function model2Promise(model){return model.promise}function items2models(items,params){if(typeof items==="string"){items=[items]}if(typeof items[0]==="string"){params=params||{};items=normalizeItems(items,params)}var models=[];for(var i=0,l=items.length;i<l;i++){var item=items[i];if(item.model&&item.model instanceof ns.Model){models.push(item.model)}else{models.push(ns.Model.get(item.id,item.params))}}return models}function models2name(model){return model.id}})();ns.router=function(url){var baseDir=ns.router.baseDir;var routesDef=ns.router._routes;if(url.indexOf(baseDir)!==0){return{page:ns.R.NOT_APP_URL,params:{},redirect:url}}url=url.substring(baseDir.length);if(!url){url="/"}var urlChunks=url.split("?");var urlWithoutQuery=urlChunks.shift();if(urlWithoutQuery in routesDef.redirect){return{page:ns.R.REDIRECT,params:{},redirect:baseDir+routesDef.redirect[urlWithoutQuery]}}if(urlWithoutQuery in routesDef.rewriteUrl){var urlQuery=urlChunks.join("?");url=routesDef.rewriteUrl[urlWithoutQuery]+(urlQuery?"?"+urlQuery:"")}var routes=routesDef.route;for(var i=0,j=routes.length;i<j;i++){var route=routes[i];var r=route.regexp.exec(url);if(r){var rparams=route.params;var params={};var l=rparams.length;var rparam;for(var k=0;k<l;k++){rparam=rparams[k];var paramValueFromURL=r[k+1];if(paramValueFromURL){try{paramValueFromURL=decodeURIComponent(paramValueFromURL)}catch(e){paramValueFromURL=""}}if(!paramValueFromURL){paramValueFromURL=rparam.default_value}params[rparam.name]=paramValueFromURL}var query=r[l+1];if(query){no.extend(params,ns.parseQuery(query))}if(route.page in routesDef.rewriteParams){params=routesDef.rewriteParams[route.page](params)}return{page:route.page,params:params}}}return{page:ns.R.NOT_FOUND,params:{}}};ns.router.init=function(){var routes=ns.router.routes;ns.router._regexps={};for(var id in ns.router.regexps){ns.router._regexps[id]=new RegExp("^"+ns.router.regexps[id]+"$")}var _routes={};_routes.redirect=routes.redirect||{};_routes.rewriteUrl=routes.rewriteUrl||{};_routes.rewriteParams=routes.rewriteParams||{};var rawRoutes=routes.route||{};var compiledRoutes=[];var compiledRoutesHash={};for(var route in rawRoutes){var page=rawRoutes[route];var compiled=ns.router.compile(route);compiled.page=page;compiledRoutes.push(compiled);compiledRoutesHash[page]=compiledRoutesHash[page]||[];compiledRoutesHash[page].push(compiled)}_routes.route=compiledRoutes;_routes.routeHash=compiledRoutesHash;ns.router._routes=_routes};ns.router.url=function(url){return ns.router.baseDir+url||"/"};ns.router.generateUrl=function(id,params){var url;var routes=ns.router._routes.routeHash[id];params=params||{};ns.assert(routes&&routes.length,"ns.router","Could not find route with id '%s'!",id);for(var i=0;i<routes.length;i++){url=ns.router._generateUrl(routes[i],params);if(url!==null){break}}ns.assert(url!==null,"ns.router","Could not generate url for layout id '%s'!",id);return ns.router.url(url)};ns.router._generateUrl=function(def,params){var url;var result=[];var query=no.extend({},params);var rewrites=ns.router._routes.rewriteUrl;var section;var svalue;var pvalue;var param;for(var i=0;i<def.sections.length;i++){section=def.sections[i];svalue="";for(var j=0;j<section.items.length;j++){param=section.items[j];if(!param.name){svalue+=param.default_value}else{var pvalue=params[param.name]||param.default_value;if(!param.is_optional&&!pvalue){return null}if(param.is_optional&&!(param.name in params)){continue}if(!ns.router._isParamValid(pvalue,param.type)){return null}svalue+=pvalue;delete query[param.name]}}if(!svalue&&section.is_optional){continue}result.push(encodeURIComponent(svalue))}url=result.join("/");url=url?"/"+url:"";var rewrote=true;while(rewrote){rewrote=false;for(var srcUrl in rewrites){if(url===rewrites[srcUrl]){url=srcUrl;rewrote=true}}}var queryString=$.param(query);return queryString?url+"?"+queryString:url};ns.router.compile=function(route){route=route.replace(/^\//,"").replace(/\/$/,"");var parts=route.split("/");var sections=parts.map(ns.router._parseSection);var sregexps=sections.map(ns.router._generateSectionRegexp);var regexp=sregexps.join("");var params=[];sections.forEach(function(s){params=params.concat(s.items.filter(function(p){return!!p.name}))});regexp="^"+regexp+"/?(?:\\?(.*))?$";return{regexp:new RegExp(regexp),params:params,sections:sections}};ns.router._parseSection=function(rawSection){var curIndex=0;var openBraketIndex=-1;var closeBraketIndex=-1;var items=[];while(true){openBraketIndex=rawSection.indexOf("{",curIndex);if(openBraketIndex<0){break}closeBraketIndex=rawSection.indexOf("}",openBraketIndex);ns.assert(closeBraketIndex>0,"ns.router","could not parse parameter in url section: %s",rawSection);if(openBraketIndex>curIndex){items.push({default_value:rawSection.substr(curIndex,openBraketIndex-curIndex)})}items.push(ns.router._parseParam(rawSection.substr(openBraketIndex+1,closeBraketIndex-openBraketIndex-1)));curIndex=closeBraketIndex+1}if(curIndex<rawSection.length){items.push({default_value:rawSection.substr(curIndex)})}return{is_optional:items.length&&items.filter(function(p){return p.is_optional}).length===items.length,items:items}};ns.router._parseParam=function(param){var type_parts;var default_parts;var param_type;var param_default;var param_is_optional;type_parts=param.split(":");param_type=type_parts[1]||"id";param=type_parts[0];if(param.indexOf("==")>=0){default_parts=param.split("==");param_is_optional=false;param=default_parts[0];param_default=default_parts[1];ns.assert(param_default,"ns.router","Parameter '%s' value must be specified",param);ns.assert(ns.router._isParamValid(param_default,param_type),"ns.router","Wrong value for '%s' parameter",param)}else{default_parts=param.split("=");param_is_optional=default_parts.length>1;param=default_parts[0];param_default=default_parts[1]}return{name:param,type:param_type,default_value:param_default,is_optional:param_is_optional}};ns.router._generateSectionRegexp=function(section){var re="";section.items.forEach(function(p){re+=ns.router._generateParamRegexp(p)});if(section.is_optional){re="(?:/(?!/)"+re+")?"}else{re="/"+re}return re};ns.router._generateParamRegexp=function(p){var re;var regexps=ns.router.regexps;if(p.default_value&&!p.name){return p.default_value}if(p.type){ns.assert(p.type in regexps,"ns.router","Could not find regexp for type '%s'!",p.type)}if(!p.is_optional&&p.default_value){re="("+p.default_value+")"}else{re=regexps[p.type];re="("+re+")";if(p.is_optional){re="(?:"+re+")?"}}return re};ns.router._isParamValid=function(pvalue,ptype){var _regexp=ns.router._regexps[ptype];ns.assert(_regexp,"ns.router","Could not find regexp for type '%s'!",ptype);return _regexp.test(pvalue)};ns.router.baseDir="";ns.router._routes=null;ns.router.routes={};ns.router.regexps={id:"[A-Za-z_][A-Za-z0-9_-]*","int":"[0-9]+"};if(window["mocha"]){ns.router.undefine=function(){ns.router._routes=null;ns.router.routes={}}}(function(){ns.Update=function(view,layout,params,options){this.view=view;if(this.view.id in layout){this.layout=layout[this.view.id]}else{throw new Error("[ns.Update] Can't find view layout")}this.params=params;this.id=++update_id;options=options||{};this.EXEC_FLAG=options.execFlag||ns.U.EXEC.GLOBAL};var currentUpdates=[];var update_id=-1;ns.Update.prototype.STATUS=ns.U.STATUS;ns.Update.prototype._EVENTS_ORDER=["ns-view-hide","ns-view-htmldestroy","ns-view-htmlinit","ns-view-async","ns-view-show","ns-view-repaint"];ns.Update.prototype.start=function(async){var resultPromise=new no.Promise;this.promise=resultPromise;if(!this.addToQueue(this)){this.abort();return this.promise}ns.log.debug("[ns.Update]","start()",this.id,"layout",this.layout);var updated=this.view._getRequestViews({sync:[],async:[]},this.layout.views,this.params);ns.log.debug("[ns.Update]","start()",this.id,"request views",updated);var that=this;var models=views2models(updated.sync);ns.log.debug("[ns.Update]","start()",this.id,"models",models);var asyncUpdaterPromises=updated.async.map(function(){return new no.Promise});var syncModelsPromise=ns.request.models(models).done(function(models){var error=null;models=models||[];if(that._expired()){error={error:that.STATUS.EXPIRED,models:models}}else if(models.some(function(m){return!m.isValid()})){error={error:that.STATUS.MODELS,models:models}}if(error&&!ns.Update.handleError(error,that)){that.error(error);return}that._update(async);that.done({async:asyncUpdaterPromises})}).fail(function(models){that.error({error:that.STATUS.MODELS,models:models})});updated.async.forEach(function(view,asyncViewId){var models=views2models([view]);no.Promise.wait([syncModelsPromise,ns.request.models(models)]).done(function(result){var models=result[1];for(var i=0,j=models.length;i<j;i++){if(!models[i].isValid()){asyncUpdaterPromises[asyncViewId].reject({error:that.STATUS.MODELS,async_view:view,models:models});return}}var layout;var params;if(ns.page.current.layout){var currentPage=ns.page.current;layout=currentPage.layout;params=currentPage.params}else{layout={};layout[that.view.id]=that.layout;params=that.params}new ns.Update(that.view,layout,params,{execFlag:ns.U.EXEC.ASYNC}).start(true).pipe(asyncUpdaterPromises[asyncViewId])}).fail(function(result){asyncUpdaterPromises[asyncViewId].reject({error:that.STATUS.MODELS,async_view:view,models:result[1]})})});return resultPromise};ns.Update.prototype._update=function(async){var params=this.params;var layout=this.layout;var tree={location:document.location,"layout-params":params,views:{}};this.view._getUpdateTree(tree,layout.views,params);ns.log.debug("[ns.Update]","start()",this.id,"updateTree",tree);var node;if(!ns.object.isEmpty(tree.views)){node=ns.tmpl(tree,null,"");ns.log.debug("[ns.Update]","start()",this.id,"new node",node.cloneNode(true))}var viewEvents={"ns-view-async":[],"ns-view-hide":[],"ns-view-htmldestroy":[],"ns-view-htmlinit":[],"ns-view-show":[],"ns-view-repaint":[]};this.view._updateHTML(node,layout.views,params,{toplevel:true,async:async},viewEvents);for(var i=0,j=this._EVENTS_ORDER.length;i<j;i++){var event=this._EVENTS_ORDER[i];var views=viewEvents[event];for(var k=views.length-1;k>=0;k--){views[k].trigger(event,params)}}};ns.Update.prototype._expired=function(){return this.stopped||currentUpdates.indexOf(this)===-1};ns.Update.prototype.abort=function(){this.stopped=true;this.error({error:ns.U.STATUS.EXPIRED})};ns.Update.prototype.done=function(result){this.removeFromQueue();this.promise.resolve(result)};ns.Update.prototype.error=function(result){this.removeFromQueue();this.promise.reject(result)};ns.Update.prototype.removeFromQueue=function(){var index=currentUpdates.indexOf(this);if(index>-1){currentUpdates.splice(index,1)}};ns.Update.prototype.addToQueue=function(newUpdate){var currentRuns=currentUpdates;var FLAGS=ns.U.EXEC;var FLAG_GLOBAL=FLAGS.GLOBAL;var FLAG_PARALLEL=FLAGS.PARALLEL;var FLAG_ASYNC=FLAGS.ASYNC;var newRunExecutionFlag=newUpdate.EXEC_FLAG;var i;var j;if(newRunExecutionFlag===FLAG_GLOBAL){var survivedRuns=[];for(i=0,j=currentRuns.length;i<j;i++){var run=currentRuns[i];if(run.EXEC_FLAG===FLAG_PARALLEL){survivedRuns.push(run)}else{run.abort()}}currentUpdates=survivedRuns}else if(newRunExecutionFlag===FLAG_ASYNC){for(i=0,j=currentRuns.length;i<j;i++){if(currentRuns[i].EXEC_FLAG===FLAG_GLOBAL){return false}}}currentUpdates.push(newUpdate);return true};ns.Update.prototype.isGlobal=function(){return this.EXEC_FLAG===ns.U.EXEC.GLOBAL};ns.Update.handleError=function(error,update){return false};function views2models(views){var added={};var models=[];for(var i=0,l=views.length;i<l;i++){var viewModels=views[i].models;for(var model_id in viewModels){var model=viewModels[model_id];var key=model.key;if(!added[key]){models.push(model);added[key]=true}}}return models}})();(function(){var VIEW_ID=0;ns.View=function(){};no.extend(ns.View.prototype,no.Events);ns.View.prototype.STATUS=ns.V.STATUS;ns.View.prototype._$document=$(document);ns.View.prototype._$window=$(window);ns.View.prototype._init=function(id,params,async){this.id=id;this.async=async;this.info=ns.View.info(id);no.extend(this,ns.View.getKeyAndParams(this.id,params||{},this.info));this._initModels();this._modelsVersions={};this._modelsEvents={};this.node=null;this.views=null;this._invalidSubviews=null;this.status=this.STATUS.NONE;this._uniqID=VIEW_ID++;this._eventNS=".ns-view-"+this.id+"-"+this._uniqID;this._bindCreateEvents();this.trigger("ns-view-init")};ns.View.prototype._initModels=function(){if(!this.models){this.models={}}for(var id in this.info.models){if(!this.models[id]){this.models[id]=ns.Model.get(id,this.params)}}};ns.View.prototype._getView=function(id){return this.views[id]};ns.View.prototype._addView=function(id,params,type){var view=this._getView(id);if(!view){if(type===ns.L.BOX){view=new ns.Box(id,params)}else{view=ns.View.create(id,params,type===ns.L.ASYNC)}this.views[view.id]=view}return view};ns.View.prototype._htmldestroy=function(events){this._unbindEvents("init");events.push(this)};ns.View.prototype._htmlinit=function(events){this._bindEvents("init");events.push(this)};ns.View.prototype._hide=function(events){if(!this.isLoading()&&this._visible===true){this._unbindEvents("show");this._hideNode();this._visible=false;if(events){events.push(this)}return true}else if(this.isLoading()&&this._visible!==false){this._hideNode();this._visible=false;return false}return false};ns.View.prototype._hideNode=function(){this.node.className=this.node.className.replace(" ns-view-visible","")+" ns-view-hidden"};ns.View.prototype._show=function(events){if(!this.isLoading()&&this._visible!==true){this._unbindModels();this._bindModels();this._bindEvents("show");this._showNode();this._visible=true;if(events){events.push(this)}return true}return false};ns.View.prototype._showNode=function(){this.node.className=this.node.className.replace(" ns-view-hidden","")+" ns-view-visible"};ns.View.prototype.invalidateSubview=function(subviewId){this._invalidSubviews[subviewId]=ns.V.STATUS.INVALID};ns.View.prototype._bindModels=function(){var that=this;var models=this.models;var subviews=this.info.subviews;for(var model_id in models){var model=models[model_id];var events=this._modelsEvents[model.key]||(this._modelsEvents[model.key]={});this._bindModel(model,"ns-model-destroyed",events,function(){that.invalidate()});var jpaths=subviews[model_id];if(jpaths){for(var jpath in jpaths){var deps=jpaths[jpath];if(""in deps){this._bindModel(model,"ns-model-changed"+jpath,events,function(){that.invalidate()})}else{(function(deps){that._bindModel(model,"ns-model-changed"+jpath,events,function(){for(var subview_id in deps){that.invalidateSubview(subview_id)}})})(deps)}}}else{this._bindModel(model,"ns-model-changed",events,function(){that.invalidate()})}}};ns.View.prototype._bindModel=function(model,eventName,events,callback){model.on(eventName,callback);events[eventName]=callback};ns.View.prototype._unbindModels=function(){var models=this.models;for(var model_id in models){var model=models[model_id];var events=this._modelsEvents[model.key]||{};for(var eventName in events){model.off(eventName,events[eventName])}delete this._modelsEvents[model.key]}};ns.View.prototype._prepareCallback=function(fn){if(typeof fn==="string"){var method=this[fn];ns.assert(method,"ns.View","Can't find method '%s' in '%s'",fn,this.id);return method}return fn};ns.View.prototype._bindEventHandlers=function(events,handlerPos){var bindedEvents=[];for(var i=0,j=events.length;i<j;i++){var event=events[i];var eventCopy=[].concat(event);eventCopy[handlerPos]=this._prepareCallback(event[handlerPos]).bind(this);bindedEvents.push(eventCopy)}return bindedEvents};ns.View.prototype._getEvents=function(type){var eventProp="_"+type+"Events";if(!this[eventProp]){var eventsInfo=this.info[type+"Events"];var noeventsInfo=this.info[type+"Noevents"];this[eventProp]={bind:this._bindEventHandlers(eventsInfo["bind"],2),delegate:this._bindEventHandlers(eventsInfo["delegate"],2),"ns-global":this._bindEventHandlers(noeventsInfo["global"],1),"ns-local":this._bindEventHandlers(noeventsInfo["local"],1)}}return this[eventProp]};ns.View.prototype._bindEvents=function(type){var $node=this.$node;var i;var j;var event;var events=this._getEvents(type);var eventNS=this._eventNS+"-"+type;var delegateEvents=events["delegate"];for(i=0,j=delegateEvents.length;i<j;i++){event=delegateEvents[i];if(event[1]==="window"||event[1]==="document"){this["_$"+event[1]].on(event[0]+eventNS,event[2])}else{if(event[1]){$node.on(event[0]+eventNS,event[1],event[2])}else{$node.on(event[0]+eventNS,event[2])}}}var bindEvents=events["bind"];for(i=0,j=bindEvents.length;i<j;i++){event=bindEvents[i];$node.find(event[1]).on(event[0]+eventNS,event[2])}var localNoevents=events["ns-local"];for(i=0,j=localNoevents.length;i<j;i++){event=localNoevents[i];this.on(event[0],event[1])}var globalNoevents=events["ns-global"];for(i=0,j=globalNoevents.length;i<j;i++){event=globalNoevents[i];ns.events.on(event[0],event[1])}};ns.View.prototype._bindCreateEvents=function(){for(var i=0,j=this.info.createEvents.length;i<j;i++){var event=this.info.createEvents[i];this.on(event[0],this._prepareCallback(event[1]))}};ns.View.prototype._unbindEvents=function(type){var $node=this.$node;var i;var j;var event;var eventNS=this._eventNS+"-"+type;var events=this._getEvents(type);$node.off(eventNS);this._$document.off(eventNS);this._$window.off(eventNS);var bindEvents=events["bind"];for(i=0,j=bindEvents.length;i<j;i++){event=bindEvents[i];$node.find(event[1]).off(eventNS)}var localNoevents=events["ns-local"];for(i=0,j=localNoevents.length;i<j;i++){event=localNoevents[i];this.off(event[0],event[1])}var globalNoevents=events["ns-global"];for(i=0,j=globalNoevents.length;i<j;i++){event=globalNoevents[i];ns.events.off(event[0],event[1])}};ns.View.prototype.invalidate=function(){var views=this._getDescendants();for(var i=0,j=views.length;i<j;i++){views[i].status=this.STATUS.INVALID}};ns.View.prototype.isOk=function(){return this.status===this.STATUS.OK};ns.View.prototype.isLoading=function(){return this.status===this.STATUS.LOADING};ns.View.prototype.isNone=function(){return this.status===this.STATUS.NONE};ns.View.prototype.isSubviewsOk=function(){return ns.object.isEmpty(this._invalidSubviews)};ns.View.prototype.isValid=ns.View.prototype.isValidSelf=function(){return this.isOk()&&this.isSubviewsOk()&&this.isModelsValidWithVersions()};ns.View.prototype.isModelsValidWithVersions=function(){return this.isModelsValid(this._modelsVersions)};ns.View.prototype.isModelsValid=function(modelsVersions){var models=this.models;for(var id in models){var model=models[id];if(this.info.models[id]===true&&(!model.isValid()||modelsVersions&&model.getVersion()>modelsVersions[id])){return false}}return true};ns.View.prototype._apply=function(callback){var views=this.views;for(var id in views){callback(views[id],id)}};ns.View.prototype._getRequestViews=function(updated,pageLayout,params){this._tryPushToRequest(updated);if(!this.views){this.views={};for(var view_id in pageLayout){this._addView(view_id,params,pageLayout[view_id].type)}}this._apply(function(view,id){view._getRequestViews(updated,pageLayout[id].views,params)});return updated};ns.View.prototype._tryPushToRequest=function(updated){this.asyncState=false;if(this.async){var hasValidModels=this.isModelsValid();var hasValidStatus=this.isOk();if(hasValidModels&&!hasValidStatus){updated.sync.push(this)}else if(!hasValidModels){this.asyncState=true;updated.async.push(this);return updated}}else if(!this.isValidSelf()){updated.sync.push(this)}return updated};ns.View.prototype._getUpdateTree=function(tree,layout,params){if(!this.isValid()){tree.views[this.id]=this._getViewTree(layout,params)}else{this._apply(function(view,id){view._getUpdateTree(tree,layout[id].views,params)})}return tree};ns.View.prototype._getViewTree=function(layout,params){var tree={async:false,tree:{},models:this._getModelsData(),errors:this._getModelsError(),is_models_valid:this.asyncState||this.isModelsValid(),params:this.params,page:ns.page.current,views:{},key:this.key};tree.tree[this.id]=true;if(this.async&&!this.isModelsValid()){tree.async=true;return tree}if(typeof layout!=="object"){return true}tree.views=this._getDescViewTree(layout,params);return tree};ns.View.prototype._getDescViewTree=function(layout,params){var views={};this._apply(function(view,id){views[id]=view._getViewTree(layout[id].views,params)});return views};ns.View.prototype._getPlaceholderTree=function(layout,params){var tree={tree:{},params:this.params,views:{},key:this.key,placeholder:true};tree.tree[this.id]=true;tree.views=this._getDescViewTree(layout,params);return tree};ns.View.prototype._getModelsData=function(){var r={};var models=this.models;for(var id in models){var data=models[id].getData();if(this.info.models[id]){if(data){r[id]=data}}else{data=data||models[id].getError();if(data){r[id]=data}}}return r};ns.View.prototype._getModelsError=function(){var r={};var models=this.models;for(var id in models){var error=models[id].getError();if(error){r[id]=error}}return r};ns.View.prototype.getModel=function(id){return this.models[id]};ns.View.prototype.getModelData=function(id){return this.getModel(id).getData()};ns.View.prototype.tmpl=function(mode,extra){switch(arguments.length){case 0:mode="";break;case 1:if(typeof mode==="object"){extra=mode;mode=""}}var tree={models:this._getModelsData(),page:ns.page.current};if(extra){tree.extra=extra}return ns.tmpl(tree,mode)};ns.View.prototype._getDescendants=function(views){views=views||[];views.push(this);this._apply(function(view){view._getDescendants(views)});return views};ns.View.prototype._setNode=function(node){var STATUS=this.STATUS;if(node){this.node=node;this.$node=$(node);if(this.isModelsValid()){this.status=STATUS.OK}else{this.status=this.asyncState?STATUS.LOADING:STATUS.OK}}else{this.status=STATUS.NONE}};ns.View.prototype._extractNode=function(node){var viewNode;var viewNodes=ns.byClass("ns-view-"+this.id,node);if(1===viewNodes.length){viewNode=viewNodes[0]}else{for(var i=0;i<viewNodes.length;i++){if(viewNodes[i].getAttribute("data-key")===this.key){viewNode=viewNodes[i]}}}return viewNode};ns.View.prototype._updateHTML=function(node,layout,params,updateOptions,events){var options_next;if(updateOptions.toplevel){options_next=no.extend({},updateOptions)}else{options_next=updateOptions}var syncUpdate=!updateOptions.async;var viewWasInvalid=!this.isValid();var viewNode;if(!this.isValid()){viewNode=this._extractNode(node);ns.assert(viewNode,"ns.View","Can't find node for '%s'",this.id);if(this.isOk()){for(var subview_id in this._invalidSubviews){var className="ns-subview-"+subview_id;var new_subview_node=ns.byClass(className,viewNode)[0];var old_subview_node=ns.byClass(className,this.node)[0];ns.assert(new_subview_node&&old_subview_node,"ns.View","Can't find node for subview '%s' in view '%s'",subview_id,this.id);ns.replaceNode(old_subview_node,new_subview_node)}}else{if(updateOptions.toplevel){if(this.node){ns.replaceNode(this.node,viewNode);options_next.parent_added=true}options_next.toplevel=false}if(this.node&&!this.isLoading()){this._hide(events["ns-view-hide"]);this._htmldestroy(events["ns-view-htmldestroy"])}if(this.node&&!updateOptions.parent_added&&!options_next.parent_added){ns.replaceNode(this.node,viewNode)}this._setNode(viewNode);if(this.isOk()){this._htmlinit(events["ns-view-htmlinit"])
}else if(this.isLoading()){events["ns-view-async"].push(this)}}this._invalidSubviews={};this._saveModelsVersions()}if((syncUpdate||viewWasInvalid)&&this.isOk()){this._show(events["ns-view-show"]);events["ns-view-repaint"].push(this)}viewNode=viewNode||node;if(!this.asyncState){this._apply(function(view,id){view._updateHTML(viewNode,layout[id].views,params,options_next,events)})}};ns.View.prototype._saveModelsVersions=function(){for(var modelId in this.models){this._modelsVersions[modelId]=this.models[modelId].getVersion()}};var _infos={};var _ctors={};ns.View.define=function(id,info,base){ns.assert(!(id in _infos),"ns.View","Can't redefine '%s'",id);info=info||{};var baseClass=ns.View;if(typeof base==="string"){baseClass=_ctors[base];ns.assert(baseClass,"ns.View","Can't find '%s' to extend '%s'",base,id)}else if(typeof base==="function"){baseClass=base}var ctor=info.ctor||function(){};ctor=no.inherit(ctor,baseClass,info.methods);info.models=ns.View._prepareModels(info.models||{});info.events=info.events||{};_infos[id]=info;_ctors[id]=ctor;return ctor};ns.View.info=function(id){var info=_infos[id];if(info&&!info.pGroups){ns.View._initInfoParams(info);ns.View._initInfoEvents(info);ns.View._initInfoSubviews(info)}return info};ns.View._initInfoParams=function(info){if(info.params){ns.assert(!info["params+"],"ns.View","you cannot specify params and params+ at the same time");ns.assert(!info["params-"],"ns.View","you cannot specify params and params- at the same time");var groups;var pGroups=[];if(!Array.isArray(info.params)){groups=[info.params]}else{groups=info.params}for(var i=0;i<groups.length;i++){var group=groups[i];pGroups.push({pNames:Object.keys(group),pFilters:group,pDefaults:{}})}info.pGroups=pGroups}else{var params={};for(var model_id in info.models){var modelInfo=ns.Model.info(model_id);ns.assert(modelInfo,ns.View,"Model %s is not defined!",model_id);no.extend(params,modelInfo.params)}var exclude=info["params-"];if(exclude){for(var i=0;i<exclude.length;i++){delete params[exclude[i]]}delete info["params-"]}if(info["params+"]){no.extend(params,info["params+"]);delete info["params+"]}var pNames=Object.keys(params);if(pNames.length){info.pGroups=[{pNames:pNames,pFilters:{},pDefaults:params}]}else{info.pGroups=[]}}};ns.View._initInfoEvents=function(info){info.createEvents=[];info.initEvents={bind:[],delegate:[]};info.showEvents={bind:[],delegate:[]};info.initNoevents={global:[],local:[]};info.showNoevents={global:[],local:[]};for(var eventDecl in info.events){var declParts=eventDecl.split(" ");var eventParts=declParts.shift().split("@");var when=eventParts.length>1?eventParts.pop():"";when=when&&(when==="init"||when==="show")?when:"";var eventName=eventParts.join("@");var eventSelector=declParts.join(" ");if(eventName){var handler=info.events[eventDecl];var nativeEvent=ns.V.DOM_EVENTS.indexOf(eventName)>-1;if(nativeEvent){var arr=[eventName,eventSelector,info.events[eventDecl]];var globalSelector=eventSelector==="window"||eventSelector==="document";var delegatedEvent=globalSelector||!(eventName==="scroll"&&eventSelector);if(!when){when=globalSelector?"show":"init"}info[when+"Events"][delegatedEvent?"delegate":"bind"].push(arr)}else{when=when||"init";if(eventName=="ns-view-init"||eventName=="ns-view-async"){info.createEvents.push([eventName,handler])}else{if(ns.V.NS_EVENTS.indexOf(eventName)>-1){info[when+"Noevents"].local.push([eventName,handler])}else{info[when+"Noevents"].global.push([eventName,handler])}}}}}delete info.events};ns.View._initInfoSubviews=function(info){var subviewTree={};for(var subview in info.subviews){var deps=info.subviews[subview];if(typeof deps==="string"){deps=[deps]}for(var i=0;i<deps.length;i++){var r=deps[i].split(" ");var model_id=r[0];var jpath=r[1]||"";var byModel=subviewTree[model_id]||(subviewTree[model_id]={});var byModelJpath=byModel[jpath]||(byModel[jpath]={});byModelJpath[subview]=true}}info.subviews=subviewTree};ns.View.getKey=function(id,params,info){return this.getKeyAndParams(id,params,info).key};ns.View.getKeyAndParams=function(id,params,info){info=info||ns.View.info(id)||{};if("function"===typeof info.rewriteParamsOnInit){params=info.rewriteParamsOnInit(no.extend({},params))||params}var keyParams;if("function"===typeof info.params){keyParams=info.params(params)}else{keyParams=ns.View._getKeyParams(id,params,info)}ns.assert(keyParams,"ns.View","Could not generate key for view %s",id);return{params:params,key:ns.key("view="+id,keyParams)}};ns.View._getKeyParams=function(id,params,info){var pGroups=info.pGroups||[];if(!pGroups.length){return{}}for(var g=0;g<pGroups.length;g++){var group=pGroups[g];var pNames=group.pNames||[];var pFilters=group.pFilters||{};var pDefaults=group.pDefaults||{};var result={};for(var i=0,l=pNames.length;i<l;i++){var pName=pNames[i];var pValue=params[pName];var pFilter=pFilters[pName];var isOptional=pName in pDefaults;pValue=pValue===undefined?pDefaults[pName]:pValue;if(pValue==null&&isOptional){continue}if(pValue==null||pFilter&&pValue!=pFilter){result=null;break}result[pName]=pValue}if(result){return result}}return null};ns.View.create=function(id,params,async){var Ctor=_ctors[id];ns.assert(Ctor,"ns.View","'%s' is not defined",id);var view=new Ctor;view._init(id,params,async);return view};ns.View._prepareModels=function(models){var _models={};if(Array.isArray(models)){for(var i=0;i<models.length;i++){_models[models[i]]=true}}else{_models=models}return _models};if(window["mocha"]){ns.View.undefine=function(id){if(id){delete _ctors[id];delete _infos[id]}else{_ctors={};_infos={}}};ns.View.privats={_ctors:_ctors,_infos:_infos}}})();ns.ViewCollection=function(){};no.inherit(ns.ViewCollection,ns.View);ns.ViewCollection.define=function(id,info){info=info||{};var ctor=ns.View.define(id,info,ns.ViewCollection);for(var model_id in info.models){if(ns.Model.infoLite(model_id).isCollection){if(info.modelCollectionId&&model_id!==info.modelCollectionId){throw new Error("[ns.ViewCollection] '"+id+"' must depends on single ns.ModelCollection only")}else{info.modelCollectionId=model_id;info.isCollection=true}}}if(!info.modelCollectionId){throw new Error("[ns.ViewCollection] '"+id+"' must depends on ns.ModelCollection")}if(!info.split||!info.split["view_id"]){throw new Error("[ns.ViewCollection] '"+id+"' must defines split.view_id")}return ctor};ns.ViewCollection.prototype._init=function(){ns.View.prototype._init.apply(this,arguments);this.views={}};ns.ViewCollection.prototype._bindModels=function(){var that=this;var models=this.models;for(var model_id in models){var model=models[model_id];model.on("ns-model-destroyed",function(e,o){if(!o||this===o.model){that.invalidate()}});model.on("ns-model-changed",function(e,o){if(!o||this===o.model){that.invalidate()}})}};ns.ViewCollection.prototype.isValid=function(){return this.isValidSelf()&&this.isValidDesc()};ns.ViewCollection.prototype.isValidDesc=function(){for(var key in this.views){if(!this.views[key].isValid()){return false}}return true};ns.ViewCollection.prototype.isModelsValid=function(modelsVersions){var models=this.models;for(var id in models){var model=models[id];var modelVersion=model.getVersion();if(ns.Model.isCollection(model)){modelVersion=model.getSelfVersion()}if(this.info.models[id]===true&&(!model.isValid()||modelsVersions&&modelVersion>modelsVersions[id])){return false}}return true};ns.ViewCollection.prototype._getView=function(id,params){var key=ns.View.getKey(id,params);return this._getViewByKey(key)};ns.ViewCollection.prototype._getViewByKey=function(key){return this.views&&this.views[key]||null};ns.ViewCollection.prototype._addView=function(id,params){var view=this._getView(id,params);if(!view){view=ns.View.create(id,params);view._showNode=no.nop;view._hideNode=no.nop;this.views[view.key]=view}return view};ns.ViewCollection.prototype._deleteView=function(view){delete this.views[view.key]};ns.ViewCollection.prototype._apply=function(callback){var views=this.views;for(var key in views){callback(views[key],views[key].id)}};ns.ViewCollection.prototype._getRequestViews=ns.View.prototype._tryPushToRequest;ns.ViewCollection.prototype._getUpdateTree=function(tree,layout,params){var decl;if(this.isValidSelf()){decl=this._getPlaceholderTree(layout,params)}else{decl=this._getViewTree(layout,params)}tree.views[this.id]=decl;return tree};ns.ViewCollection.prototype._getDescViewTree=function(layout,params){var result={};result[this.info.split.view_id]=[];if(this.isModelsValid()){var MC=this.models[this.info.modelCollectionId];for(var i=0,view,p,decl;i<MC.models.length;i++){p=no.extend({},params,MC.models[i].params);view=this._getView(this.info.split.view_id,p);if(!view){view=this._addView(this.info.split.view_id,p)}decl=null;if(this.isValidSelf()){if(!view.isValid()){if(view.info.isCollection&&view.isValidSelf()){decl=view._getPlaceholderTree(layout,params)}else{decl=view._getViewTree(layout,params)}}}else{if(view.isValid()){decl=view._getPlaceholderTree(layout,params)}else{decl=view._getViewTree(layout,params)}}if(decl){result[this.info.split.view_id].push(decl)}}}return result};ns.ViewCollection.prototype._getViewTree=function(layout,params){var tree={async:false,tree:{},models:this._getModelsData(),params:this.params,page:ns.page.current,views:{},key:this.key,collection:true};tree.tree[this.id]=true;if(this.async&&!this.isModelsValid()){tree.async=true}tree.views=this._getDescViewTree(layout,params);return tree};ns.ViewCollection.prototype._updateHTML=function(node,layout,params,updateOptions,events){var newNode=this._extractNode(node);var isOuterPlaceholder=$(newNode).hasClass("ns-view-placeholder");var viewWasInvalid=!this.isValid();var syncUpdate=!updateOptions.async;var options_next;if(updateOptions.toplevel){options_next=no.extend({},updateOptions)}else{options_next=updateOptions}if(!this.isValidSelf()){var hadOldNode=!!this.node;if(!newNode){throw new Error("[ns.ViewCollection] Can't find node for '"+this.id+"'")}if(updateOptions.toplevel){if(isOuterPlaceholder){options_next.toplevel=true}else{if(this.node){ns.replaceNode(this.node,newNode)}options_next.toplevel=false;options_next.parent_added=true;this._setNode(newNode)}}else{if(isOuterPlaceholder){ns.replaceNode(newNode,this.node);options_next.toplevel=false;options_next.parent_added=true}else{this._setNode(newNode)}}if(hadOldNode&&!this.isLoading()){this._hide(events["ns-view-hide"]);this._htmldestroy(events["ns-view-htmldestroy"])}if(this.isOk()){this._htmlinit(events["ns-view-htmlinit"])}else if(this.isLoading()){events["ns-view-async"].push(this)}}if((syncUpdate||viewWasInvalid)&&this.isOk()){this._show(events["ns-view-show"]);events["ns-view-repaint"].push(this);this._saveModelsVersions()}if(!this.isLoading()){var MC=this.models[this.info.modelCollectionId];var itemsExist={};var containerDesc;if(this.$node.is(".ns-view-container-desc")){containerDesc=this.node}else{containerDesc=ns.byClass("ns-view-container-desc",this.node)[0]}if(!containerDesc){throw new Error("[ns.ViewCollection] Can't find descendants container (.ns-view-container-desc element) for '"+this.id+"'")}for(var i=0,prev;i<MC.models.length;i++){var p=no.extend({},params,MC.models[i].params);var view=this._getView(this.info.split.view_id,p);if(isOuterPlaceholder){if(!view.isValid()){view._updateHTML(newNode,null,params,options_next,events);if(prev){$(prev.node).after(view.node)}else{$(containerDesc).prepend(view.node)}}}else{if(!view.isValid()){view._updateHTML(newNode,null,params,options_next,events)}else{ns.replaceNode(view._extractNode(newNode),view.node)}}itemsExist[view.key]=view;prev=view}this._apply(function(view){if(!itemsExist[view.key]){view.invalidate();view._hide(events["ns-view-hide"]);view._htmldestroy(events["ns-view-htmldestroy"]);this._deleteView(view);ns.removeNode(view.node)}}.bind(this))}};(function(){ph.redirect={"do":function(pageInfo,models){return this[pageInfo.page](models,pageInfo.params)},photo:function(models,params){var auth=this._model("auth",models);var profile=this._model("profile",models);var photo=this._model("photo",models);var albumInfo=this._model("album-info",models);var photoInitialRedirect=this._model("photo-initial-redirect",models);var isAuthor=this._isAuthor(profile,auth);var promise=null;if(photoInitialRedirect&&photoInitialRedirect.getAlbumId()){var albumId=photoInitialRedirect.getAlbumId();var urlParams=no.extend({},params);photoInitialRedirect.setAsValid();return this._redirectToPhoto(params,urlParams,albumId)}if(profile){if(profile.get(".isBlocked")&&!isAuthor){return this.redirectToProfile(profile)}if(profile.getError()){return this.redirectToProfile(profile)}}if(photo){promise=this.redirectToPhoto(photo,params);if(promise){return promise}}if(albumInfo){var albumInfoError=albumInfo.getError();if(albumInfoError&&albumInfoError.name!=="ask password"){return this.redirectToAlbum(albumInfo)}}return null},redirectToAlbum:function(albumInfo){var albumUrl;var params;if(albumInfo){var albumId=albumInfo.params["album-id"]||albumInfo.get(".albumId");if(typeof albumId>0){params=no.extend({},ns.page.current.params,{"album-id":albumId});albumUrl=ph.utils.generateUrl("album",params)}}if(albumUrl){return this._redirect(albumUrl)}else{return this.redirectToProfile()}},redirectToProfile:function(profile){var params=profile&&profile.params||ns.page.current.params;return this._redirect(ph.utils.generateUrl("user-profile",params))},redirectToPhoto:function(photo,params){params=params||ns.page.current.params;var urlParams=no.extend({},params,photo.params);return this._redirectToPhoto(params,urlParams,photo.get(".albumId"))},_redirectToPhoto:function(params,urlParams,albumId){if(ph.params.hiddenParams["comment-id"]){urlParams["comment-id"]=ph.params.hiddenParams["comment-id"]}if(ph.params.hiddenParams["comment-reply"]){urlParams["comment-reply"]=ph.params.hiddenParams["comment-reply"]}if(albumId){urlParams["album-id"]=albumId}if(!this._differ(params,urlParams,["author-login","image-id","album-id"])){return null}return this._redirect(ph.utils.generateUrl("photo",urlParams))},redirectTo404:function(){return this._redirect(ph.utils.generateUrl("not-found",{}))},_isAuthor:function(profile,auth){return profile&&auth&&profile.get(".userId")==auth.get(".photo-profile.userId")},_redirect:function(url){if(url){return ns.page.go(url,"replace")}return null},_model:function(id,models){for(var i=0;i<models.length;i++){if(models[i].id===id){return models[i]}}return null},_differ:function(params1,params2,keys){return keys.some(function(key){return params1[key]!=params2[key]})}}})();(function(){var goodErrors=ph.common.goodErrors;ns.assert(!("queue"in no.Promise.prototype),"no.Promise.queue","no.Promise.queue added now!");no.Promise.prototype.queue=function(callback,thisObj){var tail=new no.Promise;this.done(function(){(callback.apply(thisObj,arguments)||no.Promise.resolved()).pipe(tail)});return tail};ns.page.title=function(){return"Яндекс.Фотки"};ns.Model.prototype.extractData=function(result){if(result){return result.result}};var _canRetry=ns.Model.prototype.canRetry;ns.Model.prototype.canRetry=function(){var defaultValue=_canRetry.apply(this,arguments);if(defaultValue){var error=this.getError();if(error&&goodErrors.indexOf(error.name)>=0){ph.modelsManager.handleError(this);return false}}return defaultValue};ns.Update.handleError=function(error){if(error.error===ns.U.STATUS.MODELS){if(ph.redirect.do(ns.page.current,error.models)){return false}return true}return false}})();(function(){var slideshow={};var delay=4.5*1e3;var timeout;var isRunning=false;var go=function(){timeout=setTimeout(function(){ns.events.trigger("ph-next-photo")},delay)};slideshow.run=function(){go();isRunning=true};slideshow.stop=function(){clearTimeout(timeout);ns.events.trigger("ph-slideshow-stop");isRunning=false};slideshow.isRunning=function(){return isRunning};ph.slideshow=slideshow})();(function(){var keys={13:"enter",27:"esc",32:"space",37:"left",39:"right",69:"e",70:"f",74:"j",75:"k",76:"l",191:"/"};var keyMap={"?":{key:"/",shift:true}};var rInput=/^(input|textarea|select)$/i;var _blocks={};var _views={};var _defs={};var _keysDown={};var keyboard={};keyboard.init=function(){this._onKeyDown=function(evt){keyboard.handle(evt)};this._onKeyUp=function(evt){keyboard.handleKeyUp(evt)};this._onWindowBlur=function(evt){keyboard.handleWindowBlur(evt)};this.enable()};keyboard.disable=function(){$(document).off("keydown",this._onKeyDown);$(document).off("keyup",this._onKeyUp);$(window).off("blur",this._onWindowBlur)};keyboard.enable=function(){$(document).on("keydown",this._onKeyDown);$(document).on("keyup",this._onKeyUp);$(window).on("blur",this._onWindowBlur)};keyboard.register=function(view,def){_views[view.id]=view;_defs[view.id]=keyboard._prepareEvents(def)};keyboard.registerBlock=function(blockName,def){_blocks[blockName]=keyboard._prepareEvents(def)};keyboard.forget=function(view){_views[view.id]=null;_defs[view.id]=null};keyboard.handleKeyUp=function(evt){var key=keys[evt.which];if(!key){return}_keysDown[key]=null};keyboard.handleWindowBlur=function(){_keysDown={}};keyboard.handle=function(evt){var $target=$(evt.target);var key=keys[evt.which];var action;if(!key){return}if(_keysDown[key]){return}else{_keysDown[key]=true}for(var blockName in _blocks){action=_blocks[blockName][key];if(!action||!keyboard._isActionValid(evt,action)){continue}var blockNode=$target.closest('*[data-nb~="'+blockName+'"]')[0];var block=blockNode&&nb.block(blockNode,null,blockName);if(!block){continue}block[action.method](evt);if(action.last){evt.preventDefault();return}}for(var viewId in _views){if(!_views[viewId]){continue}action=_defs[viewId][key];var view=_views[viewId];if(action&&keyboard._isActionValid(evt,action)){view[action.method](evt);if(action.last){evt.preventDefault();return}}}};keyboard.getDefs=function(){var hash={};var data=[];for(var viewId in _defs){for(var key in _defs[viewId]){var action=_defs[viewId][key];var actionName=action.name;if(!actionName){continue}var shortcuts=hash[actionName];if(!shortcuts){shortcuts=hash[actionName]=[];data.push({actionName:actionName,keys:shortcuts})}shortcuts.push(action.printVersion)}}return data};keyboard.getKeyName=function(evt){return keys[evt.which]};keyboard._prepareEvents=function(def){var events={};for(var key in def){var action=def[key];if(typeof action==="string"){action={method:action}}else{action=no.extend({},action)}var printVersion=no.extend({},action,{keyName:key});var mapped=keyMap[key];if(mapped){action=no.extend(action,mapped,{keyName:key});key=mapped.key}action.printVersion=printVersion;events[key]=action}return events};keyboard._isActionValid=function(evt,action){var $target=$(evt.target);var nodeName=evt.target.nodeName;if(action.selector){if(!$target.is(action.selector)){return false}}else{if(rInput.test(nodeName)){return false}}var isValid=(!action.meta&&!evt.metaKey||action.meta&&evt.metaKey)&&(!action.shift&&!evt.shiftKey||action.shift&&evt.shiftKey)&&(!action.alt&&!evt.altKey||action.alt&&evt.altKey)&&(!action.ctrl&&!evt.ctrlKey||action.ctrl&&evt.ctrlKey);return isValid};ph.keyboard=keyboard})();(function(){var Queue=function(options){this.queue=[];this.queueKeys=[];ns.assert(options,"ph.Queue","options not specified");ns.assert(options.key,"ph.Queue","`key` function was not specified");this.key=options.key;this.skipCycles=options.skipCycles;this.skipErrors=options.skipErrors};Queue.prototype.add=function(keyObj,callback,dropQueue){ns.assert(keyObj,"ph.Queue","called `add` method without `keyObj` specified");ns.assert(callback,"ph.Queue","called `add` method without `callback` specified");var key=this.key(keyObj);ns.assert(key,"ph.Queue","could not calculate key");if(dropQueue){this.abortAll(dropQueue)}this.queueKeys.push(key);this.queue.push(callback);this._run()};Queue.prototype.abortAll=function(abortCurrent){this.queue=[];this.queueKeys=[];if(abortCurrent&&this._running){this._running.reject();this._running=null}};Queue.prototype._run=function(){if(this._running){return}else{this._next()}};Queue.prototype._next=function(){var that=this;var queue=this.queue;var queueKeys=this.queueKeys;this._running=null;if(queue.length===0){return}var next=queue[0];var nextKey=queueKeys[0];var foundIndex=0;if(this.skipCycles){for(var i=queueKeys.length-1;i>0;i--){if(this.key(queueKeys[i])===nextKey){foundIndex=i;break}}}next=queue[foundIndex];this.queue=queue.slice(foundIndex+1);this.queueKeys=queueKeys.slice(foundIndex+1);var promise=next();if(!promise){this._next();return}this._running=promise;if(this.skipErrors){promise.always(function(){that._next()})}else{promise.done(function(){that._next()})}};ph.Queue=Queue})();(function(){var ready=new no.Promise;var goToUrl=function(url){window.location.href=url};ph.metrika={init:function(){ph.loadModule("metrika").done(function(){var counter=new Ya.Metrika({id:149814,defer:true,clickmap:true,accurateTrackBounce:true,trackLinks:true,trackHash:false,webvisor:true});ready.resolve(counter)});ns.events.on("ph-page-show",this.countHit)},count:function(params){ready.done(function(counter){counter.params.apply(counter,params)})},countLink:function(countCallback){return function(evt){var that=this;var delay=50;var $link=$(evt.target);var href=$link.attr("href");ns.assert(href,"ph.metrika.countLink","event target must be an anchor");countCallback.call(that);setTimeout(function(){goToUrl(href)},delay);evt.preventDefault();return false}},countHit:function(){var params=[document.location.href,document.title];no.next(function(){ready.done(function(counter){counter.hit.apply(counter,params)})})},mode:function(){return ph.slideshow.isRunning()?"in slideshow":ns.page.current.params.mode==="view"?"in white mode":"in black mode"},group:function(value,groups){for(var i=1;i<groups.length;i++){var from=groups[i-1];var to=groups[i];if(value<from){return from+"-"}if(value===from&&i===1){return from+""}if(value>=from&&value<=to){if(to-from===1){return value+""}return from+1+"-"+to}}return groups[groups.length-1]+"+"},generateMetrikaCounter:function(metrikaParams){ns.assert(metrikaParams,"ph.generateMetrikaCounter","metrikaParams not specified");return function(params){ns.assert(Array.isArray(params),"metrikaCounter","params must be an array");ph.metrika.count(metrikaParams.concat(params))}},getEventSummary:function(evt){return evt&&evt.type==="click"?"click":"hotkey "+ph.metrika.getKeyName(evt)},getKeyName:function(evt){return ph.keyboard.getKeyName(evt)},getImageFormat:function(photo){return photo&&photo.get(".imageFormat")||"unknown"},getContextInfo:function(){var params=ns.page.current.params;var result={name:params.context||"album"};if(result.name==="search"){result.more="generic";if(params.modelid||params.type==="model"){result.more="camera"}else if(params.tags){result.more="tag"}}return result}}})();(function(){var warn=function(message){if(typeof no.jpath(".console.warn",window)==="function"){window.console.warn(message)}};var onPageShow=function(evt,pageInfo){var statParams=null;switch(pageInfo.page){case"photo":statParams=["desktop_web","image_viewer",pageInfo.params["context"]||"album"];break}if(!statParams){warn("No stat params for page "+pageInfo.page);return}(new Image).src=ph.utils.generateUrl("stat",statParams)};ph.statface={init:function(){ns.events.on("ph-page-show",onPageShow)}}})();var nb={};nb.inherit=function(child,parent){var F=function(){};F.prototype=parent.prototype;child.prototype=new F;child.prototype.constructor=child};nb.extend=function(dest){var srcs=[].slice.call(arguments,1);for(var i=0,l=srcs.length;i<l;i++){var src=srcs[i];for(var key in src){dest[key]=src[key]}}return dest};var nb=nb||{};(function(){nb.node={};nb.node.data=function(node,key,value){if(key){if(value!==undefined){node.setAttribute("data-nb-"+key,value)}else{return parseValue(node.getAttribute("data-nb-"+key)||"")}}else{var data={};var attrs=node.attributes;var r;for(var i=0,l=attrs.length;i<l;i++){var attr=attrs[i];if(r=/^data-nb-(.+)/.exec(attr.name)){data[r[1]]=parseValue(attr.value)}}return data}function parseValue(value){var ch=value.charAt(0);return ch==="["||ch==="{"?eval("("+value+")"):value}};nb.node.getMod=function(node,name){return nb.node.setMod(node,name)};var modCache={};nb.node.setMod=function(node,name,value){var rx=modCache[name]||(modCache[name]=RegExp("(?:^|\\s+)"+name+"(?:_([\\w-]+))?(?:$|\\s+)"));var className=node.className;if(value===undefined){var r=rx.exec(className);return r?r[1]===undefined?true:r[1]:""}else{className=className.replace(rx," ").trim();if(value!==false&&value!==""){className+=" "+name+(value===true?"":"_"+value)}node.className=className}};nb.node.delMod=function(node,name){nb.node.setMod(node,name,false)}})();(function(){var _factories={};var _docEvents={};var _domEvents=["click","dblclick","mouseup","mousedown","keydown","keypress","keyup","input","change","blur","mouseover","mouseout","focusin","focusout"];var _rx_domEvents=new RegExp("^("+_domEvents.join("|")+")\\b\\s*(.*)?$");var _id=0;var _cache={};var _getName=function(node){var _data_nb=node.getAttribute("data-nb");return _data_nb?_data_nb.trim().replace(/\s+/g," "):_data_nb};var _getNames=function(name){return name.split(/\s+/)};var Block=function(){};Block.prototype.__init=function(node){this.node=node;this.$node=$(node);this.__handlers={};this.__bindEvents();this.trigger("init");if(space){nb.trigger("inited:"+this.id,this)}};Block.prototype.__bindEvents=function(){var that=this;var mixinEvents=Factory.get(this.name).events;for(var i=0,l=mixinEvents.length;i<l;i++){var events=mixinEvents[i].custom;var local=mixinEvents[i].local;for(var event in events){(function(handlers){that.__bindCustomEvent(event,function(e,params){for(var i=handlers.length;i--;){var r=handlers[i].call(that,e,params);if(r===false||r===null){return r}}})})(events[event])}for(var event in local){for(var selector in local[event]){var suffix=(selector||"").length?" "+selector:"";var eventDefinition=event+suffix;var handlers=local[event][selector];for(var i=0;i<handlers.length;i++){(function(handler){that.on(eventDefinition,function(){handler.apply(that,arguments)})})(handlers[i])}}}}};Block.prototype.destroy=function(){var mixinEvents=Factory.get(this.name).events;for(var i=0,l=mixinEvents.length;i<l;i++){for(var event in mixinEvents[i].custom){this.off(event)}for(var event in mixinEvents[i].local){this.off(event)}}_cache[this.id]=null};Block.prototype.__getHandlers=function(name){var handlers=this.__handlers;return handlers[name]||(handlers[name]=[])};Block.prototype.on=function(name,handler){var r=_rx_domEvents.exec(name);if(r){this.$node.on(r[1],r[2]||"",handler)}else{this.__bindCustomEvent(name,handler)}return handler};Block.prototype.__bindCustomEvent=function(name,handler){this.__getHandlers(name).push(handler)};Block.prototype.off=function(name,handler){var r=_rx_domEvents.exec(name);if(r){this.$node.off(r[1],r[2]||"",handler)}else{if(handler){var handlers=this.__getHandlers(name);var i=handlers.indexOf(handler);if(i!==-1){handlers.splice(i,1)}}else{this.__handlers[name]=null}}};Block.prototype.trigger=function(name,params){var handlers=this.__getHandlers(name).slice();for(var i=0,l=handlers.length;i<l;i++){handlers[i].call(this,name,params)}};Block.prototype.nbdata=function(key,value){return nb.node.data(this.node,key,value)};Block.prototype.show=function(){this.$node.removeClass("_hidden");this.trigger("show")};Block.prototype.hide=function(){this.$node.addClass("_hidden");this.trigger("hide")};Block.prototype.getMod=function(name){return nb.node.setMod(this.node,name)};Block.prototype.setMod=function(name,value){nb.node.setMod(this.node,name,value)};Block.prototype.delMod=function(name){nb.node.setMod(this.node,name,false)};Block.prototype.children=function(){var children=[];var $nodes=this.$node.find("[data-nb]");for(var i=0,l=$nodes.length;i<l;i++){children=children.concat(nb.blocks($nodes[i]))}return children};nb.Block=Block;var Factory=function(name,ctor,events){this.name=name;ctor.prototype.name=name;this.ctor=ctor;this.events=this._prepareEvents(events)};Factory.prototype._prepareEvents=function(events){events=events||{};var proto=this.ctor.prototype;var dom={};var custom={};var local={};for(var event in events){var r=_rx_domEvents.exec(event);var handlers,key;if(r){var type=r[1];if(type==="blur"){handlers=local[type]||(local[type]={})}else{handlers=dom[type]||(dom[type]={})}key=r[2]||""}else{handlers=custom;key=event}var handler=events[event];if(typeof handler==="string"){handler=proto[handler]}if(handler===null){handlers[key]=null}else{handlers=handlers[key]||(handlers[key]=[]);handlers.push(handler)}}for(var type in dom){if(!_docEvents[type]){$(document).on(type,function(e){if(e.button&&e.type==="click"){return}return Factory._onevent(e)});_docEvents[type]=true}}return[{dom:dom,custom:custom,local:local}]};Factory.prototype.create=function(node,events){var id=node.getAttribute("id");if(!id){id="nb-"+_id++;node.setAttribute("id",id)}if(!_cache[id]){_cache[id]={};if(_getName(node)===null){node.setAttribute("data-nb",this.name)}}if(!_cache[id][this.name]){var block=new this.ctor;block.id=id;block.__init(node);if(events){for(var event in events){block.on(event,events[event])}}_cache[id][this.name]=block}return _cache[id][this.name]};Factory.prototype._extendEvents=function(base){var t_dom=this.events[0].dom;var b_dom=base.events[0].dom;for(var event in b_dom){extend(t_dom[event]||(t_dom[event]={}),b_dom[event])}extend(this.events[0].custom,base.events[0].custom);function extend(dest,src){for(var key in src){var s_handlers=src[key];var d_handlers=dest[key];dest[key]=d_handlers===null?[]:s_handlers.concat(d_handlers||[])}}};Factory._onevent=function(e){var type=e.type;var origNode=e.target;var isHover=type==="mouseover"||type==="mouseout";var fromNode=e.relatedTarget;var nodes;var n;var $nodes;var blockNode;var name;var factory;var node=origNode;nodes=[];$nodes=[];n=nodes.length;while(1){if(!findBlockNodes()){break}var names=_getNames(name);var r=true;for(var j=0;j<names.length;j++){var blockName=names[j];factory=Factory.get(blockName);var mixinEvents=factory.events;for(var i=0,l=mixinEvents.length;i<l;i++){if(checkEvents(blockName,mixinEvents[i].dom[type])===false){r=false}}}if(!r){return false}if(fromNode){return}nodes.push(node);$nodes.push($(node));n=nodes.length;node=node.parentNode}function findBlockNodes(){blockNode=null;var parent;while(parent=node.parentNode){if(name=_getName(node)){blockNode=node;break}nodes.push(node);node=parent}if(blockNode){if(isHover&&fromNode){nodes=origNode===blockNode?[]:[origNode]}n=nodes.length;return true}}function checkEvents(blockName,events){if(!events){return}var R;var node,$node;for(var i=0;i<n;i++){node=nodes[i];$node=$nodes[i]||($nodes[i]=$(node));for(var selector in events){if(selector&&$node.is(selector)&&!(isHover&&fromNode&&$.contains(node,fromNode))){var r=doHandlers(node,blockName,events[selector]);if(r===false){R=r}}}if(R===false){return R}}var handlers=events[""];if(handlers&&!(isHover&&fromNode&&$.contains(blockNode,fromNode))){return doHandlers(blockNode,blockName,handlers)}}function doHandlers(node,blockName,handlers){var block=factory.create(blockNode);for(var i=handlers.length;i--;){var r=handlers[i].call(block,e,node);if(r===false){return false}if(r===null){break}}}};Factory.get=function(name){return _factories[name]};nb.hasBlock=function(node,blockName){var id=node.getAttribute("id");return!!(id&&_cache[id]&&(!blockName||_cache[id][blockName]))};nb.block=function(node,events,blockName){var name=_getName(node);if(!name){return null}if(blockName){return Factory.get(blockName).create(node,events)}return nb.blocks(node,events)[0]};nb.blocks=function(node,events){var name=_getName(node);if(!name){return[]}var names=_getNames(name);var blocks=[];for(var i=0;i<names.length;i++){blocks.push(Factory.get(names[i]).create(node,events))}return blocks};nb.find=function(id){var node=document.getElementById(id);if(node){return nb.block(node)}};nb.define=function(name,methods,base){if(typeof name!=="string"){base=methods;methods=name;name="nb-"+_id++}if(base){base=Factory.get(base)
}var events=methods.events;delete methods.events;var ctor=function(){};nb.inherit(ctor,base?base.ctor:Block);nb.extend(ctor.prototype,methods);var factory=new Factory(name,ctor,events);if(base){factory._extendEvents(base)}_factories[name]=factory;return factory};nb.init=function(where){where=where||document;var nodes=$(where).find("._init").addBack().filter("._init");for(var i=0,l=nodes.length;i<l;i++){nb.block(nodes[i])}};nb.destroy=function(where){where=where||document;var nodes=$(where).find("._init").addBack().filter("._init");for(var i=0,l=nodes.length;i<l;i++){var node=nodes[i];var id=node.getAttribute("id");var blocks=_cache[id];if(blocks){for(var name in blocks){blocks[name].destroy()}}}};var space=nb.define({events:{click:function(e){nb.trigger("space:click",e.target)}}}).create(document.getElementsByTagName("html")[0]);nb.on=function(name,handler){return space.on(name,handler)};nb.off=function(name,handler){space.off(name,handler)};nb.trigger=function(name,params){space.trigger(name,params)};$(function(){nb.init()})})();nb.vec={};nb.vec.add=function(a,b,s){s=s||1;return[a[0]+s*b[0],a[1]+s*b[1]]};nb.vec.mulS=function(a,b){return a[0]*b[0]+a[1]*b[1]};nb.vec.mulM=function(m,a){return[nb.vec.mulS(m[0],a),nb.vec.mulS(m[1],a)]};nb.vec.scale=function(a,b){b=typeof b==="number"?[b,b]:b;return[a[0]*b[0],a[1]*b[1]]};nb.vec.dir2vec=function(dir){return[nb.vec.dirs[dir[0]],nb.vec.dirs[dir[1]]]};nb.vec.dirs={left:-1,center:0,right:1,top:-1,bottom:1};nb.vec.flipDir={left:"right",right:"left",top:"bottom",bottom:"top"};nb.rect=function(node){if(node instanceof Array){return[node,[0,0]]}var $node=$(node);var offset=$node.offset()||{};var size;if($node.hasClass("_hidden")){$node.toggleClass("_invisible",true);$node.toggleClass("_hidden",false);size={width:$node.outerWidth(),height:$node.outerHeight()};$node.toggleClass("_hidden",true);$node.toggleClass("_invisible",false)}else{size={width:$node.outerWidth(),height:$node.outerHeight()}}return[[offset.left,offset.top],[size.width,size.height]]};nb.rect.move=function(r,a){return[nb.vec.add(r[0],a),r[1]]};nb.rect.norm=function(r){var x=r[0];var y=nb.vec.add(x,r[1]);var a=[Math.min(x[0],y[0]),Math.min(x[1],y[1])];var b=[Math.max(x[0],y[0]),Math.max(x[1],y[1])];return[a,nb.vec.add(b,a,-1)]};nb.rect.trans=function(r,m){r=[nb.vec.mulM(m,r[0]),nb.vec.mulM(m,r[1])];return nb.rect.norm(r)};nb.rect.dir2vec=function(r,dir){var h=nb.vec.scale(r[1],.5);var c=nb.vec.add(r[0],h);var d=nb.vec.scale(nb.vec.dir2vec(dir),h);return nb.vec.add(c,d)};nb.rect.adjust=function(what,where,how){var a=nb.rect.dir2vec(what,how.what);var b=nb.rect.dir2vec(where,how.where);return{rect:nb.rect.move(what,nb.vec.add(b,a,-1)),point:b}};(function($,nb){function getOptions(){return{}}function oninit(){this.options=this.getOptions();this.$tail=this.$node.find(this.options.tail_selector||".popup__tail");this.hasTail=!!this.$tail.length}function ontoggle(e,params){var where=params.where;if(this.where){if(where===this.where||where instanceof Array&&where[0]===this.where[0]&&where[1]===this.where[1]){this.trigger("close");return}}this.trigger("open",params)}function onopen(e,params){this.where=params.where;this.how=params.how;this.toggler=params.toggler;this.parent=params.parent;this.size=params.size;if(!this._placeholder){this._placeholder=$('<s class="_hidden"/>').insertBefore(this.node)}if(this._type==="popup"&&!this.parent&&!(this.where instanceof Array)){var parent=$(this.where).parentsUntil($holder(),"[data-nb]").last()[0];if(parent){parent=nb.block(parent);if(parent._type==="popup"){this.parent=parent}}}this.$node.detach();nb.trigger("popup-before-open",this);if(this._type==="modal"){$paranja().append(this.node).show()}else{$holder(true).append(this.node);this._move()}this.show();nb.trigger("popup-opened",this)}function onclose(){this.where=null;this.toggler=null;this.parent=null;this.trigger("popup-before-close");nb.trigger("popup-before-close",this);if(this._type==="modal"){$paranja().hide()}this.hide();if(this._placeholder){this._placeholder.after(this.node)}nb.trigger("popup-closed",this);return false}function onmove(){this._move()}function move(){if(this.modal){return}var how=normalizeHow(this.how);var MIN_LEFT=this.options.tail_offset||27;var TAIL_WIDTH=this.options.tail_width||10;var orig_what=nb.rect(this.node);var where=nb.rect(this.where);var adj_what=nb.rect.adjust(orig_what,where,how);var what=adj_what.rect;var tailDir;var needTail=this.hasTail&&(tailDir=tailDirs(how.what,how.where));if(needTail){this.setMod("popup_to",tailDir[1]);var css={left:"",right:"",top:"",bottom:""};if(tailDir[0]!=="center"){var offset2origin=nb.vec.scale(adj_what.point,-1);var transform=transforms[tailDir.join(" ")];var t_what=nb.rect.trans(nb.rect.move(what,offset2origin),transform);var t_where=nb.rect.trans(nb.rect.move(where,offset2origin),transform);var r=Math.min(t_what[1][0]/2,t_where[1][0]/2);var x,y;if(MIN_LEFT<=r){x=r}else{x=MIN_LEFT;t_what=nb.rect.move(t_what,[r-MIN_LEFT,0])}t_what=nb.rect.move(t_what,[0,TAIL_WIDTH]);what=nb.rect.move(nb.rect.trans(nb.rect.trans(nb.rect.trans(t_what,transform),transform),transform),adj_what.point);var tailOffset=nb.vec.mulM(transform,nb.vec.mulM(transform,nb.vec.mulM(transform,[x,0])));x=tailOffset[0];y=tailOffset[1];var AUTO="auto";if(x>0){css.left=x;css.right=AUTO}else if(x<0){css.left=AUTO;css.right=-x}else if(y>0){css.top=y;css.bottom=AUTO}else{css.top=AUTO;css.bottom=-y}}else{what=nb.rect.move(what,nb.vec.scale(nb.vec.dir2vec(how.where),TAIL_WIDTH))}this.$tail.css(css).show()}else{this.$tail.hide()}this.$node.css({left:what[0][0],top:what[0][1]});if(this.size){var sizeCss={};if(this.size.width){sizeCss.width=$(this.size.width).outerWidth()}if(this.size.height){sizeCss.height=$(this.size.height).outerHeight()}this.$node.css(sizeCss)}}function normalizeHow(how){how=how||{dir:"bottom"};var what,where;if(how.dir){what=nb.vec.flipDir[how.dir];where=how.dir}else{what=how.what;where=how.where}return{what:normalizeDir(what),where:normalizeDir(where)}}var transforms={"left bottom":[[1,0],[0,1]],"right bottom":[[-1,0],[0,1]],"top left":[[0,1],[-1,0]],"bottom left":[[0,-1],[-1,0]],"right top":[[-1,0],[0,-1]],"left top":[[1,0],[0,-1]],"bottom right":[[0,-1],[1,0]],"top right":[[0,1],[1,0]]};function normalizeDir(dir){dir=dir||"";var parts;switch(dir){case"":parts=["center","center"];break;case"left":case"right":case"center":parts=[dir,"center"];break;case"top":case"bottom":parts=["center",dir];break;default:parts=dir.split(/\s+/);if(/^(?:left|right)/.test(parts[1])||/^(?:top|bottom)/.test(parts[0])){parts=[parts[1],parts[0]]}}return parts}function tailDirs(what,where){if(what[0]===where[0]&&nb.vec.flipDir[what[1]]===where[1]){return where}if(what[1]===where[1]&&nb.vec.flipDir[what[0]]===where[0]){return[where[1],where[0]]}}function show(){this.$node.removeClass("_hidden");this.trigger("show")}function hide(){this.$node.addClass("_hidden");this.trigger("hide")}function destroy(){this.trigger("close");if(this._placeholder){this._placeholder.remove()}nb.Block.prototype.destroy.call(this)}var base={events:{init:oninit,toggle:ontoggle,open:onopen,close:onclose,move:onmove,"click .popup__close":onclose},getOptions:getOptions,_move:move,show:show,hide:hide,destroy:destroy};base=nb.define(base);var $paranja=function(){var div=$('<div class="paranja paranja_theme_dark"/>').appendTo("body").hide();$paranja=function(){return div};return div};var $holder=function(){var div=$('<div class="popup-holder"/>').appendTo("body");$holder=function(append){if(append&&!div.is(":last-child")){div.appendTo("body")}return div};return div};nb.define("tooltip",{_type:"tooltip"},base.name);nb.define("popup",{_type:"popup"},base.name);nb.define("modal",{_type:"modal"},base.name);nb.define("ballon",{_type:"ballon"},base.name);nb.on("popup-before-open",function(e,popup){var opened=$holder().children();switch(popup._type){case"tooltip":for(var i=opened.length;i>0;i--){var p=nb.block(opened[i-1]);if(p._type!=="tooltip"){continue}p.trigger("close")}break;case"modal":for(var i=opened.length;i>0;i--){nb.block(opened[i-1]).trigger("close")}break;case"ballon":break;default:for(var i=opened.length;i>0;i--){var p=nb.block(opened[i-1]);if(popup.parent===p){break}if(p._type==="tooltip"){continue}p.trigger("close")}}});nb.on("popup-before-close",function(e,popup){switch(popup._type){case"tooltip":break;case"modal":var opened=$holder().children();for(var i=opened.length;i>0;i--){nb.block(opened[i-1]).trigger("close")}break;default:var nextAll=$(popup.node).nextAll();for(var i=0;i<nextAll.length;i++){var p=nb.block(nextAll[i]);if(p&&p._type==="popup"){p.trigger("close");break}}}});nb.on("keydown",function(e){if(e.keyCode!==27){return}var popup;var popupNode=$holder().children().last()[0];if(popupNode){popup=nb.block(popupNode);if(!popup.ignoreEsc){nb.block(popupNode).trigger("close");e.stopImmediatePropagation();return false}return}popupNode=$paranja().children().last()[0];if(popupNode){popup=nb.block(popupNode);if(!popup.ignoreEsc){popup.trigger("close");e.stopImmediatePropagation();return false}}});nb.on("space:click",function(e,node){var popup;popup=$holder().children().has(node).add($holder().children().filter(node));if(popup.length){popup=popup.next();if(popup.length){nb.block(popup[0]).trigger("close")}return}if($holder().children().length){popup=nb.block($holder().children().first()[0]);if(!popup.ignoreEsc){popup.trigger("close")}return}if(!$paranja().has(node).length){popup=$paranja().children().last()[0];if(popup){popup=nb.block(popup);if(!popup.ignoreEsc){popup.trigger("close")}}}});nb.on("popup-close",function(){if($holder().children().length){nb.block($holder().children().first()[0]).trigger("close")}if($paranja().children().length){nb.block($paranja().children().first()[0]).trigger("close")}});nb.popup={someOpen:function(){return!!$holder().children().length||!!$paranja().children().length},closeAll:function(){var opened=$holder().children();for(var i=opened.length;i>0;i--){var p=nb.block(opened[i-1]);if(p&&p._type==="popup"){p.trigger("close")}}}}})(jQuery,nb);nb.define("popup-toggler",{events:{click:"onclick"},onclick:function(){if(this.getMod("_disabled")){return}var popup=this.getPopup();if(popup){var data=this.nbdata("popup-toggler");popup.trigger("toggle",{where:data.where||this.node,how:data.how,toggler:this.node,size:data.size});return false}},getPopup:function(){if(!this._popup){var data=this.nbdata("popup-toggler");this._popup=nb.find(data["id"])}return this._popup}});nb.define("tooltip-toggler",{events:{mouseover:"showTooltip",mouseout:"hideTooltip"},showTooltip:function(){if(this.getMod("_disabled")){return}var tooltip=this.getTooltip();if(tooltip){var data=this.nbdata("tooltip-toggler");tooltip.trigger("open",{where:data.where||this.node,how:data.how});return false}},hideTooltip:function(){var tooltip=this.getTooltip();if(tooltip){tooltip.trigger("close");return false}},getTooltip:function(){if(!this._tooltip){var data=this.nbdata("tooltip-toggler");this._tooltip=nb.find(data["id"])}return this._tooltip}});(function($,doc){var suggest={};suggest.events={init:"onInit",keydown:"onKeyDown",keyup:"onKeyUp",click:"onFocusIn",focusin:"onFocusIn",input:"onInput"};suggest.onInit=function(){this.delay=this.getDataNumber("delay",300);this.min_length=this.getDataNumber("min_length",1);this.max_items=this.getDataNumber("max_items",-1);this.ignore_case=this.getDataBool("ignore_case");this.label_key=this.getDataString("label-key","label");this.source_url=this.getDataString("source-url");this.response_timeout=this.getDataNumber("timeout",1e4);this.scroll_min=this.getDataNumber("scroll-min",-1);this.expand_to_input=this.getDataBool("expand-popup-to-input");this.show_loader=this.getDataBool("show-loader");this.show_fade=this.getDataBool("show-fade");this.highlight_match=this.getDataBool("highlight-matches");this.focusin_show=this.getDataBool("focusin-show");this.theme_class=this.getDataString("theme-class","");this.search_param_name=this.getDataString("search-param-name","text");this.max_param_name=this.getDataString("max-param-name","max");this.default_params=this.getDataObject("default_params",{});this.popup_selector=this.getDataString("popup-selector");this.$input=this.$node;this._text=null;this._suggest_text=null;this._selected=null;this._html={};this._createPopup();this._popup_opened=false;this.createDataSource();this._getDataTimeout=null;nb.trigger("inited:"+this.node.id,this)};suggest.getDataNumber=function(key,default_value){var value=+this.nbdata(key);return isNaN(value)?default_value:value};suggest.getDataBool=function(key){return(this.nbdata(key)||"").toLowerCase()==="true"};suggest.getDataString=function(key,default_value){return this.nbdata(key)||default_value};suggest.getDataObject=function(key,default_value){return this.nbdata(key)||default_value};suggest.onFocusIn=function(){if(this.focusin_show&&!this._popup_opened&&(!!this._text||this.min_length===0)){this.suggest(this._text)}};suggest._createPopup=function(){var that=this;if(this.popup_selector){this.$popup=this.$node.next(this.popup_selector)}else{this.$popup=$('<div class="popup popup_theme_blocky popup_to_top" data-nb="popup">'+'<div class="suggest-scrollbox"></div>'+"</div>").addClass(this.theme_class).appendTo(doc.body)}if(this.show_loader){var $input=this.$input;var offset=$input.offset();var width=$input.outerWidth();this.$loader=$('<div class="loader_new"></div>').insertBefore(this.$popup);var loader_width=this.$loader.outerWidth();this.$loader.css({left:offset.left+width-loader_width,top:offset.top})}this.$popup_wrapper=this.$popup.find(".suggest-scrollbox");this.popup=nb.block(this.$popup[0],{"mouseover .suggest-scrollbox li":function(evt){that.setCurrent(evt.target)},"click .suggest-scrollbox li":function(evt){var $item=$(evt.target).closest("li");that.selectItem($item)},close:function(){that._popup_opened=false}})};suggest.onKeyDown=function(evt){if(evt.keyCode==38){evt.preventDefault();return}};suggest.onKeyUp=function(evt){if(evt.keyCode==13){evt.preventDefault();this.selectItem();return}if(!this._isReady()){return}if(evt.keyCode==27){this._reset();return}if(evt.keyCode==38){evt.preventDefault();this.changeCurrent(-1);return}if(evt.keyCode==40){evt.preventDefault();this.changeCurrent(1);return}var text=this.$input.val().trim();if(text===this._text){return}this._text=text;this.suggest(text)};suggest.onInput=function(){var text=this.$input.val().trim();if(text===this._text){return}this._text=text;this.suggest(text)};suggest.suggest=function(text){var that=this;text=text||"";if(this._getDataTimeout){clearTimeout(this._getDataTimeout)}if(text.length<this.min_length){this.popup.trigger("close");return}if(this._data.has(text)){this._showFor(text)}else{this._getDataTimeout=setTimeout(function(){that._requestData(text)},this.delay)}};suggest.clear=function(){this.$input.val("");this._text="";this._selected=null};suggest._reset=function(){this.$input.val(this._text)};suggest.createDataSource=function(){if(this.source_url){var params={url:this.source_url,retry_count:3,max_items:this.max_items,timeout:this.response_timeout,query_param_name:this.search_param_name,max_param_name:this.max_param_name,default_params:this.default_params};this._data=(new nb.suggest.ajaxDS).init(params)}};suggest.setArrayData=function(options){this._data=(new nb.suggest.arrayDS).init(options)};suggest.setDataSource=function(ds){this._data=ds};suggest._requestData=function(text){var that=this;this._data.get({key:text,onstart:function(){that.showLoader()},onsuccess:function(){that._showFor(text);that.hideLoader()},onfail:function(){that.hideLoader()}})};suggest._showFor=function(text){if(this.$input.val().trim()!==text){return}var data=this._data.getSync(text);if(data.length<=0){this.popup.trigger("close");return}this._suggest_text=text;this.showSuggest();var suggest=this.renderSuggest(text,data);this.$suggest_container=suggest.container;this.$suggest_container.find("li.current").toggleClass("current",false);if(suggest.scroll_height){this.$popup_wrapper.css({"max-height":suggest.scroll_height,"overflow-y":"scroll"})}else{this.$popup_wrapper.css({"max-height":"",overflow:""})}};suggest.renderSuggest=function(text,data){var that=this;var suggest=this._html[text];$("ul",this.$popup_wrapper).remove();if(suggest){this.$popup_wrapper.append(suggest.container);return suggest}var $container=$("<ul/>");this.$popup_wrapper.append($container);data.forEach(function(item){var $item=that.renderItem(item);$container.append($item)});var scroll_height;if(this.scroll_min>0&&data.length>this.scroll_min){var $items=$container.find("li");scroll_height=0;for(var i=0;i<this.scroll_min;i++){scroll_height+=$($items[i]).outerHeight()}}suggest={container:$container,scroll_height:scroll_height};this._html[text]=suggest;return suggest};suggest.showSuggest=function(){if(!this._popup_opened){if(this.expand_to_input){this.$popup.css("width",this.$input.outerWidth())}this.popup.trigger("open",{where:this.node,how:{where:"left bottom",what:"left top"}});this._popup_opened=true;return true}return false};suggest.renderItem=function(item){var label=item[this.label_key]||"";var label_html;if(this.highlight_match){label_html=this.hightlightMatches(label,this._suggest_text)}else{label_html="<span>"+label+"</span>"}var $item=$("<li></li>").attr("title",label).html(label_html);if(this.show_fade){$item.append('<div class="fader"></div>')}return $item};suggest.hightlightMatches=function(text,match){var index;if(!text||!match){return""}var text_low=text.toLowerCase();var text_length=text.length;var match_low=match.toLowerCase();var match_length=match.length;var cur_index=0;var parts=[];while((index=text_low.indexOf(match_low,cur_index))>=0){if(index>cur_index){parts.push("<span>"+text.substring(cur_index,index)+"</span>")}parts.push('<span class="match">'+text.substring(index,index+match_length)+"</span>");cur_index=index+match_length}if(cur_index<text_length){parts.push("<span>"+text.substring(cur_index,text_length)+"</span>")}return parts.join("")};suggest.setCurrent=function(node){$("li.current",this.$suggest_container).toggleClass("current",false);$(node).closest("li").toggleClass("current",true)};suggest.changeCurrent=function(dir){var $suggest=this.$suggest_container;var $selected=$("li.current",$suggest);var $items=$suggest.find("li");$selected.toggleClass("current",false);if(!this._popup_opened){this.suggest(this._text);return}if(!$items.length){return}if(dir>0){var $next=$selected.nextAll("li:first");if($selected.length===0){$("li:first",$suggest).addClass("current");this.$input.val(this.getText(0))}else if($next.length===0){this.$input.val(this._suggest_text)}else{$next.addClass("current");this.$input.val(this.getText($items.index($selected)+1))}}else{var $prev=$selected.prevAll("li:first");if($selected.length===0){var $item=$("li:last",$suggest).addClass("current");this.$input.val(this.getText($items.index($item)))}else if($prev.length===0){this.$input.val(this._suggest_text)}else{$prev.addClass("current");this.$input.val(this.getText($items.index($selected)-1))}}this.scrollCurrentIntoView()};suggest.getCached=function(index){var text=this._suggest_text;if(this._data.has(text)){var items=this._data.getSync(text);var label_key=this.label_key;for(var i=0,pos=0;i<items.length;i++){var item=items[i];if(item[label_key]){if(pos===index){return item}pos++}}}return{}};suggest.getText=function(index){var cached=this.getCached(index);if(cached[this.label_key]){return cached[this.label_key]}return""};suggest.selectItem=function($item){var $suggest=this.$suggest_container;if(!$suggest){$item=$("")}$item=$item||$suggest.find("li.current");var $input=this.$input;var text;var success=false;this._selected=null;if($item.length===0){text=$input.val();this._selected=this._getInputValue()}else{var index=$suggest.find("li").index($item);text=this.getText(index);$input.val(text);this._selected=this.getCached(index);success=!!text}this._text=text;this.popup.trigger("close");this.trigger("selected",this._selected);return success};suggest.getCurrentValue=function(){return this._selected||this._getInputValue()};suggest._getInputValue=function(){var text=this.$input.val();return this._selected||{label:text}};suggest.showLoader=function(){if(this.$loader){this.$loader.toggleClass("loader_new__show",true)}};suggest.hideLoader=function(){if(this.$loader){this.$loader.toggleClass("loader_new__show",false)}};suggest.scrollCurrentIntoView=function(){var dy=3;var $current=this.$suggest_container.find("li.current");if(!!$current.length){var wrapper=this.$popup_wrapper[0];var top=wrapper.scrollTop+dy;var height=this.$popup_wrapper.outerHeight();var bottom=top+height;var cur_top=wrapper.scrollTop+$current.position().top;var cur_height=$current.outerHeight();var cur_bottom=cur_top+cur_height;if(cur_bottom>bottom){wrapper.scrollTop=cur_bottom-height-dy}if(cur_top<top){wrapper.scrollTop=cur_top-dy}}};suggest._isReady=function(){return!!this.$suggest_container};nb.define("suggest",suggest)})(jQuery,document);(function($){var ds=function(){};ds.prototype.init=function(options){this.options=options;this.cache={};return this};ds.prototype.has=function(key){return key.toLowerCase()in this.cache};ds.prototype.get=function(req){};ds.prototype.getSync=function(key){return this.cache[key.toLowerCase()]};ds.prototype.prepareData=function(data){return data};var ajaxDS=function(){};nb.inherit(ajaxDS,ds);ajaxDS.prototype.init=function(options){ds.prototype.init.call(this,options);this._requests={};this.url=options.url;this.retry_count=typeof options.retry_count==="undefined"?3:+options.retry_count;this.max_items=options.max_items;this.timeout=options.timeout;this.dataType=options.dataType||"jsonp";return this};ajaxDS.prototype.get=function(req){var query=req.key.toLowerCase();if(!(query in this._requests)){this._createRequest(req)}this._requests[query].retry()};ajaxDS.prototype.createRequestData=function(text){var query={};query[this.options.query_param_name]=text;query[this.options.max_param_name]=this.max_items;return nb.extend({},this.options.default_params,query)};ajaxDS.prototype._createRequest=function(req){var that=this;var query=req.key.toLowerCase();if(query in this._requests){return}var request={retries_left:this.retry_count,retry:null};request.retry=function(){if(request.retries_left===0){req.onfail();delete that._requests[query];return}req.onstart();var params=that.createRequestData(query);$.ajax({url:that.url,type:"GET",data:params,dataType:that.dataType,success:function(data){var parsed_data=that.prepareData(data,!params.q);that.cache[query]=parsed_data;req.onsuccess(parsed_data)},error:function(){request.retry()},timeout:that.timeout});request.retries_left--};this._requests[query]=request};var arrayDS=function(){};nb.inherit(arrayDS,ds);arrayDS.prototype.init=function(options){ds.prototype.init.call(this,options);this._keys=null;this.key_name=options.key;this.ar=this.prepareData(options.data);return this};arrayDS.prototype.prepareData=function(ar){ar=ar.slice(0);return ar};arrayDS.prototype.get=function(req){var found=[];var ar=this.ar;var keys=this._keys;var key_name=this.key_name;var query=req.key.toLowerCase();var item;var key;var i;req.onstart();if(query in this.cache){req.onsuccess(this.cache[query]);return}if(keys){for(i=0;i<keys.length;i++){item=ar[i];key=keys[i];if(match(key,query)){found.push(item)}}}else{keys=this._keys=[];for(i=0;i<ar.length;i++){item=ar[i];key=keys[i]=(""+item[key_name]).toLowerCase();if(match(key,query)){found.push(item)}}}this.cache[query]=found;req.onsuccess(found);return;function match(key,query){return key.indexOf(query)>=0}};nb.suggest={};nb.suggest.ds=ds;nb.suggest.ajaxDS=ajaxDS;nb.suggest.arrayDS=arrayDS})(jQuery);(function(){var _id=0;var node2error={};var fieldErrorDefaults={isError:true,errorClass:"is-wrong",buttons:"",ok:function(){},retry:function(){},cancel:function(){}};var popupDefaultOptions={how:{dir:"right"}};var findParentPopup=function(node){var parent=$(node).parentsUntil(".popup-holder","[data-nb]").last()[0];if(parent){parent=nb.block(parent);if(parent._type==="popup"){return parent}}return null};nb.define("field-error",{showFor:function(element,options,context){this.context=context;this.options=no.extend({},fieldErrorDefaults,options);if(element&&$(element).is(":visible")){this.element=element;this.$element=$(element);this.elementId=this._getNodeId(this.element)}if(this.element){this._showPopupForElement()}else{this._showModalPopup()}if(this.options.isError){this._highlight()}if(this.options.focus){this._focusOnElement()}},cancel:function(){if(this.popup){this.popup.trigger("close")}else{this.destroy()}},_getNodeId:function(node){var id=node.getAttribute("id");if(!id){id="ph-"+_id++;node.setAttribute("id",id)}return id},_highlight:function(){if(this.$element){this.$element.toggleClass(this.options.errorClass,true)}},_focusOnElement:function(){if(this.$element){this.$element.focus()}},_showPopupForElement:function(){var that=this;var data=this._getPopupData();var okClicked=false;var popupNode=$(ns.tmpl(data,"error-popup")).appendTo(document.body)[0];var popup=this.popup=nb.block(popupNode,{click:function(){okClicked=true;that.options.ok();that._focusOnElement();popup.trigger("close");return false},close:function(){if(!okClicked){that.options.cancel()}that.destroy()}});var popupOptions=no.extend({where:this.element},popupDefaultOptions,this.options.popup);var id=this.elementId;if(node2error[id]){node2error[id].destroy()}node2error[id]=this;this.popup.trigger("toggle",popupOptions);var closeError=function(){if(that.popup){that.popup.trigger("close")}};this.$element.bind("click.error",function(){$(popupNode).trigger("click");return false}).bind("input.error",closeError).bind("keydown.error",closeError);var parentPopup=findParentPopup(this.element);if(parentPopup){parentPopup.on("popup-before-close",closeError)}},_showModalPopup:function(){var that=this;var data=this._getPopupData();var okClicked=false;var cancelClicked=false;var popupNode=$(ns.tmpl(data,"error-ballon")).appendTo(document.body)[0];var ok=function(){okClicked=true;popup.trigger("close");ph.actions.restorePage(that.context).done(function(){that.options.ok()})};var popup=this.popup=nb.block(popupNode,{click:function(evt){if($(evt.target).closest(".js-error-close").length){return}if(data.buttons){return}ok();return false},"click .js-ok":function(){ok();return false},"click .js-cancel":function(){cancelClicked=true;that.options.cancel();popup.trigger("close");return false},"popup-before-close":function(){if(!okClicked&&!cancelClicked){that.options.cancel()}that.destroy()}});popup.ignoreEsc=true;ph.errors.addItem(popup)},_getPopupData:function(){var data=this.options.data;var message=ph.utils.render(data,this.options.messageId);ns.assert(message,"field-error","error message must be set");var title=ph.utils.render(data,this.options.titleId);return no.extend({title:title,message:message,buttons:this.options.buttons},data)},destroy:function(){if(this._destroyed){return}this._destroyed=true;if(this.popup){this.popup.trigger("ph-destroy");this.popup.destroy();ns.removeNode(this.popup.node);this.popup=null}if(this.$element){this.$element.unbind(".error");this.$element.removeClass(this.options.errorClass);this.$element=null;if(node2error[this.elementId]===this){node2error[this.elementId]=null}}if(this.context){this.context.destroy()}nb.Block.prototype.destroy.call(this)}})})();nb.define("textarea-autoheight",{events:{init:"onInit",input:"updateHeight"},onInit:function(){var that=this;this.$node=$(this.node);setTimeout(function(){that.updateHeight()},0);this.setMaxHeight()},setMaxHeight:function(){var minimalExpandHeight=100;var windowPartHeight=$(window).height()*2/3;var expandHeight=windowPartHeight<minimalExpandHeight?minimalExpandHeight:windowPartHeight;this.$node.css({"max-height":expandHeight,overflow:"hidden"})},updateHeight:function(){this.$node.height(0).height(this.node.scrollHeight)}});(function(){var copyStyle=function($from,prop,dest){var _value=$from.css(prop);if(_value){dest[prop]=_value}};var block={};block.events={init:"onInit","click .nb-text":"onTextClick","click .nb-text-edit":"onPencilClick","blur .nb-editable-text__value-new":"onBlur","ph-page-leave":"onBlur"};block.onInit=function(){this._classes={empty:"nb-editable-text__empty-value"};this._nodes={$value:$(".nb-text",this.node),$editor:$(".field",this.node),$newValue:$(".nb-editable-text__value-new",this.node),newValue:$(".nb-editable-text__value-new",this.node)[0]};var _style={};copyStyle(this._nodes.$value,"line-height",_style);copyStyle(this._nodes.$value,"font-size",_style);this._nodes.$editor.css({"line-height":_style["line-height"],padding:_style["padding"]});this._nodes.$newValue.css({"line-height":_style["line-height"],"font-size":_style["font-size"]});this._new_value=nb.block(this._nodes.newValue);this._rawValue=ns.deentityify(this._nodes.$newValue.val());this._emptyText=this.nbdata()["edit"].emptyText;this._editEmpty=this.nbdata()["edit"].editEmpty;this._nowrap=!!this.nbdata()["edit"].nowrap;this._mode=null;this.setViewMode()};block.resetValue=function(value){this._rawValue=value};block.onTextClick=function(){this.startEdit(null,false);return false};block.onPencilClick=function(){this.startEdit(null,true);return false};block.startEdit=function(value,viaPencil){this._mode="edit";this._nodes.$value.toggleClass(this._classes.empty,false);this._nodes.$value.toggleClass("is-hidden",true);this._nodes.$editor.toggleClass("is-hidden",false);this.trigger("nb-text-edit",viaPencil);this._nodes.$newValue.val(value||this._rawValue||(this._editEmpty?this._emptyText:"")).focus();this._new_value.updateHeight();ph.utils.moveCaretToEnd(this._nodes.newValue)};block.setViewMode=function(saved){this._mode="view";this._nodes.$editor.toggleClass("is-hidden",true);var displayValue=ns.entityify(this._rawValue||this._emptyText);if(!this._nowrap){displayValue=ph.utils.nl2br(displayValue)}this._nodes.$value.html(displayValue);this._nodes.$value.toggleClass(this._classes.empty,this._rawValue.length===0);this._nodes.$value.toggleClass("is-hidden",false);this.trigger("nb-text-edit-end",saved)};block.onBlur=function(){if(this._mode==="edit"){this.save()}$("body").focus()};block.save=function(viaKeyboard){var newValue=$.trim(this._nodes.$newValue.val());var changed=this._rawValue!==newValue;this._rawValue=newValue;this.setViewMode();if(changed){this.trigger("save",{value:newValue,viaKeyboard:viaKeyboard})}return false};block.cancelEdit=function(){if(this._mode==="edit"){this.setViewMode(false)}};block.onPressEnter=function(){this.save(true)};nb.define("editable-text",block);ph.keyboard.registerBlock("editable-text",{enter:{method:"onPressEnter",last:true,selector:".nb-editable-text__value-new"},esc:{method:"cancelEdit",last:true,selector:".nb-editable-text__value-new"}})})();(function(){nb.define("editable-tags",{events:{init:"onInit","click .js-editable-tags-view":"onTagsViewClick","click .js-editable-tags-edit-pencil":"onTagsPencilClick","click .js-editable-tags-edit-link":"onTagsLinkClick","blur .js-editable-tags-input":"onBlur","ph-page-leave":"onPageLeave"},onInit:function(){this._class={editable:"editable-tags_edit"};this._nodes={$input:$(".js-editable-tags-input",this.node),input:$(".js-editable-tags-input",this.node)[0]};this._valueOld=this._nodes.$input.val();this._mode="view"},onTagsViewClick:function(evt){if(evt&&$(evt.target).hasClass("js-tag")){return}this.startEdit();this.metrikaCounter(["tags","start edit","on field"]);return false},onTagsPencilClick:function(){this.startEdit();this.metrikaCounter(["tags","start edit","on pencil"]);return false},onTagsLinkClick:function(){this.startEdit();this.metrikaCounter(["tags","start edit","on link"]);return false},startEdit:function(){this.trigger("nb-tags-edit-start");this._setModeEdit();this.$inputBlock=nb.block(this._nodes.$input[0]);this.$inputBlock.updateHeight()},startSave:function(viaKeyboard){if(this._mode==="edit"){this._setModeView();var newValue=this._nodes.$input.val().trim();var oldValue=this._valueOld.trim();
if(newValue!==oldValue){this.trigger("nb-tags-save",{value:newValue});this.metrikaCounter(["tags","save edit",viaKeyboard?"keyboard":"click"])}}},cancelEdit:function(){this._setModeView();this._nodes.$input.val(this._valueOld);this.trigger("nb-tags-edit-end");this.metrikaCounter(["tags","cancel edit"])},_setModeEdit:function(){this._mode="edit";$(this.node).toggleClass(this._class.editable,true);this._nodes.$input.focus();ph.utils.moveCaretToEnd(this._nodes.input)},_setModeView:function(){this._mode="view";$(this.node).toggleClass(this._class.editable,false);$("body").focus()},onBlur:function(){this.startSave()},onPageLeave:function(){this.startSave()},onPressEnter:function(){this.startSave(true)},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])});ph.keyboard.registerBlock("editable-tags",{enter:{method:"onPressEnter",last:true,selector:".js-editable-tags-input"},esc:{method:"cancelEdit",last:true,selector:".js-editable-tags-input"}})})();(function(){var utils=ph.utils;var block={};block.events={init:"onInit","click .collapse-text__expander":"onToggle"};block.onInit=function(){var data=this.nbdata();this._classes={main:"collapse-text",collapsed:"collapse-text_collapsed",expanded:"collapse-text_expanded"};var $node=$(this.node);this._nodes={$node:$node,$text:$node.is(".nb-text")?$node:$node.find(".nb-text"),$expander:$(".collapse-text__expander",this.node)};var _rows=data["collapse"]["rows"];this._always=data["collapse"]["always"];var _lineHeight=data["line-height"]||utils.cssValue(this._nodes.$text,"line-height");var _paddingTop=utils.cssValue(this._nodes.$text,"padding-top");var _paddingBottom=utils.cssValue(this._nodes.$text,"padding-bottom");this._textMaxHeight=_rows*_lineHeight;this._paddings=_paddingTop+_paddingBottom;this.enable(true)};block.collapse=function(){this._toggle(true)};block.expand=function(){this._toggle(false)};block.onToggle=function(){this._toggle();return false};block.enable=function(tryCollapse){this._nodes.$node.toggleClass(this._classes.main,true);var needCollapse=this._always||this._nodes.$text.outerHeight(true)-this._paddings>this._textMaxHeight;if(needCollapse){this._nodes.$expander.removeClass("is-hidden")}var collapse=tryCollapse&&needCollapse||this._nodes.$node.hasClass(this._classes.collapsed);this._toggle(collapse)};block.disable=function(){this._nodes.$node.toggleClass(this._classes.main,false);this._nodes.$text.css("max-height","none");this._nodes.$expander.toggleClass("is-hidden",true)};block._toggle=function(collapse){if(typeof collapse==="undefined"){collapse=!this._nodes.$node.hasClass(this._classes.collapsed)}if(this._collapsed===collapse){return}this._collapsed=collapse;this._nodes.$node.toggleClass(this._classes.collapsed,collapse);this._nodes.$node.toggleClass(this._classes.expanded,!collapse);this._nodes.$text.css("max-height",collapse?this._textMaxHeight:"none");this.trigger(collapse?"collapsed":"expanded")};nb.define("collapse-text",block)})();nb.define("two-faced-button",{events:{init:function(){this._nodes={$label:$(".js-nb-label",this.node)};this._labels=this.nbdata()["labels"];var defaultMode=this.nbdata()["default-mode"];if(defaultMode){this.setMode(defaultMode)}}},setMode:function(mode){var label=this._labels[mode];if(!label){throw"[two-faced-button] unknown mode "+mode}this._nodes.$label.html(label)}});nb.define("button-group",{events:{init:"onInit","click .js-button:not(.is-checked)":"setAsCurrent","change .js-select":"setAsCurrent"},onInit:function(){this._classes={current:"is-checked",item:"js-button",button:"js-button",select:"js-select"};this.$node=$(this.node)},getValue:function(){var $current=this.$node.find("."+this._classes.current);var $select=$current.find("select");var value=$select.val()||$current.data("val");return value},selectFirst:function(){this.$node.find("."+this._classes.item+":first").trigger("click").focus()},setValue:function(value){var $itemToSelect=this.$node.find("."+this._classes.item+'[data-val="'+value+'"]');if($itemToSelect){this._clearCurrent();$itemToSelect.toggleClass(this._classes.current,true)}else{this.selectFirst()}},setAsCurrent:function(evt){var $item=$(evt.target).closest("."+this._classes.item);var $select=$item.find("select");var _value;this._clearCurrent();if($select.length){_value=$select.val()}else{_value=$item.data("val");this.$node.find("select").val("")}if(_value){$item.toggleClass(this._classes.current,true)}this.trigger("selected",_value)},_clearCurrent:function(){$("."+this._classes.item,this.$node).removeClass(this._classes.current)}});(function(){var base={getOptions:function(){return{tail_selector:".popup-tail",tail_width:12,tail_offset:8}},onInit:function(){var that=this;this._onResize=function(){that.trigger("move")}},onClickClose:function(){this.trigger("close");return false},show:function(){var that=this;var $node=$(this.node);$node.removeClass("_hidden");setTimeout(function(){$node.addClass("_show");that.trigger("ph-show-end")},10);this.trigger("show")},hide:function(){$(this.node).addClass("_hidden").removeClass("_show");this.trigger("hide")}};nb.define("islands-popup",no.extend(base,{events:{init:"onInit",open:"onOpen",close:"onClose","click .js-close":"onClickClose"},onOpen:function(){nb.on("ph-resize",this._onResize)},onClose:function(){nb.off("ph-resize",this._onResize)}}),"popup");nb.define("islands-ballon",no.extend(base,{events:{init:"onInit",open:"onOpen",close:"onClose","click .js-close":"onClickClose"},onOpen:function(){nb.on("ph-resize",this._onResize)},onClose:function(){nb.off("ph-resize",this._onResize)}}),"ballon");nb.define("islands-modal-popup",no.extend(base,{events:{"click .js-close":"onClickClose"}}),"modal")})();(function(){var GeoSuggestDataSource=function(map){this.map=map};nb.inherit(GeoSuggestDataSource,nb.suggest.ajaxDS);GeoSuggestDataSource.prototype.init=function(){nb.suggest.ajaxDS.prototype.init.call(this,{url:"http://suggest-maps.yandex.ru/suggest-geo",max_items:10,max_param_name:"n",query_param_name:"part",default_params:{v:5,search_type:"tp",highlight:0}});return this};GeoSuggestDataSource.prototype.prepareData=function(data){return data[1].map(function(item){var type=item[0];var name=item[1];var fullName=type==="geo"?item[2]:name;return{name:name,fullName:fullName}})};GeoSuggestDataSource.prototype.createRequestData=function(text){var data=nb.suggest.ajaxDS.prototype.createRequestData.call(this,text);var b=this.map.getBounds();var c=this.map.getCenter();var spn1=Math.abs((b[1][1]-b[0][1]).toFixed(6));var spn2=Math.abs((b[1][0]-b[0][0]).toFixed(6));if(spn1<1e-6){spn1=360}data["spn"]=[spn1,spn2].join(",");data["ll"]=[c[1].toFixed(6),c[0].toFixed(6)].join(",");return data};nb.suggest.GeoSuggestDataSource=GeoSuggestDataSource})();(function(){var mapTypes={schema:"yandex#map",satellite:"yandex#satellite",hybrid:"yandex#hybrid"};var fotkiMapTypes={schema:"schema","yandex#map":"schema","yandex#satellite":"satellite","yandex#hybrid":"hybrid"};nb.define("map",{events:{init:"oninit","click .js-save:not(.is-disabled)":"onSave","click .js-modify":"startEdit","click .js-cancel":"cancel","click .js-map-remove:not(.is-disabled)":"removeMarker","dblclick .js-location":"panToMarker","ph-map-click":"moveMarker"},oninit:function(){var that=this;this._mark=null;this._fixedMark=null;this.ready=new no.Promise;this._nodes={location:$(".js-location",this.node)[0],$location:$(".js-location",this.node),$save:$(".js-save",this.node),$remove:$(".js-map-remove",this.node),modify:$(".js-modify",this.node)[0]};this.canEdit=!!this._nodes.modify;ph.loadModule("map").done(function(){that.init()})},init:function(){var that=this;var map=this.map=new ymaps.Map($(".map-container",this.node)[0],{center:[55.76,37.64],zoom:7,behaviors:["drag","dblClickZoom","multiTouch","scrollZoom"]});var topOffset=this.canEdit?49:0;var typeSelector=new ymaps.control.TypeSelector({mapTypes:["yandex#map","yandex#satellite","yandex#hybrid"]});map.controls.add(typeSelector,{top:8+topOffset,right:8});var zoomControl=new ymaps.control.SmallZoomControl;map.controls.add(zoomControl,{top:43+topOffset,right:8});if(this.canEdit){this.modifyButton=nb.block(this._nodes.modify);this._handleMapClick();var ds=new nb.suggest.GeoSuggestDataSource(this.map).init();var suggest=this.suggest=nb.block(this._nodes.location);suggest.setDataSource(ds);suggest.on("selected",this.onItemSelected.bind(this));this._updateButtons()}map.events.add("typechange",function(){that.metrikaCounter(["map","change layer",that.getMapType()])});zoomControl.events.add("zoomchange",function(evt){that.metrikaCounter(["map","scale",evt.get("newZoom")>evt.get("oldZoom")?"+":"-"])});that.ready.resolve()},setMarker:function(point,options){var mark=this._createMarker([point.lat,point.lon]);return this._setMarker(mark,options)},startEdit:function(){this.setEditMode();this.panToMarker();this.count("start edit")},setViewMode:function(){this.$node.toggleClass("map_view",true);this.$node.toggleClass("map_edit",false);if(this._mark){this._mark.options.set("draggable",false)}},setEditMode:function(){if(this.isEditMode()){return}this.$node.toggleClass("map_view",false);this.$node.toggleClass("map_edit",true);this._nodes.$location.focus();if(this._mark){this._mark.options.set("draggable",true)}this.count("show in edit mode")},isEditMode:function(){return this.$node.hasClass("map_edit")},moveMarker:function(evt,coords){var mark=this._createMarker(coords);this.count(this.hasMarker()?"move pin":"drop pin");this._setMarker(mark,{pan:true})},hasMarker:function(){return!!this._mark},onSave:function(){this.count("save");if(!this._mark){this._setMarkerFor(this.suggest.getCurrentValue())}this._triggerMapSave();return false},cancel:function(){this._resetMarker();this._clearSuggest();this.setViewMode();if(this._error){var error=this._error;this._error=null;error.cancel()}},onItemSelected:function(evt,selected){this._setMarkerFor(selected,{zoom:16});this.count("choose suggest")},redraw:function(){this.map.container.fitToViewport()},removeMarker:function(){this._removeMarker();this._clearSuggest();this.count("remove location")},panToMarker:function(){if(!this._mark){return}this.map.panTo(this._mark.geometry.getCoordinates(),{delay:0,flying:false})},fixState:function(){this._fixedMark=this._mark;this._fixedCoords=this._fixedMark?this._fixedMark.geometry.getCoordinates():null;this._updateButtons()},showError:function(options,data){var that=this;var mapNode=this.node;var details=data.details;var context=details.context;var oldData=details.oldData;var newData=details.newData;var isMapVisible=this.$node.is(":visible");var errorOptions=no.extend(options,{ok:function(){that.setEditMode();if(!isMapVisible){data.showPopup()}that._resetState(oldData);if(newData){that.setMarker({lat:newData.lat,lon:newData.lon},{mapType:newData.mapType,zoom:newData.zoom})}else if(that._fixedMark){that._setMarker(that._fixedMark)}},cancel:function(){that._resetState(oldData);that.cancel()}});if(isMapVisible){errorOptions.element=$(".js-modify:visible",mapNode)[0];errorOptions.popup={how:{where:"bottom right",what:"top right"}}}this._error=ph.errors.showError(context,errorOptions);this._error.on("ph-destroy",function(){this._error=null})},getMapType:function(){return fotkiMapTypes[this.map.getType()]||fotkiMapTypes.schema},_clearSuggest:function(){if(this.suggest){this.suggest.clear()}},_triggerMapSave:function(){var map=this.map;var mark=this._mark;var data=null;if(mark){var coords=mark.geometry.getCoordinates();data={lat:coords[0],lon:coords[1],mapType:this.getMapType(),zoom:map.getZoom()}}this.fixState();this.panToMarker();this.setViewMode();this.trigger("ph-map-save",data)},_resetState:function(data){if(this._mark){this._removeMarker();this._mark=null}if(data){var mark=this._createMarker([data.lat,data.lon]);this._setMarker(mark)}this.fixState()},_resetMarker:function(){if(this._fixedMark){this._fixedMark.geometry.setCoordinates(this._fixedCoords);if(this._mark!==this._fixedMark){this._setMarker(this._fixedMark)}}else{this._removeMarker()}},_setMarkerFor:function(item,options){var that=this;var address=item.fullName||item.label;var promise=this._geocode(address);promise.done(function(geoObject){var mark=that._createMarker(geoObject.geometry.getCoordinates());that._setMarker(mark,options)});promise.fail(function(){that._removeMarker()})},_createMarker:function(coords){var that=this;var placemark=new ymaps.Placemark(coords,{},{draggable:this.isEditMode(),preset:"twirl#photographerIcon"});placemark.events.add("dragstart",function(){that._clearSuggest()});placemark.events.add("dragend",function(){that._updateButtons();that.count("drag & drop pin")});return placemark},_setMarker:function(mark,options){var promise=new no.Promise;options=options||{};this._removeMarker();this._mark=mark;this.map.geoObjects.add(mark);if(options.mapType){this.map.setType(mapTypes[options.mapType||"schema"])}if(options.zoom){this.map.setCenter(mark.geometry.getCoordinates(),options.zoom||16,{callback:function(){promise.resolve()},checkZoomRange:true})}else{if(options.pan){this.map.panTo(this._mark.geometry.getCoordinates(),{delay:0,flying:false})}else{this.map.setCenter(mark.geometry.getCoordinates())}}this._updateButtons();return promise},_removeMarker:function(){if(!this._mark){return}this.map.geoObjects.remove(this._mark);this._mark=null;this._updateButtons()},_geocode:function(query){var promise=new no.Promise;ymaps.geocode(query).then(function(found){var l=found.geoObjects.getLength();if(l===0){promise.reject("not found");return}promise.resolve(found.geoObjects.get(0))},function(){promise.reject("error")});return promise},_toggleButton:function($button,enabled){$button.toggleClass("is-disabled",!enabled)},_handleMapClick:function(){var that=this;var map=this.map;var delay=300;map.events.add("click",function(evt){if(that._mapActive||that._addTimer||!that.isEditMode()){return}that._addTimer=setTimeout(function(){var coords=evt.get("coords");that.trigger("ph-map-click",coords);that._addTimer=null},delay)});map.events.add("actionbegin",function(){if(that._addTimer){clearTimeout(that._addTimer);that._addTimer=null}that._mapActive=true});map.events.add("actionend",function(){that._mapActive=false});map.events.add("actionbreak",function(){that._mapActive=false})},_updateButtons:function(){if(!this.canEdit){return}var markCoords=this._mark?this._mark.geometry.getCoordinates():null;var changed=this._mark!==this._fixedMark||markCoords!==this._fixedCoords;var binded=!!this._mark;this._toggleButton(this._nodes.$save,changed);this._toggleButton(this._nodes.$remove,binded);this.modifyButton.setMode(binded?"edit":"add")},count:function(){var defaultOptions=["map",this._fixedMark?"change location":"set location",ph.metrika.mode()];var options=Array.prototype.slice.call(arguments,0);this.metrikaCounter(defaultOptions.concat(options))},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])})})();nb.define("copy-to-clipboard",{events:{init:"onInit",copied:"onCopyDone"},onInit:function(){var that=this;this.$node=$(this.node);ph.loadModule("clipboard").done(function(){that.$node.removeClass("is-hidden");that._init()})},onCopyDone:function(){this.$node.focus();this.trigger("saved")},_init:function(){ph.clipboard.glue(this.node);ph.clipboard.on("mouseOver",function(){var text=$(this).attr("data-clipboard-text");ph.clipboard.setText(text)})},setData:function(data){this.$node.attr("data-clipboard-text",data)}});(function(){nb.define("blog-code",{events:{init:"onInit","change .js-add-name":"onChangeAddName","change .js-select":"onChangeSize","click .js-code":"selectCode"},onInit:function(){var that=this;this._nodes={$addName:$(".js-add-name",this.node),code:$(".js-code",this.node)[0],$code:$(".js-code",this.node),select:$(".js-select",this.node)[0],$select:$(".js-select",this.node),save:$(".js-save-code",this.node)[0],$save:$(".js-save-code",this.node)};this.format=nb.block($(".js-format",this.node)[0]);this.format.on("selected",function(evt,value){if(!value){this.selectFirst()}else{that.updateCode();that.savePref("format",value);that.metrikaCounter(["choose type",value])}});this._code={};this._clipboard=nb.block(this._nodes.save);this._clipboard.on("saved",function(){that.trigger("saved")});if(!navigator.userAgent.match(/(iPod|iPhone|iPad)/)){this._nodes.$code.prop("readonly",true)}},onChangeAddName:function(){var addName=this._nodes.$addName.is(":checked");this.savePref("addName",addName);this.updateCode();this.metrikaCounter([addName?"include name":"exclude name"])},onChangeSize:function(){var size=this._nodes.$select.val();this.savePref("size",size);this.updateCode();this.metrikaCounter(["choose size",size])},applyPrefs:function(){var that=this;var settings=this._getSettings();var controller=ph.controllers.user;for(var pref in settings){if(settings.hasOwnProperty(pref)){controller.getLocalPref("blog-code-"+pref).done(function(value){if(typeof value==="undefined"){return}switch(pref){case"format":that.format.setValue(value);break;case"size":that._nodes.$select.val(value);break;case"addName":that._nodes.$addName.prop("checked",value);break}})}}},savePref:function(name,value){if(!name||typeof value==="undefined"){return}var controller=ph.controllers.user;return controller.setLocalPref("blog-code-"+name,value)},selectCode:function(){this._nodes.$code.focus().select()},setPhoto:function(photo){this._photo=photo;this._pageUrl=ph.utils.getShareLinkBlogCode(photo.getData());this.updateCode()},updateCode:function(){var code=this.getCode();this._nodes.$code.val(code);this._clipboard.setData(code)},getCode:function(){var settings=this._getSettings();var key=this._hash(settings);return this._code[key]||(this._code[key]=this._generateCode(settings))},reset:function(){this._code={}},_generateCode:function(settings){var data={photo:this._photo.getData(),settings:settings,pageUrl:this._pageUrl};return ph.utils.render(data,"blog-code-generate")},_getSettings:function(){return{size:this._nodes.$select.val(),addName:this._nodes.$addName.is(":checked"),format:this.format.getValue()}},_hash:function(settings){return[settings.size,settings.format,settings.addName?1:0].join(":")},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer","code for blog"])})})();(function(){nb.define("complain",{events:{init:"onInit","click .js-button-send":"onClickButtonSend","click .js-send-one-more":"onClickButtonSendOneMore","change .toggler-controller":"_onChangeForm","change .js-copyright .toggler-controller":"_onChangeCopyright","change .js-other .toggler-controller":"_onChangeOther","input .js-link-to-origin":"_onChangeForm","input .js-matter":"_onChangeForm"},onInit:function(){var that=this;this._popup=nb.block($(this.node).closest(".js-complain-popup")[0]);this._class={disabled:"is-disabled",hidden:"is-hidden"};this._nodes={$form:$(".complain-form_new",this.node),$inputLinkToOrigin:$(".js-link-to-origin",this.node),$inputMatter:$(".js-matter",this.node),$buttonSend:$(".js-button-send",this.node),$result:$(".complain-form_sent",this.node),$buttonSendNew:$(".js-send-one-more",this.node),$errorSend:$(".js-error-send",this.node),$errorExist:$(".js-error-exist",this.node)};this._checkboxes={$all:$(".toggler-controller",this.node),$copyright:$(".js-copyright .toggler-controller",this.node),$contest:$(".js-contest .toggler-controller",this.node),$porn:$(".js-pron .toggler-controller",this.node),$violence:$(".js-violence .toggler-controller",this.node),$spam:$(".js-spam .toggler-controller",this.node),$other:$(".js-other .toggler-controller",this.node)};this._inputs={$all:$(".input",this.node),$linkToOrigin:$(".js-link-to-origin .input",this.node),$matter:$(".js-matter .input",this.node)};var _computeMaxHeight=function(){var $node=$(that.node);var maxHeight=$node.offset().top+$node.height();$node.css({"max-height":maxHeight})};_computeMaxHeight();that._popup.trigger("move");nb.on("ph-resize",_computeMaxHeight);this._popup.on("close",function(){nb.off("ph-resize",_computeMaxHeight)});this._popup.on("open",function(){nb.on("ph-resize",_computeMaxHeight)})},_onChangeForm:function(){this._toggleButtonSend();this.hideErrorSend();this.hideErrorExist()},_onChangeCopyright:function(){this._nodes.$inputLinkToOrigin.toggleClass(this._class.hidden,!this._checkboxes.$copyright.is(":checked"));this._popup.trigger("move")},_onChangeOther:function(){this._nodes.$inputMatter.toggleClass(this._class.hidden,!this._checkboxes.$other.is(":checked"));this._popup.trigger("move")},_toggleButtonSend:function(disable){var isBlankForm=!this._checkboxes.$all.is(":checked")||$.trim(this._inputs.$matter.val())===""&&this._checkboxes.$other.is(":checked")||$.trim(this._inputs.$linkToOrigin.val())===""&&this._checkboxes.$copyright.is(":checked");this._nodes.$buttonSend.toggleClass(this._class.disabled,disable||isBlankForm)},onClickButtonSend:function(){if(!this._nodes.$buttonSend.hasClass("is-disabled")){this.trigger("ph-click-send-complain")}this._toggleButtonSend(true);this.hideErrorSend();this.hideErrorExist()},onClickButtonSendOneMore:function(){this.trigger("ph-click-send-one-more")},resetForm:function(){this._checkboxes.$all.prop("checked",false);this._inputs.$all.prop("value","");this._onChangeCopyright();this._onChangeOther();this.hideErrorSend();this.hideErrorExist();this._toggleButtonSend()},showForm:function(){this._nodes.$result.addClass(this._class.hidden);this._nodes.$form.removeClass(this._class.hidden);this._popup.trigger("move")},showResult:function(){this._nodes.$form.addClass(this._class.hidden);this._nodes.$result.removeClass(this._class.hidden);this._popup.trigger("move")},showErrorSend:function(){this._nodes.$errorSend.removeClass(this._class.hidden);this._toggleButtonSend();this._popup.trigger("move")},showErrorExist:function(){this._nodes.$errorExist.removeClass(this._class.hidden);this._toggleButtonSend(true);this._popup.trigger("move")},hideErrorSend:function(){this._nodes.$errorSend.addClass(this._class.hidden);this._popup.trigger("move")},hideErrorExist:function(){this._nodes.$errorExist.addClass(this._class.hidden);this._popup.trigger("move")},getData:function(){var isCheckedCopyright=this._checkboxes.$copyright.is(":checked");var isCheckedOther=this._checkboxes.$other.is(":checked");var params={copyright:isCheckedCopyright,contest:this._checkboxes.$contest.is(":checked"),contestId:this.nbdata()["contest-id"],porn:this._checkboxes.$porn.is(":checked"),violence:this._checkboxes.$violence.is(":checked"),spam:this._checkboxes.$spam.is(":checked"),other:isCheckedOther,linkToOrigin:isCheckedCopyright?this._inputs.$linkToOrigin.val():"",matter:isCheckedOther?this._inputs.$matter.val():""};return params}})})();nb.define("progress-button",{events:{init:"onInit",click:"onClick"},onInit:function(){this.state=null;this.popup=null;this.defaultText=this.$node.html()},setPopup:function(popup){var that=this;this.popup=popup;this.popup.on("close",function(){that.popup=null})},setProgress:function(){this.state="progress";this.$node.toggleClass("progress-button_done",false);this.$node.toggleClass("progress-button_progress",true)},setDone:function(){var that=this;this.state="done";this.$node.html(this.nbdata()["completed-text"]);this.$node.toggleClass("progress-button_progress",false);this.$node.toggleClass("progress-button_done",true);if(this.popup){var $toggler=$(this.popup.toggler);if($toggler.is(":visible")){this.popup.trigger("move")}else{setTimeout(function(){that.popup.trigger("close")},1e3)}}},reset:function(){this.state=null;this.$node.html(this.defaultText);this.$node.toggleClass("progress-button_progress",false);this.$node.toggleClass("progress-button_done",false)},onClick:function(){if(this.state==="progress"||this.state==="done"){return false}}});yr.externals["ns-url"]=function(path){return ns.router.url(path)};(function(){var utils=ph.utils;var getData=function(model,default_value){return yr.nodeset2data(model)||default_value};var externals=yr.externals=yr.externals||{};externals.generateUrl=function(page,model,moreParams){var params;moreParams=moreParams||{};switch(page){case"photo":var photo=getData(model);params={"author-login":photo.author.login,"image-id":photo.imageId,"album-id":photo.albumId};if(moreParams["mode"]){params["mode"]=moreParams["mode"]}return utils.generateUrl(page,params);case"user-profile":var profile=getData(model);var login=no.jpath(".user.login",profile);return utils.generateUrl("user-profile",{"author-login":login});case"commenter-profile":var commenter=getData(model);var commenterLogin=no.jpath(".login",commenter);return utils.generateUrl("user-profile",{"author-login":commenterLogin});case"album":var album=getData(model);params={"author-login":album.author.login,"album-id":album.albumId};return utils.generateUrl(page,params);case"user-tag":var tag=getData(model);params={"author-login":moreParams["author-login"],tag:tag.name};return utils.generateUrl("user-tag",params);case"contest":var contest=getData(model);params={"contest-id":contest&&contest.contestId||moreParams.id};return utils.generateUrl(page,params);case"calendar":var data=getData(model);params={date:window.moment(data.date).format("YYYY-MM")};return utils.generateUrl(page,params);default:return utils.generateUrl(page,{})}};externals.generateUrlFull=function(page,model,moreParams){return ph.utils.fullUrl(externals.generateUrl(page,model,moreParams))};externals.generateDeanimatedUrl=function(url){var breakSymbol="_";var head=url.split(breakSymbol);var tail=head.pop();head.push("GIF"+tail);return head.join(breakSymbol)};externals.getAvatarUrl=function(uid){return ph.utils.getAvatarUrl(uid)};externals.formatDate=function(milliseconds,format){return window.moment(milliseconds).format(format)};externals.formatDateRelative=function(milliseconds){return ph.utils.formatDateRelative(milliseconds)};externals.formatDateWithTZ=function(dateString,format){return window.moment(dateString).zone(dateString).format(format)};externals.nl2br=function(str){return ph.utils.nl2br(str)};externals.countReplies=function(list,id){var counter=0;var countChildren=function(list,id){$.each(list,function(index,element){if(element.data.parentId===id){counter+=1;countChildren(list,element.data.id)}})};countChildren(list,id);return counter};externals.plural=function(num,f0,f1,f3,f5){return ph.utils.plural(num,f0,f1,f3,f5)};externals.getMedals=function(more){return utils.groupMedals(getData(more))};externals.number=function(str){return parseInt(str,10)};externals.sum=function(nodeset){var sum=0;nodeset.forEach(function(element){sum+=element.data});return sum};externals.isCurrentUserAdult=function(uid){return ph.allow18plus(uid)};externals.length=function(str){return(getData(str)||"").length};externals.strlen=function(str){return(str||"").length};externals.has=function(ar,value){var data=getData(ar)||[];var _ar=Array.isArray(data)?data:[data];return _ar.indexOf(value)>=0};externals.split=function(str,delimiter){return(str||"").split(delimiter)};externals.filterDifferentSizes=function(photo){var data=getData(photo);if(!data.sizes){return[]}var sizes=ph.utils.sizes;var selected=[];var prev=null;for(var sizeName in sizes){var size=data.sizes[sizeName];var orig=data.sizes["orig"];var isDifferentSize=false;if(!size){continue}if(orig){isDifferentSize=!prev||orig.width>size.width&&size.width!==prev.width||orig.height>size.width&&size.height!==prev.height||sizeName==="orig"}else{isDifferentSize=!prev||size.width!==prev.width||size.height!==prev.height||sizeName==="orig"}if(isDifferentSize){selected.push(sizeName)}prev=size}return selected};externals.getClosestSize=function(photo,sizeName){return ph.utils.getClosestSize(getData(photo),sizeName)};externals.getBoxDimentions=function(){return ph.photoBox.getDimentions()};externals.__unsafeHTML=function(str){return str?ns.deentityify(str):str};externals.redirect=function(url){ns.page.go(url)};externals.reverse=function(arr){return arr.reverse()};externals.escape=function(str){return ns.entityify(str)};externals.getBackgroundUrl=function(){var url=ph.utils.getOldFotkiContextUrl(ns.page.current.params);if(url){return ph.utils.appendParams(url,{_next:1})}return""};externals.getShareLink=function(photo){var data=getData(photo);return ph.utils.getShareLink(data)};externals.isAuthor=function(photo,auth){return no.jpath(".author.uid",getData(photo))==no.jpath(".uid.value",getData(auth))};externals.null=function(){return yr.object2nodeset(null)};externals.object=function(nodeset){return getData(nodeset)};externals.canEditImageType=function(photo){var data=getData(photo);return data&&["jpg","jpeg","png"].indexOf(data.imageFormat||"jpg")>=0};externals.timestamp=function(){return+new Date};externals.getDomainFromURL=function(url){var a=document.createElement("a");a.href=url;return a.hostname};externals.breakNumber=function(number){var str=""+(number||"0");var len=str.length;var count=len%3||3;var parts=[];while(str.length){parts.push(str.substring(0,count));str=str.substring(count);count=3}return parts}})();var yr=yr||require("yate/lib/runtime.js");(function(){var cmpNN=yr.cmpNN;var cmpSN=yr.cmpSN;var nodeset2xml=yr.nodeset2xml;var nodeset2boolean=yr.nodeset2boolean;var nodeset2attrvalue=yr.nodeset2attrvalue;var nodeset2scalar=yr.nodeset2scalar;var scalar2attrvalue=yr.scalar2attrvalue;var xml2attrvalue=yr.xml2attrvalue;var scalar2xml=yr.scalar2xml;var xml2scalar=yr.xml2scalar;var simpleScalar=yr.simpleScalar;var simpleBoolean=yr.simpleBoolean;var selectNametest=yr.selectNametest;var closeAttrs=yr.closeAttrs;var M=new yr.Module;var j0=[0,"layout-params"];M.v0=function(m,c0,i0,l0){return selectNametest("layout-params",c0.doc.root,[])};var j1=[0,"models"];M.v1=function(m,c0,i0,l0){return selectNametest("models",c0.doc.root,[])};var j2=[0,"*"];var j3=[1,0];M.k0={};M.k0.n=function k0n(m,c0,i0,l0){return m.n(j2,m.v("v1",c0))};M.k0.u=function k0u(m,c0,i0,l0){return c0.name};M.k0.b=function k0b(m,c0,i0,l0,a0){return m.s(j3,c0)};M.k0.ut="scalar";M.k0.bt="nodeset";M.f0=function f0(m,c0,i0,l0,a0,v2,v3,v4,v5){var r0="";r0+=closeAttrs(a0);r0+='<label class="'+"tumbler "+scalar2attrvalue(v4)+'">';r0+="<input";a0.a={type:new yr.scalarAttr("checkbox"),"class":new yr.scalarAttr("tumbler__checkbox")};a0.s="input";if(v5){a0.a["checked"]=new yr.scalarAttr("checked")}r0+=closeAttrs(a0);r0+="";r0+='<span class="'+"tumbler__input"+'">';r0+='<span class="'+"tumbler__inner"+'">';r0+='<span class="'+"tumbler__state tumbler__state_left"+'">'+scalar2xml(v2)+"</span>";r0+='<span class="'+"tumbler__state tumbler__state_right"+'">'+scalar2xml(v3)+"</span>";r0+="</span>";r0+="</span>";r0+="</label>";return r0};var j4=[0,"item"];M.f1=function f1(m,c0,i0,l0,a0,v6){var r0="";r0+=closeAttrs(a0);var items0=m.n(j4,yr.array2nodeset(yr.externals["breakNumber"](v6)));for(var i1=0,l1=items0.length;i1<l1;i1++){var c1=items0[i1];r0+='<span class="'+"stat__item-digit"+'">'+nodeset2xml(m.s(j3,c1))+"</span>"}return r0};M.f2=function f2(m,c0,i0,l0,a0,v7,v8,v9){v8=v8===undefined?false:v8;v9=v9===undefined?false:v9;var r0="";r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("spinner-yellow spinner-yellow_size_"+v7)};a0.s="div";if(v8){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" spinner-centered")}else{a0.a["class"]=new yr.scalarAttr(" spinner-centered")}}if(v9){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" spinner-inverted")}else{a0.a["class"]=new yr.scalarAttr(" spinner-inverted")}}r0+=closeAttrs(a0);r0+='<div class="'+"spinner-yellow-circle"+'"></div>';r0+="</div>";return r0};M.f3=function f3(m,c0,i0,l0,v10){var r0=[];var r1={};var a1={a:{}};r1["enter"]="Enter";r1["esc"]="Esc";r1["left"]="←";r1["right"]="→";r1["space"]="Пробел";r1["shift"]="Shift";r1["alt"]="Alt";r1["ctrl"]="Ctrl";r1["meta"]="Meta";var v11=r1;function p0(m,c0,i0,l0){return c0.name==v10}var j5=[0,"*",2,p0];r0=m.n(j5,yr.object2nodeset(v11));return r0};M.f4=function f4(m,c0,i0,l0,v12){var r0=[];var r1={};var a1={a:{}};r1["shortcuts: show"]="Показать список клавиатурных сокращений";r1["view photo: prev"]="Предыдущая фотография";
r1["view photo: next"]="Следующая фотография";r1["view photo: like"]="Поставить фотографии отметку «Нравится»";r1["slideshow: toggle"]="Включить / выключить слайдшоу (в режиме «На всё окно»)";r1["layout: toggle"]="Включить / выключить режим «На всё окно»";r1["exif: toggle"]="Показать EXIF";var v13=r1;function p1(m,c0,i0,l0){return c0.name==v12}var j6=[0,"*",2,p1];r0=m.n(j6,yr.object2nodeset(v13));return r0};M.f5=function f5(m,c0,i0,l0,a0,v14){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"shortcut-key"+'">';r0+='<div class="'+"button-content"+'">';if(nodeset2boolean(m.f("f3",c0,i0,l0,v14))){r0+=nodeset2xml(m.f("f3",c0,i0,l0,v14))}else{r0+=scalar2xml(v14)}r0+="</div>";r0+="</div>";return r0};M.f6=function f6(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<a class="'+"link"+'" target="'+"_blank"+'" href="'+"http://legal.yandex.ru/ugc_takedown/"+'">'+"Подробности"+"</a>";return r0};M.f7=function f7(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"image__note"+'">';r0+="На этот файл поступила жалоба, доступ к нему заблокирован. ";r0+=m.f("f6",c0,i0,l0,a0);r0+="</div>";return r0};M.f8=function f8(m,c0,i0,l0,a0,v15){v15=v15===undefined?[]:v15;var r0="";r0+=closeAttrs(a0);r0+=nodeset2scalar(v15);return r0};M.f9=function f9(m,c0,i0,l0,a0,v16){v16=v16===undefined?[]:v16;var r0="";r0+=closeAttrs(a0);r0+=yr.externals["nl2br"](nodeset2scalar(v16));return r0};var j7=[];var j8=[0,"views",0,"*"];var j9=[0,"tree",0,"*"];var j10=[0,"key"];var j11=[0,"is_models_valid"];var j12=[0,"async"];var j13=[0,"placeholder"];var j14=[0,"collection"];var j15=[0,"views",0,"*"];var j16=[0,"tag"];var j17=[0,"name"];var j18=[0,"photo"];var j19=[0,"sizes",0,"all"];var j20=[0,"flags",0,"hideOriginal"];var j23=[0,"width"];var j24=[0,"height"];var j26=[0,"settings",0,"size"];var j28=[0,"settings",0,"format"];var j29=[0,"url"];var j30=[0,"imageFormat"];var j31=[0,"fileName"];var j32=[0,"title"];var j33=[0,"pageUrl"];var j34=[0,"settings",0,"addName"];var j35=[0,"referers",0,"referers",0,"referer"];var j36=[0,"day"];var j37=[0,"week"];var j38=[0,"total"];var j39=[0,"referer"];var j40=[0,"count"];var j41=[0,"referers",0,"referers",0,"referer",0,"count"];var j42=[0,"special"];function p6(m,c0,i0,l0){return simpleBoolean("special",c0)}var j43=[0,"referer",2,p6];var j45=[0,"ya"];var j46=[0,"exif"];var j47=[0,"error"];function p8(m,c0,i0,l0){return!simpleBoolean("exif",c0)&&!simpleBoolean("error",c0)}var j48=[2,p8];function p9(m,c0,i0,l0){return simpleBoolean("error",c0)}var j49=[2,p9];var j52=[0,"models",0,"photo",0,"added"];var j58=[0,"dateTimeOriginal"];var j59=[0,"added"];var j60=[0,"camera"];var j61=[0,"make"];var j62=[0,"model"];var j63=[0,"market",0,"modelId"];function p17(m,c0,i0,l0){return nodeset2boolean(m.s(j63,c0))}var j64=[0,"camera",2,p17];var j65=[0,"market",0,"hid"];var j66=[0,"market",0,"vendor"];var j67=[0,"market",0,"model"];var j68=[0,"lens"];var j69=[0,"fired"];function p18(m,c0,i0,l0){return cmpSN(1,selectNametest("fired",c0,[]))||cmpSN(0,selectNametest("fired",c0,[]))}var j70=[0,"flash",2,p18];var j71=[0,"exposureProgram"];var j74=[0,"message"];var j75=[0,"photo",0,"sizes",0,"xxs",0,"url"];var j76=[0,"buttons"];var j77=[0,"content"];var j78=[0,"overlay"];var j79=[0,"keys"];var j80=[0,"keys"];var j81=[0,"shift"];var j82=[0,"alt"];var j83=[0,"ctrl"];var j84=[0,"meta"];var j85=[0,"keyName"];var j86=[0,"actionName"];var j87=[0,"not-found"];var j88=[0,"head"];var j89=[0,"bar"];var j90=[0,"params",0,"mode"];var j91=[0,"index"];var j93=[0,"views",0,"photo-box"];var j94=[0,"views",0,"photo-ears"];var j95=[0,"views",0,"photo-flags-box"];var j96=[0,"views",0,"photo-edit-box"];var j97=[0,"views",0,"tray"];var j98=[0,"views",0,"bar"];var j99=[0,"views",0,"panel"];var j100=[0,"photo-box"];var j101=[0,"photo-image"];var j102=[0,"models",0,"photo"];var j103=[0,"errors",0,"photo",0,"name"];function p21(m,c0,i0,l0){return cmpSN("image not found",m.s(j103,c0.doc.root))}var j104=[0,"photo-image",4,p21];function p22(m,c0,i0,l0){return cmpSN("image is blocked",m.s(j103,c0.doc.root))}var j105=[0,"photo-image",4,p22];var j106=[0,"models",0,"photo-rights",0,"blockReason"];var j107=[0,"errors",0,"photo-rights",0,"name"];function p23(m,c0,i0,l0){return cmpSN("image not found",m.s(j107,c0.doc.root))}var j108=[0,"photo-image",4,p23];function p24(m,c0,i0,l0){return cmpSN("access denied",m.s(j107,c0.doc.root))||cmpSN("access denied",m.s(j103,c0.doc.root))}var j109=[0,"photo-image",4,p24];var j110=[0,"value",0,"url"];var j111=[0,"sizeName"];var j112=[0,"askAlbumPassword"];function p25(m,c0,i0,l0){return simpleBoolean("askAlbumPassword",c0)}var j113=[0,"photo",2,p25];var j115=[0,"flags",0,"lostInStorage"];function p26(m,c0,i0,l0){return cmpSN(1,m.s(j115,c0))}var j116=[0,"photo",2,p26];var j117=[0,"models",0,"photo-rights",0,"options",0,"isOwner"];var j118=[0,"flags",0,"porno"];var j119=[0,"models",0,"auth",0,"uid",0,"value"];var j120=[0,"models",0,"photo",0,"author",0,"uid"];function p27(m,c0,i0,l0){return cmpSN(1,m.s(j118,c0))&&!yr.externals["isCurrentUserAdult"](nodeset2scalar(m.s(j119,c0.doc.root)))&&!cmpNN(m.s(j120,c0.doc.root),m.s(j119,c0.doc.root))}var j121=[0,"photo",2,p27];var j122=[0,"flags",0,"blocked"];function p28(m,c0,i0,l0){return cmpSN(1,m.s(j122,c0))}var j123=[0,"photo",2,p28];var j124=[0,"blockReason"];var j125=[0,"templateType"];function p29(m,c0,i0,l0){return cmpSN("court-verdict",selectNametest("templateType",c0,[]))}var j126=[0,"blockReason",2,p29];var j127=[0,"type"];function p30(m,c0,i0,l0){return cmpSN("agreement",selectNametest("type",c0,[]))||cmpSN("agreement-other",selectNametest("type",c0,[]))}var j128=[0,"blockReason",2,p30];var j129=[0,"panel"];function p31(m,c0,i0,l0){return cmpSN("fullscreen",m.s(j90,c0.doc.root))}var j130=[0,"panel",4,p31];var j131=[0,"views",0,"panel-box"];var j132=[0,"views",0,"ads"];var j133=[0,"photo-info"];var j134=[0,"models",0,"profile"];var j135=[0,"errors",0,"profile"];function p32(m,c0,i0,l0){return nodeset2boolean(m.s(j134,c0.doc.root))&&!nodeset2boolean(m.s(j135,c0.doc.root))}var j136=[0,"photo-info",4,p32];var j137=[0,"errors",0,"album-info",0,"name"];function p33(m,c0,i0,l0){return cmpSN("album not found",m.s(j137,c0.doc.root))}var j138=[0,"photo-info",4,p33];var j139=[0,"photo-info",4,p21];function p34(m,c0,i0,l0){return cmpSN("access denied",m.s(j107,c0.doc.root))}var j140=[0,"photo-info",4,p34];var j142=[0,"profile"];var j143=[0,"user",0,"uid"];var j144=[0,"params",0,"author-login"];var j145=[0,"user",0,"displayName"];var j147=[0,"viewerUserRelation",0,"userIsFavoriteAuthorOfViewer"];var j148=[0,"models",0,"photo-position"];var j149=[0,"models",0,"album-info"];var j150=[0,"models",0,"photo-rights",0,"canEdit"];var j151=[0,"position"];var j152=[0,"access",0,"privilege"];var j153=[0,"models",0,"auth"];var j154=[0,"author",0,"uid"];var j155=[0,"uid",0,"value"];var j156=[0,"models",0,"photo-more"];var j157=[0,"description"];var j158=[0,"photo-slider-info-item"];var j159=[0,"photo-tags"];var j160=[0,"models",0,"tags",0,"askAlbumPassword"];function p37(m,c0,i0,l0){return cmpSN("contest",selectNametest("type",c0,[]))||cmpSN("photoofday",selectNametest("type",c0,[]))||cmpSN("top",selectNametest("type",c0,[]))}var j161=[0,"*",2,p37];var j162=[0,"models",0,"tags"];var j163=[0,"tags"];var j164=[0,"tags",0,"tag"];var j165=[0,"models",0,"photo-rights",0,"actions",0,"canAddTag"];function p38(m,c0,i0,l0){return cmpNN(m.s(j120,c0.doc.root),m.s(j119,c0.doc.root))&&nodeset2boolean(m.s(j165,c0.doc.root))}var j166=[0,"tags",4,p38];function p39(m,c0,i0,l0){return selectNametest("item",c0,[]).length==1}var j167=[0,"*",2,p39];function p41(m,c0,i0,l0){return selectNametest("item",c0,[]).length>1}var j169=[0,"*",2,p41];function p42(m,c0,i0,l0){return cmpSN("photoofday",selectNametest("type",c0,[]))}var j170=[0,"*",2,p42];var j171=[0,"date"];function p43(m,c0,i0,l0){return cmpSN("top",selectNametest("type",c0,[]))}var j172=[0,"*",2,p43];function p44(m,c0,i0,l0){return cmpSN("contest",selectNametest("type",c0,[]))}var j173=[0,"*",2,p44];var j174=[0,"place"];function p45(m,c0,i0,l0){return cmpSN("contest",selectNametest("type",c0,[]))&&!simpleBoolean("place",c0)}var j175=[0,"*",2,p45];var j176=[0,"status"];var j177=[0,"votingStartDate"];var j178=[0,"state"];function p46(m,c0,i0,l0){return cmpSN("contest",selectNametest("type",c0,[]))&&cmpSN("voting-started",selectNametest("state",c0,[]))&&simpleBoolean("place",c0)}var j179=[0,"*",2,p46];var j180=[0,"votingFinishDate"];var j181=[0,"photo-on-map"];var j182=[0,"params",0,"image-id"];var j183=[0,"boundCoord"];var j184=[0,"models",0,"photo-rights",0,"actions",0,"canBindGeo"];var j186=[0,"photo-controls"];var j187=[0,"models",0,"photo",0,"askAlbumPassword"];var j188=[0,"views",0,"photo-on-map"];var j189=[0,"views",0,"send-to-contest"];var j190=[0,"models",0,"views",0,"total"];var j191=[0,"models",0,"photo",0,"flags",0,"blocked"];var j192=[0,"models",0,"views"];var j194=[0,"models",0,"auth",0,"uid"];var j195=[0,"models",0,"photo-rights",0,"actions"];var j196=[0,"models",0,"photo-rights",0,"options"];var j197=[0,"models",0,"photo",0,"likeCount"];var j198=[0,"likeAnimate"];var j199=[0,"canLike"];var j200=[0,"like"];var j202=[0,"canFavorite"];var j204=[0,"favorite"];var j206=[0,"photo-controls",4,p31];var j209=[0,"models",0,"photo",0,"sizes"];var j211=[0,"models",0,"blog-code-settings"];var j213=[0,"models",0,"photo-rights"];var j214=[0,"options",0,"isOwner"];var j215=[0,"sizes",0,"orig"];var j216=[0,"flags",0,"hasExif"];var j217=[0,"contest",0,"state"];function p47(m,c0,i0,l0){return!cmpSN("finished",m.s(j217,c0))}var j218=[0,"models",0,"photo-more",0,"contestBindings",0,"contestBinding",2,p47];var j219=[0,"contest"];var j220=[0,"imageStatus"];var j221=[0,"contestId"];var j222=[0,"sizes",0,"orig",0,"url"];var j224=[0,"photo-ears"];var j225=[0,"photo-edit"];var j226=[0,"models",0,"photo-rights",0,"canEditReason"];var j227=[0,"models",0,"settings",0,"aviaryEnabled"];var j230=[0,"photo",0,"areas"];var j233=[0,"models",0,"photo",0,"flags"];var j234=[0,"porno"];var j235=[0,"commentsDisabled"];var j236=[0,"hideOriginal"];var j238=[0,"photo-flags"];function p48(m,c0,i0,l0){return nodeset2boolean(m.s(j118,c0))}var j239=[0,"photo",2,p48];var j241=[0,"comments"];var j242=[0,"ads"];function p49(m,c0,i0,l0){return cmpSN("hide-ads",selectNametest("name",c0,[]))}var j243=[0,"models",0,"preferences",0,"preferences",0,"preference",1,0,2,p49];var j244=[0,"tray"];var j245=[0,"tray",4,p31];var j246=[0,"tray-container"];var j247=[0,"fotki-old"];var j248=[0,"send-to-contest"];var j249=[0,"models",0,"photo-rights",0,"activeContest"];var j250=[0,"contest",0,"contestId"];var j253=[0,"startDate"];var j254=[0,"logoUrl"];var j255=[0,"subject"];var j256=[0,"genre"];var j257=[0,"imageCount"];var j258=[0,"userCount"];var j259=[0,"texts",0,"description"];M.t0=function t0(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("ns-root")};a0.s="div";r0+=m.a(m,m.s(j8,c0),"ns-view",a0);r0+=closeAttrs(a0);r0+="</div>";return r0};M.t0.j=1;M.t0.a=1;M.t1=function t1(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.n(j9,yr.document(m.s(j3,c0))),"ns-build-view",a0);return r0};M.t1.j=j2;M.t1.a=0;M.t2=function t2(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("ns-view-"+c0.name),"data-key":new yr.scalarAttr(nodeset2scalar(selectNametest("key",c0.doc.root,[])))};a0.s="div";if(simpleBoolean("placeholder",c0.doc.root)){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" ns-view-placeholder")}else{a0.a["class"]=new yr.scalarAttr(" ns-view-placeholder")}r0+=m.a(m,m.s(j3,c0),"ns-view-desc",a0)}else{var r1="";var a1={a:{}};r1+=m.a(m,m.s(j3,c0),"ns-view-add-class",a1);var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addxml(r1)}else{a0.a["class"]=new yr.xmlAttr(r1)}r0+=m.a(m,m.s(j3,c0),"ns-view-add-attrs",a0);if(simpleBoolean("async",c0.doc.root)){r0+=m.a(m,m.s(j3,c0),"ns-view-async-content",a0)}else{if(selectNametest("is_models_valid",c0.doc.root,[]).length&&!simpleBoolean("is_models_valid",c0.doc.root)){r0+=m.a(m,m.s(j3,c0),"ns-view-error-content",a0)}else{r0+=m.a(m,m.s(j3,c0),"ns-view-content",a0)}}}r0+=closeAttrs(a0);r0+="</div>";return r0};M.t2.j=j2;M.t2.a=0;M.t3=function t3(m,c0,i0,l0,a0){var r0="";return r0};M.t3.j=j2;M.t3.a=0;M.t4=function t4(m,c0,i0,l0,a0){var r0="";return r0};M.t4.j=j2;M.t4.a=0;M.t5=function t5(m,c0,i0,l0,a0){var r0="";if(nodeset2boolean(selectNametest("collection",c0.doc.root,[]))){r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("ns-view-container-desc")};a0.s="div";r0+=m.a(m,m.s(j3,c0),"ns-view-desc",a0);r0+=closeAttrs(a0);r0+="</div>"}else{r0+=m.a(m,m.s(j3,c0),"ns-view-desc",a0)}return r0};M.t5.j=j2;M.t5.a=0;M.t6=function t6(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j15,c0.doc.root),"ns-view",a0);return r0};M.t6.j=j2;M.t6.a=0;M.t7=function t7(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="async-view-content";return r0};M.t7.j=j2;M.t7.a=0;M.t8=function t8(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="view-error-content";return r0};M.t8.j=j2;M.t8.a=0;M.t9=function t9(m,c0,i0,l0,a0){var r0="";return r0};M.t9.j=j2;M.t9.a=0;M.t10=function t10(m,c0,i0,l0,a0){var r0="";return r0};M.t10.j=j2;M.t10.a=0;M.t11=function t11(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"collapse-text__expander is-hidden"+'"></div>';return r0};M.t11.j=j2;M.t11.a=0;M.t12=function t12(m,c0,i0,l0,a0,v17,v18){var r0="";r0+=closeAttrs(a0);r0+='<label class="'+"field nb-editable-text is-hidden"+'">';r0+='<span class="'+"field-content"+'">';r0+="<textarea";a0.a={"class":new yr.scalarAttr("input-controller nb-editable-text__value-new"),type:new yr.scalarAttr("text")};a0.s="textarea";var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" _init")}else{a0.a["class"]=new yr.scalarAttr(" _init")}a0.a["data-nb"]=new yr.scalarAttr("textarea-autoheight");if(v17){a0.a["placeholder"]=new yr.scalarAttr(v17)}r0+=closeAttrs(a0);r0+=scalar2xml(v18);r0+="</textarea>";r0+='<span class="'+"input-view"+'">'+" "+"</span>";r0+="</span>";r0+="</label>";return r0};M.t12.j=j2;M.t12.a=0;M.t13=function t13(m,c0,i0,l0,a0,v19,v20){var r0="";r0+=closeAttrs(a0);if(v20){r0+='<div class="'+"editable-tags__view editable-tags__edit js-editable-tags-view"+'">';r0+='<div class="'+"nb-text"+'">';if(selectNametest("tag",c0,[]).length>0){r0+='<span class="'+"editable-tags__title"+'">'+"Метки: "+"</span>";r0+=m.a(m,selectNametest("tag",c0,[]),"editable-tags-item",a0,v19)}else{r0+='<span class="'+"link js-editable-tags-edit-link"+'">'+"Добавьте метки"+"</span>"}r0+="</div>";r0+="</div>";r0+='<div class="'+"editable-tags__input"+'">';r0+='<div class="'+"editable-tags__title"+'">'+"Метки: "+"</div>";r0+='<label class="'+"field"+'">';r0+='<span class="'+"field-content"+'">';r0+="<textarea";a0.a={"class":new yr.scalarAttr("input-controller js-editable-tags-input"),type:new yr.scalarAttr("text")};a0.s="textarea";a0.a["data-nb"]=new yr.scalarAttr("textarea-autoheight");r0+=m.a(m,selectNametest("tag",c0,[]),"editable-tags-item-plain",a0);r0+=closeAttrs(a0);r0+="</textarea>";r0+='<span class="'+"input-view"+'">'+" "+"</span>";r0+="</span>";r0+="</label>";r0+="</div>"}else{r0+='<div class="'+"editable-tags__view js-editable-tags-view"+'">';r0+='<div class="'+"nb-text"+'">';r0+='<span class="'+"photo-tags__total"+'">'+"Метки:"+"</span>";r0+=m.a(m,selectNametest("tag",c0,[]),"editable-tags-item",a0,v19);r0+="</div>";r0+="</div>"}return r0};M.t13.j=j2;M.t13.a=0;M.t14=function t14(m,c0,i0,l0,a0,v21){var r0="";r0+=closeAttrs(a0);if(i0>0){r0+=", "}r0+='<a class="'+"link js-tag"+'" href="'+scalar2attrvalue(yr.externals["generateUrl"]("user-tag",m.s(j3,c0),v21))+'" data-tag-name="'+nodeset2attrvalue(selectNametest("name",c0,[]))+'">';r0+=nodeset2xml(selectNametest("name",c0,[]));r0+="</a>";return r0};M.t14.j=j16;M.t14.a=0;M.t15=function t15(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);if(i0>0){r0+=", "}r0+=nodeset2xml(selectNametest("name",c0,[]));return r0};M.t15.j=j16;M.t15.a=0;M.t16=function t16(m,c0,i0,l0,a0,v22,v23){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"map"+'" data-nb="'+"map"+'">';r0+='<div class="'+"map-container"+'"></div>';if(v22&&v23){r0+='<div class="'+"map-controls map-controls_view js-view-binded"+'">';r0+='<div class="'+"map-controls__right"+'">';r0+='<button class="'+"small-button js-modify"+'" type="'+"button"+'" data-nb="'+"two-faced-button"+'" data-nb-labels="'+"{ add: 'Привязать', edit: 'Изменить' }"+'" data-nb-default-mode="'+"add"+'">';r0+='<span class="'+"button-content js-nb-label"+'"></span>';r0+="</button>";r0+="</div>";r0+="</div>";r0+='<div class="'+"map-controls map-controls_white map-controls_edit"+'">';r0+='<div class="'+"map-controls__left"+'">';r0+='<button class="'+"small-button small-button_icon map-controls__remove js-map-remove"+'" type="'+"button"+'">';r0+='<span class="'+"button-content"+'">';r0+='<span class="'+"icon_trash-16"+'"></span>';r0+="</span>";r0+="</button>";r0+="</div>";r0+='<div class="'+"map-controls__right"+'">';r0+='<button class="'+"small-action-button map-controls__save js-save"+'" type="'+"button"+'">';r0+='<span class="'+"button-content"+'">'+"Сохранить"+"</span>";r0+="</button>";r0+='<div class="'+"map-close js-cancel"+'" title="'+"Отмена"+'">';r0+='<span class="'+"popup-close"+'"></span>';r0+="</div>";r0+="</div>";r0+='<div class="'+"map-controls__center"+'">';r0+="<input";a0.a={"class":new yr.scalarAttr("small-input map-controls__location js-location"),type:new yr.scalarAttr("text"),value:new yr.scalarAttr(""),placeholder:new yr.scalarAttr("Местоположение")};a0.s="input";a0.a["data-nb"]=new yr.scalarAttr("suggest");a0.a["data-nb-label-key"]=new yr.scalarAttr("name");a0.a["data-nb-theme-class"]=new yr.scalarAttr("popup popup_to_top geo-suggest");a0.a["data-nb-popup-selector"]=new yr.scalarAttr(".js-map-suggest");a0.a["data-nb-min_length"]=new yr.scalarAttr("2");a0.a["data-nb-expand-popup-to-input"]=new yr.scalarAttr("true");r0+=closeAttrs(a0);r0+="";r0+='<div class="'+"popup popup_to_top map-suggest js-map-suggest"+'" data-nb="'+"islands-popup"+'">';r0+='<div class="'+"suggest-scrollbox"+'"></div>';r0+="</div>";r0+="</div>";r0+="</div>"}r0+="</div>";r0+='<div class="'+"popup-tail"+'"></div>';return r0};M.t16.j=j2;M.t16.a=0;M.t17=function t17(m,c0,i0,l0,a0,v24){v24=v24===undefined?[]:v24;var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"blog-code js-blog-code"+'" data-nb="'+"blog-code"+'">';r0+='<div class="'+"blog-code-row"+'">';r0+='<div class="'+"group js-format"+'" data-nb="'+"button-group"+'">';r0+='<button class="'+"small-button toggle-button js-button is-checked"+'" type="'+"button"+'" data-val="'+"html"+'">';r0+='<span class="'+"button-content"+'">'+"HTML"+"</span>";r0+="</button>";r0+='<button class="'+"small-button toggle-button js-button"+'" type="'+"button"+'" data-val="'+"bbCode"+'">';r0+='<span class="'+"button-content"+'">'+"bbCode"+"</span>";r0+="</button>";r0+="</div>";r0+="</div>";r0+="<div";a0.a={"class":new yr.scalarAttr("blog-code-row")};a0.s="div";r0+=m.a(m,m.s(j3,c0),"blog-code__sizes",a0,v24);r0+=closeAttrs(a0);r0+="</div>";r0+='<div class="'+"blog-code-row"+'">';r0+='<label class="'+"toggler"+'">';r0+='<input class="'+"toggler-controller js-add-name"+'" type="'+"checkbox"+'" checked="'+"checked"+'"/>';r0+='<span class="'+"checkbox toggler-view"+'">';r0+='<span class="'+"checkbox-icon"+'">'+" "+"</span>";r0+="</span>";r0+="Добавить в код название фото";r0+="</label>";r0+="</div>";r0+='<div class="'+"blog-code-row"+'">';r0+='<textarea class="'+"small-input blog-code__code js-code"+'" rows="'+"6"+'" cols="'+"70"+'"></textarea>';r0+="</div>";r0+='<div class="'+"blog-code-row js-save-code-row"+'">';r0+='<button class="'+"small-button js-save-code is-hidden"+'" type="'+"button"+'" data-nb="'+"copy-to-clipboard"+'">';r0+='<span class="'+"button-content"+'">'+"Скопировать код"+"</span>";r0+="</button>";r0+="</div>";r0+="</div>";r0+='<div class="'+"popup-tail"+'"></div>';r0+='<div class="'+"popup-close js-close"+'"></div>';return r0};M.t17.j=j18;M.t17.a=0;M.t18=function t18(m,c0,i0,l0,a0,v25){v25=v25===undefined?[]:v25;var r0="";var v26=m.s(j3,c0);var r1={};var a1={a:{}};r1["xxxs"]="50 px";r1["xxs"]="75 px";r1["xs"]="100 px";r1["s"]="150 px";r1["m"]="300 px";r1["l"]="500 px";r1["xl"]="800 px";r1["xxl"]="1024 px";r1["xxxl"]="1280 px";r1["orig"]="Оригинал";var v27=r1;var v28=m.n(j4,yr.array2nodeset(yr.externals["filterDifferentSizes"](v26)));var r1=[];var a1={a:{}};var items0=m.n(j19,v25);for(var i1=0,l1=items0.length;i1<l1;i1++){var c1=items0[i1];var v29=m.s(j3,c1);if(yr.externals["has"](v28,nodeset2scalar(v29))){if(!cmpSN("orig",v29)||cmpSN("orig",v29)&&!nodeset2boolean(m.n(j20,v26))){r1.push(nodeset2scalar(v29))}}}var v30=r1;r0+=closeAttrs(a0);r0+='<span class="'+"small-button select-wrap"+'">';r0+='<select class="'+"select js-select"+'">';var items0=m.n(j4,yr.array2nodeset(v30));for(var i1=0,l1=items0.length;i1<l1;i1++){var c1=items0[i1];var v31=m.s(j3,c1);function p2(m,c1,i1,l1){return cmpSN(c1.name,v31)}var j21=[0,"sizes",0,"*",2,p2];var v32=m.n(j21,v26);r0+='<option value="'+nodeset2attrvalue(v31)+'">';if(nodeset2boolean(m.n(j23,v32))&&nodeset2boolean(m.n(j24,v32))){if(cmpSN("orig",v31)){function p4(m,c1,i1,l1){return cmpSN(c1.name,v31)}var j25=[0,"*",2,p4];r0+=nodeset2xml(m.n(j25,yr.object2nodeset(v27)));r0+=" ("+nodeset2xml(m.n(j23,v32))+"×"+nodeset2xml(m.n(j24,v32))+" px)"}else{r0+=nodeset2xml(m.n(j23,v32))+"×"+nodeset2xml(m.n(j24,v32))+" px"}}else{function p3(m,c1,i1,l1){return cmpSN(c1.name,v31)}var j22=[0,"*",2,p3];r0+=nodeset2xml(m.n(j22,yr.object2nodeset(v27)))}r0+="</option>"}r0+="</select>";r0+='<span class="'+"select-focus"+'"></span>';r0+="</span>";return r0};M.t18.j=j18;M.t18.a=0;M.t19=function t19(m,c0,i0,l0,a0){var r0="";var v33=selectNametest("photo",c0,[]);function p5(m,c0,i0,l0){return cmpSN(c0.name,m.s(j26,c0.doc.root))}var j27=[0,"sizes",0,"*",2,p5];var v34=m.n(j27,v33);var v35=m.s(j28,c0.doc.root);var r1="";var a1={a:{}};if(cmpSN("gif",m.n(j30,v33))){r1+=yr.externals["generateDeanimatedUrl"](nodeset2scalar(m.n(j29,v34)))}else{r1+=nodeset2scalar(m.n(j29,v34))}var v36=r1;var r1=[];if(yr.externals["strlen"](nodeset2scalar(m.n(j32,v33)))>0){r1=m.n(j32,v33)}else{r1=m.n(j31,v33)}var v37=r1;r0+=closeAttrs(a0);if(cmpSN("bbCode",v35)){r0+="[url="+nodeset2xml(selectNametest("pageUrl",c0,[]))+"]";r0+="[img]";r0+=scalar2xml(v36);if(nodeset2boolean(m.n(j30,v33))){r0+=".";r0+=nodeset2xml(m.n(j30,v33))}r0+="[/img]";r0+="[/url]";if(nodeset2boolean(m.s(j34,c0))){r0+=nodeset2xml(v37)}}else{r0+='<a href="'+nodeset2attrvalue(selectNametest("pageUrl",c0,[]))+'" target="'+"_blank"+'">';r0+="<img";a0.a={src:new yr.scalarAttr(v36),width:new yr.scalarAttr(nodeset2scalar(m.n(j23,v34))),height:new yr.scalarAttr(nodeset2scalar(m.n(j24,v34))),border:new yr.scalarAttr("0")};a0.s="img";if(nodeset2boolean(m.n(j30,v33))){var tmp0=a0.a["src"];if(tmp0){a0.a["src"]=tmp0.addscalar("."+nodeset2scalar(m.n(j30,v33)))}else{a0.a["src"]=new yr.scalarAttr("."+nodeset2scalar(m.n(j30,v33)))}}if(nodeset2boolean(m.s(j34,c0))){a0.a["title"]=new yr.scalarAttr(nodeset2scalar(v37));a0.a["alt"]=new yr.scalarAttr(nodeset2scalar(v37))}r0+=closeAttrs(a0);r0+="";r0+="</a>"}return r0};M.t19.j=1;M.t19.a=1;M.t20=function t20(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("popup-content popup-content_stat popup-content_head")};a0.s="div";r0+=m.a(m,m.s(j3,c0),"stat-summary",a0);r0+=closeAttrs(a0);r0+="</div>";r0+='<div class="'+"popup-content popup-content_stat"+'">';r0+='<div class="'+"stat__title"+'">'+"Источники"+"</div>";r0+=m.a(m,m.s(j35,c0),"stat-item",a0);r0+=m.a(m,m.s(j3,c0),"stat-more",a0);r0+="</div>";r0+='<div class="'+"popup-close js-close"+'"></div>';r0+='<div class="'+"popup-tail"+'"></div>';return r0};M.t20.j=j2;M.t20.a=0;M.t21=function t21(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"stat__title"+'">'+"Количество просмотров"+"</div>";r0+='<div class="'+"stat__item stat__item_head"+'">';r0+='<span class="'+"stat__item-inner"+'">';r0+='<span class="'+"stat__item-content"+'">';r0+='<span class="'+"stat__item-name"+'">'+"Сегодня"+"</span>";r0+="</span>";r0+="</span>";r0+='<span class="'+"stat__item-counter"+'">'+m.f("f1",c0,i0,l0,a0,simpleScalar("day",c0))+"</span>";r0+="</div>";r0+='<div class="'+"stat__item stat__item_head"+'">';r0+='<span class="'+"stat__item-inner"+'">';r0+='<span class="'+"stat__item-content"+'">';r0+='<span class="'+"stat__item-name"+'">'+"За 7 дней"+"</span>";r0+="</span>";r0+="</span>";r0+='<span class="'+"stat__item-counter"+'">'+m.f("f1",c0,i0,l0,a0,simpleScalar("week",c0))+"</span>";r0+="</div>";r0+='<div class="'+"stat__item stat__item_head"+'">';r0+='<span class="'+"stat__item-inner"+'">';r0+='<span class="'+"stat__item-content"+'">';r0+='<span class="'+"stat__item-name"+'">'+"Всего"+"</span>";r0+="</span>";r0+="</span>";r0+='<span class="'+"stat__item-counter"+'">'+m.f("f1",c0,i0,l0,a0,simpleScalar("total",c0))+"</span>";r0+="</div>";return r0};M.t21.j=j2;M.t21.a=0;M.t22=function t22(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"stat__item"+'">';r0+='<span class="'+"stat__item-inner"+'">';r0+='<span class="'+"stat__item-content"+'">';r0+='<span class="'+"stat__item-bull"+'">'+scalar2xml(i0+1)+"."+"</span>";r0+="<span";a0.a={"class":new yr.scalarAttr("stat__item-name"),title:new yr.scalarAttr(nodeset2scalar(selectNametest("url",c0,[])))};a0.s="span";r0+=m.a(m,m.s(j3,c0),"stat-item-body",a0);r0+=closeAttrs(a0);r0+="</span>";r0+="</span>";r0+="</span>";r0+='<span class="'+"stat__item-counter"+'">'+m.f("f1",c0,i0,l0,a0,simpleScalar("count",c0))+"</span>";r0+="</div>";return r0};M.t22.j=j39;M.t22.a=0;M.t23=function t23(m,c0,i0,l0,a0){var r0="";var v38=yr.externals["sum"](m.s(j41,c0));var v39=simpleScalar("total",c0)-v38;r0+=closeAttrs(a0);if(v39>0){r0+='<div class="'+"stat__item"+'">';r0+='<span class="'+"stat__item-inner"+'">';r0+='<span class="'+"stat__item-content"+'">';r0+='<span class="'+"stat__item-bull"+'"></span>';r0+='<span class="'+"stat__item-name"+'">'+"Остальные"+"</span>";r0+="</span>";r0+="</span>";r0+='<span class="'+"stat__item-counter"+'">'+m.f("f1",c0,i0,l0,a0,v39)+"</span>";r0+="</div>"}return r0};M.t23.j=j2;M.t23.a=0;M.t24=function t24(m,c0,i0,l0,a0){var r0="";var v40="http://"+nodeset2scalar(selectNametest("url",c0,[]));r0+=closeAttrs(a0);r0+='<a class="'+"link js-stat-link"+'" href="'+"http://"+nodeset2attrvalue(selectNametest("url",c0,[]))+'" target="'+"_blank"+'">';r0+=nodeset2xml(selectNametest("url",c0,[]));r0+="</a>";return r0};M.t24.j=j39;M.t24.a=0;M.t25=function t25(m,c0,i0,l0,a0){var r0="";var r1={};var a1={a:{}};var r2={};var a2={a:{}};r2["title"]="Яндекс.Фотки";r2["ya"]="1";r1["fotki"]=r2;var r2={};var a2={a:{}};r2["title"]="Яндекс";r2["ya"]="1";r1["yandex"]=r2;var r2={};var a2={a:{}};r2["title"]="Яндекс на устройствах";r2["ya"]="1";r1["yandex-embeded"]=r2;var r2={};var a2={a:{}};r2["title"]="Яндекс.Почта";r2["ya"]="1";r1["mail-ya"]=r2;var r2={};var a2={a:{}};r2["title"]="Яндекс.Карты";r2["ya"]="1";r1["maps"]=r2;var r2={};var a2={a:{}};r2["title"]="Яндекс.Виджет в телевизорах LG";r2["ya"]="1";r1["hw-lg"]=r2;var r2={};var a2={a:{}};r2["title"]="Яндекс.Панель для Opera";r2["ya"]="1";r1["panel-opera"]=r2;var r2={};var a2={a:{}};r2["title"]="Яндекс.Открытки";r2["ya"]="1";r1["cards-ya"]=r2;var r2={};var a2={a:{}};r2["title"]="Записи друзей на Я.ру";r2["ya"]="1";r1["friend-ya"]=r2;var r2={};var a2={a:{}};r2["title"]="Яндекс.Виджет";r2["ya"]="1";r1["widget-ya"]=r2;var r2={};var a2={a:{}};r2["title"]="Почта";r1["mail"]=r2;var r2={};var a2={a:{}};r2["title"]="Микроблоги";r1["microblog"]=r2;var r2={};var a2={a:{}};r2["title"]="Ленты друзей";r1["friend"]=r2;var r2={};var a2={a:{}};r2["title"]="RSS";r1["RSS"]=r2;var r2={};var a2={a:{}};r2["title"]="Лента друзей в LiveJournal";r1["friend-lj"]=r2;var r2={};var a2={a:{}};r2["title"]="Социальные сети";r1["social"]=r2;var v41=r1;var v42=selectNametest("special",c0,[]);function p7(m,c0,i0,l0){return cmpSN(c0.name,v42)}var j44=[0,"*",2,p7];var v43=m.n(j44,yr.object2nodeset(v41));r0+=closeAttrs(a0);r0+="<span";a0.a={"class":new yr.scalarAttr("stat__item-special")};a0.s="span";if(nodeset2boolean(v43)&&nodeset2boolean(m.n(j45,v43))){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" stat__item-special-ya")}else{a0.a["class"]=new yr.scalarAttr(" stat__item-special-ya")}}r0+=closeAttrs(a0);if(nodeset2boolean(v43)&&nodeset2boolean(m.n(j29,v43))){r0+='<a class="'+"link js-stat-link"+'" href="'+nodeset2attrvalue(m.n(j29,v43))+'">';r0+=nodeset2xml(m.n(j32,v43));r0+="</a>"}else if(nodeset2boolean(v43)){r0+=nodeset2xml(m.n(j32,v43))}else{r0+=nodeset2xml(v42)}r0+="</span>";return r0};M.t25.j=j43;M.t25.a=0;M.t26=function t26(m,c0,i0,l0,a0){var r0="";function p10(m,c0,i0,l0){return c0.name=="camera"||c0.name=="lens"}var j50=[0,"exif",0,"*",2,p10];function p11(m,c0,i0,l0){return c0.name!="camera"&&c0.name!="lens"}var j51=[0,"exif",0,"*",2,p11];r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("popup-content popup-content_details text js-details-content")};a0.s="div";r0+=m.a(m,m.s(j48,c0.doc.root),"details-loading",a0);r0+=m.a(m,m.s(j49,c0.doc.root),"details-error",a0);r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("details__col details__col_name")};a0.s="div";r0+=m.a(m,m.s(j50,c0.doc.root),"details-item-name",a0);r0+=m.a(m,m.s(j51,c0.doc.root),"details-item-name",a0);r0+=m.a(m,m.s(j52,c0.doc.root),"details-item-name",a0);r0+=closeAttrs(a0);r0+="</div>";r0+="<div";a0.a={"class":new yr.scalarAttr("details__col details__col_value")};a0.s="div";r0+=m.a(m,m.s(j50,c0.doc.root),"details-item-value",a0);r0+=m.a(m,m.s(j51,c0.doc.root),"details-item-value",a0);r0+=m.a(m,m.s(j52,c0.doc.root),"details-item-value",a0);r0+=closeAttrs(a0);r0+="</div>";r0+="</div>";r0+='<div class="'+"popup-tail"+'"></div>';r0+='<div class="'+"popup-close js-close"+'"></div>';return r0};M.t26.j=1;M.t26.a=1;M.t27=function t27(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"details__loading"+'">'+"Загрузка EXIF…"+"</div>";return r0};M.t27.j=1;M.t27.a=1;M.t28=function t28(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"details__error"+'">'+"Ошибка при получении EXIF"+"</div>";return r0};M.t28.j=1;M.t28.a=1;M.t29=function t29(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);if(selectNametest("*",c0,[]).length){r0+='<div class="'+"details__group"+'">';r0+="<div";a0.a={"class":new yr.scalarAttr("details__name details_group")};a0.s="div";r0+=m.a(m,m.s(j3,c0),"details-name",a0);r0+=closeAttrs(a0);r0+="</div>";r0+=m.a(m,selectNametest("*",c0,[]),"details-item-name",a0);r0+="</div>"}else{r0+="<div";a0.a={"class":new yr.scalarAttr("details__name")};a0.s="div";r0+=m.a(m,m.s(j3,c0),"details-name",a0);r0+=closeAttrs(a0);r0+="</div>"}return r0};M.t29.j=j2;M.t29.a=0;M.t30=function t30(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);if(selectNametest("*",c0,[]).length){r0+='<div class="'+"details__group"+'">';r0+='<div class="'+"details__value details_group"+'">';r0+=" ";r0+="</div>";r0+=m.a(m,selectNametest("*",c0,[]),"details-item-value",a0);r0+="</div>"}else{r0+="<div";a0.a={"class":new yr.scalarAttr("details__value")};a0.s="div";r0+=m.a(m,m.s(j3,c0),"details-value",a0);r0+=closeAttrs(a0);r0+="</div>"}return r0};M.t30.j=j2;M.t30.a=0;M.t31=function t31(m,c0,i0,l0,a0){var r0="";var r1={};var a1={a:{}};r1["camera"]="Камера";r1["make"]="Производитель";r1["model"]="Модель";r1["lens"]="Объектив";r1["isoSpeed"]="Чувствительность (ISO)";r1["fNumber"]="Диафрагма";r1["focalLength"]="Фокусное расстояние";r1["colorSpace"]="Пространство цветов";r1["artist"]="Автор";r1["copyright"]="Авторские права";r1["software"]="Программа";r1["dateTimeOriginal"]="Время съёмки";r1["added"]="Дата загрузки";r1["exposureTime"]="Выдержка";r1["exposureBias"]="Компенсация экспозиции";r1["exposureProgram"]="Режим съёмки";r1["flash"]="Вспышка";r1["fired"]="Использована";r1["mode"]="Режим";r1["redEye"]="Защита от красных глаз";var v44=r1;var v45=c0.name;function p12(m,c0,i0,l0){return c0.name==v45}var j53=[0,"*",2,p12];r0+=closeAttrs(a0);if(nodeset2boolean(m.n(j53,yr.object2nodeset(v44)))){function p13(m,c0,i0,l0){return c0.name==v45
}var j54=[0,"*",2,p13];r0+=nodeset2xml(m.n(j54,yr.object2nodeset(v44)))}else{r0+=scalar2xml(v45)}return r0};M.t31.j=j2;M.t31.a=0;M.t32=function t32(m,c0,i0,l0,a0){var r0="";var r1={};var a1={a:{}};r1["false"]="нет";r1["true"]="да";r1["unknown"]="неизвестно";var v46=r1;var r1={};var a1={a:{}};r1["fNumber"]="f/";var v47=r1;var r1={};var a1={a:{}};r1["exposureTime"]=" сек";r1["focalLength"]=" мм";r1["exposureBias"]=" eV";var v48=r1;var v49=c0.name;var v50=m.s(j3,c0);function p14(m,c0,i0,l0){return c0.name==v49}var j55=[0,"*",2,p14];var v51=m.n(j55,yr.object2nodeset(v47));var v52=m.n(j55,yr.object2nodeset(v48));var r1=[];function p15(m,c0,i0,l0){return c0.name==""+yr.nodeset2scalar(v50)}var j56=[0,"*",2,p15];if(nodeset2boolean(m.n(j56,yr.object2nodeset(v46)))){function p16(m,c0,i0,l0){return c0.name==""+yr.nodeset2scalar(v50)}var j57=[0,"*",2,p16];r1=m.n(j57,yr.object2nodeset(v46))}else{r1=v50}var v53=r1;r0+=closeAttrs(a0);r0+=nodeset2xml(v51);r0+=nodeset2xml(v53);r0+=nodeset2xml(v52);return r0};M.t32.j=j2;M.t32.a=0;M.t33=function t33(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=scalar2xml(yr.externals["formatDateWithTZ"](nodeset2scalar(m.s(j3,c0)),"D MMMM YYYY, HH:mm:ss"));return r0};M.t33.j=j58;M.t33.a=0;M.t34=function t34(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=scalar2xml(yr.externals["formatDate"](nodeset2scalar(m.s(j3,c0)),"D MMMM YYYY, HH:mm:ss"));return r0};M.t34.j=j59;M.t34.a=0;M.t35=function t35(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("details__name")};a0.s="div";r0+=m.a(m,m.s(j3,c0),"details-name",a0);r0+=closeAttrs(a0);r0+="</div>";return r0};M.t35.j=j60;M.t35.a=0;M.t36=function t36(m,c0,i0,l0,a0){var r0="";var v54="ru";var v55="http://market.yandex."+v54+"/search.xml?cvredirect=1&text="+nodeset2scalar(selectNametest("make",c0,[]))+" "+nodeset2scalar(selectNametest("model",c0,[]));r0+=closeAttrs(a0);r0+='<div class="'+"details__value"+'" title="'+nodeset2attrvalue(selectNametest("make",c0,[]))+" "+nodeset2attrvalue(selectNametest("model",c0,[]))+'">';r0+='<a class="'+"outer-link js-model"+'" href="'+scalar2attrvalue(v55)+'" target="'+"_blank"+'">';r0+=nodeset2xml(selectNametest("make",c0,[]));r0+=" ";r0+=nodeset2xml(selectNametest("model",c0,[]));r0+="</a>";r0+="</div>";return r0};M.t36.j=j60;M.t36.a=0;M.t37=function t37(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("details__name")};a0.s="div";r0+=m.a(m,m.s(j3,c0),"details-name",a0);r0+=closeAttrs(a0);r0+="</div>";r0+='<div class="'+"details__name"+'">';r0+=" ";r0+="</div>";return r0};M.t37.j=j64;M.t37.a=0;M.t38=function t38(m,c0,i0,l0,a0){var r0="";var v56="ru";var r1="";var a1={a:{}};r1+="http://market.yandex."+v56+"/model.xml?modelid="+nodeset2scalar(m.s(j63,c0));if(nodeset2boolean(m.s(j65,c0))){r1+="&hid="+nodeset2scalar(m.s(j65,c0))}var v57=r1;var v58="/search.xml?grouping=on&modelid="+nodeset2scalar(m.s(j63,c0));r0+=closeAttrs(a0);r0+='<div class="'+"details__value"+'" title="'+nodeset2attrvalue(m.s(j66,c0))+" "+nodeset2attrvalue(m.s(j67,c0))+'">';r0+='<a class="'+"outer-link js-model"+'" href="'+scalar2attrvalue(v57)+'" target="'+"_blank"+'">';r0+=nodeset2xml(m.s(j66,c0));r0+=" ";r0+=nodeset2xml(m.s(j67,c0));r0+="</a>";r0+="</div>";r0+='<div class="'+"details__value"+'">';r0+='<a class="'+"link js-model-shots"+'" href="'+scalar2attrvalue(v58)+'">'+"снимки, сделанные этим устройством"+"</a>";r0+="</div>";return r0};M.t38.j=j64;M.t38.a=0;M.t39=function t39(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("details__value")};a0.s="div";var r1="";var a1={a:{}};r1+=m.a(m,m.s(j3,c0),"details-value",a1);a0.a["title"]=new yr.xmlAttr(r1);r0+=m.a(m,m.s(j3,c0),"details-value",a0);r0+=closeAttrs(a0);r0+="</div>";return r0};M.t39.j=j68;M.t39.a=0;M.t40=function t40(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("details__name")};a0.s="div";r0+=m.a(m,m.s(j3,c0),"details-name",a0);r0+=closeAttrs(a0);r0+="</div>";return r0};M.t40.j=j70;M.t40.a=0;M.t41=function t41(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"details__value"+'">';if(simpleBoolean("fired",c0)){r0+="сработала"}else{r0+="отключена"}r0+="</div>";return r0};M.t41.j=j70;M.t41.a=0;M.t42=function t42(m,c0,i0,l0,a0){var r0="";var r1={};var a1={a:{}};r1["0"]="авто";r1["1"]="ручной";r1["2"]="обычный";r1["3"]="приоритет диафрагмы";r1["4"]="приоритет выдержки";r1["5"]="творческий";r1["6"]="спорт";r1["7"]="портрет";r1["8"]="пейзаж";var v59=r1;var v60=m.s(j3,c0);var r1=[];function p19(m,c0,i0,l0){return c0.name==""+yr.nodeset2scalar(v60)}var j72=[0,"*",2,p19];if(nodeset2boolean(m.n(j72,yr.object2nodeset(v59)))){function p20(m,c0,i0,l0){return c0.name==""+yr.nodeset2scalar(v60)}var j73=[0,"*",2,p20];r1=m.n(j73,yr.object2nodeset(v59))}else{r1=v60}var v61=r1;r0+=closeAttrs(a0);r0+=nodeset2xml(v61);return r0};M.t42.j=j71;M.t42.a=0;M.t43=function t43(m,c0,i0,l0,a0,v62){var r0="";r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("complain js-complain"),"data-nb":new yr.scalarAttr("complain")};a0.s="div";if(v62){a0.a["data-nb-contest-id"]=new yr.scalarAttr(v62)}r0+=closeAttrs(a0);r0+='<div class="'+"popup-content complain-form complain-form_new"+'">';r0+='<div class="'+"complain-form__row complain-form__head"+'">';r0+="Укажите причину жалобы";r0+="</div>";r0+='<div class="'+"complain-form__group"+'">';if(v62){r0+='<div class="'+"complain-form__row js-contest"+'">';r0+='<label class="'+"toggler"+'">';r0+='<input class="'+"toggler-controller"+'" type="'+"checkbox"+'"/>';r0+='<span class="'+"checkbox toggler-view"+'"><span class="'+"checkbox-icon"+'">'+" "+"</span></span>";r0+="Фото нарушает правила конкурса";r0+="</label>";r0+="</div>"}r0+='<div class="'+"complain-form__row js-copyright"+'">';r0+='<label class="'+"toggler"+'">';r0+='<input class="'+"toggler-controller"+'" type="'+"checkbox"+'"/>';r0+='<span class="'+"checkbox toggler-view"+'"><span class="'+"checkbox-icon"+'">'+" "+"</span></span>";r0+="Фото нарушает авторские права";r0+="</label>";r0+="</div>";r0+='<div class="'+"complain-form__row js-pron"+'">';r0+='<label class="'+"toggler"+'">';r0+='<input class="'+"toggler-controller"+'" type="'+"checkbox"+'"/>';r0+='<span class="'+"checkbox toggler-view"+'"><span class="'+"checkbox-icon"+'">'+" "+"</span></span>";r0+="Порнография";r0+="</label>";r0+="</div>";r0+='<div class="'+"complain-form__row js-violence"+'">';r0+='<label class="'+"toggler"+'">';r0+='<input class="'+"toggler-controller"+'" type="'+"checkbox"+'"/>';r0+='<span class="'+"checkbox toggler-view"+'"><span class="'+"checkbox-icon"+'">'+" "+"</span></span>";r0+="Демонстрация насилия и жестокости";r0+="</label>";r0+="</div>";r0+='<div class="'+"complain-form__row js-spam"+'">';r0+='<label class="'+"toggler"+'">';r0+='<input class="'+"toggler-controller"+'" type="'+"checkbox"+'"/>';r0+='<span class="'+"checkbox toggler-view"+'"><span class="'+"checkbox-icon"+'">'+" "+"</span></span>";r0+="Спам";r0+="</label>";r0+="</div>";r0+='<div class="'+"complain-form__row js-other"+'">';r0+='<label class="'+"toggler"+'">';r0+='<input class="'+"toggler-controller"+'" type="'+"checkbox"+'"/>';r0+='<span class="'+"checkbox toggler-view"+'"><span class="'+"checkbox-icon"+'">'+" "+"</span></span>";r0+="Другое";r0+="</label>";r0+="</div>";r0+="</div>";r0+='<div class="'+"complain-form__row js-link-to-origin is-hidden"+'">';r0+='<input class="'+"input"+'" type="'+"text"+'" value="'+""+'" placeholder="'+"Укажите ссылку на оригинал"+'"/>';r0+="</div>";r0+='<div class="'+"complain-form__row js-matter is-hidden"+'">';r0+='<textarea class="'+"input"+'" rows="'+"5"+'" cols="'+"20"+'" placeholder="'+"Опишите суть жалобы"+'"></textarea>';r0+="</div>";r0+='<div class="'+"complain-form__row complain-form__error is-hidden js-error-send"+'">';r0+="Жалоба не отправлена, попробуйте ещё раз.";r0+="</div>";r0+='<div class="'+"complain-form__row complain-form__error is-hidden js-error-exist"+'">';r0+="Подобная жалоба уже находится на рассмотрении.";r0+="</div>";r0+='<div class="'+"complain-form__row"+'">';r0+='<span class="'+"button is-disabled js-button-send"+'">';r0+='<span class="'+"button-content"+'">'+"Отправить жалобу"+"</span>";r0+="</span>";r0+="</div>";r0+='<div class="'+"complain-form__row complain-form__note"+'">';r0+="Если публикация этого изображения нарушает ваши права, действуйте согласно ";r0+='<a class="'+"link js-help"+'" href="'+scalar2attrvalue(yr.externals["generateUrl"]("rights"))+'" target="'+"_blank"+'">'+"инструкции"+"</a>";r0+=".";r0+="</div>";r0+="</div>";r0+='<div class="'+"popup-content complain-form complain-form_sent is-hidden"+'">';r0+='<div class="'+"complain-form__row complain-form__head"+'">';r0+="Жалоба отправлена модератору";r0+="</div>";r0+='<div class="'+"complain-form__row complain-form__one-more"+'">';r0+='<a class="'+"link js-send-one-more"+'">'+"Отправить ещё жалобу"+"</a>";r0+="</div>";r0+="</div>";r0+="</div>";r0+='<div class="'+"popup-tail"+'"></div>';r0+='<div class="'+"popup-close js-close"+'"></div>';return r0};M.t43.j=j2;M.t43.a=0;M.t44=function t44(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Неправильный формат ссылки";return r0};M.t44.j=1;M.t44.a=1;M.t45=function t45(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"popup error-popup"+'" data-nb="'+"islands-ballon"+'">';r0+='<div class="'+"popup-tail"+'"></div>';r0+=simpleScalar("message",c0);r0+="</div>";return r0};M.t45.j=1;M.t45.a=1;M.t46=function t46(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("popup error-popup error-popup-ballon with-close is-hidden"),"data-nb":new yr.scalarAttr("islands-ballon")};a0.s="div";if(simpleBoolean("photo",c0)){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" with-photo")}else{a0.a["class"]=new yr.scalarAttr(" with-photo")}}r0+=closeAttrs(a0);r0+='<div class="'+"popup-close popup__close js-error-close"+'"></div>';if(simpleBoolean("photo",c0)){r0+='<div class="'+"error-popup-photo"+'" style="'+"background-image: url('"+nodeset2attrvalue(m.s(j75,c0))+"');"+'"></div>'}r0+='<span class="'+"error-popup-message"+'">';r0+=simpleScalar("message",c0);r0+="</span>";if(simpleBoolean("buttons",c0)){r0+="<div";a0.a={"class":new yr.scalarAttr("error-popup-buttons")};a0.s="div";r0+=m.a(m,m.n(j4,yr.array2nodeset(yr.externals["split"](simpleScalar("buttons",c0),","))),"error-popup-button",a0);r0+=closeAttrs(a0);r0+="</div>"}r0+="</div>";return r0};M.t46.j=1;M.t46.a=1;M.t47=function t47(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);if(cmpSN("ok",m.s(j3,c0))){r0+='<button class="'+"small-action-button js-ok"+'" type="'+"button"+'">';r0+='<span class="'+"button-content"+'">'+"Да"+"</span>";r0+="</button>"}if(cmpSN("retry",m.s(j3,c0))){r0+='<button class="'+"small-action-button js-ok"+'" type="'+"button"+'">';r0+='<span class="'+"button-content"+'">'+"Повторить"+"</span>";r0+="</button>"}if(cmpSN("cancel",m.s(j3,c0))){r0+='<button class="'+"small-button popup__close js-cancel"+'" type="'+"button"+'">';r0+='<span class="'+"button-content"+'">'+"Отменить"+"</span>";r0+="</button>"}if(cmpSN("close",m.s(j3,c0))){r0+='<button class="'+"small-button popup__close js-cancel"+'" type="'+"button"+'">';r0+='<span class="'+"button-content"+'">'+"Закрыть"+"</span>";r0+="</button>"}return r0};M.t47.j=j2;M.t47.a=0;M.t48=function t48(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_edit"+'">';r0+='<svg class="'+"svg-icon"+'" xmlns="'+"http://www.w3.org/2000/svg"+'" width="'+"16"+'" height="'+"16"+'"><path fill="'+"currentColor"+'" d="'+"M 7.6517 10.4633 L 5.0068 10.9922 L 5.5359 8.3475 L 13.8833 0 L 15.9991 2.1158 L 7.6517 10.4633 ZM 2 13.9991 L 12 13.9991 L 12 8.9991 L 14 8.9991 L 14 15.9991 L 0 15.9991 L 0 1.9991 L 7 1.9991 L 7 3.9991 L 2 3.9991 L 2 13.9991 Z"+'"></path></svg>';r0+="</span>";return r0};M.t48.j=1;M.t48.a=1;M.t49=function t49(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_trash"+'">';r0+='<svg class="'+"svg-icon"+'" xmlns="'+"http://www.w3.org/2000/svg"+'" width="'+"14"+'" height="'+"18"+'" viewBox="'+"-2.5 499.5 14 18"+'"><path fill="'+"currentColor"+'" d="'+"M-2.5,502.5v-2h5v-1h4v1h5v2H-2.5z M10.5,517.5h-12v-14h12V517.5z M2.5,505.5h-2v10h2V505.5z M5.5,505.5h-2v10 h2V505.5z M8.5,505.5h-2v10h2V505.5z"+'"></path></svg>';r0+="</span>";return r0};M.t49.j=1;M.t49.a=1;M.t50=function t50(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_access"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" class="'+"svg-icon"+'" width="'+"16"+'" height="'+"16"+'"><path fill="'+"currentColor"+'" d="'+"M 12.8904 4.5254 C 14.5604 6.8686 14.3457 10.1412 12.2434 12.2434 C 10.1412 14.3457 6.8685 14.5604 4.5253 12.8905 L 12.8904 4.5254 ZM 3.1111 11.4763 C 1.4412 9.133 1.6559 5.8604 3.7582 3.7582 C 5.8604 1.6559 9.133 1.4412 11.4762 3.1112 L 3.1111 11.4763 ZM 2.3439 13.6577 C 2.5834 13.8971 2.8329 14.1196 3.0934 14.3223 C 6.2319 16.7649 10.7729 16.5424 13.6577 13.6577 C 16.5424 10.7729 16.7649 6.2319 14.3223 3.0935 C 14.1196 2.833 13.8971 2.5834 13.6577 2.3439 C 13.4182 2.1045 13.1686 1.882 12.9081 1.6793 C 9.7697 -0.7633 5.2288 -0.5408 2.3439 2.3439 C -0.5408 5.2287 -0.7633 9.7697 1.6793 12.9081 C 1.882 13.1686 2.1045 13.4182 2.3439 13.6577 ZM 1.6793 12.9081 L 1.6368 12.9506 L 2.3439 13.6577 C 2.1045 13.4182 1.882 13.1686 1.6793 12.9081 ZM 13.6577 2.3439 L 12.9506 1.6369 L 12.9081 1.6793 C 13.1686 1.882 13.4182 2.1045 13.6577 2.3439 ZM 14.3223 3.0935 L 14.3647 3.0511 L 13.6577 2.3439 C 13.8971 2.5834 14.1196 2.833 14.3223 3.0935 ZM 2.3439 13.6577 L 3.051 14.3648 L 3.0934 14.3223 C 2.8329 14.1196 2.5834 13.8971 2.3439 13.6577 Z"+'"></path></svg>';r0+="</span>";return r0};M.t50.j=1;M.t50.a=1;M.t51=function t51(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_help"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" class="'+"svg-icon"+'" width="'+"16"+'" height="'+"16"+'"><path fill="'+"currentColor"+'" d="'+"M 8.0001 0 C 3.582 0 0 3.5821 0 8 C 0 12.418 3.582 16 8.0001 16 C 12.418 16 16.0001 12.418 16.0001 8 C 16.0001 3.5821 12.418 0 8.0001 0 ZM 9 12.9999 L 7 12.9999 L 7 11 L 9 11 L 9 12.9999 ZM 11.5928 6.7798 C 11.3262 7.1309 10.7578 7.6079 9.8857 8.2129 C 9.4355 8.5253 9.1563 8.7753 9.0459 8.9658 C 8.9375 9.1563 8.8887 9.496 8.8984 9.9863 L 6.959 9.9863 C 6.9551 9.7539 6.9521 9.6113 6.9521 9.5625 C 6.9521 9.039 7.0562 8.6075 7.2642 8.27 C 7.4712 7.9312 7.8872 7.5508 8.5098 7.1278 C 9.1339 6.7061 9.5059 6.4292 9.6279 6.2979 C 9.8164 6.0908 9.9092 5.8618 9.9092 5.6129 C 9.9092 5.267 9.7432 4.9702 9.4111 4.7231 C 9.0791 4.4771 8.6318 4.354 8.0688 4.354 C 7.527 4.354 7.0732 4.4828 6.7081 4.7402 C 6.3438 4.998 6.0928 5.3911 5.9561 5.918 L 3.9951 5.7157 C 4.0508 4.9599 4.4371 4.1611 5.1538 3.6328 C 5.8712 3.1049 6.8121 2.8408 7.978 2.8408 C 9.2041 2.8408 10.1797 3.1089 10.9044 3.6431 C 11.6279 4.1768 11.9912 4.9551 11.9912 5.665 C 11.9912 6.0581 11.8574 6.4302 11.5928 6.7798 Z"+'"></path></svg>';r0+="</span>";return r0};M.t51.j=1;M.t51.a=1;M.t52=function t52(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_18plus"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" width="'+"29"+'" height="'+"14"+'"><path fill-rule="'+"evenodd"+'" clip-rule="'+"evenodd"+'" fill="'+"currentColor"+'" d="'+"M7,0H4.52C4.17,0.9,3.53,1.69,2.59,2.36C1.66,3.03,0.8,3.5,0,3.73 v2.8C1.53,6.04,2.86,5.25,4,4.2V14h3V0z"+'"></path><path fill-rule="'+"evenodd"+'" clip-rule="'+"evenodd"+'" fill="'+"currentColor"+'" d="'+"M13.36,8.17c0.25-0.47,0.62-0.7,1.14-0.7 c0.44,0,0.8,0.22,1.08,0.62C15.86,8.5,16,9.06,16,9.73c0,0.78-0.14,1.38-0.42,1.79c-0.28,0.41-0.64,0.61-1.05,0.61 c-0.44,0-0.81-0.2-1.09-0.64C13.14,11.07,13,10.47,13,9.7C13,9.14,13.11,8.63,13.36,8.17z M13.41,2.38 c0.28-0.34,0.64-0.51,1.11-0.51c0.43,0,0.79,0.17,1.07,0.51C15.86,2.71,16,3.15,16,3.7c-0.09,0.6-0.25,1.07-0.48,1.4 c-0.24,0.34-0.58,0.5-1.04,0.5c-0.45,0-0.76-0.16-0.95-0.5C13.34,4.78,13.16,4.32,13,3.72C13,3.16,13.13,2.73,13.41,2.38z M10.63,7.89C10.2,8.5,10,9.17,10,9.9c0,1.33,0.48,2.38,1.47,3.14c0.81,0.64,1.86,0.96,3.11,0.96c1.33,0,2.39-0.38,3.2-1.17 C18.59,12.06,19,11.04,19,9.79c0-0.75-0.23-1.4-0.67-1.99c-0.45-0.58-1.11-1.02-1.95-1.33c0.82-0.26,1.46-0.64,1.93-1.15 C18.77,4.83,19,4.24,19,3.59c0-1.02-0.41-1.88-1.19-2.57C17.03,0.35,15.92,0,14.5,0c-1.44,0-2.55,0.35-3.33,1.02 C10.39,1.71,10,2.57,10,3.59c0,0.61,0.2,1.18,0.61,1.69c0.41,0.51,1.08,0.9,1.98,1.19C11.69,6.81,11.03,7.28,10.63,7.89z"+'"></path><polygon fill-rule="'+"evenodd"+'" clip-rule="'+"evenodd"+'" fill="'+"currentColor"+'" points="'+"21,6 21,8 24,8 24,11 26,11 26,8 29,8 29,6 26,6 26,3 24,3 24,6"+'"></polygon></svg>';r0+="</span>";return r0};M.t52.j=1;M.t52.a=1;M.t53=function t53(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_16 icon_pseudo icon_layout-expand"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" width="'+"16"+'" height="'+"13"+'"><polygon fill="'+"currentColor"+'" points="'+"1,0 1,5 3,5 3,2 13,2 13,10 9,10 9,12 15,12 15,0"+'"></polygon><polygon fill="'+"currentColor"+'" points="'+"0,6 0,12 8,12 8,6.02"+'"></polygon></svg>';r0+="</span>";return r0};M.t53.j=1;M.t53.a=1;M.t54=function t54(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_16 icon_pseudo icon_layout-collapse"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" width="'+"16"+'" height="'+"13"+'"><polygon fill="'+"currentColor"+'" fill-rule="'+"evenodd"+'" clip-rule="'+"evenodd"+'" points="'+"7,0 7,2 14,2 14,7 16,7 16,0"+'"></polygon><path fill="'+"currentColor"+'" fill-rule="'+"evenodd"+'" clip-rule="'+"evenodd"+'" d="'+"M0,3v10h13V3H0z M2,5h9v6H2V5z"+'"></path></svg>';r0+="</span>";return r0};M.t54.j=1;M.t54.a=1;M.t55=function t55(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_share"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" width="'+"12"+'" height="'+"17"+'"><path fill="'+"currentColor"+'" fill-rule="'+"evenodd"+'" clip-rule="'+"evenodd"+'" d="'+"M6.98 12h-1.98v-6h-3l4-6 4 6h-3l-.02 6zm-6.98 5v-9h2l-.02 7h8.02v-7h2v9h-12z"+'"></path></svg>';r0+="</span>";return r0};M.t55.j=1;M.t55.a=1;M.t56=function t56(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_16 icon_pseudo icon_lock"+'">';r0+='<svg width="'+"12"+'" height="'+"15"+'" xmlns="'+"http://www.w3.org/2000/svg"+'"><path d="'+"m11,6l0,-1c0,0 -0.062,-5 -5,-5s-5,5 -5,5l0,1l-1,0l0,7c0,0 0,2 2,2l8,0c0,0 2,0.062 2,-2l0,-7l-1,0zm-2,0l-6,0l0,-1c0,0 0,-3 3,-3s3,3 3,3l0,1z"+'" clip-rule="'+"evenodd"+'" fill-rule="'+"evenodd"+'" fill="'+"currentColor"+'"></path></svg>';r0+="</span>";return r0};M.t56.j=1;M.t56.a=1;M.t57=function t57(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_16 icon_pseudo icon_medal"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" width="'+"15"+'" height="'+"14"+'" viewBox="'+"-2.5 115.5 15 14"+'" enable-background="'+"new -2.5 115.5 15 14"+'">';r0+='<path fill="'+"currentColor"+'" d="'+"M12.454 117.5c-.103-.269-.719-1-.994-1h-1.987v-1h-8.946s.005.663 0 1h-1.987c-.275 0-.89.731-.994 1-.266.693.67 2.411 1.882 3.521.569.52 2.751 1.089 2.736 1.16.423.476 2.339 1.619 2.339 2.319v3l-1.988 1h-.994c.036.497 0 1 0 1h6.957000000000001v-1c0-.01-.994 0-.994 0l-1.988-1v-3c0-.701 1.916-1.844 2.339-2.319-.015-.071 2.168-.641 2.736-1.16 1.214-1.11 2.15-2.828 1.883-3.521zm-13.914 0h1.988c.037 1.174.119 2.182.944 3.689-.64-.01-1.187-.219-1.631-.625-1.147-1.051-1.583-3.064-1.301-3.064zm11.619 3.064c-.444.406-.991.615-1.631.625.826-1.507.908-2.515.945-3.689h1.988c.281 0-.154 2.013-1.302 3.064z"+'"></path>';r0+="</svg>";r0+="</span>";return r0};M.t57.j=1;M.t57.a=1;M.t58=function t58(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_pseudo icon_rotate-ccw"+'">';r0+='<svg class="'+"svg-icon"+'" xmlns="'+"http://www.w3.org/2000/svg"+'" width="'+"15"+'" height="'+"16"+'"><g><path fill="'+"currentColor"+'" d="'+"M 11 11.9 C 13.2823 11.4367 15 9.419 15 7 C 15 4.2385 12.7615 2 10 2 C 9.2889 2 8.6125 2.1474 8 2.415 L 8 3.535 C 8.5883 3.1947 9.2714 3 10 3 C 12.2092 3 14 4.7908 14 7 C 14 8.8639 12.7252 10.431 11 10.875 L 11 11.9 Z"+'"></path><path fill="'+"currentColor"+'" d="'+"M 5 2.5 L 8 0 L 8 5 L 5 2.5 Z"+'"></path><path fill="'+"currentColor"+'" d="'+"M 0 7 L 0 16 L 9 16 L 9 7 L 0 7 Z"+'"></path></g></svg>';r0+="</span>";return r0};M.t58.j=1;M.t58.a=1;M.t59=function t59(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_pseudo icon_cross js-go-back"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" width="'+"31"+'" height="'+"31"+'"><path fill="'+"currentColor"+'" d="'+"M0,29.698l1.414,1.414l14.142-14.142l14.142,14.142 l1.414-1.414L16.971,15.556L31.113,1.414L29.698,0L15.556,14.142L1.414,0L0,1.414l14.142,14.142L0,29.698z"+'"></path></svg>';r0+="</span>";return r0};M.t59.j=1;M.t59.a=1;M.t60=function t60(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_pseudo icon_cross-small"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" width="'+"14"+'" height="'+"14"+'"><path fill="'+"currentColor"+'" d="'+"M14.5,0.2l-0.7-0.7L7.5,5.799L1.2-0.5L0.5,0.2l6.3,6.3 l-6.3,6.299L1.2,13.5l6.3-6.3l6.3,6.3l0.7-0.701L8.2,6.5L14.5,0.2z"+'"></path></svg>';r0+="</span>";return r0};M.t60.j=1;M.t60.a=1;M.t61=function t61(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_pin"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" class="'+"svg-icon"+'" width="'+"11"+'" height="'+"18"+'"><path fill="'+"currentColor"+'" d="'+"M11 5.361c0-2.961-2.462-5.361-5.5-5.361-3.037 0-5.5 2.4-5.5 5.361s2.463 5.362 5.5 5.362l-1.965 7.277c4.666-6.319 7.465-9.027 7.465-12.639zm-7.621 0c0-1.142.949-2.067 2.121-2.067s2.121.926 2.121 2.067c0 1.143-.949 2.068-2.121 2.068s-2.121-.925-2.121-2.068z"+'"></path></svg>';r0+="</span>";return r0};M.t61.j=1;M.t61.a=1;M.t62=function t62(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_eye"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" class="'+"svg-icon"+'" width="'+"19"+'" height="'+"19"+'"><path fill="'+"currentColor"+'" fill-rule="'+"evenodd"+'" clip-rule="'+"evenodd"+'" d="'+"M9,4.561c-1.08,0-1.96,0.96-1.96,2.06c0,1.131,0.88,2.04,1.96,2.04 c1.061,0,1.98-0.909,1.98-2.04C10.98,5.521,10.061,4.561,9,4.561z M13.41,6.62c0-2.51-1.99-4.57-4.41-4.57S4.59,4.11,4.59,6.62 c0,2.52,1.99,4.58,4.41,4.58S13.41,9.14,13.41,6.62z M18,6.62c0,0-3.62,6.49-9,6.49S0,6.62,0,6.62s3.62-6.51,9-6.51S18,6.62,18,6.62 z"+'"></path></svg>';r0+="</span>";return r0};M.t62.j=1;M.t62.a=1;M.t63=function t63(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_heart"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" class="'+"svg-icon"+'" width="'+"16.998"+'" height="'+"14"+'"><path fill-rule="'+"evenodd"+'" clip-rule="'+"evenodd"+'" fill="'+"currentColor"+'" d="'+"M12.398.04c-.257-.025-.498-.04-.723-.04-1.812 0-2.681 1.346-3.676 2.348-.993-1.002-1.863-2.348-3.674-2.348-.226 0-.468.015-.724.04-1.569.127-3.381 1.345-3.601 3.694v.773c.206 2.247 2.192 5.015 7.999 8.493 5.808-3.478 7.796-6.246 8.001-8.493v-.773c-.221-2.349-2.034-3.567-3.602-3.694z"+'"></path></svg>';r0+="</span>";return r0};M.t63.j=1;M.t63.a=1;M.t64=function t64(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_star"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" class="'+"svg-icon"+'" width="'+"17"+'" height="'+"15"+'"><polygon fill="'+"currentColor"+'" points="'+"8.5,0 10.971,4.939 17,6 12.5,9.57 13.439,15 8.5,12.439 3.561,15 4.5,9.57 0,6 6.029,4.939"+'"></polygon></svg>';r0+="</span>";return r0};M.t64.j=1;M.t64.a=1;M.t65=function t65(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_code"+'">';r0+='<svg xmlns="'+"http://www.w3.org/2000/svg"+'" class="'+"svg-icon"+'" width="'+"19"+'" height="'+"11"+'"><path fill="'+"currentColor"+'" d="'+"M 0 5.5 L 5.6043 11 L 7.0053 9.625 L 2.8022 5.5 L 7.0053 1.3751 L 5.6043 0 L 1.4011 4.125 L 0 5.5 ZM 19 5.5 L 17.5989 4.125 L 13.3957 0 L 11.9947 1.3751 L 16.1978 5.5 L 11.9947 9.625 L 13.3957 11 L 19 5.5 Z"+'"></path></svg>';r0+="</span>";return r0};M.t65.j=1;M.t65.a=1;M.t66=function t66(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" content";return r0};M.t66.j=j77;M.t66.a=0;M.t67=function t67(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" overlay";return r0};M.t67.j=j78;M.t67.a=0;M.t68=function t68(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"popup shortcuts"+'" data-nb="'+"islands-modal-popup"+'">';r0+="<h3>"+"Клавиатурные сокращения"+"</h3>";var items0=selectNametest("keys",c0.doc.root,[]);for(var i1=0,l1=items0.length;i1<l1;i1++){var c1=items0[i1];r0+=m.a(m,m.s(j3,c1),"shortcut",a0)}r0+="</div>";return r0};M.t68.j=1;M.t68.a=1;M.t69=function t69(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"shortcut"+'">';var items0=selectNametest("keys",c0,[]);for(var i1=0,l1=items0.length;i1<l1;i1++){var c1=items0[i1];if(i1>0){r0+=" / "}if(simpleBoolean("shift",c1)){r0+=m.f("f5",c1,i1,l1,a0,"shift");r0+=" + "}if(simpleBoolean("alt",c1)){r0+=m.f("f5",c1,i1,l1,a0,"alt");r0+=" + "}if(simpleBoolean("ctrl",c1)){r0+=m.f("f5",c1,i1,l1,a0,"ctrl");r0+=" + "}if(simpleBoolean("meta",c1)){r0+=m.f("f5",c1,i1,l1,a0,"meta");r0+=" + "}r0+=m.f("f5",c1,i1,l1,a0,simpleScalar("keyName",c1))}r0+='<div class="'+"shortcut-action"+'">';r0+=nodeset2xml(m.f("f4",c0,i0,l0,simpleScalar("actionName",c0)));r0+="</div>";r0+="</div>";return r0};M.t69.j=j2;M.t69.a=0;M.t70=function t70(m,c0,i0,l0,a0){var r0="";return r0};M.t70.j=j87;M.t70.a=0;M.t71=function t71(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"head"+'">';r0+='<h1 class="'+"header-logo"+'">';r0+='<span class="'+"header-logo-text"+'">'+"Яндекс"+"</span>";r0+='<span class="'+"header-logo-image"+'"></span>';r0+="</h1>";r0+='<div class="'+"search-arrow"+'">';r0+='<label class="'+"search-field"+'">';r0+='<a class="'+"field-label"+'" href="'+"#root"+'">';r0+="Фотки";r0+="</a>";r0+='<span class="'+"field-content"+'">';r0+='<input class="'+"input-controller"+'" type="'+"text"+'" value="'+""+'"/>';r0+='<span class="'+"input-view"+'">'+" "+"</span>";r0+="</span>";r0+="</label>";r0+='<button class="'+"button"+'">';r0+='<span class="'+"button-content"+'">'+"Найти"+"</span>";r0+="</button>";r0+="</div>";r0+='<img class="'+"proto-login"+'" src="'+"/next/i/login.png"+'"/>';r0+="</div>";return r0};M.t71.j=j88;M.t71.a=0;M.t72=function t72(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);if(cmpSN("fullscreen",m.s(j90,c0.doc.root))){r0+=" bar bar_dark"}else{r0+=" bar"}return r0};M.t72.j=j89;M.t72.a=0;M.t73=function t73(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j3,c0),"ns-view-desc",a0);return r0};M.t73.j=j89;M.t73.a=0;M.t74=function t74(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" page-index";return r0};M.t74.j=j91;M.t74.a=0;M.t75=function t75(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Hi, I am index page";return r0};M.t75.j=j91;M.t75.a=0;M.t76=function t76(m,c0,i0,l0,a0){var r0="";var j92=[];r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("photo")};a0.s="div";if(cmpSN("fullscreen",m.s(j90,c0.doc.root))){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" photo_dark photo_no-panel")}else{a0.a["class"]=new yr.scalarAttr(" photo_dark photo_no-panel")}}r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("closer js-go-back-area")};a0.s="div";r0+=m.a(m,[c0.doc.root],"icon_cross",a0);r0+=closeAttrs(a0);r0+="</div>";r0+="<div";a0.a={"class":new yr.scalarAttr("photo__frame")};a0.s="div";r0+=m.a(m,m.s(j93,c0.doc.root),"ns-view",a0);r0+=m.a(m,m.s(j94,c0.doc.root),"ns-view",a0);r0+=m.a(m,m.s(j95,c0.doc.root),"ns-view",a0);r0+=m.a(m,m.s(j96,c0.doc.root),"ns-view",a0);r0+=m.a(m,m.s(j97,c0.doc.root),"ns-view",a0);r0+=m.a(m,m.s(j98,c0.doc.root),"ns-view",a0);r0+=m.a(m,m.s(j3,c0),"photo-is-updating",a0);r0+=closeAttrs(a0);r0+="</div>";r0+=m.a(m,m.s(j99,c0.doc.root),"ns-view",a0);r0+="</div>";return r0};M.t76.j=j18;M.t76.a=0;M.t77=function t77(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"photo-is-updating photo-is-updating_hidden js-spinner"+'">';r0+=m.f("f2",c0,i0,l0,a0,"xl",true,true);r0+="</div>";return r0};M.t77.j=j18;M.t77.a=0;M.t78=function t78(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" photo-box js-photo-box";return r0};M.t78.j=j100;M.t78.a=0;M.t79=function t79(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" image-wrap";return r0};M.t79.j=j101;M.t79.a=0;M.t80=function t80(m,c0,i0,l0,a0){var r0="";var v63=m.s(j102,c0.doc.root);r0+=m.a(m,v63,"photo-image",a0);return r0};M.t80.j=j101;M.t80.a=0;M.t81=function t81(m,c0,i0,l0,a0){var r0="";return r0};M.t81.j=j101;M.t81.a=0;M.t82=function t82(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j3,c0),"error-image-not-found",a0);return r0};M.t82.j=j104;M.t82.a=0;M.t83=function t83(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j3,c0),"photo-blocked",a0,m.s(j106,c0.doc.root));return r0};M.t83.j=j105;M.t83.a=0;M.t84=function t84(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j3,c0),"error-image-not-found",a0);return r0};M.t84.j=j108;M.t84.a=0;M.t85=function t85(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j3,c0),"error-access-denied",a0);return r0};M.t85.j=j109;M.t85.a=0;M.t86=function t86(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"image-dummy"+'">';r0+='<div class="'+"image__inner"+'">';r0+='<div class="'+"image__header"+'">'+"Фото не найдено"+"</div>";r0+='<div class="'+"image__note"+'">';r0+="Фото не найдено или у вас нет прав на его просмотр";r0+="</div>";r0+="</div>";r0+="</div>";return r0};M.t86.j=j2;M.t86.a=0;M.t87=function t87(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"image-dummy"+'">';r0+='<div class="'+"image__inner"+'">';r0+='<div class="'+"image__header"+'">'+"Доступ ограничен"+"</div>";r0+='<div class="'+"image__note"+'">';r0+="У вас нет прав на просмотр этой фотографии";r0+="</div>";r0+="</div>";r0+="</div>";return r0};M.t87.j=j2;M.t87.a=0;M.t88=function t88(m,c0,i0,l0,a0){var r0="";var v64=yr.externals["getBoxDimentions"]();var v65=yr.externals["getClosestSize"](m.s(j3,c0),v64);r0+=closeAttrs(a0);r0+='<img class="'+"image js-image"+'" src="'+nodeset2attrvalue(m.n(j110,yr.object2nodeset(v65)))+'" data-size="'+nodeset2attrvalue(m.n(j17,yr.object2nodeset(v65)))+'" data-size-name="'+nodeset2attrvalue(m.n(j111,yr.object2nodeset(v65)))+'"/>';return r0};M.t88.j=j18;M.t88.a=0;M.t89=function t89(m,c0,i0,l0,a0){var r0="";var j114=[];var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" image-wrap_well")}else{a0.a["class"]=new yr.scalarAttr(" image-wrap_well")}r0+=closeAttrs(a0);r0+='<div class="'+"image-dummy"+'">';r0+='<div class="'+"image__inner"+'">';r0+='<div class="'+"image__header"+'">'+"Альбом защищён паролем"+"</div>";r0+='<div class="'+"image__note"+'">';r0+='<div class="'+"group"+'">';r0+='<input class="'+"input group-item js-album-password"+'" type="'+"password"+'" placeholder="'+"Введите пароль"+'" style="'+"width:200px"+'"/>';r0+='<button class="'+"button group-item js-button-password-check is-disabled"+'" type="'+"button"+'">';r0+="<span";a0.a={"class":new yr.scalarAttr("button-content")};a0.s="span";r0+=m.a(m,[c0.doc.root],"icon_lock",a0);r0+=closeAttrs(a0);r0+="</span>";r0+="</button>";r0+="</div>";r0+="</div>";r0+="</div>";r0+="</div>";return r0};M.t89.j=j113;M.t89.a=0;M.t90=function t90(m,c0,i0,l0,a0){var r0="";var v66=m.s(j117,c0.doc.root);r0+=closeAttrs(a0);r0+='<div class="'+"image-dummy"+'">';r0+='<div class="'+"image__inner"+'">';r0+='<div class="'+"image__header"+'">'+"Фото не найдено"+"</div>";r0+='<div class="'+"image__note"+'">';r0+="Произошёл технический сбой.";if(nodeset2boolean(v66)){r0+="<br/>";r0+="Обратитесь в службу поддержки: ";r0+='<a class="'+"link"+'" href="'+"mailto:fotki@support.yandex.ru"+'">'+"fotki@support.yandex.ru"+"</a>"}r0+="</div>";r0+="</div>";r0+="</div>";return r0};M.t90.j=j116;M.t90.a=0;M.t91=function t91(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"image-dummy image-dummy_blocked image-dummy_18plus"+'">';r0+='<div class="'+"image__inner"+'">';r0+='<div class="'+"image__header"+'">'+"Запретный контент"+"</div>";
r0+='<div class="'+"image__note"+'">';r0+="Если вам меньше 18 лет, то фото нанесёт непоправимый вред вашей психике. ";r0+="Повлияет на будущие поступки и мировоззрение";r0+="</div>";r0+='<div class="'+"image__form"+'">';r0+='<button class="'+"button button_gap-right js-button-gte18"+'">';r0+='<span class="'+"button-content"+'">'+"Да, я старше 18"+"</span>";r0+="</button>";r0+='<button class="'+"button js-button-lt18"+'">';r0+='<span class="'+"button-content"+'">'+"Нет"+"</span>";r0+="</button>";r0+="</div>";r0+="</div>";r0+="</div>";return r0};M.t91.j=j121;M.t91.a=0;M.t92=function t92(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j3,c0),"photo-blocked",a0,selectNametest("blockReason",c0,[]));return r0};M.t92.j=j123;M.t92.a=0;M.t93=function t93(m,c0,i0,l0,a0,v67){v67=v67===undefined?[]:v67;var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"image-dummy image-dummy_blocked"+'">';r0+='<div class="'+"image__inner"+'">';r0+='<div class="'+"image__header"+'">'+"Фото заблокировано"+"</div>";if(nodeset2boolean(v67)){r0+=m.a(m,v67,"photo-image-block-reason",a0)}else{r0+=m.f("f7",c0,i0,l0,a0)}r0+="</div>";r0+="</div>";return r0};M.t93.j=j2;M.t93.a=0;M.t94=function t94(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"image__note"+'">';r0+="На этот файл поступила жалоба, доступ к нему заблокирован. ";r0+=m.f("f6",c0,i0,l0,a0);r0+="</div>";return r0};M.t94.j=j124;M.t94.a=0;M.t95=function t95(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"image__note"+'">';r0+="Доступ к файлу заблокирован ";if(simpleBoolean("url",c0)){r0+='<a href="'+nodeset2attrvalue(selectNametest("url",c0,[]))+'" class="'+"link"+'" target="'+"_blank"+'">'+"по решению суда"+"</a>"}else{r0+="по решению суда"}r0+=". ";r0+="<br/>";r0+=m.f("f6",c0,i0,l0,a0);r0+="</div>";return r0};M.t95.j=j126;M.t95.a=0;M.t96=function t96(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=m.f("f7",c0,i0,l0,a0);return r0};M.t96.j=j128;M.t96.a=0;M.t97=function t97(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Что-то пошло не так";return r0};M.t97.j=1;M.t97.a=1;M.t98=function t98(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Введите пароль";return r0};M.t98.j=1;M.t98.a=1;M.t99=function t99(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Неверный пароль";return r0};M.t99.j=1;M.t99.a=1;M.t100=function t100(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" panel js-panel";return r0};M.t100.j=j129;M.t100.a=0;M.t101=function t101(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" panel js-panel is-hidden";return r0};M.t101.j=j130;M.t101.a=0;M.t102=function t102(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("panel__inner")};a0.s="div";r0+=m.a(m,m.s(j131,c0.doc.root),"ns-view",a0);r0+=m.a(m,m.s(j132,c0.doc.root),"ns-view",a0);r0+=closeAttrs(a0);r0+="</div>";return r0};M.t102.j=j129;M.t102.a=0;M.t103=function t103(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j3,c0),"normal-content",a0);return r0};M.t103.j=j133;M.t103.a=0;M.t104=function t104(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j3,c0),"normal-content",a0);return r0};M.t104.j=j136;M.t104.a=0;M.t105=function t105(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j3,c0),"normal-content",a0);return r0};M.t105.j=j138;M.t105.a=0;M.t106=function t106(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j134,c0.doc.root),"photo-view-panel__author",a0);return r0};M.t106.j=j139;M.t106.a=0;M.t107=function t107(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j134,c0.doc.root),"photo-view-panel__author",a0);return r0};M.t107.j=j140;M.t107.a=0;M.t108=function t108(m,c0,i0,l0,a0){var r0="";var v68=m.s(j102,c0.doc.root);var v69=m.n(j112,v68);function p35(m,c0,i0,l0){return!nodeset2boolean(v69)}var j141=[4,p35];var v70=m.n(j141,v68);if(nodeset2boolean(v70)){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" js-metrika-visible")}else{a0.a["class"]=new yr.scalarAttr(" js-metrika-visible")}}r0+=m.a(m,m.s(j134,c0.doc.root),"photo-view-panel__author",a0);r0+=m.a(m,v70,"photo-view-panel__title",a0);r0+=m.a(m,v68,"photo-view-panel__info",a0);r0+=m.a(m,v70,"photo-view-panel__description",a0);return r0};M.t108.j=j133;M.t108.a=0;M.t109=function t109(m,c0,i0,l0,a0){var r0="";var v71=m.s(j3,c0);var v72=m.s(j102,c0.doc.root);var v73=m.n(j143,v71);var r1=[];if(nodeset2boolean(m.n(j145,v71))){r1=m.n(j145,v71)}else{r1=m.s(j144,c0.doc.root)}var v74=r1;var v75=cmpNN(m.s(j119,c0.doc.root),v73);function p36(m,c0,i0,l0){return!v75}var j146=[4,p36];r0+=closeAttrs(a0);r0+='<div class="'+"author"+'">';r0+='<div class="'+"userpic"+'" style="'+"background-image: url("+scalar2attrvalue(yr.externals["getAvatarUrl"](nodeset2scalar(v73)))+");"+'"></div>';r0+='<div class="'+"author__inner"+'">';r0+='<div class="'+"author__row"+'">';r0+='<a class="'+"username link js-username"+'" href="'+scalar2attrvalue(yr.externals["generateUrl"]("user-profile",v71))+'">';r0+=nodeset2xml(v74);r0+="</a>";r0+="</div>";r0+=m.a(m,m.n(j146,v71),"photo-info-button-follow",a0);r0+="</div>";r0+="</div>";return r0};M.t109.j=j142;M.t109.a=0;M.t110=function t110(m,c0,i0,l0,a0){var r0="";var v76=m.s(j147,c0);r0+=closeAttrs(a0);r0+='<div class="'+"ns-subview-follower author__row"+'">';r0+='<div class="'+"small-pseudo-button js-follow"+'">';if(nodeset2boolean(v76)){r0+='<span class="'+"button-content"+'">';r0+="Отписаться";r0+="</span>"}else{r0+='<span class="'+"button-content"+'">';r0+="Подписаться";r0+="</span>"}r0+="</div>";r0+="</div>";return r0};M.t110.j=j142;M.t110.a=0;M.t111=function t111(m,c0,i0,l0,a0){var r0="";var v77=m.s(j3,c0);var v78=m.s(j148,c0.doc.root);var v79=m.s(j149,c0.doc.root);var v80=m.s(j117,c0.doc.root);var v81=m.s(j150,c0.doc.root);r0+=closeAttrs(a0);if(nodeset2boolean(v79)){r0+='<div class="'+"photo-album"+'">';r0+='<a class="'+"link js-album-link"+'" href="'+scalar2attrvalue(yr.externals["generateUrl"]("album",v79))+'" title="'+"Альбом"+'">';r0+=scalar2xml(yr.externals["__unsafeHTML"](nodeset2scalar(m.n(j32,v79))));r0+="</a>";if(nodeset2scalar(m.n(j151,v78))>=0&&nodeset2scalar(m.n(j38,v78))>0){r0+='<span class="'+"photo-position"+'">';r0+=", фото ";r0+=scalar2xml(nodeset2scalar(m.n(j151,v78))+1)+" из "+nodeset2xml(m.n(j38,v78));r0+="</span>"}r0+="</div>"}r0+='<div class="'+"photo-info"+'">';r0+="Добавлено ";r0+=scalar2xml(yr.externals["formatDate"](nodeset2scalar(m.n(j59,v77)),"D.MM.YYYY"));if(nodeset2boolean(v80)&&nodeset2boolean(v81)){r0+=m.a(m,m.s(j3,c0),"photo-view-panel__public-toggler",a0)}r0+="</div>";return r0};M.t111.j=j18;M.t111.a=0;M.t112=function t112(m,c0,i0,l0,a0){var r0="";var v82=cmpSN("public",m.s(j152,c0));r0+=closeAttrs(a0);r0+=". ";r0+='<a class="'+"link link_alt-text js-toggle-privacy"+'">';if(v82){r0+='<span class="'+"link__content-default"+'">';r0+="Доступно всем";r0+="</span>";r0+='<span class="'+"link__content-alt"+'">';r0+="Сделать приватным";r0+="</span>"}else{r0+='<span class="'+"link__content-default"+'">';r0+="Приватное фото";r0+="</span>";r0+='<span class="'+"link__content-alt"+'">';r0+="Сделать доступным";r0+="</span>"}r0+="</a>";return r0};M.t112.j=j18;M.t112.a=0;M.t113=function t113(m,c0,i0,l0,a0){var r0="";var v83=m.s(j149,c0.doc.root);r0+=closeAttrs(a0);if(nodeset2boolean(v83)){r0+='<div class="'+"photo-album"+'">';r0+='<a class="'+"link"+'" href="'+scalar2attrvalue(yr.externals["generateUrl"]("album",v83))+'">';r0+=scalar2xml(yr.externals["__unsafeHTML"](nodeset2scalar(m.n(j32,v83))));r0+="</a>";r0+="</div>"}return r0};M.t113.j=j113;M.t113.a=0;M.t114=function t114(m,c0,i0,l0,a0){var r0="";var v84=m.s(j153,c0.doc.root);var v85=m.s(j3,c0);var v86=nodeset2scalar(m.n(j31,v85));var v87=cmpNN(m.n(j154,v85),m.n(j155,v84));var v88=m.s(j150,c0.doc.root);r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("photo-title js-nb-title")};a0.s="div";if(v87&&nodeset2boolean(v88)){a0.a["data-nb"]=new yr.scalarAttr("editable-text collapse-text");a0.a["data-nb-collapse"]=new yr.scalarAttr("{ rows: 2 }");a0.a["data-nb-edit"]=new yr.scalarAttr("{ emptyText: '"+nodeset2scalar(m.n(j31,v85))+"', nowrap: true, editEmpty: true }");r0+=closeAttrs(a0);r0+='<div class="'+"small-pseudo-button nb-text-edit"+'">';r0+='<span class="'+"button-content"+'">';r0+='<span class="'+"icon icon_small-edit-black"+'"></span>';r0+="</span>";r0+="</div>";r0+='<div class="'+"photo-title__value nb-text nb-editable-text_editable"+'">';r0+=m.f("f8",c0,i0,l0,a0,m.n(j32,v85));r0+="</div>";r0+=m.a(m,m.s(j3,c0),"collapse-text",a0);r0+=m.a(m,m.s(j3,c0),"editable-text",a0,"Заголовок",nodeset2scalar(m.n(j32,v85)))}else{a0.a["data-nb"]=new yr.scalarAttr("collapse-text");a0.a["data-nb-collapse"]=new yr.scalarAttr("{ rows: 2 }");r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("photo-title__value nb-text")};a0.s="div";if(!nodeset2boolean(m.n(j32,v85))){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" nb-editable-text__empty-value")}else{a0.a["class"]=new yr.scalarAttr(" nb-editable-text__empty-value")}r0+=closeAttrs(a0);r0+=nodeset2xml(m.n(j31,v85))}else{r0+=closeAttrs(a0);r0+=m.f("f8",c0,i0,l0,a0,m.n(j32,v85))}r0+=closeAttrs(a0);r0+="</div>";r0+=m.a(m,m.s(j3,c0),"collapse-text",a0)}r0+=closeAttrs(a0);r0+="</div>";return r0};M.t114.j=j18;M.t114.a=0;M.t115=function t115(m,c0,i0,l0,a0){var r0="";var v89=m.s(j153,c0.doc.root);var v90=m.s(j3,c0);var v91=m.s(j156,c0.doc.root);var v92=cmpNN(m.n(j154,v90),m.n(j155,v89));var v93=m.s(j150,c0.doc.root);r0+=closeAttrs(a0);if(nodeset2boolean(m.n(j157,v91))||v92&&nodeset2boolean(v93)){r0+="<div";a0.a={"class":new yr.scalarAttr("photo-description js-nb-description")};a0.s="div";a0.a["data-nb"]=new yr.scalarAttr("collapse-text");a0.a["data-nb-collapse"]=new yr.scalarAttr("{ rows: 2 }");var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" collapse-text_multiline")}else{a0.a["class"]=new yr.scalarAttr(" collapse-text_multiline")}if(v92&&nodeset2boolean(v93)){var tmp0=a0.a["data-nb"];if(tmp0){a0.a["data-nb"]=tmp0.addscalar(" editable-text")}else{a0.a["data-nb"]=new yr.scalarAttr(" editable-text")}a0.a["data-nb-edit"]=new yr.scalarAttr("{ emptyText: 'Введите описание' }");r0+=closeAttrs(a0);r0+='<div class="'+"small-pseudo-button nb-text-edit"+'">';r0+='<span class="'+"button-content"+'">';r0+='<span class="'+"icon icon_small-edit-black"+'"></span>';r0+="</span>";r0+="</div>";r0+='<div class="'+"photo-description__value nb-text nb-editable-text_editable"+'">';r0+=m.f("f9",c0,i0,l0,a0,m.n(j157,v91));r0+="</div>";r0+=m.a(m,m.s(j3,c0),"collapse-text",a0);r0+=m.a(m,m.s(j3,c0),"editable-text",a0,"Описание",nodeset2scalar(m.n(j157,v91)))}else{r0+=closeAttrs(a0);r0+='<div class="'+"photo-description__value nb-text"+'">';if(nodeset2boolean(m.n(j157,v91))){r0+=m.f("f9",c0,i0,l0,a0,m.n(j157,v91))}r0+="</div>";r0+=m.a(m,m.s(j3,c0),"collapse-text",a0)}r0+=closeAttrs(a0);r0+="</div>"}return r0};M.t115.j=j18;M.t115.a=0;M.t116=function t116(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось сохранить описание";return r0};M.t116.j=1;M.t116.a=1;M.t117=function t117(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось сохранить заголовок";return r0};M.t117.j=1;M.t117.a=1;M.t118=function t118(m,c0,i0,l0,a0){var r0="";var v94=m.s(j102,c0.doc.root);r0+=closeAttrs(a0);r0+='<div class="'+"slider-info"+'">';r0+="<div";a0.a={"class":new yr.scalarAttr("slider-info__right")};a0.s="div";r0+=m.a(m,v94,"photo-slider-info__position",a0);r0+=closeAttrs(a0);r0+="</div>";r0+="<div";a0.a={"class":new yr.scalarAttr("slider-info__inner")};a0.s="div";r0+=m.a(m,v94,"photo-slider-info__title",a0);r0+=closeAttrs(a0);r0+="</div>";r0+="</div>";return r0};M.t118.j=j158;M.t118.a=0;M.t119=function t119(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);if(simpleBoolean("title",c0)){r0+=m.f("f8",c0,i0,l0,a0,selectNametest("title",c0,[]))}else{r0+=nodeset2xml(selectNametest("fileName",c0,[]))}return r0};M.t119.j=j18;M.t119.a=0;M.t120=function t120(m,c0,i0,l0,a0){var r0="";var v95=m.s(j148,c0.doc.root);r0+=closeAttrs(a0);if(nodeset2scalar(m.n(j151,v95))>=0&&nodeset2scalar(m.n(j38,v95))>0){r0+=scalar2xml(nodeset2scalar(m.n(j151,v95))+1)+" из "+nodeset2xml(m.n(j38,v95))}return r0};M.t120.j=j18;M.t120.a=0;M.t121=function t121(m,c0,i0,l0,a0){var r0="";var v96=m.s(j160,c0.doc.root);if(!nodeset2boolean(v96)){var v97=m.n(j161,yr.array2nodeset(yr.externals["getMedals"](m.s(j156,c0.doc.root))));var r1={};var a1={a:{}};if(nodeset2boolean(v97)){r1["item"]=yr.nodeset2data(v97)}var v98=r1;var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" js-metrika-visible")}else{a0.a["class"]=new yr.scalarAttr(" js-metrika-visible")}r0+=m.a(m,m.s(j162,c0.doc.root),"photo-view-panel__tags",a0);r0+=m.a(m,yr.object2nodeset(v98),"photo-view-panel__honors",a0)}return r0};M.t121.j=j159;M.t121.a=0;M.t122=function t122(m,c0,i0,l0,a0){var r0="";return r0};M.t122.j=j159;M.t122.a=0;M.t123=function t123(m,c0,i0,l0,a0){var r0="";var r1={};var a1={a:{}};r1["author-login"]=yr.nodeset2data(m.s(j144,c0.doc.root));var v99=r1;r0+=closeAttrs(a0);if(m.s(j164,c0).length>0){r0+="<div";a0.a={"class":new yr.scalarAttr("photo-tags js-collapsed-text")};a0.s="div";a0.a["data-nb"]=new yr.scalarAttr("collapse-text");a0.a["data-nb-collapse"]=new yr.scalarAttr("{ rows: 1 }");r0+=m.a(m,selectNametest("tags",c0,[]),"editable-tags",a0,v99,false);r0+=m.a(m,m.s(j3,c0),"collapse-text",a0);r0+=closeAttrs(a0);r0+="</div>"}return r0};M.t123.j=j163;M.t123.a=0;M.t124=function t124(m,c0,i0,l0,a0){var r0="";var r1={};var a1={a:{}};r1["author-login"]=yr.nodeset2data(m.s(j144,c0.doc.root));var v100=r1;r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("photo-tags")};a0.s="div";var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" js-collapsed-text")}else{a0.a["class"]=new yr.scalarAttr(" js-collapsed-text")}a0.a["data-nb"]=new yr.scalarAttr("collapse-text");a0.a["data-nb-collapse"]=new yr.scalarAttr("{ rows: 1 }");var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" js-editable-tags")}else{a0.a["class"]=new yr.scalarAttr(" js-editable-tags")}var tmp0=a0.a["data-nb"];if(tmp0){a0.a["data-nb"]=tmp0.addscalar(" editable-tags")}else{a0.a["data-nb"]=new yr.scalarAttr(" editable-tags")}r0+=closeAttrs(a0);r0+='<div class="'+"small-pseudo-button js-editable-tags-edit-pencil"+'">';r0+='<span class="'+"button-content"+'">';r0+='<span class="'+"icon icon_small-edit-black"+'"></span>';r0+="</span>";r0+="</div>";r0+=m.a(m,selectNametest("tags",c0,[]),"editable-tags",a0,v100,true);r0+=m.a(m,m.s(j3,c0),"collapse-text",a0);r0+="</div>";return r0};M.t124.j=j166;M.t124.a=0;M.t125=function t125(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"photo-honors"+'">';r0+="<div";a0.a={"class":new yr.scalarAttr("medals-wrapper medals-wrapper_solo")};a0.s="div";r0+=m.a(m,selectNametest("item",c0,[]),"medal",a0);r0+=closeAttrs(a0);r0+="</div>";r0+="</div>";return r0};M.t125.j=j167;M.t125.a=0;M.t126=function t126(m,c0,i0,l0,a0){var r0="";var r1={};var a1={a:{}};r1["1"]="Одна награда";r1["2"]="Две награды";r1["3"]="Три награды";r1["4"]="Четыре награды";r1["5"]="Пять наград";r1["6"]="Шесть наград";r1["7"]="Семь наград";r1["8"]="Восемь наград";r1["9"]="Девять наград";r1["10"]="Десять наград";var v101=r1;var v102=selectNametest("item",c0,[]).length;r0+=closeAttrs(a0);r0+='<div class="'+"photo-honors__total"+'">';if(v102>10){r0+=scalar2xml(yr.externals["plural"](v102,"","$0 награда","$0 награды","$0 наград"))}else{function p40(m,c0,i0,l0){return c0.name==v102}var j168=[0,"*",2,p40];r0+=nodeset2xml(m.n(j168,yr.object2nodeset(v101)))}r0+="</div>";return r0};M.t126.j=j2;M.t126.a=0;M.t127=function t127(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("photo-honors collapse-text_collapsed js-medals")};a0.s="div";a0.a["data-nb"]=new yr.scalarAttr("collapse-text");a0.a["data-nb-collapse"]=new yr.scalarAttr("{ rows: 1, always: true }");r0+=closeAttrs(a0);r0+='<div class="'+"nb-text"+'"></div>';r0+="<div";a0.a={"class":new yr.scalarAttr("medals-wrapper js-medals-wrapper")};a0.s="div";r0+=m.a(m,m.s(j3,c0),"photo-honors__total",a0);r0+=m.a(m,selectNametest("item",c0,[]),"medal",a0);r0+=closeAttrs(a0);r0+="</div>";r0+=m.a(m,m.s(j3,c0),"collapse-text",a0);r0+="</div>";return r0};M.t127.j=j169;M.t127.a=0;M.t128=function t128(m,c0,i0,l0,a0){var r0="";var v103=yr.externals["formatDate"](simpleScalar("date",c0),"D MMMM YYYY");var v104="Фото Дня за "+v103;r0+=closeAttrs(a0);r0+='<div class="'+"medal-wrapper medal_photoofday-wrapper js-medal_photoofday"+'" title="'+scalar2attrvalue(v104)+'">';r0+='<span class="'+"medal medal-photoofday"+'"></span>';r0+="<a";a0.a={"class":new yr.scalarAttr("medal__link")};a0.s="a";a0.a["href"]=new yr.scalarAttr(yr.externals["generateUrl"]("calendar",m.s(j3,c0)));r0+=closeAttrs(a0);r0+="Фото дня";r0+="</a>";r0+='<span class="'+"medal__place"+'">';r0+=scalar2xml(v103);r0+="</span>";r0+="</div>";return r0};M.t128.j=j170;M.t128.a=0;M.t129=function t129(m,c0,i0,l0,a0){var r0="";var v105=yr.externals["formatDate"](simpleScalar("date",c0),"D MMMM YYYY");var v106="Было в ТОП "+v105;r0+=closeAttrs(a0);r0+='<div class="'+"medal-wrapper medal_photoofday-wrapper js-medal_photoofday"+'" title="'+scalar2attrvalue(v106)+'">';r0+='<span class="'+"medal medal-top"+'"></span>';r0+='<span class="'+"medal__name"+'">';r0+="Было в ТОП";r0+="</span>";r0+='<span class="'+"medal__place"+'">';r0+=scalar2xml(v105);r0+="</span>";r0+="</div>";return r0};M.t129.j=j172;M.t129.a=0;M.t130=function t130(m,c0,i0,l0,a0){var r0="";var r1="";var a1={a:{}};if(cmpSN(1,selectNametest("place",c0,[]))){r1+="medal-gold"}if(cmpSN(2,selectNametest("place",c0,[]))){r1+="medal-silver"}if(cmpSN(3,selectNametest("place",c0,[]))){r1+="medal-bronse"}if(simpleScalar("place",c0)>3||selectNametest("place",c0,[]).length==0){r1+="medal-pure"}var v107=r1;var v108=yr.externals["plural"](simpleScalar("place",c0),"","$0 место","$0 место","$0 место");var v109=yr.externals["formatDate"](simpleScalar("date",c0),"D MMMM YYYY");var v110=v108+' в конкурсе "'+nodeset2scalar(selectNametest("name",c0,[]))+'"';r0+=closeAttrs(a0);r0+='<div class="'+"medal-wrapper"+'" title="'+scalar2attrvalue(v110)+'">';r0+='<span class="'+"medal "+scalar2attrvalue(v107)+'"></span>';r0+="<a";a0.a={"class":new yr.scalarAttr("medal__link")};a0.s="a";a0.a["href"]=new yr.scalarAttr(yr.externals["generateUrl"]("contest",yr.externals["null"](),yr.externals["object"](m.s(j3,c0))));r0+=closeAttrs(a0);r0+=nodeset2xml(selectNametest("name",c0,[]));r0+="</a>";r0+='<span class="'+"medal__place"+'">';r0+=scalar2xml(v108)+", "+scalar2xml(v109);r0+="</span>";r0+="</div>";return r0};M.t130.j=j173;M.t130.a=0;M.t131=function t131(m,c0,i0,l0,a0){var r0="";var v111="medal-white";var v112='Конкурс "'+nodeset2scalar(selectNametest("name",c0,[]))+'"';r0+=closeAttrs(a0);r0+='<div class="'+"medal-wrapper"+'" title="'+scalar2attrvalue(v112)+'">';r0+="<span";a0.a={"class":new yr.scalarAttr("medal "+v111)};a0.s="span";if(cmpSN("submitted",selectNametest("status",c0,[]))){a0.a["title"]=new yr.scalarAttr("После проверки модератором фото будет доступно среди других фотографий-участниц конкурса")}if(cmpSN("accepted",selectNametest("status",c0,[]))){a0.a["title"]=new yr.scalarAttr("Начало голосования "+yr.externals["formatDate"](simpleScalar("votingStartDate",c0),"D MMMM YYYY"))}r0+=closeAttrs(a0);r0+="</span>";r0+="<a";a0.a={"class":new yr.scalarAttr("medal__link")};a0.s="a";a0.a["href"]=new yr.scalarAttr(yr.externals["generateUrl"]("contest",yr.externals["null"](),yr.externals["object"](m.s(j3,c0))));r0+=closeAttrs(a0);r0+=nodeset2xml(selectNametest("name",c0,[]));r0+="</a>";r0+='<span class="'+"medal__place"+'">';r0+="фото участвует в конкурсе";r0+="</span>";r0+="</div>";return r0};M.t131.j=j175;M.t131.a=0;M.t132=function t132(m,c0,i0,l0,a0){var r0="";var v113="medal-white";var v114='Конкурс "'+nodeset2scalar(selectNametest("name",c0,[]))+'"';var v115=yr.externals["plural"](simpleScalar("place",c0),"","место $0","место $0","место $0");r0+=closeAttrs(a0);r0+='<div class="'+"medal-wrapper"+'" title="'+scalar2attrvalue(v114)+'">';r0+="<span";a0.a={"class":new yr.scalarAttr("medal "+v113)};a0.s="span";a0.a["title"]=new yr.scalarAttr("Голосование продлится до "+yr.externals["formatDate"](simpleScalar("votingFinishDate",c0),"D MMMM YYYY"));r0+=closeAttrs(a0);r0+="</span>";r0+="<a";a0.a={"class":new yr.scalarAttr("medal__link")};a0.s="a";a0.a["href"]=new yr.scalarAttr(yr.externals["generateUrl"]("contest",yr.externals["null"](),yr.externals["object"](m.s(j3,c0))));r0+=closeAttrs(a0);r0+=nodeset2xml(selectNametest("name",c0,[]));r0+="</a>";r0+='<span class="'+"medal__place"+'">';r0+="участвует в конкурсе, "+scalar2xml(v115);r0+="</span>";r0+="</div>";return r0};M.t132.j=j179;M.t132.a=0;M.t133=function t133(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось сохранить метки";return r0};M.t133.j=1;M.t133.a=1;M.t134=function t134(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Нельзя добавить больше 30 меток";return r0};M.t134.j=1;M.t134.a=1;M.t135=function t135(m,c0,i0,l0,a0){var r0="";var v116=m.s(j156,c0.doc.root);var v117="_"+nodeset2scalar(m.s(j144,c0.doc.root))+"-"+nodeset2scalar(m.s(j182,c0.doc.root))+"-"+nodeset2scalar(m.s(j90,c0.doc.root));var v118="photo-map"+v117;var v119=cmpNN(m.s(j120,c0.doc.root),m.s(j119,c0.doc.root));var v120=!!nodeset2boolean(m.n(j183,v116));var v121=m.s(j184,c0.doc.root);var v122=v120||v119;var v123=v120||v119&&nodeset2boolean(v121);r0+=closeAttrs(a0);if(v122){var j185=[];r0+="<div";a0.a={"class":new yr.scalarAttr("ghost-button ns-subview-map-button"),title:new yr.scalarAttr("Это фото на карте")};a0.s="div";if(!v123){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" ghost-button_inactive")}else{a0.a["class"]=new yr.scalarAttr(" ghost-button_inactive")}}else{var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" js-photo-map-toggler")}else{a0.a["class"]=new yr.scalarAttr(" js-photo-map-toggler")}a0.a["data-nb"]=new yr.scalarAttr("popup-toggler");a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v118+"', how: { where: 'left top', what: 'left bottom' } }")}r0+=m.a(m,[c0.doc.root],"icon_pin",a0);r0+=closeAttrs(a0);r0+='<span class="'+"button-content"+'">';if(nodeset2boolean(m.n(j183,v116))){r0+="На карте"}else{r0+="Привязать к карте"}r0+="</span>";r0+="</div>";r0+="<div";a0.a={"class":new yr.scalarAttr("popup popup_to_top map-popup js-map-popup _hidden"),"data-nb":new yr.scalarAttr("islands-popup"),id:new yr.scalarAttr(v118)};a0.s="div";r0+=m.a(m,v116,"map",a0,v119,v121);r0+=closeAttrs(a0);r0+="</div>"}return r0};M.t135.j=j181;M.t135.a=0;M.t136=function t136(m,c0,i0,l0,a0){var r0="";return r0};M.t136.j=j181;M.t136.a=0;M.t137=function t137(m,c0,i0,l0,a0){var r0="";return r0};M.t137.j=j181;M.t137.a=0;M.t138=function t138(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось привязать фотографию к карте";return r0};M.t138.j=1;M.t138.a=1;M.t139=function t139(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось удалить привязку к карте";return r0};M.t139.j=1;M.t139.a=1;M.t140=function t140(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" photo-controls";return r0};M.t140.j=j186;M.t140.a=0;M.t141=function t141(m,c0,i0,l0,a0){var r0="";var v124=m.s(j187,c0.doc.root);r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("photo-controls__left")};a0.s="div";r0+=m.a(m,m.s(j188,c0.doc.root),"ns-view",a0);r0+=closeAttrs(a0);r0+="</div>";r0+="<div";a0.a={"class":new yr.scalarAttr("photo-controls__right")};a0.s="div";r0+=m.a(m,m.s(j3,c0),"item-layout-toggle",a0);r0+=closeAttrs(a0);r0+="</div>";r0+="<div";a0.a={"class":new yr.scalarAttr("photo-controls__inner")};a0.s="div";if(!nodeset2boolean(v124)){r0+=m.a(m,m.s(j3,c0),"item-slideshow",a0);r0+=m.a(m,m.s(j189,c0.doc.root),"ns-view",a0);r0+=m.a(m,m.s(j3,c0),"item-views",a0);r0+=m.a(m,m.s(j3,c0),"item-like",a0);r0+=m.a(m,m.s(j3,c0),"item-favorite",a0);r0+=m.a(m,m.s(j3,c0),"item-share",a0);r0+=m.a(m,m.s(j3,c0),"item-more",a0)}else{r0+=m.a(m,m.s(j189,c0.doc.root),"ns-view",a0)}r0+=closeAttrs(a0);r0+="</div>";return r0};M.t141.j=j186;M.t141.a=0;M.t142=function t142(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j188,c0.doc.root),"ns-view",a0);r0+=m.a(m,m.s(j189,c0.doc.root),"ns-view",a0);return r0};M.t142.j=j186;M.t142.a=0;M.t143=function t143(m,c0,i0,l0,a0){var r0="";var v125=m.s(j190,c0.doc.root);var v126="_"+nodeset2scalar(m.s(j144,c0.doc.root))+"-"+nodeset2scalar(m.s(j182,c0.doc.root));var v127="stat"+v126;var v128=m.s(j191,c0.doc.root);var j193=[];r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("ns-subview-views ghost-button"),title:new yr.scalarAttr("Просмотры")};a0.s="div";if(nodeset2boolean(m.s(j190,c0.doc.root))&&!nodeset2boolean(v128)){a0.a["data-nb"]=new yr.scalarAttr("popup-toggler");a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v127+"', how: { where: 'center top', what: 'center bottom' } }");r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("popup popup_to_top stat-popup js-stat-popup _hidden"),"data-nb":new yr.scalarAttr("islands-popup"),id:new yr.scalarAttr(v127)};a0.s="div";r0+=m.a(m,m.s(j192,c0.doc.root),"stat",a0);r0+=closeAttrs(a0);r0+="</div>"}else{var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" ghost-button_inactive")}else{a0.a["class"]=new yr.scalarAttr(" ghost-button_inactive")}}r0+=m.a(m,[c0.doc.root],"icon_eye",a0);r0+=closeAttrs(a0);r0+='<span class="'+"ghost-button__counter"+'">';var items0=m.n(j4,yr.array2nodeset(yr.externals["breakNumber"](nodeset2scalar(v125))));for(var i1=0,l1=items0.length;i1<l1;i1++){var c1=items0[i1];r0+='<span class="'+"stat__item-digit"+'">'+nodeset2xml(m.s(j3,c1))+"</span>"}r0+="</span>";r0+="</div>";return r0};M.t143.j=j186;M.t143.a=0;M.t144=function t144(m,c0,i0,l0,a0){var r0="";var v129=!!nodeset2boolean(m.s(j194,c0.doc.root));var v130=m.s(j195,c0.doc.root);var v131=m.s(j196,c0.doc.root);var v132=m.s(j197,c0.doc.root);var r1="";var a1={a:{}};if(nodeset2scalar(m.n(j198,v131))){r1+="animate"}else{r1+=""}var v133=r1;var j201=[];r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("ns-subview-like ghost-button "+v133)};a0.s="div";if(!nodeset2boolean(m.n(j199,v130))&&v129){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" ghost-button_inactive")}else{a0.a["class"]=new yr.scalarAttr(" ghost-button_inactive")}}else{var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" js-like")}else{a0.a["class"]=new yr.scalarAttr(" js-like")}}if(nodeset2scalar(m.n(j200,v131))){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" ghost-button_checked")}else{a0.a["class"]=new yr.scalarAttr(" ghost-button_checked")}a0.a["title"]=new yr.scalarAttr("Больше не нравится")}else{a0.a["title"]=new yr.scalarAttr("Мне нравится")}r0+=m.a(m,[c0.doc.root],"icon_heart",a0);r0+=closeAttrs(a0);r0+='<span class="'+"ghost-button__counter"+'">'+nodeset2xml(v132)+"</span>";r0+="</div>";return r0};M.t144.j=j186;M.t144.a=0;M.t145=function t145(m,c0,i0,l0,a0){var r0="";var v134=!!nodeset2boolean(m.s(j194,c0.doc.root));var v135=m.s(j195,c0.doc.root);var v136=m.s(j196,c0.doc.root);r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("ns-subview-favorite ghost-button")};a0.s="div";if(!nodeset2boolean(m.n(j202,v135))&&v134){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" ghost-button_inactive")}else{a0.a["class"]=new yr.scalarAttr(" ghost-button_inactive")}}else{var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" js-favorite")}else{a0.a["class"]=new yr.scalarAttr(" js-favorite")}}if(nodeset2scalar(m.n(j204,v136))){var j205=[];var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" ghost-button_checked")}else{a0.a["class"]=new yr.scalarAttr(" ghost-button_checked")}a0.a["title"]=new yr.scalarAttr("Убрать из избранного");r0+=m.a(m,[c0.doc.root],"icon_star",a0);r0+=closeAttrs(a0);r0+='<span class="'+"button-content"+'">';r0+="В избранном";r0+="</span>"}else{var j203=[];a0.a["title"]=new yr.scalarAttr("Добавить в избранное");r0+=m.a(m,[c0.doc.root],"icon_star",a0);r0+=closeAttrs(a0);r0+='<span class="'+"button-content"+'">';r0+="В избранное";r0+="</span>"}r0+=closeAttrs(a0);r0+="</div>";return r0};M.t145.j=j186;M.t145.a=0;M.t146=function t146(m,c0,i0,l0,a0){var r0="";var v137=m.s(j196,c0.doc.root);r0+=closeAttrs(a0);r0+='<div class="'+"ghost-button js-slideshow"+'">';r0+='<div class="'+"ghost-button__inner ghost-button__inner_play"+'">';r0+="Слайдшоу";r0+="</div>";r0+='<div class="'+"ghost-button__inner ghost-button__inner_pause"+'">';r0+='<span class="'+"icon icon_pseudo icon_pause"+'"></span>';r0+="</div>";r0+="</div>";return r0};M.t146.j=j206;M.t146.a=0;M.t147=function t147(m,c0,i0,l0,a0){var r0="";var v138=nodeset2scalar(m.s(j90,c0.doc.root));r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("ghost-button js-layout-toggle")};a0.s="div";if(v138=="fullscreen"){var j208=[];a0.a["title"]=new yr.scalarAttr("Уменьшить область просмотра");r0+=m.a(m,[c0.doc.root],"icon_layout-collapse",a0)}else{var j207=[];a0.a["title"]=new yr.scalarAttr("Увеличить область просмотра");r0+=m.a(m,[c0.doc.root],"icon_layout-expand",a0)}r0+=closeAttrs(a0);r0+="</div>";return r0};M.t147.j=j186;M.t147.a=0;M.t148=function t148(m,c0,i0,l0,a0){var r0="";var v139="_"+nodeset2scalar(m.s(j144,c0.doc.root))+"-"+nodeset2scalar(m.s(j182,c0.doc.root))+"-"+nodeset2scalar(m.s(j90,c0.doc.root));var v140="photo-share"+v139;var v141="blog-code"+v139;var v142="share"+v139;var v143=m.s(j191,c0.doc.root);var j212=[];r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("ghost-button"),title:new yr.scalarAttr("Поделиться")};a0.s="div";if(nodeset2boolean(v143)){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" ghost-button_inactive")}else{a0.a["class"]=new yr.scalarAttr(" ghost-button_inactive")}}else{var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" js-share")}else{a0.a["class"]=new yr.scalarAttr(" js-share")}a0.a["data-nb"]=new yr.scalarAttr("popup-toggler");a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v140+"', how: { where: 'center top', what: 'center bottom' } }")}r0+=closeAttrs(a0);r0+='<div class="'+"popup popup_to_top js-photo-share-popup _hidden"+'" data-nb="'+"islands-popup"+'" id="'+scalar2attrvalue(v140)+'">';r0+='<div class="'+"popup-tail"+'"></div>';r0+='<div class="'+"menu"+'">';r0+='<div class="'+"popup__share-menu"+'" id="'+scalar2attrvalue(v142)+'"></div>';if(nodeset2boolean(m.s(j209,c0.doc.root))){var j210=[];r0+="<a";a0.a={"class":new yr.scalarAttr("menu-item js-blog-code")};a0.s="a";a0.a["data-nb"]=new yr.scalarAttr("popup-toggler");a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v141+"', where: '.js-share:visible', how: { where: 'center top', what: 'center bottom' } }");r0+=m.a(m,[c0.doc.root],"icon_code",a0);r0+=closeAttrs(a0);r0+="Код для блога";r0+="</a>"}r0+="<a";a0.a={"class":new yr.scalarAttr("menu-item is-hidden js-copy-link"),"data-nb":new yr.scalarAttr("copy-to-clipboard")};a0.s="a";a0.a["data-clipboard-text"]=new yr.scalarAttr(yr.externals["getShareLink"](m.s(j102,c0.doc.root)));r0+=closeAttrs(a0);r0+='<span class="'+"icon icon_copy"+'"></span>';r0+="Скопировать ссылку";r0+="</a>";r0+="</div>";r0+="</div>";r0+="<div";a0.a={"class":new yr.scalarAttr("popup popup_to_top blog-code-popup js-blog-code-popup _hidden"),"data-nb":new yr.scalarAttr("islands-popup"),id:new yr.scalarAttr(v141)};a0.s="div";r0+=m.a(m,m.s(j102,c0.doc.root),"blog-code",a0,m.s(j211,c0.doc.root));r0+=closeAttrs(a0);r0+="</div>";r0+=m.a(m,[c0.doc.root],"icon_share",a0);r0+='<span class="'+"button-content"+'">';r0+="Поделиться";r0+="</span>";r0+="</div>";return r0};M.t148.j=j186;M.t148.a=0;M.t149=function t149(m,c0,i0,l0,a0){var r0="";var v144=!!nodeset2boolean(m.s(j119,c0.doc.root));var v145=m.s(j102,c0.doc.root);var v146=m.s(j213,c0.doc.root);var v147=m.n(j214,v146);var v148=m.s(j191,c0.doc.root);var v149="_"+nodeset2scalar(m.s(j144,c0.doc.root))+"-"+nodeset2scalar(m.s(j182,c0.doc.root));var v150="photo-more"+v149;var v151="details"+v149;var v152="complain"+v149;var v153=nodeset2boolean(v147)||!nodeset2boolean(m.n(j118,v145))||nodeset2boolean(m.n(j118,v145))&&yr.externals["isCurrentUserAdult"](nodeset2scalar(m.s(j119,c0.doc.root)));var v154=nodeset2boolean(m.n(j215,v145))&&v153;
var v155=!nodeset2boolean(v147)&&v144;r0+=closeAttrs(a0);if(nodeset2boolean(m.n(j216,v145))||v154||v155){var v156=m.s(j218,c0.doc.root);var v157=m.n(j219,v156);var r1="";var a1={a:{}};if(nodeset2boolean(v156)&&!cmpSN("rejected",m.n(j220,v156))){r1+=nodeset2scalar(m.n(j221,v157))}else{r1+=""}var v158=r1;var j223=[];r0+="<div";a0.a={"class":new yr.scalarAttr("ghost-button"),title:new yr.scalarAttr("Ещё")};a0.s="div";if(nodeset2boolean(v148)){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" ghost-button_inactive")}else{a0.a["class"]=new yr.scalarAttr(" ghost-button_inactive")}}else{var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" nb js-more")}else{a0.a["class"]=new yr.scalarAttr(" nb js-more")}a0.a["data-nb"]=new yr.scalarAttr("popup-toggler");a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v150+"', how: { where: 'center top', what: 'center bottom' } }")}r0+=closeAttrs(a0);r0+='<div class="'+"popup popup_to_top js-photo-more-popup _hidden"+'" data-nb="'+"islands-popup"+'" id="'+scalar2attrvalue(v150)+'">';r0+='<div class="'+"popup-tail"+'"></div>';r0+='<div class="'+"menu"+'">';if(nodeset2boolean(m.n(j216,v145))){r0+="<a";a0.a={"class":new yr.scalarAttr("menu-item js-exif")};a0.s="a";a0.a["data-nb"]=new yr.scalarAttr("popup-toggler");a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v151+"', where: '.js-more:visible', how: { where: 'center top', what: 'center bottom' } }");r0+=closeAttrs(a0);r0+="Показать EXIF";r0+="</a>"}if(v154){r0+='<a class="'+"menu-item js-show-original"+'" href="'+nodeset2attrvalue(m.n(j222,v145))+'" target="'+"_blank"+'">';r0+="Открыть оригинал";r0+="</a>"}if(v155){r0+="<a";a0.a={"class":new yr.scalarAttr("menu-item")};a0.s="a";a0.a["data-nb"]=new yr.scalarAttr("popup-toggler");a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v152+"', where: '.js-more:visible', how: { where: 'center top', what: 'center bottom' } }");r0+=closeAttrs(a0);r0+="Пожаловаться";r0+="</a>"}r0+="</div>";r0+="</div>";r0+="<div";a0.a={"class":new yr.scalarAttr("popup details-popup js-details-popup _hidden"),"data-nb":new yr.scalarAttr("islands-popup"),id:new yr.scalarAttr(v151)};a0.s="div";r0+=m.a(m,[c0.doc.root],"details",a0);r0+=closeAttrs(a0);r0+="</div>";r0+="<div";a0.a={"class":new yr.scalarAttr("popup complain-popup js-complain-popup _hidden"),"data-nb":new yr.scalarAttr("islands-popup"),id:new yr.scalarAttr(v152)};a0.s="div";r0+=m.a(m,m.s(j102,c0.doc.root),"complain",a0,v158);r0+=closeAttrs(a0);r0+="</div>";r0+='<span class="'+"icon icon_pseudo icon_more"+'">';r0+="• • •";r0+="</span>";r0+="</div>"}return r0};M.t149.j=j186;M.t149.a=0;M.t150=function t150(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" photo-ears _hidden";return r0};M.t150.j=j224;M.t150.a=0;M.t151=function t151(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j3,c0),"item-prev",a0);r0+=m.a(m,m.s(j3,c0),"item-next",a0);return r0};M.t151.j=j224;M.t151.a=0;M.t152=function t152(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"photo-ears__left js-prev"+'">';r0+='<span class="'+"icon icon_arrow-left"+'"></span>';r0+="</div>";return r0};M.t152.j=j224;M.t152.a=0;M.t153=function t153(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"photo-ears__right js-next"+'">';r0+='<span class="'+"icon icon_arrow-right"+'"></span>';r0+="</div>";return r0};M.t153.j=j224;M.t153.a=0;M.t154=function t154(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" photo-edit";return r0};M.t154.j=j225;M.t154.a=0;M.t155=function t155(m,c0,i0,l0,a0){var r0="";var v159=m.s(j117,c0.doc.root);var v160=m.s(j150,c0.doc.root);var v161=cmpSN("yes",m.s(j226,c0.doc.root));var v162=yr.externals["canEditImageType"](m.s(j102,c0.doc.root));if(nodeset2boolean(v159)&&nodeset2boolean(v160)){if(v161&&v162){if(nodeset2boolean(m.s(j227,c0.doc.root))){r0+=m.a(m,m.s(j3,c0),"item-edit",a0)}r0+=m.a(m,m.s(j3,c0),"item-rotate",a0)}r0+=m.a(m,m.s(j3,c0),"item-delete",a0);r0+=m.a(m,m.s(j3,c0),"item-access",a0)}return r0};M.t155.j=j225;M.t155.a=0;M.t156=function t156(m,c0,i0,l0,a0){var r0="";var j228=[];r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("pseudo-button group-item js-rotate"),title:new yr.scalarAttr("Повернуть")};a0.s="div";r0+=m.a(m,[c0.doc.root],"icon_rotate-ccw",a0);r0+=closeAttrs(a0);r0+="</div>";return r0};M.t156.j=j225;M.t156.a=0;M.t157=function t157(m,c0,i0,l0,a0){var r0="";var j229=[];r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("pseudo-button group-item js-edit"),title:new yr.scalarAttr("Редактировать…")};a0.s="div";r0+=m.a(m,[c0.doc.root],"icon_edit",a0);r0+=closeAttrs(a0);r0+='<span class="'+"button-label"+'">';r0+="Редактировать";r0+="</span>";r0+="</div>";return r0};M.t157.j=j225;M.t157.a=0;M.t158=function t158(m,c0,i0,l0,a0){var r0="";var v163="_"+nodeset2scalar(m.s(j144,c0.doc.root))+"-"+nodeset2scalar(m.s(j182,c0.doc.root));var v164="before-edit"+v163;r0+=closeAttrs(a0);r0+='<div class="'+"popup js-popup-before-edit _hidden"+'" data-nb="'+"islands-modal-popup"+'" id="'+scalar2attrvalue(v164)+'">';r0+='<div class="'+"popup-content"+'">';r0+='<div class="'+"popup__head"+'">'+"Данные об отмеченных людях будут потеряны"+"</div>";if(nodeset2boolean(m.s(j230,c0.doc.root))){var v165=m.s(j230,c0.doc.root).length;r0+='<div class="'+"popup__row"+'">';r0+="На фото "+scalar2xml(yr.externals["plural"](v165,"","отмечен $0 человек","отмечено $0 человека","отмечено $0 человек"))+".";r0+="</div>"}r0+="<br/>";r0+='<div class="'+"popup__foot"+'">';r0+='<a class="'+"small-button js-continue"+'">';r0+='<span class="'+"button-content"+'">'+"Продолжить"+"</span>";r0+="</a>";r0+='<a class="'+"small-button js-cancel"+'">';r0+='<span class="'+"button-content"+'">'+"Отменить все изменения"+"</span>";r0+="</a>";r0+="</div>";r0+="</div>";r0+='<div class="'+"popup-close js-close"+'"></div>';r0+="</div>";return r0};M.t158.j=1;M.t158.a=1;M.t159=function t159(m,c0,i0,l0,a0){var r0="";var v166="_"+nodeset2scalar(m.s(j144,c0.doc.root))+"-"+nodeset2scalar(m.s(j182,c0.doc.root));var v167="confirm"+v166;var j231=[];r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("pseudo-button group-item js-delete"),title:new yr.scalarAttr("Удалить")};a0.s="div";a0.a["data-nb"]=new yr.scalarAttr("popup-toggler");a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v167+"'}");r0+=m.a(m,[c0.doc.root],"icon_trash",a0);r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("popup js-popup-delete  _hidden"),"data-nb":new yr.scalarAttr("islands-modal-popup"),id:new yr.scalarAttr(v167)};a0.s="div";r0+=m.a(m,m.s(j3,c0),"photo-edit-dialog-delete",a0);r0+=closeAttrs(a0);r0+="</div>";r0+="</div>";return r0};M.t159.j=j225;M.t159.a=0;M.t160=function t160(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"popup-content"+'">';r0+="<p>"+"Удалить фото вместе с оценками и комментариями?"+"</p>";r0+='<div class="'+"popup__foot"+'">';r0+='<a class="'+"small-action-button js-delete-agree"+'">';r0+='<span class="'+"button-content"+'">'+"Удалить"+"</span>";r0+="</a>";r0+='<a class="'+"small-button js-cancel js-close"+'">';r0+='<span class="'+"button-content"+'">'+"Отменить"+"</span>";r0+="</a>";r0+="</div>";r0+="</div>";r0+='<div class="'+"popup-close js-x js-close"+'"></div>';return r0};M.t160.j=j2;M.t160.a=0;M.t161=function t161(m,c0,i0,l0,a0){var r0="";var v168="_"+nodeset2scalar(m.s(j144,c0.doc.root))+"-"+nodeset2scalar(m.s(j182,c0.doc.root));var v169="access"+v168;var j232=[];r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("pseudo-button group-item js-access"),title:new yr.scalarAttr("Доступ")};a0.s="div";a0.a["data-nb"]=new yr.scalarAttr("popup-toggler");a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v169+"'}");r0+=m.a(m,[c0.doc.root],"icon_access",a0);r0+=closeAttrs(a0);r0+='<span class="'+"icon_arrow-dropdown"+'"></span>';r0+="<div";a0.a={"class":new yr.scalarAttr("popup js-popup-access _hidden"),"data-nb":new yr.scalarAttr("islands-popup"),id:new yr.scalarAttr(v169)};a0.s="div";r0+=m.a(m,m.s(j3,c0),"photo-edit-popup-access",a0);r0+=closeAttrs(a0);r0+="</div>";r0+="</div>";return r0};M.t161.j=j225;M.t161.a=0;M.t162=function t162(m,c0,i0,l0,a0){var r0="";var v170=m.s(j233,c0.doc.root);var v171=m.n(j234,v170);var v172=!nodeset2boolean(m.n(j235,v170));var v173=!nodeset2boolean(m.n(j236,v170));var j237=[];r0+=closeAttrs(a0);r0+='<div class="'+"menu"+'">';r0+='<label class="'+"menu-row toggler"+'">';r0+="<input";a0.a={"class":new yr.scalarAttr("toggler-controller js-is-pron"),type:new yr.scalarAttr("checkbox")};a0.s="input";if(nodeset2boolean(v171)){a0.a["checked"]=new yr.scalarAttr("checked")}r0+=closeAttrs(a0);r0+="";r0+='<span class="'+"checkbox toggler-view"+'"><span class="'+"checkbox-icon"+'">'+" "+"</span></span>";r0+="Только для взрослых";r0+="</label>";r0+='<label class="'+"menu-row toggler"+'">';r0+="<input";a0.a={"class":new yr.scalarAttr("toggler-controller js-enable-comments"),type:new yr.scalarAttr("checkbox")};a0.s="input";if(v172){a0.a["checked"]=new yr.scalarAttr("checked")}r0+=closeAttrs(a0);r0+="";r0+='<span class="'+"checkbox toggler-view"+'"><span class="'+"checkbox-icon"+'">'+" "+"</span></span>";r0+="Разрешить комментарии";r0+="</label>";r0+='<label class="'+"menu-row menu-row_print-orig toggler"+'">';r0+="<input";a0.a={"class":new yr.scalarAttr("toggler-controller js-enable-print"),type:new yr.scalarAttr("checkbox")};a0.s="input";if(v173){a0.a["checked"]=new yr.scalarAttr("checked")}r0+=closeAttrs(a0);r0+="";r0+='<span class="'+"checkbox toggler-view"+'"><span class="'+"checkbox-icon"+'">'+" "+"</span></span>";r0+='<span class="'+"toggle-view-label"+'">';r0+="Разрешить печать";r0+="<br/>";r0+="и просмотр оригинала";r0+="</span>";r0+="</label>";r0+='<div class="'+"menu-separator"+'"></div>';r0+="<div";a0.a={"class":new yr.scalarAttr("menu-row"),"data-nb":new yr.scalarAttr("progress-button")};a0.s="div";a0.a["data-action"]=new yr.scalarAttr("comment-block-author");a0.a["data-nb-completed-text"]=new yr.scalarAttr("URL изменён");r0+=closeAttrs(a0);r0+='<a class="'+"link js-invalidate-url"+'">';r0+="Изменить URL";r0+="</a>";r0+="<span";a0.a={"class":new yr.scalarAttr("js-invalidate-url-help"),title:new yr.scalarAttr("Публикации по предыдущему URL будут потеряны.")};a0.s="span";r0+=m.a(m,[c0.doc.root],"icon_help",a0);r0+=closeAttrs(a0);r0+="</span>";r0+="</div>";r0+="</div>";r0+='<div class="'+"popup-tail"+'"></div>';return r0};M.t162.j=j2;M.t162.a=0;M.t163=function t163(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось удалить фотографию";return r0};M.t163.j=1;M.t163.a=1;M.t164=function t164(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось повернуть фотографию";return r0};M.t164.j=1;M.t164.a=1;M.t165=function t165(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось сохранить изображение";return r0};M.t165.j=1;M.t165.a=1;M.t166=function t166(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Редактирование фотографии недоступно";return r0};M.t166.j=1;M.t166.a=1;M.t167=function t167(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" photo-flags";return r0};M.t167.j=j238;M.t167.a=0;M.t168=function t168(m,c0,i0,l0,a0){var r0="";var v174=m.s(j102,c0.doc.root);r0+=m.a(m,v174,"photo-flags-item",a0);return r0};M.t168.j=j238;M.t168.a=0;M.t169=function t169(m,c0,i0,l0,a0){var r0="";var j240=[];r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("photo-flag-item"),title:new yr.scalarAttr("Только для взрослых")};a0.s="div";r0+=m.a(m,[c0.doc.root],"icon_18plus",a0);r0+=closeAttrs(a0);r0+="</div>";return r0};M.t169.j=j239;M.t169.a=0;M.t170=function t170(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" comments";return r0};M.t170.j=j241;M.t170.a=0;M.t171=function t171(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"comment comments_message"+'">';r0+="Загрузка комментариев";r0+="</div>";return r0};M.t171.j=j241;M.t171.a=0;M.t172=function t172(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="<div>";r0+='<div class="'+"js-comments"+'"></div>';r0+='<div class="'+"ns-subview-photo-like-ignore-1"+'"></div>';r0+='<div class="'+"ns-subview-photo-like-ignore-2"+'"></div>';r0+="</div>";return r0};M.t172.j=j241;M.t172.a=0;M.t173=function t173(m,c0,i0,l0,a0){var r0="";var tmp0=a0.a["style"];if(tmp0){a0.a["style"]=tmp0.addscalar(" display: none;")}else{a0.a["style"]=new yr.scalarAttr(" display: none;")}return r0};M.t173.j=j241;M.t173.a=0;M.t174=function t174(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось добавить комментарий";return r0};M.t174.j=1;M.t174.a=1;M.t175=function t175(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось удалить комментарий";return r0};M.t175.j=1;M.t175.a=1;M.t176=function t176(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Неверно введены контрольные цифры";return r0};M.t176.j=1;M.t176.a=1;M.t177=function t177(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось заблокировать автора комментария";return r0};M.t177.j=1;M.t177.a=1;M.t178=function t178(m,c0,i0,l0,a0){var r0="";r0+=m.a(m,m.s(j3,c0),"banner",a0);return r0};M.t178.j=j242;M.t178.a=0;M.t179=function t179(m,c0,i0,l0,a0){var r0="";var v175=!!nodeset2boolean(m.s(j243,c0.doc.root));r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("banner-placeholder js-banner-placeholder")};a0.s="div";if(v175){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" is-hidden")}else{a0.a["class"]=new yr.scalarAttr(" is-hidden")}}r0+=closeAttrs(a0);r0+='<div class="'+"banner-wrapper js-banner-wrapper"+'">';r0+='<div class="'+"banner js-banner"+'">';r0+='<div class="'+"banner__inner"+'" id="'+"yandex_ad_R-94178-6"+'"></div>';r0+="</div>";r0+="</div>";r0+="</div>";return r0};M.t179.j=j2;M.t179.a=0;M.t180=function t180(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" tray tray_hidden";return r0};M.t180.j=j244;M.t180.a=0;M.t181=function t181(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" tray tray_hidden tray_dark";return r0};M.t181.j=j245;M.t181.a=0;M.t182=function t182(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" tray-container";return r0};M.t182.j=j246;M.t182.a=0;M.t183=function t183(m,c0,i0,l0,a0){var r0="";var v176=yr.externals["getBackgroundUrl"]();r0+=closeAttrs(a0);if(yr.externals["strlen"](v176)>0){r0+='<iframe src="'+scalar2attrvalue(yr.externals["__unsafeHTML"](v176))+'" style="'+"border: 0; position: absolute; width: 100%; height: 100%;"+'"></iframe>'}return r0};M.t183.j=j247;M.t183.a=0;M.t184=function t184(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+=" send-to-contest-button";return r0};M.t184.j=j248;M.t184.a=0;M.t185=function t185(m,c0,i0,l0,a0){var r0="";var v177=yr.externals["isAuthor"](m.s(j102,c0.doc.root),m.s(j153,c0.doc.root));if(v177){var v178=m.s(j249,c0.doc.root);function p50(m,c0,i0,l0){return cmpNN(m.s(j250,c0),m.n(j221,v178))}var j251=[0,"models",0,"photo-more",0,"contestBindings",0,"contestBinding",2,p50];var v179=m.s(j251,c0.doc.root);var v180=m.s(j218,c0.doc.root);var v181=m.n(j219,v180);if(nodeset2boolean(v180)&&!cmpSN("rejected",m.n(j220,v180))){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" ghost-button")}else{a0.a["class"]=new yr.scalarAttr(" ghost-button")}r0+=m.a(m,v181,"revoke-button",a0)}else{if(nodeset2boolean(v178)&&!nodeset2boolean(v179)){var tmp0=a0.a["class"];if(tmp0){a0.a["class"]=tmp0.addscalar(" ghost-button")}else{a0.a["class"]=new yr.scalarAttr(" ghost-button")}r0+=m.a(m,v178,"send-button",a0)}}}return r0};M.t185.j=j248;M.t185.a=0;M.t186=function t186(m,c0,i0,l0,a0){var r0="";var v182=m.s(j3,c0);var v183="send-to-contest_"+nodeset2scalar(m.s(j144,c0.doc.root))+"-"+nodeset2scalar(m.s(j182,c0.doc.root));var j252=[];a0.a["title"]=new yr.scalarAttr("Отправить фото на конкурс");a0.a["data-nb"]=new yr.scalarAttr("popup-toggler");a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v183+"', where: '.bar:visible', how: { where: 'left top', what: 'left bottom' } }");r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("popup popup_to_top send-to-contest-popup js-send-to-contest _hidden"),"data-nb":new yr.scalarAttr("islands-popup send-to-contest"),id:new yr.scalarAttr(v183)};a0.s="div";a0.a["data-nb-contest-id"]=new yr.scalarAttr(nodeset2scalar(m.n(j221,v182)));r0+=m.a(m,v182,"send-popup-body",a0);r0+=closeAttrs(a0);r0+='<div class="'+"popup-close popup__close"+'"></div>';r0+="</div>";r0+=m.a(m,[c0.doc.root],"icon_medal",a0);r0+='<span class="'+"button-content"+'">';r0+="На конкурс";r0+="</span>";return r0};M.t186.j=j2;M.t186.a=0;M.t187=function t187(m,c0,i0,l0,a0){var r0="";var v184=m.s(j3,c0);var v185=m.n(j253,v184);var v186=m.n(j177,v184);var v187=m.n(j180,v184);var v188=yr.externals["generateUrl"]("contest",v184);r0+=closeAttrs(a0);r0+='<div class="'+"send-to-contest"+'">';r0+='<div class="'+"send-to-contest-left"+'">';r0+='<h2 class="'+"contest-title"+'">'+nodeset2xml(selectNametest("name",c0,[]))+"</h2>";r0+='<ul class="'+"contest-details"+'">';r0+='<li class="'+"contest-theme"+'">';if(simpleBoolean("logoUrl",c0)){r0+="Тему предлагает ";r0+='<img class="'+"contest-theme-logo"+'" src="'+nodeset2attrvalue(selectNametest("logoUrl",c0,[]))+'"/>'}else{r0+="Конкурс от ";r0+='<span class="'+"contest-theme-by-fotki"+'">'+"Яндекс.Фоток"+"</span>"}r0+="</li>";if(simpleBoolean("subject",c0)){r0+="<li>";r0+="Тема: "+nodeset2xml(selectNametest("subject",c0,[]));r0+="</li>"}if(simpleBoolean("genre",c0)){r0+="<li>";r0+="Жанр: "+nodeset2xml(selectNametest("genre",c0,[]));r0+="</li>"}r0+="<li>";r0+="Фотографии принимаются ";if(yr.externals["formatDate"](nodeset2scalar(v185),"YYYY")==yr.externals["formatDate"](nodeset2scalar(v186),"YYYY")){if(yr.externals["formatDate"](nodeset2scalar(v185),"MMMM")==yr.externals["formatDate"](nodeset2scalar(v186),"MMMM")){r0+="c "+scalar2xml(yr.externals["formatDate"](nodeset2scalar(v185),"D"))+" по "+scalar2xml(yr.externals["formatDate"](nodeset2scalar(v186),"D MMMM YYYY"))}else{r0+="c "+scalar2xml(yr.externals["formatDate"](nodeset2scalar(v185),"D MMMM"))+" по "+scalar2xml(yr.externals["formatDate"](nodeset2scalar(v186),"D MMMM YYYY"))}}else{r0+="c "+scalar2xml(yr.externals["formatDate"](nodeset2scalar(v185),"D MMMM YYYY"))+" по "+scalar2xml(yr.externals["formatDate"](nodeset2scalar(v186),"D MMMM YYYY"))}r0+="</li>";r0+="<li>";r0+="Голосование продлится до "+scalar2xml(yr.externals["formatDate"](simpleScalar("votingFinishDate",c0),"D MMMM YYYY"));r0+="</li>";r0+="</ul>";r0+='<p class="'+"contest-participants-count"+'">';r0+="Сейчас в конкурсе принимает участие "+scalar2xml(yr.externals["plural"](nodeset2scalar(m.n(j257,v184)),"$0 фотографий","$0 фотография","$0 фотографии","$0 фотографий"));r0+=" от "+scalar2xml(yr.externals["plural"](nodeset2scalar(m.n(j258,v184)),"$0 пользователей","$0 пользователя","$0 пользователей","$0 пользователей"))+".";r0+="</p>";r0+=nodeset2scalar(m.n(j259,v184));r0+="</div>";r0+='<div class="'+"send-to-contest-right"+'">';r0+='<div class="'+"send-to-contest-right-inner"+'">';r0+='<div class="'+"contest-row"+'">';r0+="<label>";r0+="Укажите название фото";r0+='<input class="'+"small-input js-title"+'" type="'+"text"+'" placeholder="'+"Название фото"+'"/>';r0+="</label>";r0+="</div>";r0+='<div class="'+"contest-row"+'">';r0+="<label>";r0+="Добавьте метки";r0+='<textarea class="'+"small-input js-tags"+'" placeholder="'+"Например: лес, новый год, отпуск"+'"></textarea>';r0+="</label>";r0+="</div>";r0+='<div class="'+"contest-row"+'">';r0+="Отправляя фото вы принимаете ";r0+='<a href="'+scalar2attrvalue(v188)+"#contest-rules"+'" class="'+"link js-contest-rules"+'" target="'+"_blank"+'">'+"правила конкурса"+"</a>";r0+=" и ";r0+='<a href="'+scalar2attrvalue(v188)+"#contest-full-rules"+'" class="'+"link js-general-rules"+'" target="'+"_blank"+'">'+"общие правила участия"+"</a>";r0+="</div>";r0+='<div class="'+"contest-row"+'">';r0+='<button class="'+"small-action-button js-send"+'" type="'+"button"+'">';r0+='<span class="'+"button-content"+'">'+"Отправить фото"+"</span>";r0+="</button>";r0+="</div>";r0+="</div>";r0+="</div>";r0+="</div>";return r0};M.t187.j=j2;M.t187.a=0;M.t188=function t188(m,c0,i0,l0,a0){var r0="";var v189=m.s(j3,c0);var v190="revoke-from-contest_"+nodeset2scalar(m.s(j144,c0.doc.root))+"-"+nodeset2scalar(m.s(j182,c0.doc.root));var j260=[];a0.a["title"]=new yr.scalarAttr("Снять фото с конкурса");a0.a["data-nb"]=new yr.scalarAttr("popup-toggler");a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v190+"', how: { where: 'center top', what: 'center bottom' } }");r0+=closeAttrs(a0);r0+="<div";a0.a={"class":new yr.scalarAttr("popup popup_to_top send-to-contest-popup js-revoke-from-contest _hidden"),"data-nb":new yr.scalarAttr("islands-popup revoke-from-contest"),id:new yr.scalarAttr(v190)};a0.s="div";a0.a["data-nb-contest-id"]=new yr.scalarAttr(nodeset2scalar(m.n(j221,v189)));r0+=m.a(m,v189,"revoke-popup-body",a0);r0+=closeAttrs(a0);r0+='<div class="'+"popup-tail"+'"></div>';r0+="</div>";r0+=m.a(m,[c0.doc.root],"icon_medal",a0);r0+='<span class="'+"button-content"+'">';r0+="На конкурсе";r0+="</span>";return r0};M.t188.j=j2;M.t188.a=0;M.t189=function t189(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+='<div class="'+"menu"+'">';r0+='<a class="'+"menu-item js-go-to-contest"+'" href="'+scalar2attrvalue(yr.externals["generateUrl"]("contest",m.s(j3,c0)))+'">';r0+="На страницу конкурса";r0+="</a>";r0+='<a class="'+"menu-item js-revoke"+'">';r0+="Не участвовать";r0+="</a>";r0+="</div>";return r0};M.t189.j=j2;M.t189.a=0;M.t190=function t190(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось добавить фото на конкурс";return r0};M.t190.j=1;M.t190.a=1;M.t191=function t191(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не удалось снять фото с конкурса";return r0};M.t191.j=1;M.t191.a=1;M.t192=function t192(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не указан заголовок";return r0};M.t192.j=1;M.t192.a=1;M.t193=function t193(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0);r0+="Не указаны метки";return r0};M.t193.j=1;M.t193.a=1;M.matcher={"":{"":["t0"]},"ns-view":{"*":["t1"]},"ns-build-view":{"*":["t2"]},"ns-view-add-class":{"*":["t3"],content:["t66","t3"],overlay:["t67","t3"],bar:["t72","t3"],index:["t74","t3"],"photo-box":["t78","t3"],"photo-image":["t79","t3"],panel:["t101","t100","t3"],"photo-controls":["t140","t3"],"photo-ears":["t150","t3"],"photo-edit":["t154","t3"],"photo-flags":["t167","t3"],comments:["t170","t3"],tray:["t181","t180","t3"],"tray-container":["t182","t3"],"send-to-contest":["t184","t3"]},"ns-view-add-attrs":{"*":["t4"]},"ns-view-content":{"*":["t5"],"not-found":["t70","t5"],head:["t71","t5"],bar:["t73","t5"],index:["t75","t5"],photo:["t76","t5"],"photo-image":["t80","t5"],panel:["t102","t5"],"photo-info":["t103","t5"],"photo-slider-info-item":["t118","t5"],"photo-tags":["t121","t5"],"photo-on-map":["t135","t5"],"photo-controls":["t141","t5"],"photo-ears":["t151","t5"],"photo-edit":["t155","t5"],"photo-flags":["t168","t5"],comments:["t172","t5"],ads:["t178","t5"],"fotki-old":["t183","t5"],"send-to-contest":["t185","t5"]},"ns-view-desc":{"*":["t6"]},"ns-view-async-content":{"*":["t9","t7"],"photo-on-map":["t136","t9","t7"],comments:["t171","t9","t7"]},"ns-view-error-content":{"*":["t10","t8"],"photo-image":["t85","t84","t83","t82","t81","t10","t8"],"photo-info":["t107","t106","t105","t104","t10","t8"],"photo-tags":["t122","t10","t8"],"photo-on-map":["t137","t10","t8"],"photo-controls":["t142","t10","t8"],comments:["t173","t10","t8"]},"collapse-text":{"*":["t11"]},"editable-text":{"*":["t12"]},"editable-tags":{"*":["t13"]},"editable-tags-item":{tag:["t14"]},"editable-tags-item-plain":{tag:["t15"]},map:{"*":["t16"]},"blog-code":{photo:["t17"]},"blog-code__sizes":{photo:["t18"]},"blog-code-generate":{"":["t19"]},stat:{"*":["t20"]},"stat-summary":{"*":["t21"]},"stat-item":{referer:["t22"]},"stat-more":{"*":["t23"]},"stat-item-body":{referer:["t25","t24"]},details:{"":["t26"]},"details-loading":{"":["t27"]},"details-error":{"":["t28"]},"details-item-name":{"*":["t29"],camera:["t37","t35","t29"],flash:["t40","t29"]},"details-item-value":{"*":["t30"],camera:["t38","t36","t30"],lens:["t39","t30"],flash:["t41","t30"]},"details-name":{"*":["t31"]},"details-value":{"*":["t32"],dateTimeOriginal:["t33","t32"],added:["t34","t32"],exposureProgram:["t42","t32"]},complain:{"*":["t43"]},"complain-wrong-url":{"":["t44"]},"error-popup":{"":["t45"]},"error-ballon":{"":["t46"]},"error-popup-button":{"*":["t47"]},icon_edit:{"":["t48"]},icon_trash:{"":["t49"]},icon_access:{"":["t50"]},icon_help:{"":["t51"]},icon_18plus:{"":["t52"]},"icon_layout-expand":{"":["t53"]},"icon_layout-collapse":{"":["t54"]},icon_share:{"":["t55"]},icon_lock:{"":["t56"]},icon_medal:{"":["t57"]},"icon_rotate-ccw":{"":["t58"]},icon_cross:{"":["t59"]},"icon_cross-small":{"":["t60"]},icon_pin:{"":["t61"]},icon_eye:{"":["t62"]},icon_heart:{"":["t63"]},icon_star:{"":["t64"]},icon_code:{"":["t65"]},"keyboard-shortcuts":{"":["t68"]},shortcut:{"*":["t69"]},"photo-is-updating":{photo:["t77"]},"error-image-not-found":{"*":["t86"]},"error-access-denied":{"*":["t87"]},"photo-image":{photo:["t92","t91","t90","t89","t88"]},"photo-blocked":{"*":["t93"]},"photo-image-block-reason":{blockReason:["t96","t95","t94"]},"error_something-goes-wrong":{"":["t97"]},"error_album-password-empty":{"":["t98"]},"error_album-password-wrong":{"":["t99"]},"normal-content":{"photo-info":["t108"]},"photo-view-panel__author":{profile:["t109"]},"photo-info-button-follow":{profile:["t110"]},"photo-view-panel__info":{photo:["t113","t111"]},"photo-view-panel__public-toggler":{photo:["t112"]},"photo-view-panel__title":{photo:["t114"]},"photo-view-panel__description":{photo:["t115"]},"error_save-description":{"":["t116"]},"error_save-title":{"":["t117"]},"photo-slider-info__title":{photo:["t119"]},"photo-slider-info__position":{photo:["t120"]},"photo-view-panel__tags":{tags:["t124","t123"]},"photo-view-panel__honors":{"*":["t127","t125"]},"photo-honors__total":{"*":["t126"]},medal:{"*":["t132","t131","t130","t129","t128"]},"error_edit-tags":{"":["t133"]},"error_edit-tags-limit":{"":["t134"]},"error_map-bind-failed":{"":["t138"]},"error_map-unbind-failed":{"":["t139"]},"item-views":{"photo-controls":["t143"]},"item-like":{"photo-controls":["t144"]},"item-favorite":{"photo-controls":["t145"]},"item-slideshow":{"photo-controls":["t146"]},"item-layout-toggle":{"photo-controls":["t147"]},"item-share":{"photo-controls":["t148"]},"item-more":{"photo-controls":["t149"]},"item-prev":{"photo-ears":["t152"]},"item-next":{"photo-ears":["t153"]},"item-rotate":{"photo-edit":["t156"]},"item-edit":{"photo-edit":["t157"]},"photo-before-edit-dialog":{"":["t158"]},"item-delete":{"photo-edit":["t159"]},"photo-edit-dialog-delete":{"*":["t160"]},"item-access":{"photo-edit":["t161"]},"photo-edit-popup-access":{"*":["t162"]},"error_photo-remove-failed":{"":["t163"]},"error_photo-rotate-failed":{"":["t164"]},"error_image-edit-failed":{"":["t165"]},"error_image-edit-unavailable":{"":["t166"]},"photo-flags-item":{photo:["t169"]},"error_could-not-add-comment":{"":["t174"]},"error_could-not-remove-comment":{"":["t175"]},"error_captcha-invalid":{"":["t176"]},"error_user-ban-failed":{"":["t177"]},banner:{"*":["t179"]},"send-button":{"*":["t186"]},"send-popup-body":{"*":["t187"]},"revoke-button":{"*":["t188"]},"revoke-popup-body":{"*":["t189"]},"error_send-to-contest":{"":["t190"]},"error_revoke-from-contest":{"":["t191"]},invalid_title_is_empty:{"":["t192"]},invalid_tags_are_empty:{"":["t193"]}};M.imports=[];yr.register("main",M)})();(function(){var $window=$(window);var unloaded=false;$(window).bind("beforeunload",function(){unloaded=true});var queue=[];var visible=[];var max=3;var gap=3*10;var errors={};errors.showError=function(context,options){if(typeof options==="string"){options={messageId:options}}else{options=options||{}}if(context&&context.pageLeft&&!options.persistent||context&&unloaded){context.destroy();return}var node=$('<div data-nb="field-error"/>')[0];var error=nb.block(node);error.showFor(options.element,options,context);return error};errors.addItem=function(popup){var that=this;var item={popup:popup,height:null,$placeholder:null};queue.push(item);item.popup.on("ph-destroy",function(){that._removeItem(item);that._update()});this._update()};errors.getStartPoint=function(){var offset=$(".photo-controls:visible").offset();offset.left+=gap;return offset};errors._removeItem=function(item){var index=visible.indexOf(item);if(index<0){return}item.$placeholder.remove();visible.splice(index,1)};errors._update=function(){this._updatePositions();this._showMore()};errors._showMore=function(){var count=visible.length;while(count++<max&&queue.length){this._showItem(queue.splice(0,1)[0])}};errors._showItem=function(item){var prev=visible[visible.length-1];var $popup=$(item.popup.node);$popup.removeClass("is-hidden");item.height=$popup.outerHeight();item.$placeholder=$('<div class="error-placeholder"/>').css({height:item.height});item.$placeholder.appendTo(document.body);item.popup.trigger("toggle",{where:item.$placeholder[0],how:{where:"top right",what:"top left"}});this._updatePosition(item,prev);visible.push(item)};errors._updatePositions=function(){for(var i=0;i<visible.length;i++){this._updatePosition(visible[i],visible[i-1])}};errors._updatePosition=function(item,prev){var prevTopLeft=prev?prev.$placeholder.offset():this.getStartPoint();item.$placeholder.css({left:prevTopLeft.left,bottom:$window.height()-(prevTopLeft.top-gap)});item.popup.trigger("move")};ph.errors=errors})();ph.ERRORS={imageNotFound:"image not found"};ns.layout.define("app",{app:{head:true,"content@":{},"overlay@":{bar:{"controls@":{}},"layers@":{}}}});var photoViewMode=function(params){var layout={photo:{"photo-box@":{"photo-image":true},"photo-ears":true,"photo-flags-box@":{"photo-flags":true},"photo-edit-box@":{"photo-edit":true},panel:{"panel-box@":{"panel-container":{"photo-info":true,"photo-tags":true,"comments-container@":"comments&"}},"ads&":true},bar:{"controls@":{"photo-controls":{"photo-on-map&":true,"send-to-contest&":true}}},tray:{"tray-container":{"tray-box@":{"slider&":true}}}}};var context=params["context"]||"album";if(context!=="album"){delete layout.photo["photo-edit-box@"]}return layout};var photoFullscreenMode=function(){return{photo:{"photo-box@":{"photo-image":true},"photo-ears":true,bar:{"controls@":{"photo-controls":{"photo-on-map&":true,"send-to-contest&":true}}},tray:{"tray-container":{"photo-slider-info@":{"photo-slider-info-item":true},"tray-box@":{"slider&":true}}}}}};ns.layout.define("photo",{app:{"content@":"fotki-old","overlay@":function(params){return params.mode==="view"?photoViewMode(params):photoFullscreenMode()}}});ns.layout.define("not-found",{app:{"content@":"not-found","overlay@":{}}});ph.params={hiddenParams:{},sliderParams:function(params){var searchParamsList=["context","search-author","how","noreask","search-text","tags","type","modelid","chastity"];var context=params["context"];switch(context){case"search":return ph.utils.pick(params,searchParamsList);case"contest":return ph.utils.pick(params,["context","contest-id"],true);case"tag":return ph.utils.pick(params,["context","tag"],true);default:if(context){return ph.utils.pick(params,["context"],true)}else if(params["author-login"]&&params["album-id"]){return ph.utils.pick(params,["author-login","album-id"],true)}}return{}},commentsParams:function(params){var defaultCount=7;var _params=ph.utils.pick(params,["author-login","image-id"]);_params["roots-sort-order"]="desc";_params["replies-sort-order"]="asc";if("comment-id"in params){_params["comment-id"]=params["comment-id"];_params["count"]=params["count"]||defaultCount-1}else if("comment-id"in ph.params.hiddenParams){_params["comment-id"]=ph.params.hiddenParams["comment-id"];_params["count"]=params["count"]||defaultCount-1}else{_params["index"]=0;_params["count"]=params["count"]||defaultCount}return _params},oldSearchParams:function(params){return ph.utils.transformParams(params,{text:["search-text"],p:["page"],type:["type"],modelid:["modelid"],tags:["tags"],noreask:["noreask"],how:["how"],search_author:["search-author"],grouping:[null,"off"]})}};(function(){var getNearestMultipleOf=function(num,divider){var mod=num%divider;
return num+(mod===0?0:divider-mod)};var generateSequence=function(from,to,reverse){var result=[];for(var i=from;i<=to;i++){result.push(i)}return reverse?result.reverse():result};var DynamicModelCollection=function(){};no.inherit(DynamicModelCollection,ns.ModelCollection);var _invalidate=DynamicModelCollection.prototype.invalidate;DynamicModelCollection.prototype._init=function(){ns.ModelCollection.prototype._init.apply(this,arguments);ns.assert(this.info.dynamic,"dynamicModelCollection","info.dynamic was not specified for '%s'",this.id);var pagingModelInfo=ns.Model.infoLite(this.info.dynamic.pagingModel);this._pagingModelInfo=pagingModelInfo;ns.assert(pagingModelInfo.params["page-size"],"dynamicModelCollection","Paging model '%s' must have 'page-size' parameter set",this.info.dynamic.pagingModel);this._dynamicReset();this.listenToMutations()};DynamicModelCollection.prototype._dynamicReset=function(){this.dynamic={};this.dynamic.pageSize=this._pagingModelInfo.params["page-size"];this.dynamic.pages={}};DynamicModelCollection.prototype.invalidate=function(){this._dynamicReset();return _invalidate.apply(this,arguments)};DynamicModelCollection.prototype.sync=function(visible){var pageFrom=visible.pages.from;var pageTo=visible.pages.to;if(!this.firstDataPortionLoaded&&"page"in ns.page.current.params){var pageCurrent=Math.max(+ns.page.current.params["page"]||0,0);pageFrom=pageTo=pageCurrent}var pageMaxIndex=this.getPageMaxIndex(pageTo);var models=this.models;if(models.length<pageMaxIndex+1){this.insert(this.createFakeModels(models.length,pageMaxIndex));this.notifyNewItemsLoaded()}this.requestPages(generateSequence(pageFrom,pageTo))};DynamicModelCollection.prototype.syncCurrent=function(){if(this.syncPagesHash()){this.notifySyncNeeded()}};DynamicModelCollection.prototype.getItemIndex=function(params){var models=this.models;for(var i=0;i<models.length;i++){var model=models[i];if(!this.isModelGood(model)){continue}if(this.compareParams(model.params,params)){return i}}return-1};DynamicModelCollection.prototype.getItem=function(index){var model=this.models[index];return this.isModelGood(model)?model:null};DynamicModelCollection.prototype.listenToMutations=function(){var that=this;this.on("ns-model-remove",function(evt,models){if(that.isMutating){return}if(models&&models.length){var oldTotal=that.dynamic.total;that.dynamic.total-=models.length;that.syncPagesHash();that.notifyTotalChanged(oldTotal)}})};DynamicModelCollection.prototype.requestPages=function(pages){for(var i=0;i<pages.length;i++){var page=pages[i];if(this.dynamic.pages[page]||!this.pageExists(page)){continue}this.requestPage(page)}};DynamicModelCollection.prototype.pageExists=function(page){if(!this.firstDataPortionLoaded){return Object.keys(this.dynamic.pages).length===0}var firstPageIndex=page*this.dynamic.pageSize;return firstPageIndex<this.dynamic.total};DynamicModelCollection.prototype.requestPage=function(page){var that=this;this.dynamic.pages[page]="loading";this.requestPagingModel(page).done(function(pagingModel){var models=that.models;that.firstDataPortionLoaded=true;that.isMutating=true;var totalChanged=false;var extracted=that.extractPageData(pagingModel,page);var newModels=extracted.models;var newTotal=extracted.total;var oldTotal=that.dynamic.total;if(newTotal!==that.dynamic.total){that.dynamic.total=newTotal;that.removeRedundantItems();totalChanged=true}var indexes=that.generateIndexesForPage(page);var firstIndex=indexes[0];var lastIndex=indexes[indexes.length-1];var newIndex=0;var from=null;var to;for(var i=0;i<indexes.length;i++){var index=indexes[i];var model=models[index];if(!that.isModelGood(model)){if(from===null){from=index}}else{if(from!==null){to=index-1;that.replaceItems(from,to,from+newIndex,newModels);newIndex+=from-to;from=null}}}that.replaceItems(from,lastIndex,from+newIndex,newModels);from=null;that.isMutating=false;that.dynamic.pages[page]="loaded";that.syncPagesHash();if(totalChanged){that.notifyTotalChanged(oldTotal)}that.notifyNewItemsLoaded(page)})};DynamicModelCollection.prototype.replaceItems=function(from,to,offset,newItems){if(from===null){return}this.removeItems(from,to);this.insert(newItems.slice(from-offset,to-offset+1),from)};DynamicModelCollection.prototype.removeRedundantItems=function(){if(this.dynamic.total<this.models.length){this.removeItems(this.dynamic.total,this.models.length-1)}};DynamicModelCollection.prototype.removeItems=function(from,to){var models=this.models;var indexes=generateSequence(from,to).filter(function(index){return!!models[index]});this.remove(indexes.reverse())};DynamicModelCollection.prototype.syncPagesHash=function(){var changed=false;var models=this.models;var l=Math.min(this.dynamic.total,getNearestMultipleOf(models.length,this.dynamic.pageSize));for(var i=0;i<l;i++){var page=Math.floor(i/this.dynamic.pageSize);if(this.dynamic.pages[page]!=="loaded"){continue}var model=models[i];if(!this.isModelGood(model)){if(this.dynamic.pages[page]!=null){changed=true}this.dynamic.pages[page]=undefined}}return changed};DynamicModelCollection.prototype.createFakeModels=function(from,to){var models=[];for(var i=from;i<=to;i++){models.push(this.createFakeModel(i))}return models};DynamicModelCollection.prototype.generateIndexesForPage=function(page){var from=page*this.dynamic.pageSize;var to=this.getPageMaxIndex(page);return generateSequence(from,to)};DynamicModelCollection.prototype.getPageMaxIndex=function(page){var pageSize=this.dynamic.pageSize;var pageLastIndex=(page+1)*pageSize-1;if(this.dynamic.total==null){return pageLastIndex}var total=this.dynamic.total;return pageLastIndex+1>total?total-1:pageLastIndex};DynamicModelCollection.prototype.isModelGood=function(model){return model&&model.isValid()&&!this.isFakeModel(model)};DynamicModelCollection.prototype.notifyTotalChanged=function(oldTotal){this.trigger("total-changed",this.dynamic.total,oldTotal)};DynamicModelCollection.prototype.notifyNewItemsLoaded=function(page){this.trigger("new-items-loaded",page)};DynamicModelCollection.prototype.notifySyncNeeded=function(){this.trigger("sync-needed")};DynamicModelCollection.prototype.createFakeModel=function(){throw new Error("[dynamicModelCollection] you need to implement createFakeModel() method")};DynamicModelCollection.prototype.isFakeModel=function(model){throw new Error("[dynamicModelCollection] you need to implement isFakeModel() method")};DynamicModelCollection.prototype.extractPageData=function(pagingModel,page){throw new Error("[dynamicModelCollection] you need to implement extractPageData() method")};DynamicModelCollection.prototype.compareParams=function(p1,p2){throw new Error("[dynamicModelCollection] you need to implement compareParams() method")};DynamicModelCollection.prototype.requestPagingModel=function(page){throw new Error("[dynamicModelCollection] you need to implement requestPagingModel ) method")};ph.DynamicModelCollection=DynamicModelCollection})();ns.Model.define("auth",{methods:{extractData:function(data){var uid=no.jpath(".auth.uid.value",data);if(!uid){return{}}var result=no.extend({},data.auth);if(data.profile.result){no.extend(result,{"photo-profile":data.profile.result})}return result},isAuthValid:function(){return!!no.jpath(".uid.value",this.getData())},hasProfile:function(){return!!no.jpath(".photo-profile",this.getData())}}});ns.Model.define("profile",{params:{"author-login":null}});ns.Model.define("ticket");ns.Model.define("preferences",{methods:{extractData:function(data){if(!data){return null}if(data.error){var errorName=data.error.name;if(errorName==="user not found"){return{error:errorName}}}return ns.Model.prototype.extractData.apply(this,arguments)},isSet:function(name){return!!no.jpath('.preferences.preference.[ .name == "'+name+'" ]',this.getData())}}});(function(){var photoParams={"author-login":null,"image-id":null};var PhotoLite=function(){};no.inherit(PhotoLite,ns.Model);PhotoLite.prototype.needUpdateData=function(newData){var oldData=this.getData();return!oldData||newData.updated!==oldData.updated||newData.version!==oldData.version};ns.Model.define("photo-lite",{params:photoParams},PhotoLite);ns.Model.define("photo",{params:photoParams,methods:{extractData:function(result){var data=ns.Model.prototype.extractData.call(this,result);var redirectModel=ns.Model.get("photo-initial-redirect",{});if(redirectModel.isRedirectNeeded()&&data&&data.albumId){redirectModel.setRedirectInfo(data.albumId)}return data}}},PhotoLite);ns.Model.define("photo-initial-redirect",{params:{},methods:{canRetry:function(){return false},extractError:function(){return this.getError()},extractData:function(){return this.getData()},isRedirectNeeded:function(){var pageInfo=ns.page.current;return pageInfo.page==="photo"&&!pageInfo.params["album-id"]},getAlbumId:function(){return no.jpath(".album-id",this.getError())},setAsValid:function(){this.setData({})},setRedirectInfo:function(albumId){this.setError({name:"ph-photo-redirect-to-url-with-album","album-id":albumId})}}});ns.Model.get("photo-initial-redirect",{}).setAsValid()})();ns.Model.define("photo-more",{params:{"author-login":null,"image-id":null}});ns.Model.define("photo-rights",{params:{"author-login":null,"image-id":null}});ns.Model.define("photo-position",{params:{context:null,"author-login":null,"image-id":null,"contest-id":null,tag:null}});ns.Model.define("photo-ads-state");ns.Model.get("photo-ads-state",{}).setData({disabled:false});ns.Model.define("album",{params:{"author-login":null,"album-id":null,"page-size":20,page:0},split:{items:".images.images.image",model_id:"photo",params:{"author-login":".author.login","image-id":".imageId"}}});ns.Model.define("comments-more",{params:ph.params.commentsParams,split:{items:".comments.comment",model_id:"comment",params:{id:".id"}}});ns.Model.define("comments",{params:ph.params.commentsParams,split:{items:".comments.comment",model_id:"comment",params:{id:".id"}},methods:{onItemChanged:no.nop,onItemTouched:no.nop,onItemDestroyed:no.nop}});ns.Model.define("comment",{params:{id:null}});ns.Model.define("comment-add-so",{params:{"author-login":null,"image-id":null}});ns.Model.define("photo-near-context",{params:{context:null,"author-login":null,"image-id":null,"page-size":20,"contest-id":null,tag:null}});ns.Model.define("tags",{params:{"author-login":null,"image-id":null}});ns.Model.define("album-info",{params:{"author-login":null,"album-id":null}});ns.Model.define("blog-code-settings");ns.Model.get("blog-code-settings",{}).setData({sizes:{quick:["l","xl","orig"],all:["orig","xxxl","xxl","xl","l","m","s","xs","xxs","xxxs"]}});ns.Model.define("exif",{params:{"author-login":null,"image-id":null}});ns.Model.define("views",{params:{"author-login":null,"image-id":null}});ns.Model.define("slider-context",{params:ph.params.sliderParams,split:{items:".images.images.image",model_id:"photo-lite",params:{"author-login":".author.login","image-id":".imageId"}},dynamic:{pagingModel:"do-get-context-page"},methods:{onItemChanged:function(){},createFakeModel:function(itemIndex){return ns.Model.get("photo-lite",{"author-login":0,"image-id":itemIndex}).setData({fake:true})},isFakeModel:function(model){return model.get(".fake")},extractPageData:function(pagingModel,page){var that=this;var insertion=pagingModel.models;insertion=ph.utils.uniq(insertion,function(m){return m.key});insertion=insertion.filter(function(m){return that.models.indexOf(m)===-1});var pageSize=this.dynamic.pageSize;var total=pagingModel.get(".images.total")||0;var countRaw=pagingModel.models.length;var count=insertion?insertion.length:0;var calcTotal=page*pageSize+count;var calcRawTotal=page*pageSize+countRaw;var totalConfirmed=this.dynamic.totalConfirmed=this.dynamic.totalConfirmed||calcRawTotal;var totalMax=this.dynamic.totalMax=this.dynamic.totalMax||Math.max(total,calcRawTotal);if(count>0&&countRaw<pageSize){this.dynamic.totalConfirmed=calcTotal;this.dynamic.totalMax=calcTotal;return{models:insertion,total:calcTotal}}if(count>0){this.dynamic.totalConfirmed=Math.max(totalConfirmed,calcRawTotal);this.dynamic.totalMax=Math.max(totalMax,Math.max(total,calcRawTotal))}if(count===0){if(totalConfirmed>calcRawTotal){this.dynamic.totalConfirmed=0}if(totalMax>calcRawTotal&&countRaw>=0&&countRaw<pageSize){this.dynamic.totalMax=calcRawTotal}}return{models:insertion,total:this.dynamic.totalMax}},compareParams:function(p1,p2){return p1["author-login"]==p2["author-login"]&&p1["image-id"]==p2["image-id"]},requestPagingModel:function(page){var promise=new no.Promise;var params=no.extend({},ns.page.current.params,{page:page});ph.controllers.slider.getAlbumPage(params).done(function(context){promise.resolve(context.model)});return promise}}},ph.DynamicModelCollection);ns.Model.define("fotki-old",{});ns.Model.define("settings");ns.Model.define("do-agreement-accept",{params:{ticket:null}});ns.Model.define("do-photo-description-edit",{params:{"image-id":null,description:null}});ns.Model.define("do-photo-edit",{params:{"image-id":null,"access-rights":null,"disable-comments":null,"hide-orig":null,"invalidate-links":null,porno:null}});ns.Model.define("do-photo-title-edit",{params:{"image-id":null,title:null}});ns.Model.define("do-photo-complain",{params:{"author-login":null,"image-id":null,types:null,url:null,comment:null,"contest-id":null},methods:{extractData:function(result){if(result&&result.result&&result.result.complete){return result.result}},extractError:function(result){if(result){return result.error||result.result.rejectReason}}}});ns.Model.define("do-photo-remove",{params:{"image-id":null}});ns.Model.define("do-photo-rotate",{params:{ticket:null,"image-id":null,angle:null}});(function(){var modelExtractor=function(){};no.inherit(modelExtractor,ns.ModelCollection);modelExtractor.prototype.preprocessData=function(data){var dataNew={comment:[]};dataNew.comment.push(data);return dataNew};ns.Model.define("do-comment-add",{params:{"author-login":null,"image-id":null,content:null,"parent-comment-id":null,"cap-key":null,"cap-rep":null,"display-name":null,so:null},split:{items:".comment",model_id:"comment",params:{id:".id"}}},modelExtractor)})();ns.Model.define("do-comment-delete",{params:{"author-login":null,"image-id":null,"comment-id":null}});ns.Model.define("do-comment-complain",{params:{"author-login":null,"image-id":null,"comment-id":null}});ns.Model.define("do-tag-edit",{params:{"author-login":null,"image-id":null,tags:null}});ns.Model.define("do-captcha-get",{});ns.Model.define("do-like-set",{params:{"author-login":null,"image-id":null,operation:null}});ns.Model.define("do-favorite-set",{params:{"author-login":null,"image-id":null,operation:null}});ns.Model.define("do-geo-bind",{params:{"author-login":null,"image-id":null,latitude:null,longitude:null,mapType:null,zoomLevel:null}});ns.Model.define("do-geo-unbind",{params:{"author-login":null,"image-id":null}});ns.Model.define("do-user-ban",{params:{"user-ids":null}});ns.Model.define("do-user-follow",{params:{"author-login":null}});ns.Model.define("do-user-unfollow",{params:{"author-ids":null}});ns.Model.define("do-password-check",{params:{ticket:null,"album-id":null,password:null,"author-id":null}});ns.Model.define("do-get-context-page",{params:{"page-size":20,page:0,context:null,"author-login":null,"album-id":null,"contest-id":null,tag:null,type:null,"search-text":null,"search-author":null,how:null,tags:null,modelid:null,noreask:null,chastity:null},split:{items:".images.images.image",model_id:"photo-lite",params:{"author-login":".author.login","image-id":".imageId"}}});ns.Model.define("do-send-to-contest",{params:{"author-login":null,"image-id":null,title:null,tags:null,"contest-id":null,ticket:null}});ns.Model.define("do-revoke-from-contest",{params:{"author-login":null,"image-id":null,"contest-id":null,ticket:null}});ns.Model.define("do-image-can-edit",{params:{ticket:null,"image-id":null}});ns.Model.define("do-image-before-edit",{params:{ticket:null,"image-id":null,actions:null}});ns.Model.define("do-image-edit",{params:{ticket:null,"image-id":null,actions:null}});ns.Model.define("do-image-edit-status",{params:{ticket:null,"image-id":null}});(function(){var key2timer={};var destroyModel=function(id,params){var m=ns.Model.get(id,params);if(m.isValid()){ns.Model.destroy(m)}};var invalidateModels=function(id,filter){ns.Model.invalidate(id,filter)};var cleanup=function(modelId,params){var cleanupHandler=cleanupHandlers[modelId];cleanupHandler(params)};var cleanupHandlers={};cleanupHandlers["photo"]=function(params){destroyModel("photo",params);destroyModel("photo-lite",params);invalidateModels("photo-near-context");invalidateModels("photo-position")};var errorHandlers={};errorHandlers["photo-rights"]={};errorHandlers["photo-rights"]["image not found"]=function(m){cleanup("photo",m.params)};var cacheFor=function(model,timeout,force){var key=model.key;if(key2timer[key]&&!force){return}if(force&&key2timer[key]){clearTimeout(key2timer[key])}key2timer[key]=setTimeout(function(){model.status=ns.M.STATUS.INVALID;key2timer[key]=null},timeout)};ph.modelsManager={cleanup:function(modelId,params){cleanup(modelId,params)},handleError:function(model){var error=model.getError();if(!error){return}var modelHandlers=errorHandlers[model.id];if(!modelHandlers){return}var errorHandler=modelHandlers[error.name];if(!errorHandler){return}errorHandler(model)},cacheFor:cacheFor}})();ph.views={};ns.View.define("app",{events:{"ns-view-htmlinit":"onHtmlInit"},methods:{onHtmlInit:function(){ph.keyboard.register(this,{"?":{method:"showShortcuts",name:"shortcuts: show"}})},showShortcuts:function(){var popup=this.shortcutsPopup||(this.shortcutsPopup=this._createShortcutsPopup());popup.trigger("toggle",{where:document.body})},_createShortcutsPopup:function(){var data={keys:ph.keyboard.getDefs()};var popupNode=$(ns.tmpl(data,"keyboard-shortcuts")).appendTo(document.body)[0];return nb.block(popupNode,{show:function(){ph.metrika.count(["desktop web","interface elements","image viewer","show hotkeys help",ph.metrika.mode()])}})}}});ns.View.define("not-found",{events:{"ns-view-show":function(){ns.page.go("/404.xml","replace")}}});ns.View.define("head",{});ns.View.define("bar",{params:[{mode:null},{}]});ns.View.define("index");ns.View.define("tray",{params:{mode:null},events:{"ns-view-htmlinit":"onHtmlInit","ph-multiple-photo-album@show":"enableTray","ph-single-photo-album@show":"disableTray"},methods:{onHtmlInit:function(){this._classes={show:"tray_visible",hide:"tray_hidden"};this._timeout=1.2*1e3;this._teased=false;this.disabled=true},tease:function(){if(this._teased){return}var that=this;this._teased=true;this.$node.addClass(this._classes.show);setTimeout(function(){that.$node.removeClass(that._classes.show)},this._timeout)},enableTray:function(){this.tease();this.$node.removeClass(this._classes.hide);this.disabled=false},disableTray:function(){this.$node.addClass(this._classes.hide);this.disabled=true}}});ns.View.define("tray-container",{});(function(){var key=function(params){return ns.Model.key("photo",params)};var SliderItem=React.createClass({displayName:"SliderItem",handleClick:function(){var photoParams=this.props.photoParams;var params=no.extend({},ns.page.current.params,{"author-login":photoParams["author-login"],"album-id":photoParams["album-id"],"image-id":photoParams["image-id"],page:photoParams["page"]});ns.page.go(ph.utils.generateUrl("photo",params),window.screenfull.isFullscreen?"preserve":false);this.props.metrikaCounter(["click on preview",ph.metrika.mode()])},render:function(){var photo=this.props.photo;var className="slider-item";var imageStyle={};if(this.props.more.isBlocked){className+=" slider-item_restricted"}else if(this.props.more.is18plus){className+=" slider-item_18plus"}else if(this.props.more.isLost){className+=" slider-item_lost"}else if(this.props.photo.sizes){imageStyle.backgroundImage="url('"+this.props.photo.sizes.xxs.url+"')"}else{className+=" slider-item_loading"}if(this.props.isCurrent){className+=" slider-item_current"}return React.DOM.div({className:className,onClick:photo.fake?null:this.handleClick},React.DOM.div({className:"photo-link",style:imageStyle}))}});var Scrolled={getVisible:function(scrollLeft){var pageSize=this.props.pageSize;var itemSize=this.props.itemSize;var scrollWrapperNode=this.refs["scroll-wrapper"].getDOMNode();var width=scrollWrapperNode.offsetWidth;var leftEdge=scrollLeft||scrollWrapperNode.scrollLeft;var rightEdge=leftEdge+width;var firstItemIndex=Math.floor(leftEdge/itemSize);var lastItemDelta=rightEdge%itemSize;var lastItemIndex=lastItemDelta===0?rightEdge/itemSize-1:Math.floor(rightEdge/itemSize);if(this.state.total){lastItemIndex=Math.min(this.state.total-1,lastItemIndex)}var firstPageIndex=Math.floor(firstItemIndex/pageSize);var lastPageIndex=Math.floor(lastItemIndex/pageSize);return{items:{from:firstItemIndex,to:lastItemIndex},pages:{from:firstPageIndex,to:lastPageIndex}}},zip:function(visible,silent){var hardThreshold=5;visible=visible||this.visible;var pageFrom=visible.pages.from;var pageTo=visible.pages.to;var goodPageFrom=Math.max(pageFrom-hardThreshold-pageFrom%hardThreshold,0);var goodPageToReserve=hardThreshold-pageTo%hardThreshold;var goodPageTo=pageTo+hardThreshold+(goodPageToReserve===hardThreshold?0:goodPageToReserve);var needUpdate=false;if(this.pageFrom!==goodPageFrom){this.pageFrom=goodPageFrom;needUpdate=true}if(this.pageTo!==goodPageTo){this.pageTo=goodPageTo;needUpdate=true}if(needUpdate&&!silent){this.forceUpdate()}},scrollToPage:function(page,scrollToEnd){var sliderOuterNode=this.refs["scroll-wrapper"].getDOMNode();var sliderWidth=sliderOuterNode.offsetWidth;var pageWidth=+this.props.pageSize*+this.props.itemSize;if(scrollToEnd){this._setScrollLeft((page+1)*pageWidth-sliderWidth-this.props.itemsGap)}else{this._setScrollLeft(page*pageWidth)}},expandScrolled:function(scrollLeft){var pageSize=this.props.pageSize;var itemSize=this.props.itemSize;var sliderOuterNode=this.refs["scroll-wrapper"].getDOMNode();var sliderInnerNode=this.refs.scrolled.getDOMNode();var sliderWidth=sliderOuterNode.offsetWidth;var fullWidth=sliderInnerNode.offsetWidth;scrollLeft=scrollLeft||sliderOuterNode.scrollLeft;var hardExtendStepPages=5;var pageWidth=pageSize*itemSize;var extendGap=pageWidth;var extendStep=hardExtendStepPages*pageWidth;if(scrollLeft+sliderWidth+extendGap>fullWidth){var newScrolledWidth=scrollLeft-scrollLeft%extendStep;while(newScrolledWidth-(scrollLeft+sliderWidth)<extendGap){newScrolledWidth+=extendStep}this.setScrolledWidth(newScrolledWidth)}},setScrolledWidth:function(newScrolledWidth){var oldScrolledWidth=this.state.scrolledWidth;newScrolledWidth=this.normalizeScrolledWidth(newScrolledWidth);if(oldScrolledWidth!=newScrolledWidth){this.setState({scrolledWidth:newScrolledWidth})}},normalizeScrolledWidth:function(newScrolledWidth,total){total=total||this.state.total;var maxScrollWidth=total!=null?this.getTotalWidth(total):Infinity;return Math.min(newScrolledWidth,maxScrollWidth)},arrowsUpdate:function(){var sliderOuterNode=this.refs["scroll-wrapper"].getDOMNode();var sliderInnerNode=this.refs.scrolled.getDOMNode();var scrollLeft=sliderOuterNode.scrollLeft;var sliderWidth=sliderOuterNode.offsetWidth;var fullWidth=sliderInnerNode.offsetWidth;var itemSize=this.props.itemSize;var hideNext=fullWidth-itemSize/2<scrollLeft+sliderWidth;var hidePrev=scrollLeft<itemSize/2;$(this.refs.nextArrow.getDOMNode())[hideNext?"fadeOut":"fadeIn"]();$(this.refs.prevArrow.getDOMNode())[hidePrev?"fadeOut":"fadeIn"]()},isItemFullyVisible:function(index){var itemLeftEdge=index*this.props.itemSize;var itemRightEdge=(index+1)*this.props.itemSize-this.props.itemsGap;var sliderOuterNode=this.refs["scroll-wrapper"].getDOMNode();var scrollLeft=sliderOuterNode.scrollLeft;var sliderWidth=sliderOuterNode.offsetWidth;return itemLeftEdge>=scrollLeft&&itemRightEdge<=scrollLeft+sliderWidth},scrollTo:function(index,animate){var newScrollLeft=this.props.itemSize*index;this._setScrollLeft(newScrollLeft,animate)},scrollLeft:function(){this._scrollBy(-3);this.props.metrikaCounter(["click to previous",ph.metrika.mode()])},scrollRight:function(){this._scrollBy(3);this.props.metrikaCounter(["click to next",ph.metrika.mode()])},_scrollBy:function(delta){var sliderOuterNode=this.refs["scroll-wrapper"].getDOMNode();var newScrollLeft=sliderOuterNode.scrollLeft+delta*this.props.itemSize;this._setScrollLeft(newScrollLeft)},_setScrollLeft:function(newScrollLeft,animate){var sliderOuterNode=this.refs["scroll-wrapper"].getDOMNode();this.expandScrolled(newScrollLeft);this.zip(this.getVisible(newScrollLeft),true);this.forceUpdate();animate=typeof animate==="undefined"?true:animate;if(animate){$(sliderOuterNode).animate({scrollLeft:newScrollLeft},300)}else{sliderOuterNode.scrollLeft=newScrollLeft}},getTotalWidth:function(total){total=total||this.state.total;if(total==null){throw new Error("[getTotalWidth] total was not specified")}return total*this.props.itemSize-this.props.itemsGap}};var MouseWheelScroll={enableMouseWheel:function(){var that=this;if(this.scrollLazyCallback){return}this.scrollLazyCallback=ph.utils.lazyCallback(10,function(delta){delta=delta||0;if(delta!==0){that.refs["scroll-wrapper"].getDOMNode().scrollLeft-=delta}},function(value,args){var evt=args[0];if((evt.deltaX||0)!==0){return value}evt.preventDefault();return value+evt.deltaY*evt.deltaFactor});$(this.refs["scroll-wrapper"].getDOMNode()).on("mousewheel",this.scrollLazyCallback)},disableMouseWheel:function(){if(this.scrollLazyCallback){$(this.refs["scroll-wrapper"].getDOMNode()).off("mousewheel",this.scrollLazyCallback);this.scrollLazyCallback=null}}};var Slider=React.createClass({displayName:"Slider",mixins:[Scrolled,MouseWheelScroll],getInitialState:function(){return{total:null,currentItemKey:null,scrolledWidth:0}},componentDidMount:function(){this.update()},componentDidUpdate:function(){this.update();this.enableMouseWheel()},componentWillUnmount:function(){this.disableMouseWheel()},update:function(){this.expandScrolled();this.visible=this.getVisible();this.props.data.sync(this.visible);this.arrowsUpdate();this.zip()},handleScroll:function(){this.update()},getItemIndex:function(params){return this._getItemIndex(key(params))},_getItemIndex:function(itemKey){var models=this.props.data.models;for(var i=0;i<models.length;i++){if(key(models[i].params)===itemKey){return i}}return-1},setCurrentItem:function(params){this.setState({currentItemKey:key(params)})},getCurrentItemIndex:function(){return this._getItemIndex(this.state.currentItemKey)},setTotal:function(total,callback){if(this.state.total===total){return}this.setState({total:total,scrolledWidth:this.normalizeScrolledWidth(this.state.scrolledWidth,total)},callback)},resetAllItems:function(){this.setState(this.getInitialState())},preloadNextImage:function(){if(this.nextItemKey==null){return}var nextItem=this.refs[this.nextItemKey];if(!nextItem||!nextItem.props.photo){return}var img=new Image;var size=ph.utils.getClosestSize(nextItem.props.photo,ph.photoBox.getDimentions());if(size){img.src=size.value.url}},render:function(){var setAsNext=false;this.nextItemKey=null;var items=[];for(var i=this.pageFrom*this.props.pageSize;i<Math.min(this.pageTo*this.props.pageSize,this.props.data.models.length);i++){var photoModel=this.props.data.models[i];var photo=photoModel.getData();if(!photo){photo=this.props.data.createFakeModel(i).getData()}var itemKey=key(photoModel.params);if(setAsNext){setAsNext=false;this.nextItemKey=itemKey}var isCurrent=itemKey===this.state.currentItemKey;setAsNext=isCurrent;var more={};if(!photo.fake){more.isBlocked=photo.flags.blocked;more.isLost=photo.flags.lostInStorage;more.is18plus=photo.flags.porno&&!ph.allow18plus(this.props.uid)&&photo.author.uid!=this.props.uid}var photoParams={"author-login":photoModel.params["author-login"],"album-id":photoModel.get(".albumId"),"image-id":photoModel.params["image-id"],page:Math.floor(i/this.props.pageSize)};items.push(SliderItem({photo:photo,photoParams:photoParams,isCurrent:isCurrent,more:more,index:i,key:itemKey,ref:itemKey,metrikaCounter:this.props.metrikaCounter}))}var paddingLeft=this.pageFrom*this.props.pageSize*this.props.itemSize;var scrolledAreaStyle={paddingLeft:paddingLeft,width:this.state.scrolledWidth-paddingLeft};return React.DOM.div({className:"slider"},React.DOM.div({className:"slider-scroll-wrapper",ref:"scroll-wrapper",onScroll:this.handleScroll},React.DOM.div({className:"slider-next-photo",ref:"nextArrow",style:{display:"none"},onClick:this.scrollRight},React.DOM.span({className:"icon icon_arrow-right"})),React.DOM.div({className:"slider-prev-photo",ref:"prevArrow",style:{display:"none"},onClick:this.scrollLeft},React.DOM.span({className:"icon icon_arrow-left"})),React.DOM.div({className:"slider-scroll",ref:"scrolled",style:scrolledAreaStyle},items)))}});ph.R.Slider=Slider})();ns.View.define("slider",{params:ph.params.sliderParams,models:["slider-context","auth"],events:{"ns-view-htmlinit":"onHtmlInit","ns-view-htmldestroy":"onHtmlDestroy","ns-view-show":"onShow","ns-view-hide":"onHide","ns-page-before-load@show":"onPageGo",mouseenter:"countSliderShow","ph-next-photo@show":"goToNextPhoto","ph-prev-photo@show":"goToPrevPhoto","ph-slider-sync@show":"onSliderSync","ph-resize@show":"onWindowResize","ph-i-am-gt18@show":"invalidate","ph-slider-redraw@show":"onSliderRedrawRequest"},methods:{onHtmlInit:function(){this.collection=this.models["slider-context"];this.controller=ph.controllers.slider;this._initCallbacks()},onHtmlDestroy:function(){this._destroySliderComponent()},onShow:function(){this._ensureSliderComponent();this.collection.on("new-items-loaded",this._callbacks.redrawCallback);this.collection.on("sync-needed",this._callbacks.redrawCallback);this.collection.on("total-changed",this._callbacks.totalChangedCallback);this._syncCurrentItem();this._notifyAboutSliderState()},onHide:function(){this.collection.off("new-items-loaded",this._callbacks.redrawCallback);this.collection.off("sync-needed",this._callbacks.redrawCallback);this.collection.off("total-changed",this._callbacks.totalChangedCallback)},onSliderRedrawRequest:function(){if(this.collection){this.collection.syncCurrent()}},_ensureSliderComponent:function(){var that=this;var params=ns.page.current.params;var context=params["context"]||"album";if(context==="album"&&!params["album-id"]){return}if(this._initDone){this._setTotalIfPresent();return}this._initDone=true;this._initialScrollDone=false;if(!this.scrollQueue){this.scrollQueue=new ph.Queue({skipCycles:true,skipErrors:true,key:function(params){return ns.Model.key("photo",params)}})}var itemPadding=10;var itemSize=75+itemPadding;var uid=no.jpath(".uid.value",this.models.auth.getData());var ready=new no.Promise;var Slider=ph.R.Slider;var sliderComponent=React.renderComponent(Slider({itemSize:itemSize,itemsGap:itemPadding,pageSize:this.collection.dynamic.pageSize,uid:uid,data:this.collection,metrikaCounter:this.metrikaCounter.bind(this)}),this.node,function(){ready.resolve()});ready.done(function(){that.sliderComponent=sliderComponent;that._setTotalIfPresent()})},_setTotalIfPresent:function(){if(this.sliderComponent&&this.collection.dynamic.total){this._totalChanged()}},_destroySliderComponent:function(){if(this.scrollQueue){this.scrollQueue.abortAll(true);this.scrollQueue=null}if(this.sliderComponent){React.unmountComponentAtNode(this.node);this.sliderComponent=null;this._initDone=false;this._initialScrollDone=false}},onPageGo:function(evt,pair){var oldParams=pair[0].params;var newParams=pair[1].params;if(oldParams["author-login"]==newParams["author-login"]&&oldParams["image-id"]==newParams["image-id"]){return}this._syncCurrentItem(pair[1],true,true);ns.events.trigger("ph-photo-go")},onSliderSync:function(){this._syncCurrentItem()},onWindowResize:function(){if(this.sliderComponent){this.sliderComponent.forceUpdate()}},goToNextPhoto:function(){this._goToPhoto(+1)},goToPrevPhoto:function(){this._goToPhoto(-1)},_initCallbacks:function(){var that=this;this._callbacks={redrawCallback:function(){if(that.sliderComponent){that.sliderComponent.forceUpdate()}},totalChangedCallback:function(){that._totalChanged()
}}},_totalChanged:function(){var that=this;if(this._redirectIfAlbumIsEmpty()){return}if(!this.sliderComponent){return}var scrollCurrentIntoView=false;if(!this._initialScrollDone){this._initialScrollDone=true;scrollCurrentIntoView=true}this.sliderComponent.setTotal(this.collection.dynamic.total,function(){that._syncCurrentItem(null,scrollCurrentIntoView);that._notifyAboutSliderState()})},_notifyAboutSliderState:function(){if(!this.collection.firstDataPortionLoaded){return}ns.events.atrigger(this.collection.dynamic.total>1?"ph-multiple-photo-album":"ph-single-photo-album")},_goToPhoto:function(delta){if(delta===0){return}var currentIndex=this.sliderComponent.getCurrentItemIndex();if(currentIndex>=0){this._goToPhotoByIndex(currentIndex+delta,delta>0)}else{this._goToPhotoByIndex(0)}},_goToPhotoByIndex:function(newIndex,isNext){var that=this;var total=this.collection.dynamic.total;if(!this.sliderComponent){return}if(!this.collection.firstDataPortionLoaded){return}if(this._redirectIfAlbumIsEmpty()){return}if(newIndex>=total){newIndex=0}else if(newIndex<0){newIndex=total-1}var nextPhoto=this.collection.getItem(newIndex);if(nextPhoto){this._redirectToPhotoPage(nextPhoto.getData());return}this.controller.getPhotoNearContext().done(function(context){if(context.pageLeft){return}var photo=context.model.get(isNext?".next":".prev");if(photo){that._redirectToPhotoPage(photo)}else{if(newIndex!==0){that._goToPhotoByIndex(0)}}})},_redirectIfAlbumIsEmpty:function(){if(this.collection.firstDataPortionLoaded&&this.collection.dynamic.total<=0){ns.events.atrigger("ph-viewer-can-be-closed");return true}return false},_redirectToPhotoPage:function(photoModelData){if(!photoModelData){return}if(!this.sliderComponent){return}var screenfull=window.screenfull;var url=this._generateUrl(photoModelData);if(url===ns.page.currentUrl){return}ns.page.go(url,screenfull.isFullscreen?"preserve":false);var params={"author-login":photoModelData.author.login,"image-id":photoModelData.imageId};this.sliderComponent.setCurrentItem(params)},_generateUrl:function(photoModelData){var pageParams=no.extend({},ns.page.current.params,{"author-login":photoModelData.author.login,"album-id":photoModelData.albumId,"image-id":photoModelData.imageId});return ph.utils.generateUrl("photo",pageParams)},_syncCurrentItem:function(newPage,scrollIntoView,cancelOldScroll){var that=this;newPage=newPage||ns.page.current;scrollIntoView=typeof scrollIntoView==="undefined"?true:scrollIntoView;if(!this.sliderComponent){return}if(newPage.page!=="photo"){return}this.scrollQueue.add(newPage.params,function(){return that._asyncSetCurrentItem(newPage.params,scrollIntoView)},cancelOldScroll)},_asyncSetCurrentItem:function(params,scrollIntoView){var that=this;var promise=new no.Promise;that._getItemIndex(params).done(function(itemIndex){if(!that.sliderComponent){promise.resolve();return}that.sliderComponent.setCurrentItem(params);if(scrollIntoView&&!that.sliderComponent.isItemFullyVisible(itemIndex)){that.sliderComponent.scrollTo(itemIndex)}that.sliderComponent.preloadNextImage();promise.resolve()});return promise},_getItemIndex:function(params){var itemIndex=this.sliderComponent.getItemIndex(params);if(itemIndex>=0){return no.Promise.resolved(itemIndex)}var promise=new no.Promise;this.controller.getPhotoPosition(params).done(function(context){promise.resolve(context.model.getData().position)}).fail(function(details){if(no.jpath(".context.error.name",details)===ph.ERRORS.imageNotFound){promise.resolve(0)}});return promise},countSliderShow:function(){ph.metrika.count(["desktop web","interface elements","image viewer","show slider",ph.metrika.mode()])},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer","previews"])}});(function(){var userScroll=true;ns.View.define("panel",{events:{"scroll@show":"onScroll"},methods:{onScroll:function(){if(userScroll){ns.events.trigger("ph-panel-scroll")}}}});ns.View.define("panel-container",{params:[{"author-login":null,"image-id":null,"album-id":null,mode:null},{"author-login":null,"image-id":null,mode:null}],events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"onShow","ns-page-before-load@show":"onPageUpdate"},methods:{onHtmlInit:function(){this.scrollPosition=0;this._nodes={$viewport:this.$node.closest(".js-panel")}},onShow:function(){userScroll=false;this._nodes.$viewport.scrollTop(this.scrollPosition);setTimeout(function(){userScroll=true},50)},onPageUpdate:function(){this.scrollPosition=this._nodes.$viewport.scrollTop()}}})})();ns.View.define("photo",{params:{mode:null},models:["photo-initial-redirect"],events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"onShow","ns-view-hide":"onHide","click .js-go-back":"onClickGoBack","click .js-go-back-area":"onClickGoBackArea","ph-resize@show":"_onResize","ph-close-viewer@show":"closeViewer","ph-photo-saving@show":"showSpinner","ph-photo-save-done@show":"hideSpinner"},methods:{onHtmlInit:function(){this._nodes={$photoBox:$(".js-photo-box",this.node),$spinner:$(".js-spinner",this.node)};this._updateDimentions();this._shortcuts={esc:{method:"handleCloseViewerShortcut",last:true}}},onShow:function(){ph.keyboard.register(this,this._shortcuts)},onHide:function(){ph.keyboard.forget(this)},handleCloseViewerShortcut:function(evt){if(nb.popup.someOpen()){return}var params=ns.page.current.params;var isFullscreen=params["mode"]==="fullscreen";if(isFullscreen){this.metrikaCounter(["go to white mode",ph.metrika.getEventSummary(evt)])}else{this.metrikaCounter(["close image viewer",ph.metrika.getEventSummary(evt)])}this.closeViewer();return false},_onResize:function(){this._updateDimentions();ns.events.trigger("ph-photo-box-resize")},_updateDimentions:function(){this._dimentions={height:this._nodes.$photoBox.height(),width:this._nodes.$photoBox.width()};ph.photoBox.setSize(this._dimentions)},onClickGoBack:function(){var params=ns.page.current.params;var isFullscreen=params["mode"]==="fullscreen";if(isFullscreen){this.metrikaCounter(["go to white mode","x"])}else{this.metrikaCounter(["close image viewer","x"])}this.closeViewer();return false},onClickGoBackArea:function(){this.metrikaCounter(["close image viewer","dark area"]);this.closeViewer();return false},closeViewer:function(){var url;var params=ns.page.current.params;if(ph.slideshow.isRunning()){ph.slideshow.stop()}if(params["mode"]==="fullscreen"){url=ph.utils.generateUrl("photo",no.extend({},params,{mode:"view"}))}else{var fotkiOld=ns.Model.getValid("fotki-old",{});url=fotkiOld&&fotkiOld.get(".url")||"/"}ns.page.go(url)},showSpinner:function(){this._nodes.$spinner.toggleClass("photo-is-updating_hidden",false)},hideSpinner:function(){this._nodes.$spinner.toggleClass("photo-is-updating_hidden",true)},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}});ns.View.define("photo-image",{params:[{"author-login":null,"image-id":null,"album-id":null,mode:null},{"author-login":null,"image-id":null,mode:null}],models:["photo","photo-rights","auth"],subviews:{image:["photo .author","photo .sizes","photo .blockReason","photo-rights .options.isOwner"]},events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"onShow","ns-view-hide":"onHide","click .js-button-gte18":"onClickGte18","click .js-button-lt18":"onClickLt18","click .js-button-password-check":"checkPassword","input .js-album-password":"onInputPassword","ph-photo-box-resize@show":"updateImageIfNeeded","ph-image-changed":"updateImage","ph-i-am-gt18":"invalidate","ph-password-validated@show":"invalidate","ph-page-change@show":"onPageChange"},methods:{onHtmlInit:function(){if(ph.redirect.redirectToPhoto(this.models.photo)){return}this._nodes={$buttonCheckPassword:$(".js-button-password-check",this.node),$inputPassword:$(".js-album-password",this.node),$image:$(".js-image",this.node),image:$(".js-image",this.node)[0]};this._classes={disabled:"is-disabled"};this._shortcuts={enter:{method:"checkPassword",last:true,selector:".js-album-password"}};this._boxSize=this._nodes.$image.data("size")},onShow:function(){this.updateImageIfNeeded();ph.keyboard.register(this,this._shortcuts);this.countOnShow();if(!ph.slideshow.isRunning()){return}if(this._nodes.image){ph.utils.imgOnLoad(this._nodes.$image,function(){ns.events.trigger("ph-slideshow-image-show")})}else{ns.events.trigger("ph-slideshow-image-show")}},onHide:function(){ph.keyboard.forget(this)},onInputPassword:function(){this._nodes.$buttonCheckPassword.toggleClass(this._classes.disabled,this._isPasswordEmpty())},_isPasswordEmpty:function(){return this._nodes.$inputPassword.val().trim()===""},checkPassword:function(evt){if(this._isPasswordEmpty()){return}var that=this;var password=this._nodes.$inputPassword.val();var promise=ph.controllers.photo.checkPassword(this.models.photo,password);promise.done(function(details){ns.events.trigger("ph-password-validated");ph.actions.redrawView(details.context,that).done(function(){that.countIfPassworded()});that.metrikaCounter(["password enter","result","success"])});promise.fail(function(details){var messages={"empty password":"error_album-password-empty","access denied":"error_album-password-wrong","ph-default":"error_something-goes-wrong"};var error=no.jpath(".context.error.name",details);var message=messages[error]||messages["ph-default"];that._showError(details.context,that._nodes.$inputPassword[0],message);that.metrikaCounter(["password enter","result","no luck"])});this.metrikaCounter(["password enter",ph.metrika.getEventSummary(evt)])},_showError:function(context,node,errorId){ph.errors.showError(context,{messageId:errorId,element:node,popup:{how:{dir:"left"}}})},updateImage:function(){this.invalidate();ns.page.go(ns.page.currentUrl,"preserve")},updateImageIfNeeded:function(){var photoData=this.models.photo.getData();if(!photoData){return}var currentBoxSize=ph.utils.getClosestSize(photoData,ph.photoBox.getDimentions());if(currentBoxSize&&this._boxSize<currentBoxSize.name){this.updateImage()}},onClickGte18:function(){var that=this;var promise=ph.controllers.photo.setGte18(this.models.auth);promise.done(function(){ns.events.trigger("ph-i-am-gt18");ns.page.go(ns.page.currentUrl,window.screenfull.isFullscreen?"preserve":false).done(function(){that.countIf18Plus()})});this.metrikaCounter(["18+ button reply","yes"])},onClickLt18:function(){ns.events.trigger("ph-next-photo");this.metrikaCounter(["18+ button reply","no"])},countOnShow:function(){if(this.counted){return}this.countImageView();this.countIf18Plus();this.countIfPassworded();this.counted=true},onPageChange:function(){this.counted=false},countImageView:function(){var contextInfo=ph.metrika.getContextInfo();var mParams=["show main image",ph.metrika.mode(),"from context",contextInfo.name];if(contextInfo.more){mParams.push(contextInfo.more)}mParams=mParams.concat([this.models.photo.get(".imageFormat")||"unknown",this._nodes.$image.data("size-name")]);this.metrikaCounter(mParams)},countIf18Plus:function(){var photo=this.getModel("photo");if(!photo.get(".flags.porno")){return}var authorUid=photo.get(".author.uid");var currentUserUid=this.getModel("auth").get(".uid.value");var isAuthor=currentUserUid==authorUid;this.metrikaCounter(["18+",isAuthor?"author":ph.allow18plus(currentUserUid)?"show image":"show stub"])},countIfPassworded:function(){var photo=this.getModel("photo");if(!photo.get(".access.passworded")){return}var authorUid=photo.get(".author.uid");var currentUserUid=this.getModel("auth").get(".uid.value");var isAuthor=currentUserUid==authorUid;this.metrikaCounter(["passworded",isAuthor?"author":photo.get(".askAlbumPassword")?"show stub":"show image"])},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}});ns.View.define("photo-info",{params:[{"author-login":null,"image-id":null,"album-id":null},{"author-login":null,"image-id":null}],models:["auth","ticket","photo","photo-rights","photo-more","photo-position","profile","album-info"],subviews:{photo:["photo .author"],follower:["profile .viewerUserRelation.userIsFavoriteAuthorOfViewer"]},events:{"ns-view-htmlinit":"onViewHtmlInit","ns-view-show":"onShow","ns-page-before-load@show":"onPageLeave","click .js-follow":"toggleFollow","click .js-toggle-privacy":"togglePrivacy","click .js-album-link":"countGoToAlbum","click .js-username":"countGoToAuthorPage","ph-page-change@show":"onPageChange"},methods:{onViewHtmlInit:function(){var that=this;this.controller=ph.controllers.photo;this._nodes={$title:$(".js-nb-title",this.node),title:$(".js-nb-title",this.node)[0],$description:$(".js-nb-description",this.node),description:$(".js-nb-description",this.node)[0],$togglerPrivacy:$(".js-toggle-privacy",this.node)};this.title=this._initEditCollapsePair("title",this._nodes.$title,function(newValue){that.saveTitle(newValue)});this.description=this._initEditCollapsePair("description",this._nodes.$description,function(newValue){that.saveDescription(newValue)})},onShow:function(){this.countOnShow()},toggleFollow:function(evt){var that=this;var $buttonFollow=$(evt.target);if($buttonFollow.hasClass("is-disabled")){return}$buttonFollow.addClass("is-disabled");if(ph.noAuthRedirect(this.models.auth)){return}var profile=this.getModel("profile");var wasFollowing=profile.get(".viewerUserRelation.userIsFavoriteAuthorOfViewer");var promise=this.controller.toggleFollow(profile);if(promise==null){return}promise.always(function(details){ph.actions.redrawView(details.context,that)});this.metrikaCounter([wasFollowing?"unsubscribe":"subscribe"])},togglePrivacy:function(){var that=this;var photo=this.getModel("photo");if(this._nodes.$togglerPrivacy.hasClass("is-disabled")||!photo){return}this._nodes.$togglerPrivacy.addClass("is-disabled");var wasPublic=photo.get(".access.privilege")==="public";var promise=this.controller.setParam(photo,"access-rights");if(promise==null){return}promise.always(function(details){ph.actions.redrawView(details.context,that)});this.metrikaCounter(["change privacy",wasPublic?"set private":"set public"])},onPageLeave:function(){if(this.title&&this.title.edit){this.title.edit.trigger("ph-page-leave")}if(this.description&&this.description.edit){this.description.edit.trigger("ph-page-leave")}},saveDescription:function(newDescription){var that=this;var photoMore=this.models["photo-more"];var promise=this.controller.saveDescription(newDescription,photoMore);promise.fail(function(details){var newDescription=details.newDescription;var oldDescription=details.oldDescription;var context=details.context;that.description.edit.resetValue(oldDescription);ph.errors.showError(context,{messageId:"error_save-description",persistent:true,element:that._nodes.description,popup:{how:{dir:"left"}},data:{photo:that.models["photo"].getData()},ok:function(){that.description.edit.startEdit(newDescription)},cancel:function(){ph.actions.redrawView(context,that)}})});return false},saveTitle:function(newTitle){var that=this;var photo=this.models["photo"];var promise=this.controller.saveTitle(newTitle,photo);promise.fail(function(details){var newTitle=details.newTitle;var oldTitle=details.oldTitle;var context=details.context;that.title.edit.resetValue(oldTitle);ph.errors.showError(context,{messageId:"error_save-title",persistent:true,element:that._nodes.title,popup:{how:{dir:"left"}},data:{photo:photo.getData()},ok:function(){that.title.edit.startEdit(newTitle)},cancel:function(){ph.actions.redrawView(context,that)}})});return false},_initEditCollapsePair:function(what,$node,onSave){var that=this;var node=$node[0];if(!node){return}nb.block(node);var collapse=nb.block(node,null,"collapse-text");collapse.on("collapsed",this.countToggle.bind(this,what,false));collapse.on("expanded",this.countToggle.bind(this,what,true));if(!nb.hasBlock(node,"editable-text")){return{collapse:collapse}}var edit=nb.block(node,null,"editable-text");edit.on("nb-text-edit",function(evt,viaPencil){collapse.disable();that.countStartEdit(what,viaPencil)});edit.on("nb-text-edit-end",function(evt,saved){no.next(function(){collapse.enable()});if(saved===false){that.countCancelEdit(what)}});edit.on("save",function(evt,details){onSave(details.value);that.countSave(what,details.viaKeyboard)});return{edit:edit,collapse:collapse}},countOnShow:function(){if(this.counted){return}this.counted=true;if(!this.$node.is(".js-metrika-visible")){this.metrikaCounter(["title","show","hidden"]);this.metrikaCounter(["description","show","hidden"]);return}var photo=this.getModel("photo");var photoMore=this.getModel("photo-more");this.metrikaCounter(["title","show",photo.get(".title")?"filled":"empty"]);this.metrikaCounter(["description","show",photoMore.get(".description")?"filled":"empty"])},onPageChange:function(){this.counted=false},countStartEdit:function(what,viaPencil){this.metrikaCounter([what,"start edit",viaPencil?"on pencil":"on field"])},countCancelEdit:function(what){this.metrikaCounter([what,"cancel edit"])},countSave:function(what,viaKeyboard){this.metrikaCounter([what,"save edit",viaKeyboard?"keyboard":"click"])},countToggle:function(what,expanded){this.metrikaCounter([what,expanded?"unhide":"hide"])},countGoToAlbum:ph.metrika.countLink(function(){this.metrikaCounter(["go to album"])}),countGoToAuthorPage:ph.metrika.countLink(function(){var authorUid=this.getModel("profile").get(".user.uid");var currentUserUid=this.getModel("auth").get(".uid.value");var isAuthor=currentUserUid==authorUid;this.metrikaCounter(["go to author page",isAuthor?"author":"others"])}),metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}});ns.View.define("photo-slider-info");ns.View.define("photo-slider-info-item",{models:["photo","photo-position"]});(function(){var utils=ph.utils;ns.View.define("photo-tags",{params:{"author-login":null,"image-id":null},models:["auth","photo","tags","photo-rights","photo-more"],subviews:{photo:["photo .author"],"photo-rights":["photo-rights .actions.canAddTags"]},events:{"ns-view-htmlinit":"onViewHtmlInit","ns-view-show":"onShow","click .js-tag":"countGoToTagView","ph-page-change@show":"onPageChange"},methods:{onViewHtmlInit:function(){var that=this;this._nodes={$medals:$(".js-medals",this.node),$medalsWrapper:$(".js-medals-wrapper",this.node),$medalPhotoOfDay:$(".js-medal_photoofday",this.node),$tags:$(".js-editable-tags",this.node),tags:$(".js-editable-tags",this.node)[0]};var $tagsCollapseNode=$(this.node).find(".js-collapsed-text");var collapse;if($tagsCollapseNode.length){$tagsCollapseNode.attr("data-nb-line-height",24);collapse=nb.block($tagsCollapseNode[0],null,"collapse-text");collapse.on("collapsed",this.countToggle.bind(this,"tags",false));collapse.on("expanded",this.countToggle.bind(this,"tags",true))}if(this._nodes.$tags.length){var editableTags=this.editableTags=nb.block(this._nodes.tags,null,"editable-tags");editableTags.on("nb-tags-edit-start",function(){collapse.disable()});editableTags.on("nb-tags-edit-end",function(){no.next(function(){collapse.enable()})});editableTags.on("nb-tags-save",function(evt,details){that.editTags(details.value)})}if(this._nodes.$medals.length){var $medal=this._nodes.$medalsWrapper.find(".medal-wrapper:not(.medal_photoofday-wrapper)");if($medal.length){var _medalWidth=$medal.outerWidth(true);var _photoOfDayWidth=this._nodes.$medalPhotoOfDay.outerWidth(true);var _medalsWidthAvailable=this._nodes.$medals.outerWidth(false);_medalsWidthAvailable-=utils.cssValue(this._nodes.$medals,"padding-left");_medalsWidthAvailable-=utils.cssValue(this._nodes.$medals,"padding-right");_medalsWidthAvailable-=_photoOfDayWidth;_medalsWidthAvailable-=_medalsWidthAvailable%_medalWidth;_medalsWidthAvailable+=_photoOfDayWidth;this._nodes.$medalsWrapper.css("max-width",_medalsWidthAvailable)}var medalsCollapse=nb.block(this._nodes.$medals[0]);medalsCollapse.on("collapsed",this.countToggle.bind(this,"awards",false));medalsCollapse.on("expanded",this.countToggle.bind(this,"awards",true))}},onShow:function(){this.countOnShow()},editTags:function(tagsString){var that=this;var promise=ph.controllers.photo.editTags(tagsString,this.models);var redrawContext={pageUrl:ns.page.currentUrl};ph.actions.redrawView(redrawContext,this);promise.done(function(context){ph.actions.redrawView(context,that)});promise.fail(function(context){var messageId="error_edit-tags";if(!context){messageId="error_edit-tags-limit"}ph.errors.showError(context||null,{messageId:messageId,persistent:true,element:that._nodes.tags,popup:{how:{dir:"left"}},data:{photo:that.models.photo.getData()},ok:function(){that.editableTags.startEdit()},cancel:function(){ph.actions.redrawView(redrawContext,that)}})})},onPageChange:function(){this.counted=false},countOnShow:function(){if(this.counted){return}this.counted=true;if(!this.$node.is(".js-metrika-visible")){this.metrikaCounter(["tags","show","hidden"]);return}var tagsCount=(this.models.tags.get(".tags.tag")||[]).length;this.metrikaCounter(["tags","show",ph.metrika.group(tagsCount,[0,5,10,20,30]),tagsCount]);var medals=ph.utils.groupMedals(this.models["photo-more"].getData());if(medals.length){this.metrikaCounter(["awards","total",medals.length])}var contestCount=0;for(var i=0;i<medals.length;i++){if(medals[i].type==="photoofday"){this.countMedal("pod")}else if(medals[i].type==="top"){this.countMedal("top")}else if(medals[i].type==="contest"){contestCount++}}if(contestCount>0){this.metrikaCounter(["awards","types","contest",contestCount])}},countMedal:function(type){this.metrikaCounter(["awards","types",type])},countToggle:function(what,expanded){this.metrikaCounter([what,expanded?"unhide":"hide"])},countGoToTagView:ph.metrika.countLink(function(){this.metrikaCounter(["go to tag view"])}),metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}})})();ns.View.define("photo-on-map",{params:{"author-login":null,"image-id":null,mode:null},models:["auth","photo","photo-rights","photo-more"],subviews:{"map-button":["photo-rights .actions.canBindGeo","photo-more .boundCoord"]},events:{"ns-view-htmlinit":"onHtmlInit","ns-view-htmldestroy":"onHtmlDestroy"},methods:{onHtmlInit:function(){this.controller=ph.controllers.photo;this._nodes={mapPopup:$(".js-map-popup",this.node)[0],map:$(".js-map-popup .map",this.node)[0],$mapPopupToggler:$(".js-photo-map-toggler",this.node)};this._createMapControl()},onHtmlDestroy:function(){this._destroyMapControl()},_createMapControl:function(){var that=this;this.mapReadyPromise=this._prepareMapInit().done(function(){that._endMapInit()})},_destroyMapControl:function(){var map=this.map;var mapPopup=this.mapPopup;this.map=null;this.mapPopup=null;if(mapPopup){mapPopup.trigger("close");mapPopup.destroy()}if(map){map.cancel();map.destroy()}this.mapReadyPromise=null},_onMapOpen:function(){if(this.map.canEdit&&!this.map.hasMarker()){this.map.setEditMode()}else{this.map.setViewMode()}this.map.redraw()},_prepareMapInit:function(){var that=this;var promise=new no.Promise;if(!this._nodes.mapPopup||!this._nodes.map){promise.reject();return promise}var mapPopup=this.mapPopup=nb.block(this._nodes.mapPopup,{show:this.countMapShow.bind(this)});ph.utils.once(mapPopup,"open",function(){var map=that.map=nb.block(that._nodes.map);map.ready.pipe(promise)});return promise},_endMapInit:function(){var that=this;var map=this.map;var mapPopup=this.mapPopup;var more=that.models["photo-more"].getData();if(more&&more.boundCoord){map.setMarker({lat:more.boundCoord.latitude,lon:more.boundCoord.longitude},{mapType:more.boundCoord.mapType,zoom:more.boundCoord.zoomlevel||more.boundCoord.zoomLevel})}map.fixState();map.on("ph-map-save",function(evt,data){if(data){that._geoBind(data)}else{that._geoUnbind()}});this._onMapOpen();mapPopup.on("ph-show-end",this._onMapOpen.bind(this));mapPopup.on("close",function(){map.cancel()})},_geoBind:function(data){var that=this;var map=this.map;var promise=this.controller.geoBind(data,this.models["photo-more"]);promise.done(function(details){ph.actions.redraw(details.context)});promise.fail(function(details){map.showError({persistent:true,messageId:"error_map-bind-failed",data:{photo:that.models["photo"].getData()}},{details:details,showPopup:function(){that._showMapPopup()}})})},_geoUnbind:function(){var that=this;var map=this.map;var promise=this.controller.geoUnbind(this.models["photo-more"]);if(!promise){return}promise.done(function(details){ph.actions.redraw(details.context)});promise.fail(function(details){map.showError({persistent:true,messageId:"error_map-unbind-failed",data:{photo:that.models["photo"].getData()}},{details:details,showPopup:function(){that._showMapPopup()}})})},_showMapPopup:function(){this._nodes.$mapPopupToggler.trigger("click")},countMapShow:function(){var that=this;var authorUid=this.getModel("photo").get(".author.uid");var currentUserUid=this.getModel("auth").get(".uid.value");var isAuthor=currentUserUid==authorUid;this.mapReadyPromise.done(function(){that.metrikaCounter(["map","show map",isAuthor?"owner":"visitor",ph.metrika.mode(),that.map.getMapType()])})},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}});ns.View.define("photo-controls",{params:{"author-login":null,"image-id":null,mode:null},models:["auth","photo","photo-rights","photo-more","blog-code-settings","views"],subviews:{views:"views .total",like:["photo .likeCount","photo-rights .options.like"],favorite:"photo-rights .options.favorite"},events:{"ns-view-htmlinit":"onHtmlInit","ns-view-htmldestroy":"onHtmlDestroy","ns-view-show":"onShow","ns-view-hide":"onHide","click .js-slideshow":"toggleSlideshow","click .js-like":"toggleLike","click .js-favorite":"toggleFavorite","click .js-layout-toggle":"toggleLayout","ph-fullscreen-change@show":"handleFullscreenChange","ph-i-am-gt18":"invalidate","ph-password-validated@show":"invalidate","ph-image-changed":"invalidate","ph-photo-print-changed@show":"invalidate","ph-slideshow-stop":"onSlideshowStop","ph-slideshow-image-show@show":"onImageShow"},methods:{onHtmlInit:function(){var that=this;if(!this.models.photo||!this.models.photo.isValid()){return}var nodes=this._nodes={copyToClipboard:$(".js-copy-link",this.$node)[0],blogCodePopup:$(".js-blog-code-popup",this.$node)[0],blogCode:$(".js-blog-code-popup .js-blog-code",this.$node)[0],statPopup:$(".js-stat-popup",this.$node)[0],photoSharePopup:$(".js-photo-share-popup",this.$node)[0],photoMorePopup:$(".js-photo-more-popup",this.$node)[0],complainPopup:$(".js-complain-popup",this.$node)[0],detailsPopup:$(".js-details-popup",this.$node)[0]};this.controller=ph.controllers.photo;ph.loadModule("share").done(function(){that._initShare()});if(nodes.copyToClipboard){this._clipboard=nb.block(nodes.copyToClipboard);this._clipboard.on("saved",function(){var sharePopup=nb.block(that._clipboard.$node.closest(".popup")[0]);sharePopup.trigger("close");that.metrikaCounter(["share",ph.metrika.mode(),"copy link"])})}if(nodes.statPopup){nb.block(nodes.statPopup,{show:function(){that.metrikaCounter(["statistics","show",ph.metrika.mode()])},"click .js-stat-link":function(){that.metrikaCounter(["statistics","click on referrer url"])}})}if(nodes.photoSharePopup){nb.block(nodes.photoSharePopup,{"click .js-vkontakte":function(){that.metrikaCounter(["share",ph.metrika.mode(),"vk"])},"click .js-odnoklassniki":function(){that.metrikaCounter(["share",ph.metrika.mode(),"odnoklassniki"])},"click .js-facebook":function(){that.metrikaCounter(["share",ph.metrika.mode(),"fb"])},"click .js-twitter":function(){that.metrikaCounter(["share",ph.metrika.mode(),"twitter"])},"click .js-yaru":function(){that.metrikaCounter(["share",ph.metrika.mode(),"yaru"])},"click .js-blog-code":function(){that.metrikaCounter(["share",ph.metrika.mode(),"blog code"])}})}if(nodes.blogCodePopup&&nodes.blogCode){this.blogCodePopup=nb.block(nodes.blogCodePopup);var blogCode=this.blogCode=nb.block(nodes.blogCode);blogCode.setPhoto(this.models.photo)}if(nodes.photoMorePopup){nb.block(nodes.photoMorePopup,{show:function(){that.metrikaCounter(["show dots menu",ph.metrika.mode()])},"click .js-show-original":function(){that.metrikaCounter(["show original",ph.metrika.mode()])},"click .js-exif":function(){that.metrikaCounter(["EXIF","show",ph.metrika.mode(),"click"])}})}if(nodes.complainPopup){var handleOption=function(){var options=Array.prototype.slice.call(arguments,0);return function(){if($(this).is(":checked")){that.metrikaCounter(["complain","choose reason"].concat(options))}}};this.complainPopup=nb.block(nodes.complainPopup,{show:function(){that.metrikaCounter(["complain","show",ph.metrika.mode()])},"click .js-help":function(){that.metrikaCounter(["complain","help"])},"change .js-copyright :checkbox":handleOption("copyright"),"change .js-pron :checkbox":handleOption("porn"),"change .js-violence :checkbox":handleOption("violent"),"change .js-spam :checkbox":handleOption("spam"),"change .js-other :checkbox":handleOption("other"),"change .js-contest :checkbox":handleOption("contest","against rules")});ph.utils.once(this.complainPopup,"open",function(){that._initComplainPhoto()})}if(nodes.detailsPopup){this.detailsPopup=nb.block(nodes.detailsPopup,{"click .js-model":ph.metrika.countLink(function(){that.metrikaCounter(["EXIF","go to market"])}),"click .js-model-shots":ph.metrika.countLink(function(){that.metrikaCounter(["EXIF","go to search"])})});ph.utils.once(this.detailsPopup,"open",function(){that._initDetails()})}this._shortcuts={l:{method:"toggleLike",name:"view photo: like"},f:{method:"toggleLayout",name:"layout: toggle",last:true},e:{method:"toggleExif",name:"exif: toggle"},space:{method:"toggleSlideshow",name:"slideshow: toggle",last:true}};this._callbacks={onPhotoChange:function(){if(that.blogCode){that.blogCode.reset();that.blogCode.updateCode()}},onBlogCodeSave:function(){if(!that.blogCodePopup){return}that.blogCodePopup.trigger("close");that.metrikaCounter(["code for blog","copy code button"])},onBlogCodeOpen:function(){if(!that.blogCode){return}that.blogCode.applyPrefs();that.blogCode.updateCode();that.metrikaCounter(["code for blog","show",ph.metrika.mode()])},onBlogCodeClose:function(){if(!that.blogCode){return}blogCode.reset()}}},toggleExif:function(evt){var popup=this.detailsPopup;var more=$(".js-more:visible",this.$node)[0];if(!popup||!more){return}if(!popup.$node.is(":visible")){popup.trigger("open",{where:more,how:{where:"center top",what:"center bottom"}});this.metrikaCounter(["EXIF","show",ph.metrika.mode(),ph.metrika.getEventSummary(evt)])}else{popup.trigger("close")}},onHtmlDestroy:function(){ph.utils.destroyBlocks(this)},onSlideshowStop:function(){var $overlay=this.$node.closest(".overlay");$overlay.removeClass("overlay_slideshow")},handleFullscreenChange:function(evt,isFullscreen){nb.popup.closeAll();if(!isFullscreen&&ph.slideshow.isRunning()){ph.slideshow.stop();this.toggleSlideshowButton();this.metrikaCounter(["slideshow","exit","other"])}},_initDetails:function(){var that=this;var $detailsContent=$(".js-details-content",this.detailsPopup.node);var promise=that.controller.details();var updatePopup=function(extendData){var data=no.extend({models:{photo:that.models.photo.getData()}},extendData);$detailsContent.replaceWith(ns.tmpl(data,"details"));that.detailsPopup.trigger("move")};promise.done(function(details){updatePopup({exif:details.model.getData()})});promise.fail(function(){updatePopup({error:true})})},_initComplainPhoto:function(){var that=this;var complainForm=nb.block($(".js-complain",this.complainPopup.node)[0]);var urlNode=$(".js-link-to-origin .input",this.complainPopup.node)[0];complainForm.on("ph-click-send-complain",function(){var formData=complainForm.getData();var promise=that.controller.complain(formData);promise.done(function(){complainForm.showResult()});promise.fail(function(details){var context=details.context;if(context.error==="already-exist"||context.error==="already-moderated"){complainForm.showErrorExist()}else{complainForm.showErrorSend()}if(context.error==="bad-url"){ph.errors.showError(context,{messageId:"complain-wrong-url",element:urlNode,popup:{how:{dir:"left"}}})}});that.metrikaCounter(["complain","send"])
});complainForm.on("ph-click-send-one-more",function(){complainForm.resetForm();complainForm.showForm();that.metrikaCounter(["complain","send one more"])})},_initShare:function(){var that=this;var params=ns.page.current.params;var elementId="share_"+params["author-login"]+"-"+params["image-id"]+"-"+params["mode"];var photo=that.models.photo.getData();var link=ph.utils.getShareLink(photo);var title=(photo.title||photo.fileName)+" на Яндекс.Фотках";var quickServices=["vkontakte","odnoklassniki","facebook","twitter"];var serviceClasses=["js-vkontakte","js-odnoklassniki","js-facebook","js-twitter"];that._share=new Ya.share({onready:function(instance){var links=$(".b-share__link",instance._block);links.each(function(index,element){$(element).addClass("link").addClass(serviceClasses[index]).append($(element).attr("title"))})},element:elementId,l10n:"ru",theme:"default",elementStyle:{type:"none",border:false,quickServices:quickServices},link:link,title:title})},onShow:function(){if(this.models.photo&&this.models.photo.isValid()){this.models.photo.on("ns-model-changed",this._callbacks.onPhotoChange)}this.toggleSlideshowButton();ph.keyboard.register(this,this._shortcuts);if(this.blogCode&&this.blogCodePopup){this.blogCode.on("saved",this._callbacks.onBlogCodeSave);this.blogCodePopup.on("open",this._callbacks.onBlogCodeOpen);this.blogCodePopup.on("close",this._callbacks.onBlogCodeClose)}},onHide:function(){if(this.models.photo&&this.models.photo.isValid()){this.models.photo.off("ns-model-changed",this._callbacks.onPhotoChange)}ph.keyboard.forget(this);if(this.blogCode&&this.blogCodePopup){this.blogCode.off("saved",this._callbacks.onBlogCodeSave);this.blogCodePopup.off("open",this._callbacks.onBlogCodeOpen);this.blogCodePopup.off("close",this._callbacks.onBlogCodeClose)}},onImageShow:function(){if(ph.slideshow.isRunning()){ph.slideshow.run()}},isFullscreen:function(){return ns.page.current.params.mode==="fullscreen"},toggleSlideshowButton:function(){if(!this.isFullscreen()){return}var slideshow=ph.slideshow;var $slideshowButton=$(".js-slideshow",this.node);var $overlay=$slideshowButton.closest(".overlay");var toggle=slideshow.isRunning();$slideshowButton.toggleClass("ghost-button_pause",toggle);$overlay.toggleClass("overlay_slideshow",toggle);ph.keyboard.handleWindowBlur()},toggleSlideshow:function(evt){var slideshow=ph.slideshow;var slideshowToggler=$(".js-slideshow:visible",this.$node)[0];if(!slideshowToggler){return}var metrikaEventName;if(!slideshow.isRunning()){this.enterFullscreen();slideshow.run();metrikaEventName="start"}else{slideshow.stop();this.exitFullscreen();metrikaEventName="exit"}this.metrikaCounter(["slideshow",metrikaEventName,ph.metrika.getEventSummary(evt)]);this.toggleSlideshowButton()},toggleLike:function(evt){var like=$(".js-like:visible",this.$node)[0];if(!like||ph.noAuthRedirect(this.models.auth)){return}var that=this;var wasLike=!!this.models["photo-rights"].get(".options.like");var promise=this.controller.toggleLike(this.models["photo"],this.models["photo-rights"]);if(promise==null){return}ph.utils.once(this,"ns-view-hide",function(){$(".animate",this.node).removeClass("animate")});ns.page.go(ns.page.currentUrl,"preserve").done(function(){that.models["photo-rights"].set(".options.likeAnimate",false)});promise.fail(function(details){ph.actions.redrawView(details.context,that)});this.metrikaCounter([wasLike?"dislike":"like",ph.metrika.mode(),evt&&evt.type==="click"?"click":"shortcut"])},toggleFavorite:function(){if(ph.noAuthRedirect(this.models.auth)){return}var that=this;var wasFavorite=!!this.models["photo-rights"].get(".options.favorite");var promise=this.controller.toggleFavorite(this.models["photo-rights"]);if(promise==null){return}promise.done(function(details){ph.actions.redrawView(details.context,that)});promise.fail(function(details){ph.actions.redrawView(details.context,that)});this.metrikaCounter([wasFavorite?"remove from fav":"add to fav",ph.metrika.mode()])},toggleFullscreen:function(){if(this.isFullscreen()){this.enterFullscreen()}else{this.exitFullscreen()}},toggleLayout:function(evt){nb.popup.closeAll();var params=ns.page.current.params;var modeNew=params["mode"]==="view"?"fullscreen":"view";var url=ph.utils.generateUrl("photo",no.extend({},params,{mode:modeNew}));this.metrikaCounter([modeNew==="fullscreen"?"go to black mode":"go to white mode",ph.metrika.getEventSummary(evt)]);ns.page.go(url)},enterFullscreen:function(){var screenfull=window.screenfull;if(screenfull.enabled){screenfull.request()}},exitFullscreen:function(){var screenfull=window.screenfull;if(screenfull.enabled){screenfull.exit()}},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}});ns.View.define("photo-ears",{events:{"ns-view-init":"onInit","ns-view-show":"onShow","ns-view-hide":"onHide","click .js-next":"onClickNext","click .js-prev":"onClickPrev","ph-multiple-photo-album@show":"showEars","ph-single-photo-album@show":"hideEars"},methods:{onInit:function(){this._shortcuts={right:{method:"handleNextPhotoShortcut",name:"view photo: next"},j:{method:"handleNextPhotoShortcut",name:"view photo: next"},left:{method:"handlePrevPhotoShortcut",name:"view photo: prev"},k:{method:"handlePrevPhotoShortcut",name:"view photo: prev"}}},onShow:function(){ph.keyboard.register(this,this._shortcuts)},onHide:function(){ph.keyboard.forget(this)},onClickNext:function(evt){this.goToNextPhoto(evt);this.metrikaCounter(["go to next image",ph.metrika.mode(),"click right arrow"])},onClickPrev:function(evt){this.goToPrevPhoto(evt);this.metrikaCounter(["go to previous image",ph.metrika.mode(),"click left arrow"])},handleNextPhotoShortcut:function(evt){this.goToNextPhoto(evt);this.metrikaCounter(["go to next image",ph.metrika.mode(),ph.metrika.getEventSummary(evt)])},handlePrevPhotoShortcut:function(evt){this.goToPrevPhoto(evt);this.metrikaCounter(["go to previous image",ph.metrika.mode(),ph.metrika.getEventSummary(evt)])},goToNextPhoto:function(evt){this._goToPhoto(evt,"ph-next-photo")},goToPrevPhoto:function(evt){this._goToPhoto(evt,"ph-prev-photo")},showEars:function(){this.$node.removeClass("_hidden")},hideEars:function(){this.$node.toggleClass("_hidden",true)},_goToPhoto:function(evt,eventName){ns.events.trigger(eventName);evt.preventDefault();nb.popup.closeAll()},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}});ns.View.define("photo-edit",{events:{"ns-view-htmlinit":"onHtmlInit","ns-view-htmldestroy":"onHtmlDestroy","ns-view-show":"onShow","click .js-rotate:not(.is-disabled)":"rotateImage","click .js-edit:not(.is-disabled)":"onClickEdit","click .js-delete:not(.is-disabled)":"onClickDelete","click .js-access":"onClickAccess"},models:["photo","photo-rights","ticket","settings"],subviews:{controls:"photo .imageId"},methods:{onHtmlInit:function(){this.controller=ph.controllers.photo;this._nodes={$rotateButton:$(".js-rotate",this.$node),$editButton:$(".js-edit",this.$node),$deleteButton:$(".js-delete",this.$node),popupDelete:$(".js-popup-delete",this.$node)[0],popupAccessToggler:$(".js-access",this.$node)[0],$popupAccess:$(".js-popup-access",this.$node),popupAccess:$(".js-popup-access",this.$node)[0]};if(this.accessPopup&&this.accessPopupOpened&&this.hackMovePopup){this.hackMovePopup=false;this.accessPopup.toggler=this._nodes.popupAccessToggler;this.accessPopup.where=this._nodes.popupAccessToggler;this.accessPopup.trigger("move")}ph.modelsManager.cacheFor(this.models.settings,3e5)},onHtmlDestroy:function(){if(this.accessPopup&&this.accessPopupOpened){this.hackMovePopup=true}},onShow:function(){if(this.accessPopup&&this.accessPopup.$node.is(":visible")){this.$node.addClass("with-menu")}},rotateImage:function(){var photo=this.models["photo"];ns.events.trigger("ph-photo-saving");ph.keyboard.disable();var promise=this.controller.rotateImage(photo);promise.always(function(){ph.keyboard.enable();ns.events.trigger("ph-photo-save-done")});promise.done(function(){ns.events.trigger("ph-image-changed");ns.events.trigger("ph-slider-redraw")});promise.fail(function(details){var context=details.context;ph.errors.showError(context,{messageId:"error_photo-rotate-failed",persistent:true,popup:{how:{dir:"bottom"}},data:{photo:photo.getData()}})});this.metrikaCounter(["rotate image"])},onClickDelete:function(){var that=this;if(this.removePopup){return}var removePopup=this.removePopup=nb.block(this._nodes.popupDelete,{show:function(){removePopup.state={yes:false,cancelled:false,x:false}},hide:function(){if(!removePopup.state.counted){that.countImageDelete(removePopup.state)}},"click .js-cancel":function(){removePopup.state.cancelled=true},"click .js-x":function(){removePopup.state.x=true},"click .js-delete-agree":function(){var photo=that.models["photo"];var promise=that.controller.remove(photo);removePopup.state.yes=true;that.countImageDelete(removePopup.state);removePopup.state.counted=true;promise.done(function(details){removePopup.trigger("close");if(details.nextPhotoParams){var nextPhotoUrl=ph.utils.generateUrl("photo",no.extend({},ns.page.current.params,details.nextPhotoParams));ns.page.go(nextPhotoUrl,"replace").done(function(){ns.events.trigger("ph-slider-sync")})}else{ns.events.trigger("ph-close-viewer")}});promise.fail(function(details){removePopup.trigger("close");ph.errors.showError(details.context,{messageId:"error_photo-remove-failed",data:{photo:that.models["photo"].getData()},persistent:false})});return false}})},onClickAccess:function(){var that=this;if(this.accessPopup){return}this.accessPopup=nb.block(this._nodes.popupAccess,{open:function(){that.$node.addClass("with-menu");that.accessPopupOpened=true},close:function(){that.$node.removeClass("with-menu");that.accessPopupOpened=false},show:function(){that.metrikaCounter(["change privacy","show"])},"change .js-is-pron":function(evt){that.setPhotoParam("porno",evt.target)},"change .js-enable-comments":function(evt){that.setPhotoParam("disable-comments",evt.target)},"change .js-enable-print":function(evt){that.setPhotoParam("hide-orig",evt.target);ns.events.trigger("ph-photo-print-changed")},"click .js-invalidate-url":function(evt){that.invalidateLinks(evt.target);that.metrikaCounter(["change privacy","change url"])}});this.initChangeUrlHelpCounter()},setPhotoParam:function(name,node){var that=this;var $menuItem=$(node).closest(".toggler");if($menuItem.hasClass("is-disabled")){return}$menuItem.addClass("is-disabled");var promise=this.controller.setParam(this.models.photo,name);if(!promise){return}promise.always(function(details){$menuItem.removeClass("is-disabled");ph.actions.redrawView(details.context,that)});this.countPropChange(name,$(node).is(":checked"))},invalidateLinks:function(node){var that=this;this._nodes.$editButton.toggleClass("is-disabled",true);this._nodes.$rotateButton.toggleClass("is-disabled",true);this._nodes.$deleteButton.toggleClass("is-disabled",true);var progressButton=nb.block($(node).closest(".menu-row")[0],null,"progress-button");progressButton.setPopup(that.accessPopup);progressButton.setProgress();var promise=this.controller.invalidateLinks(this.models.photo);promise.done(function(details){progressButton.setDone();ns.events.trigger("ph-image-changed");ns.events.trigger("ph-slider-redraw");ph.actions.redrawView(details.context,that)});promise.fail(function(){progressButton.reset()})},beforeEditAsk:function(promise){if(this.beforeEditPopup){this.beforeEditPopup.destroy();this.beforeEditPopup=null}var renderData={param:ns.page.current.params,photo:this.models.photo.getData()};var node=ns.tmpl(renderData,"photo-before-edit-dialog");var willContinue=false;var beforeEditPopup=this.beforeEditPopup=nb.block(node,{"click .js-continue":function(){willContinue=true;beforeEditPopup.trigger("close");promise.resolve();return false},"click .js-cancel":function(){beforeEditPopup.trigger("close");return false},close:function(){if(!willContinue){promise.reject({name:"cancelled"})}}});beforeEditPopup.trigger("open",{})},onClickEdit:function(){var that=this;var photo=this.models.photo;var params=photo.params;if(this.editorIsActive){return}ns.events.trigger("ph-photo-saving");this.editorIsActive=true;var openTime=+new Date;this.metrikaCounter(["edit in aviary","show aviary"]);var canEditPromise=ph.controllers.photo.canEditImage(photo);var loadAviaryModulePromise=new no.Promise;var editorFullyLoaded=new no.Promise;canEditPromise.done(function(details){var origSize=details.model&&details.model.get(".hiresDimension");ph.loadModule("aviary").pipe(loadAviaryModulePromise).done(function(editor){var sizeInfo=ph.utils.getClosestSize(that.models.photo.getData(),ph.photoBox.getDimentions());var sizeName=(sizeInfo&&sizeInfo.sizeName||"xl").toLowerCase();var urlParams=no.extend({},params,{size:sizeName});var imageProxyUrl=ph.utils.generateUrl("editor-photo",urlParams);var imageProxyId="image-proxy-"+params["author-login"]+"-"+params["image-id"];var onClose=function(evt,actions){if(actions){that.saveImage(photo,actions)}else{ph.keyboard.enable()}editor.off("close",onClose);var time=Math.floor((+new Date-openTime)/1e3);that.metrikaCounter(["edit in aviary","time in aviary",ph.metrika.group(time,[0,5,15,60,180]),time])};ph.keyboard.disable();editor.on("close",onClose);editor.load(imageProxyId,imageProxyUrl,origSize).pipe(editorFullyLoaded)})});canEditPromise.fail(function(details){var context=details.context;ph.errors.showError(context,{messageId:"error_image-edit-unavailable",persistent:true,data:{photo:photo.getData()}})});no.Promise.wait([canEditPromise,loadAviaryModulePromise,editorFullyLoaded]).always(function(){ns.events.trigger("ph-photo-save-done");that.editorIsActive=false})},saveImage:function(photo,actions){var promise;ns.events.trigger("ph-photo-saving");promise=ph.controllers.photo.editImage(photo,actions,this.beforeEditAsk.bind(this),this.countSave.bind(this));promise.always(function(){ph.keyboard.enable();ns.events.trigger("ph-photo-save-done")});promise.done(function(){ns.events.trigger("ph-image-changed");ns.events.trigger("ph-slider-redraw")});promise.fail(function(details){var errorName=no.jpath(".error.name",details);if(errorName==="aborted"){return}var context=details.context;ph.errors.showError(context,{messageId:"error_image-edit-failed",persistent:true,data:{photo:photo.getData()}})})},countSave:function(userAnswer){var userAnswerValue="no warning";if(userAnswer===true){userAnswerValue="warning yes"}else if(userAnswer===false){userAnswerValue="warning no"}this.metrikaCounter(["edit in aviary","save changes",userAnswerValue])},countPropChange:function(name,isSet){var hash={porno:["uncheck 18+","check 18+"],"disable-comments":["forbid comments","allow comments"],"hide-orig":["hide orig","show orig"]};this.metrikaCounter(["change privacy",hash[name][isSet?1:0]])},countImageDelete:function(info){var contextInfo=ph.metrika.getContextInfo();var mParams=["delete image","from context",contextInfo.name];if(contextInfo.more){mParams.push(contextInfo.more)}if(info.yes){mParams=mParams.concat(["yes",ph.metrika.getImageFormat(this.getModel("photo"))])}else{mParams=mParams.concat(["no",info.cancelled?"button":info.x?"x":"other",ph.metrika.getImageFormat(this.getModel("photo"))])}this.metrikaCounter(mParams)},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"]),initChangeUrlHelpCounter:function(){var that=this;var countShowHelpTimer=null;var countShowHelp=function(){that.metrikaCounter(["change privacy","show change url help"]);countShowHelpTimer=null};this._nodes.$popupAccess.on("mouseenter",".js-invalidate-url-help",function(){countShowHelpTimer=setTimeout(countShowHelp,1e3)});this._nodes.$popupAccess.on("mouseleave",".js-invalidate-url-help",function(){if(!countShowHelpTimer){return}clearTimeout(countShowHelpTimer);countShowHelpTimer=null})}}});ns.View.define("photo-flags",{models:["photo"]});ns.View.define("send-to-contest",{params:{"author-login":null,"image-id":null,mode:null},models:["auth","photo","tags","photo-rights","photo-more","ticket"],events:{"ns-view-htmlinit":"onHtmlInit","ns-view-htmldestroy":"onHtmlDestroy"},methods:{onHtmlInit:function(){var that=this;this._nodes={$popupToggler:this.$node,sendToContest:$(".js-send-to-contest",this.node)[0],revokeFromContest:$(".js-revoke-from-contest",this.node)[0]};if(this._nodes.sendToContest){this.sendBlock=nb.block(this._nodes.sendToContest,{send:this.sendToContest.bind(this)},"send-to-contest");this.sendBlockPopup=nb.block(this._nodes.sendToContest,{open:this.setFields.bind(this),show:function(){that.metrikaCounter(["send to contest","show",ph.metrika.mode()])}},"islands-popup")}if(this._nodes.revokeFromContest){this.revokeBlock=nb.block(this._nodes.revokeFromContest,{revoke:this.revokeFromContest.bind(this)},"revoke-from-contest");this.revokeBlockPopup=nb.block(this._nodes.revokeFromContest,{show:function(){that.metrikaCounter(["revoke from contest","show",ph.metrika.mode()])}},"islands-popup")}},setFields:function(){this.sendBlock.setFields({title:this.models.photo.get(".title"),tags:this.models.tags.get(".tags.tag.name")})},sendToContest:function(evt,data){var that=this;var photoData=this.models.photo.getData();this.sendBlockPopup.trigger("close");var promise=ph.controllers.photo.sendToContest(this.models.photo,this.models.tags,data);promise.done(function(context){ph.actions.redraw(context)});promise.fail(function(details){var context=details.context;ph.errors.showError(context,{messageId:"error_send-to-contest",persistent:true,data:{photo:photoData},ok:function(){ph.actions.restorePage(context).queue(function(){return ph.actions.redraw(context)}).queue(function(){that._nodes.$popupToggler.trigger("click")})},cancel:function(){ph.actions.redraw(context)}})})},revokeFromContest:function(evt,contestId){var photoData=this.models.photo.getData();this.revokeBlockPopup.trigger("close");var promise=ph.controllers.photo.revokeFromContest(this.models.photo,contestId);promise.done(function(context){ph.actions.redraw(context)});promise.fail(function(details){var context=details.context;ph.actions.redraw(context);ph.errors.showError(context,{messageId:"error_revoke-from-contest",persistent:true,data:{photo:photoData},ok:function(){if(context.pageLeft){ph.actions.restorePage(context).queue(function(){ph.actions.redraw(context)})}}})})},onHtmlDestroy:function(){if(this.sendBlock){this.sendBlock.destroy()}if(this.sendBlockPopup){this.sendBlockPopup.destroy()}if(this.revokeBlock){this.revokeBlock.destroy()}if(this.revokeBlockPopup){this.revokeBlockPopup.destroy()}},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}});nb.define("send-to-contest",{events:{init:"onInit","click .js-send":"validateAndSend","click .js-contest-rules":"countViewContestRules","click .js-general-rules":"countViewGeneralRules"},onInit:function(){this._nodes={title:$(".js-title",this.node)[0],$title:$(".js-title",this.node),tags:$(".js-tags",this.node)[0],$tags:$(".js-tags",this.node)}},setFields:function(data){this._nodes.$title.val(data.title);this._nodes.$tags.val((data.tags||[]).join(", "))},validateAndSend:function(){var data={title:this._nodes.$title.val().trim(),tags:this._nodes.$tags.val().trim(),contestId:this.nbdata("contest-id")};if(data.title===""){this._showError("invalid_title_is_empty",this._nodes.title)}else if(data.tags===""){this._showError("invalid_tags_are_empty",this._nodes.tags)}else{this.trigger("send",data)}this.metrikaCounter(["send to contest","send"]);return false},_showError:function(errorId,node){ph.errors.showError(ph.actions.createContext(),{messageId:errorId,element:node,popup:{how:{dir:"right"}}})},countViewContestRules:function(){this.metrikaCounter(["send to contest","view contest rules"])},countViewGeneralRules:function(){this.metrikaCounter(["send to contest","view general rules"])},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])});nb.define("revoke-from-contest",{events:{"click .js-go-to-contest":"countGoToContest","click .js-revoke":"revoke"},revoke:function(){this.trigger("revoke",this.nbdata("contest-id"));this.metrikaCounter(["revoke from contest","revoke"]);return false},countGoToContest:ph.metrika.countLink(function(){this.metrikaCounter(["revoke from contest","go to contest page"])}),metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])});var cx=React.addons.classSet;var showError=function(context,errorId,node){ph.errors.showError(context,{messageId:errorId,element:node,popup:{how:{dir:"left"}}})};var getAvatarUrl=function(uid){return ph.utils.getAvatarUrl(uid)};var getSpecialKeyName=function(evt){if(evt.altKey){return"alt"}if(evt.ctrlKey){return"ctrl"}if(evt.shiftKey){return"shift"}if(evt.metaKey){return"meta"}return"UNKNOWN"};var CommentBase={getClassSet:function(){var comment=this.props.comment.getData();return cx({comment:true,"comment-with-back":true,comment_deleted:comment.deleted,comment_thread:this.props.isThreadStart,comment_sub:comment.level>0,"comment_from-moderator":!comment.deleted&&comment.immortal,"comment_commenter-deleted":!comment.deleted&&comment.commenter&&comment.commenter.deleted,"comment_commenter-banned":this.props.isCommenterBanned,"comment_is-current":this.props.isCurrent})},getFlags:function(){var comment=this.props.comment.getData();var details=this.props.details;var authorUid=details.authorUid;var currentUserUid=details.currentUserUid;var commenterUid=comment.commenter?comment.commenter.uid:-1;var isAuthor=currentUserUid==authorUid;return{canDelete:(currentUserUid==commenterUid||isAuthor)&&!comment.immortal,canBan:isAuthor&&comment.commenter&&commenterUid!=currentUserUid,isCommenter:currentUserUid==commenterUid,isAuthor:isAuthor}}};var Comment=React.createClass({displayName:"Comment",mixins:[CommentBase],componentDidMount:function(){this.collapseComment();if(this.props.isCurrent&&this.props.setReplyMode){this.handleReplyClick()}},componentWillUnmount:function(){$(this.refs.text.getDOMNode()).trigger("destroy")},collapseComment:function(){if(this.initialCollapseDone){return}this.initialCollapseDone=true;var that=this;var $commentBodyParentNode=$(this.refs.text.getDOMNode());var $commentBodyNode=$commentBodyParentNode.find(".js-comment-body");var $expander=$(".js-expand",$commentBodyParentNode).removeClass("is-hidden");$commentBodyNode.dotdotdot({ellipsis:" ...",wrap:"word",fallbackToLetter:true,height:100,after:$expander,callback:function(isTruncated){$expander=$(".js-expand",$commentBodyParentNode);if(!isTruncated){$expander.addClass("is-hidden")}else{$expander.on("click",function(){$commentBodyNode.trigger("destroy");$(this).addClass("is-hidden");that.props.onCommentExpand()})}}})},handleReplyClick:function(evt){this.props.onClickReply(this.props.comment,this.props.threadRefName);if(evt){this.props.metrikaCounter(["comments","reply","click on reply"])}},handleDeleteClick:function(){this.props.onClickDelete(this.props.comment);var flags=this.getFlags();this.props.metrikaCounter(["comments","delete",this.props.comment.get(".parentId")?"reply":"comment",flags.isCommenter?"by comment owner":flags.isAuthor?"by image owner":"UNKNOWN"])},getCommenterInfo:function(comment){var commenter=comment.get(".commenter");if(!commenter){return{name:""}}var commenterName=commenter.displayName||commenter.login||comment.get(".login")||"";var commenterUrl=null;if(commenter&&!commenter.deleted){commenterUrl=ph.utils.generateUrl("user-profile",{"author-login":commenter.login})}return{name:commenterName,url:commenterUrl}},handleCommenterNameClick:ph.metrika.countLink(function(){this.props.metrikaCounter(["go to commenter page","click on name"])}),handleCommenterImageClick:ph.metrika.countLink(function(){this.props.metrikaCounter(["go to commenter page","click on userpic"])}),render:function(){var comment=this.props.comment.getData();var commenterDeleted=no.jpath(".commenter.deleted",comment);var avatarUrl=getAvatarUrl(commenterDeleted?null:no.jpath(".commenter.uid",comment));var commenterInfo=this.getCommenterInfo(this.props.comment);var parentCommenerInfo=this.props.parentComment?this.getCommenterInfo(this.props.parentComment):null;var commentUrl=this.props.generateCommentUrl(comment.id);return React.DOM.div({className:this.getClassSet(),"data-comment-id":comment.id},commenterInfo.url?React.DOM.a({className:"userpic ns-action",href:commenterInfo.url,onClick:this.handleCommenterImageClick,"data-click-action":"metrika-count","data-dblclick-action":"metrika-count",style:{backgroundImage:"url("+avatarUrl+")"}}):React.DOM.div({className:"userpic",style:{backgroundImage:"url("+avatarUrl+")"}}),React.DOM.div({className:"comment__body"},this.getFlags().canDelete?React.DOM.div({className:"comment__delete",onClick:this.handleDeleteClick,title:"Удалить комментарий"}):null,React.DOM.div({className:"comment__author-container"},React.DOM.span({className:"comment__author"},commenterInfo.url?React.DOM.a({className:"unlike-link ns-action",href:commenterInfo.url,onClick:this.handleCommenterNameClick,"data-click-action":"metrika-count","data-dblclick-action":"metrika-count"},commenterInfo.name):commenterInfo.name),parentCommenerInfo?React.DOM.span({className:"comment__parent-author",dangerouslySetInnerHTML:{__html:"&nbsp;&rarr; "+ns.entityify(parentCommenerInfo.name)}}):null),React.DOM.div({className:"comment__text",ref:"text"},React.DOM.span({className:"js-comment-body",dangerouslySetInnerHTML:{__html:ph.utils.nl2br(ph.utils.escape(comment.content))}}),React.DOM.span({className:"js-expand is-hidden"}," ",React.DOM.span({className:"link",title:"Показать комментарий полностью"},"Ещё"))),React.DOM.div({className:"comment__footer"},React.DOM.a({className:"comment__date ns-action",href:commentUrl,"data-click-action":"fix-url","data-params":JSON.stringify({url:commentUrl})},ph.utils.formatDateRelative(comment.updateTime)),this.props.details.canComment?React.DOM.span({className:"comment__reply"},React.DOM.a({className:"link js-comment-reply",onClick:this.handleReplyClick},"Ответить")):null)))}});var CommentDeleted=React.createClass({displayName:"CommentDeleted",mixins:[CommentBase],handleBanClick:function(){this.props.comment.set(".commenter-ban-in-progress",true);this.forceUpdate();this.props.onClickBan(this.props.comment);this.props.metrikaCounter(["comments","block user"])},render:function(){var canBan=this.getFlags().canBan;var comment=this.props.comment.getData();var banInProgress=comment["commenter-ban-in-progress"];var commenterBanned=this.props.isCommenterBanned;var deletedRecently=comment["deleted-recently"];var showBanLink=canBan&&deletedRecently&&!banInProgress&&!commenterBanned;var showBanInProgress=banInProgress;var showBanned=commenterBanned;var deletedHeaderClasses=cx({"comment-deleted-header":true,"comment-deleted-header_extra":showBanLink||showBanInProgress||showBanned});return React.DOM.div({className:this.getClassSet(),"data-comment-id":comment.id},React.DOM.div({className:"comment__body"},React.DOM.div({className:"comment__text"},React.DOM.span({className:deletedHeaderClasses},"Комментарий удалён"),showBanLink?React.DOM.span({className:"comment__action unlike-link",onClick:this.handleBanClick},"Заблокировать автора"):null,showBanInProgress?React.DOM.span({className:"comment__action progress-button_progress"},"Заблокировать автора"):null,showBanned?React.DOM.span({className:"comment__action progress-button_done"},"Автор заблокирован"):null)))}});var CommentsThread=React.createClass({displayName:"CommentsThread",getDefaultProps:function(){return{showExpandedCount:2}},getInitialState:function(){return{collapsed:this.props.comments.length>this.props.showExpandedCount&&!this.props.expanded}},expandThread:function(){this.setState({collapsed:false},this.onThreadExpand)},onThreadExpand:function(){this.props.onThreadExpand(this.props.comments.length)},render:function(){var that=this;var threadRefName=this.props.threadRefName;var commentsTotal=this.props.comments.length;var details=this.props.details;var currentCommentId=this.props.currentCommentId;var renderCount=this.state.collapsed?this.props.showExpandedCount:commentsTotal;var isThread=commentsTotal>1;var collapsedCount=commentsTotal-this.props.showExpandedCount;var collapsed=this.state.collapsed&&commentsTotal>this.props.showExpandedCount;var isThreadStart;var comment;var commentId;var comments=[];var parentComment;var isCommenterBanned;for(var i=0;i<renderCount&&i<commentsTotal;i++){comment=this.props.comments[i];commentId=comment.get(".id");parentComment=this.props.commentsHash[comment.get(".parentId")];isCommenterBanned=this.props.banList[comment.get(".commenter.uid")];isThreadStart=isThread&&i===0;if(comment.get(".deleted")){comments.push(CommentDeleted({key:commentId,comment:comment,details:details,isThreadStart:isThreadStart,isCommenterBanned:isCommenterBanned,onClickBan:that.props.onClickBan,metrikaCounter:this.props.metrikaCounter}))}else{comments.push(Comment({key:commentId,comment:comment,details:details,threadRefName:threadRefName,isThreadStart:isThreadStart,isCommenterBanned:isCommenterBanned,currentCommentId:currentCommentId,isCurrent:commentId==currentCommentId,setReplyMode:this.props.setReplyMode,parentComment:parentComment,onClickReply:that.props.onClickReply,onClickDelete:that.props.onClickDelete,onCommentExpand:that.props.onCommentExpand,generateCommentUrl:this.props.generateCommentUrl,metrikaCounter:this.props.metrikaCounter}))}}var threadClasses=cx({"comments-thread":true,"comments-thread_with-indention":this.props.indent});return React.DOM.div({className:threadClasses},comments,collapsed?React.DOM.div({className:"comment comment-with-back comment_sub"},React.DOM.div({className:"comment__body"},React.DOM.div({className:"comment__text link",onClick:this.expandThread},"Показать ещё ",ph.utils.plural(collapsedCount,"","$0 ответ","$0 ответа","$0 ответов")))):null)}});var Captcha=React.createClass({displayName:"Captcha",getResponse:function(){return(this.refs.reply.getDOMNode().value||"").trim()},setFocus:function(){$(this.refs.reply.getDOMNode()).focus()},clearInput:function(){$(this.refs.reply.getDOMNode()).val("")},showError:function(context,errorId){showError(context,errorId,this.refs.reply.getDOMNode())},handleCaptchaImageClick:function(){this.props.reloadCaptcha();this.props.metrikaCounter(["comments","captcha","reload by click"])},handleMouseDown:function(){this.props.metrikaCounter(["comments","captcha","focus by click"])},render:function(){return React.DOM.div({className:"comment__body comment__body_editor"},React.DOM.div({className:"captcha-row captcha-row_pic"},React.DOM.img({className:"captcha-image",src:this.props.data.imageurl,alt:"Картинка с цифрами",title:"Показать другую картинку",onClick:this.handleCaptchaImageClick})),React.DOM.div({className:"captcha-row captcha-row_field"},React.DOM.input({className:"small-input",type:"text",placeholder:"Введите цифры",ref:"reply",onKeyDown:this.props.handleCaptchaResponseKeyDown,onMouseDown:this.handleMouseDown,maxLength:"20"})))}});var Note=React.createClass({displayName:"Note",render:function(){return React.DOM.div({className:"comment comments_message"},this.props.message)}});var StickyPanel=React.createClass({displayName:"StickyPanel",getInitialState:function(){return{stickyAds:null,stickyEditor:false,editorMinHeight:0}},componentDidMount:function(){this.updateHeight()},componentDidUpdate:function(){this.updateHeight()},updateHeight:function(){var innerHeight=$(this.refs.inner.getDOMNode()).outerHeight();if(this.state.editorMinHeight!=innerHeight){this.setState({editorMinHeight:innerHeight},this.stickEditor)}},stickEditor:function(stickyAds){var adsOffset=this.getAdsOffset(stickyAds);var $placeholder=$(this.refs.placeholder.getDOMNode());var top=$placeholder.offset().top;var height=$placeholder.outerHeight();var editorPlaceholderBottom=top+height+adsOffset;var viewportHeight=this.getViewportHeight();var stickyEditor=editorPlaceholderBottom-viewportHeight>=1;if(this.state.stickyEditor!==stickyEditor){this.setState({stickyEditor:stickyEditor})
}},getAdsOffset:function(stickyAds){var adsOffsetConst=150;if(typeof stickyAds==="undefined"){if(this.state.stickyAds==null){stickyAds=true}else{stickyAds=this.state.stickyAds}}return stickyAds?adsOffsetConst:0},toggleStickyAds:function(stickyAds){if(this.state.stickyAds!==stickyAds){this.setState({stickyAds:stickyAds});this.stickEditor(stickyAds)}},isAdsHiddenForView:function(){return this.state.stickyAds===false},getEditorHeight:function(){return this.state.editorMinHeight},getViewportHeight:function(){var $viewport=$(this.getDOMNode()).closest(".js-panel");return $viewport.height()},render:function(){var classes=cx({"comment-editor-placeholder":true,"with-ads":this.state.stickyAds,fixed:this.state.stickyEditor,"with-message":this.props.withMessage});return React.DOM.div({className:classes,ref:"placeholder",style:{minHeight:this.state.editorMinHeight}},React.DOM.div({className:"comment-editor-wrapper"},React.DOM.div({className:"comment-editor-cover",ref:"inner"},this.props.children)))}});var ReplyForm=React.createClass({displayName:"ReplyForm",getInitialState:function(){return{message:"",disabled:false}},setReplyComment:function(comment,threadRefName){this.setState({commentToReply:comment,commentToReplyThreadRefName:threadRefName});setTimeout(function(){this.setFocus()}.bind(this),1)},handleChange:function(evt){this.setState({message:evt.target.value})},showCaptcha:function(captchaData,callback){callback=callback||function(){};this.setState({captcha:captchaData},callback);this.clearCaptchaReplyInput();this.props.metrikaCounter(["comments","captcha","show"])},handleCommentKeyDown:function(evt){var info=this.getKeyboardInfo(evt);if(info.isEnter&&!info.isSpecialPressed){evt.preventDefault();this.onReply("keyboard")}else if(info.isEnter){this.props.metrikaCounter(["comments",this.state.commentToReply?"reply":"new comment","add new line",getSpecialKeyName(evt)+" + enter"])}},handleCaptchaResponseKeyDown:function(evt){var info=this.getKeyboardInfo(evt);if(info.isEnter){evt.preventDefault();this.onReply();this.props.metrikaCounter(["comments","captcha","enter"])}},getKeyboardInfo:function(evt){return{isEnter:evt.which===13,isSpecialPressed:evt.altKey||evt.ctrlKey||evt.metaKey||evt.shiftKey}},handleReplyButtonClick:function(evt){evt.stopPropagation();this.onReply("button")},isCommentEmpty:function(){return!this.state.message.trim()},onReply:function(via){if(this.isCommentEmpty()){return}var data={commentBody:this.state.message.trim()};if(this.state.captcha){data.captchaInfo={key:this.state.captcha.token,reply:this.refs.captcha.getResponse()};if(!data.captchaInfo.reply){this.setFocusOnCaptcha();return}}this.setState({disabled:true});if(via){this.props.metrikaCounter(["comments",this.state.commentToReply?"reply":"new comment",this.state.commentToReply?"post reply":"post comment",via])}this.props.onReply(data,this.state.commentToReply)},cancelReply:function(){this.props.onCancelReply();this.setState({commentToReply:null,commentToReplyThreadRefName:null});this.props.metrikaCounter(["comments","reply","cancel reply via x"])},enable:function(){this.setState({disabled:false})},reset:function(){var newState={captcha:null,disabled:false,message:"",commentToReply:null,commentToReplyThreadRefName:null};this.setState(newState,this.resetInputHeight.bind(this))},resetInputHeight:function(){var block=nb.block(this.refs.input.getDOMNode(),null,"textarea-autoheight");if(block){block.updateHeight()}},setFocus:function(){if(this.refs.input){this.refs.input.getDOMNode().focus()}},setFocusOnCaptcha:function(){if(this.refs.captcha){this.refs.captcha.clearInput();this.refs.captcha.setFocus()}},clearCaptchaReplyInput:function(){if(this.refs.captcha){this.refs.captcha.clearInput()}},showError:function(context,errorId,elementName){var ref=this.refs[elementName];ns.assert(ref,"comments",'Unknown element "%s"',elementName);if(elementName==="captcha"){if(this.refs.captcha){this.refs.captcha.showError(context,errorId)}}else{showError(context,errorId,ref.getDOMNode())}},handleMouseDown:function(){this.props.metrikaCounter(["comments",this.state.commentToReply?"reply":"new comment","focus by click"])},render:function(){var replyToName=null;if(this.state.commentToReply){replyToName=this.state.commentToReply.get(".commenter.displayName || .commenter.login || .login")||""}var enableAddButton=!this.state.disabled&&!this.isCommentEmpty();var editorClasses=cx({"editor-body":true,"editor_reply-mode":!!replyToName});var addButtonClasses=cx({"comment_add-button":true,"comment_add-button_enabled":enableAddButton});return React.DOM.div({className:"comment comment_editor"},React.DOM.div({className:"userpic",style:{backgroundImage:"url("+getAvatarUrl(this.props.details.currentUserUid)+")"}}),React.DOM.label({className:editorClasses},replyToName?React.DOM.div({className:"comment-reply-name"},React.DOM.span(null,"Кому: "+replyToName+" "),React.DOM.span({className:"comment-reply-name-remove",onClick:this.cancelReply})):null,React.DOM.label({className:"small-field comment-text",ref:"inputContainer"},React.DOM.span({className:"field-content"},React.DOM.textarea({className:"input-controller",ref:"input",placeholder:"Оставьте комментарий","data-nb":"textarea-autoheight",rows:"1",value:this.state.message,onFocus:this.props.onReplyInputFocus,onKeyDown:this.handleCommentKeyDown,onKeyUp:this.props.handleHeightChange,onChange:this.handleChange,onMouseDown:this.handleMouseDown,disabled:this.state.disabled}),React.DOM.span({className:"input-view",dangerouslySetInnerHTML:{__html:"&nbsp;"}})),React.DOM.div({className:addButtonClasses,title:"Добавить комментарий",onClick:enableAddButton?this.handleReplyButtonClick:null},React.DOM.span({className:"comment_add-icon"})))),this.state.captcha?Captcha({data:this.state.captcha,ref:"captcha",reloadCaptcha:this.props.reloadCaptcha,handleCaptchaResponseKeyDown:this.handleCaptchaResponseKeyDown,metrikaCounter:this.props.metrikaCounter}):null)}});var LoadMoreBase={renderExpander:function(label){return React.DOM.div({className:"comment comment_expander"},React.DOM.div({className:"comment__left"},this.props.showProgress?React.DOM.span({className:"progress-button_progress"},"Загрузка комментариев"):React.DOM.span({className:"unlike-link",onClick:this.props.onClick},label)),React.DOM.div({className:"comment__right comment_expander_count"},this.props.count+" из "+this.props.total))}};var LoadPrevComments=React.createClass({displayName:"LoadPrevComments",mixins:[LoadMoreBase],render:function(){return this.renderExpander("Показать предыдущие")}});var LoadNextComments=React.createClass({displayName:"LoadNextComments",mixins:[LoadMoreBase],render:function(){return this.renderExpander("Показать следующие")}});var Comments=React.createClass({displayName:"Comments",getInitialState:function(){return{nextCount:this.props.initialState.nextCount,prevCount:this.props.initialState.prevCount,currentCommentId:this.props.initialState.currentCommentId,loadingNext:false,loadingPrev:false}},componentDidMount:function(){if(this.state.currentCommentId){this.scrollToComment(this.state.currentCommentId)}},componentDidUpdate:function(){this._restoreScrollPosition();this.stickEditor()},hasNextCommentsCollapsed:function(){return this.state.nextCount>0},stickEditor:function(){if(this.refs.panel){this.refs.panel.stickEditor()}},toggleStickyAds:function(toggle){if(this.refs.panel){this.refs.panel.toggleStickyAds(toggle)}},isAdsHiddenForView:function(){if(this.refs.panel){return this.refs.panel.isAdsHiddenForView()}return false},updateEditorHeight:function(){if(this.refs.panel){this.refs.panel.updateHeight()}},onClickReply:function(comment,threadRefName){if(!this.refs.replyForm){return}this.refs.replyForm.setReplyComment(comment,threadRefName);this.setState({currentCommentId:comment.get(".id")})},onCancelReply:function(){this.setState({currentCommentId:null})},resetReplyForm:function(){if(this.refs.replyForm){this.refs.replyForm.reset()}this.setState({currentCommentId:null})},enableReplyForm:function(){if(this.refs.replyForm){this.refs.replyForm.enable()}},onClickDelete:function(comment){this.props.onDelete(comment)},onClickBan:function(comment){this.props.onBan(comment)},onThreadExpand:function(commentsCount){this.stickEditor();this.props.metrikaCounter(["comments","expand thread",ph.metrika.group(commentsCount,[1,2,3,4,5,10,20]),commentsCount])},onCommentExpand:function(){this.stickEditor();this.props.metrikaCounter(["comments","expand comment"])},getThreads:function(){var comments=this.props.comments.models;var comment;var commentId;var commenterUid;var isRootComment;var isLastComment;var isCommenterBanned;var threads=[];var currentCommentId=this.state.currentCommentId;var banList={};var thread={id:null,isFirst:true,isLast:false,expanded:false,comments:[],commentsHash:{}};var prevThread=null;for(var i=0;i<comments.length;i++){comment=comments[i];commentId=comment.get(".id");isRootComment=!comment.get(".parentId");isLastComment=i===comments.length-1;commenterUid=comment.get(".commenter.uid");isCommenterBanned=comment.get(".commenterBanned");if(isCommenterBanned&&commenterUid){banList[commenterUid]=true}if(isRootComment){if(thread.comments.length){threads.push(this.createThread(thread,prevThread,banList));prevThread=thread;thread={}}thread.id=commentId;thread.comments=[comment];thread.commentsHash={};thread.commentsHash[commentId]=comment;if(thread.id==currentCommentId){thread.expanded=true}}else{thread.comments.push(comment);thread.commentsHash[commentId]=comment;if(commentId==currentCommentId){thread.expanded=true}}if(isLastComment&&thread.comments.length){thread.isLast=true;threads.push(this.createThread(thread,prevThread,banList))}}return threads},createThread:function(thread,prevThread,banList){var refName;if(thread.isFirst){refName="firstThread"}else if(thread.isLast){refName="lastThread"}else{refName="thread."+thread.id}var indent=prevThread&&prevThread.comments.length>1&&thread.comments.length>1;return CommentsThread({ref:refName,key:thread.id,threadId:thread.id,threadRefName:refName,comments:thread.comments,commentsHash:thread.commentsHash,banList:banList,details:this.props.details,currentCommentId:this.state.currentCommentId,setReplyMode:this.props.initialState.setReplyMode,expanded:thread.expanded,lastThread:thread.isLast,indent:indent,onClickReply:this.onClickReply,onClickDelete:this.onClickDelete,onClickBan:this.onClickBan,onThreadExpand:this.onThreadExpand,onCommentExpand:this.onCommentExpand,generateCommentUrl:this.props.generateCommentUrl,metrikaCounter:this.props.metrikaCounter})},scrollToComment:function(commentId,callback){var $viewport=$(this.getDOMNode()).closest(".js-panel");var $commentBox=$('[data-comment-id="'+commentId+'"]',this.getDOMNode());if(!$commentBox.length){return}var adsOffset=0;var editorHeight=0;var viewportHeight=0;if(this.refs.panel){adsOffset=this.refs.panel.getAdsOffset();editorHeight=this.refs.panel.getEditorHeight();viewportHeight=this.refs.panel.getViewportHeight()}var commentBottom=$commentBox.offset().top+$commentBox.outerHeight()+adsOffset;var viewportScrollTop=$viewport.scrollTop();var newScrollTop=viewportScrollTop+commentBottom+editorHeight-viewportHeight;$viewport.animate({scrollTop:newScrollTop},300,callback||function(){})},showCaptcha:function(captchaData,callback){if(this.refs.replyForm){this.refs.replyForm.showCaptcha(captchaData,callback)}},setFocusOnReply:function(){if(this.refs.replyForm){this.refs.replyForm.setFocus()}},showCaptchaError:function(context,errorId){if(this.refs.replyForm){this.refs.replyForm.showError(context,errorId,"captcha");this.refs.replyForm.setFocusOnCaptcha()}},showCommentError:function(context,errorId){if(this.refs.replyForm){this.refs.replyForm.showError(context,errorId,"inputContainer")}},handleResize:function(){if(this.refs.panel){this.refs.panel.updateHeight()}},setCounts:function(counts){var stateDelta={};if(counts.next<this.state.nextCount){stateDelta.nextCount=counts.next}if(counts.prev<this.state.prevCount){stateDelta.prevCount=counts.prev}if(counts.wasNextLoaded){stateDelta.loadingNext=false}else{stateDelta.loadingPrev=false}this._saveScrollPosition();this.setState(stateDelta)},commentAddedUpdate:function(){var replyForm=this.refs.replyForm;var commentToReplyThread;if(replyForm){if(replyForm.state.commentToReply&&replyForm.state.commentToReplyThreadRefName){commentToReplyThread=this.refs[replyForm.state.commentToReplyThreadRefName];if(commentToReplyThread){commentToReplyThread.setState({collapsed:false})}}}this._saveScrollPosition();this.forceUpdate()},commentsAreHidden:function(){return this.props.details.hideComments},_saveScrollPosition:function(){var firstThread=this.refs.firstThread;if(!firstThread){return}var viewportNode=$(this.getDOMNode()).closest(".js-panel")[0];var firstThreadNode=firstThread.getDOMNode();this.keepScrollThreadId=firstThread.props.threadId;this.keepScrollThreadTop=firstThreadNode.offsetTop-viewportNode.scrollTop},_restoreScrollPosition:function(){var threadId=this.keepScrollThreadId;var threadTop=this.keepScrollThreadTop;this.keepScrollThreadId=null;this.keepScrollThreadTop=null;if(!threadId){return}var thread=this.refs["thread."+threadId];if(!thread){return}var viewportNode=$(this.getDOMNode()).closest(".js-panel")[0];var threadNode=thread.getDOMNode();viewportNode.scrollTop=threadNode.offsetTop-threadTop},loadMore:function(dir){return function(){var loadNext=dir<0;if(loadNext){this.props.loadMore(this.refs.firstThread.props.threadId,-this.props.loadMoreCount);this.setState({loadingNext:true})}else{this.props.loadMore(this.refs.lastThread.props.threadId,this.props.loadMoreCount);this.setState({loadingPrev:true})}this.props.metrikaCounter(["comments",loadNext?"show next comments":"show previous comments"])}.bind(this)},handleHeightChange:function(){if(this.refs.panel){this.refs.panel.updateHeight()}},render:function(){var details=this.props.details;var showMessage=!details.canComment||details.hideComments;var panelContent;var loadedCount;var total;var threads;var commentsClasses;var allCommentsAreLoaded=false;if(showMessage){panelContent=Note({message:details.hideComments?"Комментарии скрыты":this.props.details.commentsDisabledMessage})}else{panelContent=ReplyForm({details:details,ref:"replyForm",onReplyInputFocus:this.props.onReplyInputFocus,onReply:this.props.onReply,onCancelReply:this.onCancelReply,reloadCaptcha:this.props.reloadCaptcha,handleHeightChange:this.handleHeightChange,metrikaCounter:this.props.metrikaCounter})}if(details.hideComments){return React.DOM.div(null,StickyPanel({withMessage:showMessage,ref:"panel"},panelContent))}else{loadedCount=this.props.comments.models.length;total=+this.props.comments.get(".totalWithChildren");allCommentsAreLoaded=loadedCount>=total;threads=this.getThreads();commentsClasses=cx({"comments-container":true,comments_empty:threads.length===0});return React.DOM.div({className:commentsClasses},this.state.nextCount>0&&!allCommentsAreLoaded?LoadNextComments({count:loadedCount,total:total,onClick:this.loadMore(-1),showProgress:this.state.loadingNext}):null,this.getThreads(),this.state.prevCount>0&&!allCommentsAreLoaded?LoadPrevComments({count:loadedCount,total:total,onClick:this.loadMore(+1),showProgress:this.state.loadingPrev}):null,StickyPanel({withMessage:showMessage,ref:"panel"},panelContent))}}});ph.R.Comments=Comments;(function(){ns.View.define("comments",{params:function(params){var _params=ph.utils.pick(params,["author-login","image-id"]);if(ph.params.hiddenParams["comment-id"]){_params["comment-id"]=ph.params.hiddenParams["comment-id"]}return _params},models:["auth","preferences","photo","photo-rights","comments","photo-ads-state"],subviews:{"ads-enabled":'preferences .preferences.preference.[.name == "hide-ads"]',"photo-like-ignore-1":"photo .likeCount","photo-like-ignore-2":"photo-rights .options.like"},events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"onShow","ns-view-hide":"onHide","ns-view-htmldestroy":"onHtmlDestroy",click:"onClick","ph-i-am-gt18":"invalidate","ph-panel-scroll@show":"onPanelScroll","ph-resize@show":"onResize","ph-page-change@show":"onPageChange"},methods:{onHtmlInit:function(){this.isAdsDisabledByUser=this.models.preferences.isSet("hide-ads");ns.events.trigger("ph-comments-ready")},onShow:function(){var that=this;this._ensureCommentsComponent(function(){var isAdsHiddenForView;if(that.isAdsDisabledByUser){isAdsHiddenForView=true;that.commentsComponent.toggleStickyAds(false)}else{isAdsHiddenForView=that.commentsComponent.isAdsHiddenForView();if(!that.isAdsDisabledByUser&&!isAdsHiddenForView){var adsDisabledNow=that.models["photo-ads-state"].get(".disabled");that.commentsComponent.toggleStickyAds(!adsDisabledNow)}}that.bindAdsStateChange();ns.events.trigger("ph-comments-turned",isAdsHiddenForView);that.countOnShow()})},onHide:function(){this.unbindAdsStateChange()},onHtmlDestroy:function(){this._destroyCommentsComponent()},onPanelScroll:function(){if(this.commentsComponent){this.commentsComponent.stickEditor();this.commentsComponent.toggleStickyAds(false)}ns.events.trigger("ph-comments-interact");this._movePopups()},onResize:function(){if(this.commentsComponent){this.commentsComponent.handleResize()}},bindAdsStateChange:function(){if(!this.commentsComponent){return}var that=this;var state=this.models["photo-ads-state"];this._onAdsStateChanged=function(){that.commentsComponent.toggleStickyAds(!state.get(".disabled"))};state.on("ns-model-changed.disabled",this._onAdsStateChanged)},unbindAdsStateChange:function(){var state=this.models["photo-ads-state"];state.off("ns-model-changed.disabled",this._onAdsStateChanged)},onClick:function(){if(this.commentsComponent){this.commentsComponent.toggleStickyAds(false)}ns.events.trigger("ph-comments-interact")},onReplyInputFocus:function(){var that=this;if(ph.noAuthRedirect(this.models.auth)){return}var promise=ph.controllers.user.getPreferences();promise.done(function(context){var caughtInSpam=context.model.isSet("caught-in-spam");if(caughtInSpam&&!that.captchaVisible){that.showCaptcha()}})},showCaptcha:function(callback){var that=this;callback=callback||function(){};ph.controllers.comments.getCaptcha().done(function(context){that.captchaVisible=true;that.commentsComponent.showCaptcha(context.model.getData(),function(){that._movePopups();callback()})})},hideCaptcha:function(){this.captchaVisible=false},deleteComment:function(commentToDelete){var that=this;var promise=ph.controllers.comments.removeComment(commentToDelete);promise.done(function(){that.commentsComponent.forceUpdate();that.commentsComponent.stickEditor()});promise.fail(function(details){ph.errors.showError(details.context,{messageId:"error_could-not-remove-comment",persistent:true})})},banCommentAuthor:function(comment){var that=this;var promise=ph.controllers.comments.banCommentAuthor(comment);promise.done(function(){that.commentsComponent.forceUpdate()});promise.fail(function(details){that.commentsComponent.forceUpdate();ph.errors.showError(details.context,{messageId:"error_user-ban-failed",persistent:true})})},loadMore:function(fromCommentId,count){var that=this;var promise=ph.controllers.comments.loadComments(fromCommentId,count);promise.done(function(context){var loadedComments=context.model.models;var wasNextLoaded=count<0;if(wasNextLoaded){that.models.comments.insert(loadedComments,0)}else{that.models.comments.insert(loadedComments)}that.commentsComponent.setCounts({next:context.model.get(".totalWithChildrenBefore"),prev:context.model.get(".totalWithChildrenAfter"),wasNextLoaded:wasNextLoaded})})},reply:function(data,parentComment){var that=this;var commentBody=data.commentBody;var captchaInfo=data.captchaInfo;var preferences=ns.Model.get("preferences");var promise=ph.controllers.comments.addComment(commentBody,captchaInfo,parentComment,preferences);promise.done(function(context){var comment=context.model;var commentId=comment.get(".id");if(that.captchaVisible){that.hideCaptcha()}if(that.commentsComponent.hasNextCommentsCollapsed()){var addedCommentUrl=that.generateCommentUrl(commentId);ns.page.go(addedCommentUrl);return}that._insertComment(comment,parentComment);that.commentsComponent.commentAddedUpdate();that.commentsComponent.resetReplyForm();that.commentsComponent.setFocusOnReply()});promise.fail(function(details){var context=details.context;var errorName=no.jpath(".error.name",context)||"";if(errorName==="spam"){that.showCaptcha()}else if(errorName==="captcha-check-failed"){that.showCaptcha(function(){that.commentsComponent.showCaptchaError(context,"error_captcha-invalid");that.metrikaCounter(["comments","captcha","wrong captcha"])})}else{that.hideCaptcha();that.commentsComponent.showCommentError(context,"error_could-not-add-comment")}that.commentsComponent.enableReplyForm()})},generateCommentUrl:function(commentId){return ph.utils.generateUrl(ns.page.current.page,no.extend({},ns.page.current.params,{"comment-id":commentId}))},_insertComment:function(comment,parentComment){var index;var commentsModel=this.models.comments;var comments=commentsModel.models;var commentModel;if(parentComment){index=ph.utils.getIndexOfLastChild(comments,parentComment.get(".id"))+1}else{index=0;for(var i=0;i<comments.length;i++){commentModel=comments[i];if(commentModel.get(".immortal")){index=i+1}else if(!commentModel.get(".parentId")){break}}}commentsModel.insert(comment,index);commentsModel.set(".totalWithChildren",+commentsModel.get(".totalWithChildren")+1,{silent:true})},_ensureCommentsComponent:function(callback){var that=this;if(this.commentsComponent){callback();return}var commentsModel=this.models["comments"];var currentUserUid=this.models["auth"].get(".uid.value");var authorUid=this.models["photo"].get(".author.uid");var flags=this.models["photo-rights"].get(".canComment.userSpecific")||{};var photoIs18Plus=this.models["photo"].get(".flags.porno")==1;var photoIsBlocked=this.models["photo"].get(".flags.blocked")||no.jpath(".name",this.models["photo"].getError())=="image is blocked";var photoIsPassworded=this.models["photo"].get(".askAlbumPassword");var photoIsPrivate=no.jpath(".name",this.models["photo"].getError())=="access denied";var needConfirmation18Plus=photoIs18Plus&&currentUserUid!=authorUid&&!ph.allow18plus(currentUserUid);var disableComments=flags.userBanned||flags.imageCommentsDisabled||flags.commentsDisabledForUser||photoIsBlocked;var hideComments=disableComments||needConfirmation18Plus||photoIsPassworded||photoIsPrivate;var details={currentUserUid:currentUserUid,authorUid:authorUid,hideComments:hideComments,canComment:!disableComments,commentsDisabledMessage:this._getCommentsDisabledMessage(flags)};var initialState={nextCount:commentsModel.get(".totalWithChildrenBefore"),prevCount:commentsModel.get(".totalWithChildrenAfter"),currentCommentId:ph.params.hiddenParams["comment-id"],setReplyMode:+ph.params.hiddenParams["comment-reply"]};React.renderComponent(ph.R.Comments({comments:commentsModel,details:details,initialState:initialState,loadMoreCount:25,loadMore:this.loadMore.bind(this),onReplyInputFocus:this.onReplyInputFocus.bind(this),onReply:this.reply.bind(this),onDelete:this.deleteComment.bind(this),onBan:this.banCommentAuthor.bind(this),reloadCaptcha:this.showCaptcha.bind(this),generateCommentUrl:this.generateCommentUrl.bind(this),metrikaCounter:this.metrikaCounter.bind(this)}),this.$node.find(".js-comments")[0],function(){that.commentsComponent=this;callback()})},_destroyCommentsComponent:function(){if(!this.commentsComponent){return}this.unbindAdsStateChange();React.unmountComponentAtNode(this.node);this.commentsComponent=null},_getCommentsDisabledMessage:function(flags){if(flags.commentsDisabledForUser){return"Автор запретил комментировать фотографии"}if(flags.imageCommentsDisabled){return"Автор запретил комментировать фотографию"}if(flags.userBanned){return"Вы заблокированы автором фотографии"}return"Комментирование временно не доступно"},_movePopups:ph.utils.lazyCallback(100,function(){nb.trigger("ph-resize");ns.events.trigger("ph-resize")}),onPageChange:function(){this.counted=false},countOnShow:function(){if(this.counted){return}if(this.commentsComponent.commentsAreHidden()){this.metrikaCounter(["comments","show total on load","hidden"])}else{var count=(this.models.comments.get(".comments.comment")||[]).length;this.metrikaCounter(["comments","show total on load",ph.metrika.group(count,[0,1,5,10,20,50,100,300,500,1e3]),count])}this.counted=true},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}})})();(function(){ns.View.define("ads",{events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"onShow","ph-resize@show":"initTenacity","ph-panel-scroll@show":"stickBanner","ph-comments-ready@show":"initTenacity","ph-comments-turned@show":"onCommentsTurn","ph-comments-interact@show":"onCommentsInteract","ph-photo-go@show":"countTurn"},params:{},models:["preferences","photo-ads-state"],subviews:{"ads-enabled":'preferences .preferences.preference.[.name == "hide-ads"]'},methods:{onHtmlInit:function(){this.adOffset=0;this._nodes={$viewport:this.$node.closest(".js-panel"),$banner:this.$node.find(".js-banner"),$bannerWrapper:this.$node.find(".js-banner-wrapper"),$bannerPlaceholder:this.$node.find(".js-banner-placeholder")};this.isAdsDisabledByUser=this.models.preferences.isSet("hide-ads");this.pagingCount=0;this.pagingCountLimit=3;this.secondsTimestamp=0;this.secondsDiffLimit=30},onShow:function(){if(!this.isAdsDisabledByUser){this.showAds();this.renderAds();this.secondsTimestamp=Date.now()/1e3}},countTurn:function(){this.pagingCount++},onCommentsTurn:function(event,isAdsHidden){if(this.isAdsDisabledByUser){return}var secondsNow=Date.now()/1e3;var secondsDiff=secondsNow-this.secondsTimestamp;var that=this;if(this.pagingCount>=this.pagingCountLimit&&secondsDiff>this.secondsDiffLimit){this.renderAds();this.pagingCount=0;this.secondsTimestamp=secondsNow}else if(isAdsHidden){this.hideAds()}else{this.showAds()}setTimeout(function(){that.stickBanner()},0)},onCommentsInteract:function(){this.hideAds();this.stickBanner()},renderAds:function(){var that=this;if(this.models["photo-ads-state"].get(".disabled")){this._enableAds()}this.showAds();ph.loadModule("ads").done(function(){Ya.Context.AdvManager.render({blockId:"R-94178-6",renderTo:"yandex_ad_R-94178-6",async:true},function(){that._disableAds()})})},_disableAds:function(){this._nodes.$bannerPlaceholder.addClass("is-hidden");this.initTenacity();this.models["photo-ads-state"].set(".disabled",true)},_enableAds:function(){this._nodes.$bannerPlaceholder.removeClass("is-hidden");this.initTenacity();this.models["photo-ads-state"].set(".disabled",false)},showAds:function(){this.adOffset=150;this._nodes.$bannerPlaceholder.addClass("with-ads")},hideAds:function(){this.adOffset=0;this._nodes.$bannerPlaceholder.removeClass("with-ads")},initTenacity:function(){if(this.isAdsDisabledByUser){return}this.updateBannerHeight();this.stickBanner()},updateBannerHeight:function(){this.viewportHeight=this._nodes.$viewport.height();this.bannerHeight=this._nodes.$banner.outerHeight();this._nodes.$bannerPlaceholder.css("min-height",this.bannerHeight);this.bannerPlaceholderHeight=this._nodes.$bannerPlaceholder.outerHeight()},stickBanner:function(){if(this.isAdsDisabledByUser){return}var bannerPlaceholderBottom=this._nodes.$bannerPlaceholder.offset().top+this.bannerPlaceholderHeight-(this.bannerPlaceholderHeight-this.adOffset);var toggle=bannerPlaceholderBottom>this.viewportHeight?true:false;this._nodes.$bannerPlaceholder.toggleClass("fixed",toggle)}}})})();ns.View.define("fotki-old",{params:ph.params.sliderParams,events:{"ns-view-htmlinit":function(){var m=ns.Model.getValid("fotki-old");if(!m){var url=document.referrer||null;if(!ph.utils.isReferrerUsableForContext(url)){url=ph.utils.getOldFotkiContextUrl(ns.page.current.params)}ns.Model.get("fotki-old").setData({url:url})}}}});ph.controllers={};ph.controllers.isOk=function(model){return no.jpath(".result",model.getData())==="ok"};(function(){var isOk=ph.controllers.isOk;ph.controllers.photo={saveTitle:function(newTitle,photo){var promise=new no.Promise;var params=ns.page.current.params;var oldTitle=photo.getData().title;photo.set(".title",this.escapeUserInput(newTitle));ph.actions.do("do-photo-title-edit",{"author-login":params["author-login"],"image-id":params["image-id"],title:newTitle},{check:isOk,done:function(context){promise.resolve(context)},fail:function(context){photo.set(".title",oldTitle);promise.reject({newTitle:newTitle,oldTitle:oldTitle,context:context})}});return promise},saveDescription:function(newDescription,photoMore){var promise=new no.Promise;var params=ns.page.current.params;var oldDescription=photoMore.getData().description;photoMore.set(".description",this.escapeUserInput(newDescription));ph.actions.do("do-photo-description-edit",{"author-login":params["author-login"],"image-id":params["image-id"],description:newDescription},{check:isOk,done:function(model){promise.resolve(model)},fail:function(context){photoMore.set(".description",oldDescription);promise.reject({newDescription:newDescription,oldDescription:oldDescription,context:context})}});return promise},toggleLike:function(photo,photoRights){var photoData=photo.getData();var photoRightsData=photoRights.getData();if(!photoRightsData.actions.canLike){return null}var promise=new no.Promise;var params=ns.page.current.params;var oldData={count:photoData.likeCount,like:!!photoRightsData.options.like};var newData={count:oldData.count+(oldData.like?-1:1),like:!oldData.like};photo.set(".likeCount",newData.count);photoRights.set(".options.like",newData.like);photoRights.set(".options.likeAnimate",newData.like);ph.actions.do("do-like-set",{"author-login":params["author-login"],"image-id":params["image-id"],operation:newData.like?"SET":"UNSET"},{check:isOk,done:function(){promise.resolve()},fail:function(context){photo.set(".likeCount",oldData.count);photoRights.set(".options.like",oldData.like);promise.reject({newData:newData,oldData:oldData,context:context})}});return promise},acceptAgreement:function(){var auth=ns.Model.get("auth");var promise=new no.Promise;if(!auth.hasProfile()){var ticket=ns.Model.get("ticket").getData();ph.actions.do("do-agreement-accept",{ticket:ticket},{check:isOk,done:function(context){auth.invalidate();promise.resolve({context:context})},fail:function(context){promise.reject({context:context})}})}else{promise.resolve()}return promise},toggleFavorite:function(photoRights){var photoRightsData=photoRights.getData();if(!photoRightsData.actions.canFavorite){return null}var promise=new no.Promise;var acceptAgreement=this.acceptAgreement();var params=ns.page.current.params;var oldValue=!!photoRightsData.options.favorite;var newValue=!oldValue;photoRights.set(".options.favorite",newValue);ns.page.go(ns.page.currentUrl,"preserve");acceptAgreement.done(function(){ph.actions.do("do-favorite-set",{"author-login":params["author-login"],"image-id":params["image-id"],operation:newValue?"SET":"UNSET"},{check:isOk,done:function(context){promise.resolve({context:context})},fail:function(context){photoRights.set(".options.favorite",oldValue);promise.reject({newValue:newValue,oldValue:oldValue,context:context})}})});acceptAgreement.fail(function(details){promise.reject({newValue:newValue,oldValue:oldValue,context:details.context})});return promise},toggleFollow:function(profile){var acceptAgreement=this.acceptAgreement();var promise=new no.Promise;var authorId=profile.get(".user.uid");var authorLogin=profile.get(".user.login");var oldValue=!!profile.get(".viewerUserRelation.userIsFavoriteAuthorOfViewer");var newValue=!oldValue;acceptAgreement.done(function(){var paramsNew={};profile.set(".viewerUserRelation.userIsFavoriteAuthorOfViewer",newValue);var action=oldValue?"do-user-unfollow":"do-user-follow";var paramName=oldValue?"author-ids":"author-login";var paramValue=oldValue?authorId:authorLogin;paramsNew[paramName]=paramValue;ph.actions.do(action,paramsNew,{check:isOk,done:function(context){promise.resolve({context:context})},fail:function(context){profile.set(".viewerUserRelation.userIsFavoriteAuthorOfViewer",oldValue);
promise.reject({context:context})}})});acceptAgreement.fail(function(details){promise.reject({context:details.context})});return promise},setParam:function(photo,name){var photoData=photo.getData();var nameField="";var valueOld=null;var valueNew=null;var valueNewModel=null;var invalidateModel=false;switch(name){case"access-rights":nameField=".access.privilege";valueOld=no.jpath(nameField,photoData);valueNew=valueOld==="public"?"private":"public";valueNewModel=valueOld==="public"?"owner":"public";break;case"porno":nameField=".flags.porno";valueOld=no.jpath(nameField,photoData);valueNew=!valueOld;valueNewModel=valueNew;break;case"disable-comments":nameField=".flags.commentsDisabled";valueOld=no.jpath(nameField,photoData);valueNew=!valueOld;valueNewModel=valueNew;break;case"hide-orig":nameField=".flags.hideOriginal";valueOld=no.jpath(nameField,photoData);valueNew=!valueOld;valueNewModel=valueNew;invalidateModel=true;break;default:return null}var promise=new no.Promise;var paramsNew={};paramsNew["image-id"]=no.jpath(".imageId",photoData);paramsNew[name]=valueNew;photo.set(nameField,valueNewModel);ph.actions.do("do-photo-edit",paramsNew,{check:isOk,done:function(context){if(invalidateModel){photo.invalidate()}promise.resolve({context:context})},fail:function(context){photo.set(nameField,valueOld);promise.reject({context:context})}});return promise},invalidateLinks:function(photo){var that=this;var promise=new no.Promise;var params=ns.page.current.params;ph.actions.do("do-photo-edit",{"image-id":photo.get(".imageId"),"invalidate-links":true},{check:isOk,done:function(context){photo.invalidate();that._invalidateImageModels(params);promise.resolve({context:context})},fail:function(context){promise.reject({context:context})}});return promise},checkPassword:function(photo,password){var promise=new no.Promise;var ticket=ns.Model.get("ticket").getData();var photoData=photo.getData();var params=ns.page.current.params;if($.trim(password)===""){var context=ph.actions.createContext({name:"empty password"});return promise.reject({context:context})}ph.actions.do("do-password-check",{ticket:ticket,password:password,"album-id":photoData.albumId,"author-id":photoData.author.uid},{check:isOk,done:function(context){ns.Model.get("photo",params).invalidate();ns.Model.get("album-info",params).invalidate();ns.Model.get("photo-more",params).invalidate();ns.Model.get("photo-rights",params).invalidate();ns.Model.get("tags",params).invalidate();ns.Model.get("slider-context",params).invalidate();promise.resolve({context:context})},fail:function(context){promise.reject({context:context})}});return promise},setGte18:function(auth){var uid=auth.get(".uid.value")||"0";$.cookie("fotki_adult","fotki_adult:"+uid,{path:"/"});return no.Promise.resolved(ph.actions.createContext())},complain:function(data){var promise=new no.Promise;var params=ns.page.current.params;var types=[];var dict={copyright:data.contestId?"CONTEST_PLAGIARISM":"PLAGIARISM",contest:"NOT_SUITABLE_FOR_CONTEST",porn:"PORNO",violence:"VIOLENCE",spam:"SPAM",other:"OTHER"};for(var name in dict){if(dict.hasOwnProperty(name)){if(data[name]){types.push(dict[name])}}}ph.actions.do("do-photo-complain",{"author-login":params["author-login"],"image-id":params["image-id"],types:types.join(","),url:data.linkToOrigin,comment:data.matter,"contest-id":data.contestId},{check:function(model){return no.jpath(".complete",model.getData())},done:function(){promise.resolve()},fail:function(context){promise.reject({context:context})}});return promise},editTags:function(tagsString,models){var tagsArrayDirty=[];tagsString.split(",").forEach(function(element){var tag=element.trim();if(tag){tagsArrayDirty.push(tag.toLocaleLowerCase())}});var onlyUnique=function(value,index,self){return self.indexOf(value)===index};var tagsArray=tagsArrayDirty.filter(onlyUnique);var tagsData={tags:{tag:[]}};tagsArray.forEach(function(element){tagsData.tags.tag.push({name:element,tagger:models.photo.getData().author,declined:false})});var tagsDataOld=models.tags.getData();var tagNames=no.jpath(".tags.tag.name",tagsDataOld)||[];var tagsDataStringOld=tagNames.join(",");var tagsDataString=tagsArray.join(",");var promise=new no.Promise;models.tags.setData(tagsData);if(tagsArray.length>30){models.tags.setData(tagsDataOld);return promise.reject()}if(tagsDataString===tagsDataStringOld){return promise.resolve({pageUrl:ns.page.currentUrl})}var params=ns.page.current.params;ph.actions.do("do-tag-edit",{"author-login":params["author-login"],"image-id":params["image-id"],tags:tagsDataString},{check:function(model){return no.jpath(".tags.tag",model.getData())?true:false},done:function(context){models.tags.setData(context.model.getData());promise.resolve(context)},fail:function(context){models.tags.setData(tagsDataOld);promise.reject(context)}});return promise},details:function(){var promise=new no.Promise;var params=ns.page.current.params;ph.actions.get("exif",{"author-login":params["author-login"],"image-id":params["image-id"]},{check:function(model){return!model.error},done:function(context){promise.resolve(context)},fail:function(context){promise.reject(context)}});return promise},geoBind:function(geoData,photoMore){var promise=new no.Promise;var params=ns.page.current.params;var photoMoreData=photoMore.getData();var oldData=null;if(photoMoreData.boundCoord){oldData={lat:photoMoreData.boundCoord.latitude,lon:photoMoreData.boundCoord.longitude,mapType:photoMoreData.boundCoord.mapType,zoom:photoMoreData.boundCoord.zoomlevel||photoMoreData.boundCoord.zoomLevel}}photoMore.set(".boundCoord.latitude",geoData.lat);photoMore.set(".boundCoord.longitude",geoData.lon);photoMore.set(".boundCoord.mapType",geoData.mapType);photoMore.set(".boundCoord.zoomLevel",geoData.zoom);ph.actions.do("do-geo-bind",{"author-login":params["author-login"],"image-id":params["image-id"],latitude:geoData.lat,longitude:geoData.lon,mapType:geoData.mapType,zoomLevel:geoData.zoom},{check:isOk,done:function(context){promise.resolve({context:context})},fail:function(context){if(oldData){photoMore.set(".boundCoord.latitude",oldData.lat);photoMore.set(".boundCoord.longitude",oldData.lon);photoMore.set(".boundCoord.mapType",oldData.mapType);photoMore.set(".boundCoord.zoomLevel",oldData.zoom)}else{photoMore.set(".boundCoord",undefined);delete photoMoreData.boundCoord}promise.reject({context:context,newData:geoData,oldData:oldData})}});return promise},geoUnbind:function(photoMore){var photoMoreData=photoMore.getData();if(!photoMoreData.boundCoord){return null}var promise=new no.Promise;var params=ns.page.current.params;var oldData={lat:photoMoreData.boundCoord.latitude,lon:photoMoreData.boundCoord.longitude,mapType:photoMoreData.boundCoord.mapType,zoom:photoMoreData.boundCoord.zoomlevel||photoMoreData.boundCoord.zoomLevel};photoMore.set(".boundCoord.latitude",undefined);photoMore.set(".boundCoord.longitude",undefined);photoMore.set(".boundCoord.mapType",undefined);photoMore.set(".boundCoord.zoomLevel",undefined);photoMore.set(".boundCoord",undefined);delete photoMoreData.boundCoord;ph.actions.do("do-geo-unbind",{"author-login":params["author-login"],"image-id":params["image-id"]},{check:isOk,done:function(context){promise.resolve({context:context})},fail:function(context){if(oldData){photoMore.set(".boundCoord.latitude",oldData.lat);photoMore.set(".boundCoord.longitude",oldData.lon);photoMore.set(".boundCoord.mapType",oldData.mapType);photoMore.set(".boundCoord.zoomLevel",oldData.zoom)}promise.reject({context:context,oldData:oldData})}});return promise},remove:function(photo){var promise=new no.Promise;var params=photo.params;var nextPhotoParams=null;var _remove=function(){ph.actions.do("do-photo-remove",{"image-id":params["image-id"]},{check:isOk,done:function(context){ph.modelsManager.cleanup("photo",params);promise.resolve({context:context,nextPhotoParams:nextPhotoParams})},fail:function(context){promise.reject({context:context})}})};ph.controllers.slider.getPhotoNearContext(params).done(function(context){nextPhotoParams={"author-login":context.model.get(".next.author.login"),"image-id":context.model.get(".next.imageId")};if(!nextPhotoParams["author-login"]||!nextPhotoParams["image-id"]||ph.utils.matchParams(params,nextPhotoParams,["author-login","image-id"])){nextPhotoParams=null}_remove()}).fail(function(){_remove()});return promise},escapeUserInput:function(str){return ns.entityify(str)},sendToContest:function(photo,tags,data){var that=this;var promise=new no.Promise;var params=ns.page.current.params;var ticket=ns.Model.get("ticket").getData();ph.actions.do("do-send-to-contest",{"author-login":params["author-login"],"image-id":params["image-id"],title:data.title,tags:data.tags,"contest-id":data.contestId,ticket:ticket},{check:isOk,done:function(context){photo.invalidate();tags.invalidate();that._invalidateContestModels(params);promise.resolve(context)},fail:function(context){photo.invalidate();tags.invalidate();that._invalidateContestModels(params);promise.reject({context:context})}});return promise},revokeFromContest:function(photo,contestId){var that=this;var promise=new no.Promise;var params=ns.page.current.params;var ticket=ns.Model.get("ticket").getData();ph.actions.do("do-revoke-from-contest",{"author-login":params["author-login"],"image-id":params["image-id"],"contest-id":contestId,ticket:ticket},{check:isOk,done:function(context){photo.invalidate();that._invalidateContestModels(params);promise.resolve(context)},fail:function(context){photo.invalidate();that._invalidateContestModels(params);promise.reject({context:context})}});return promise},rotateImage:function(photo){var that=this;var promise=new no.Promise;var params=ns.page.current.params;var ticket=ns.Model.get("ticket").getData();ph.actions.do("do-photo-rotate",{ticket:ticket,"image-id":params["image-id"],angle:-90},{check:isOk,done:function(context){photo.invalidate();that._invalidateImageModels(params);promise.resolve(context)},fail:function(context){promise.reject({context:context})}});return promise},canEditImage:function(){var promise=new no.Promise;var params=ns.page.current.params;var ticket=ns.Model.get("ticket").getData();ph.actions.do("do-image-can-edit",{ticket:ticket,"image-id":params["image-id"]},{check:isOk,done:function(context){promise.resolve(context)},fail:function(context){promise.reject({context:context})}});return promise},editImage:function(photo,actions,beforeEditCallback,metrikaCountCallback){var that=this;var promise=new no.Promise;var params=ns.page.current.params;var ticket=ns.Model.get("ticket").getData();ns.assert(beforeEditCallback,"photo-controller","beforeEditCallback must be set");ns.assert(metrikaCountCallback,"photo-controller","metrikaCountCallback must be set");var task=new ph.ImageEditTask(photo,actions,ticket,beforeEditCallback,metrikaCountCallback);task.run().done(function(){photo.invalidate();that._invalidateImageModels(params);promise.resolve(ph.actions.createContext())}).fail(function(error){promise.reject(ph.actions.createContext(error))});return promise},_invalidateContestModels:function(params){var authorLogin=params["author-login"];var filter=function(m){return m.params["author-login"]===authorLogin};ns.Model.invalidate("photo-rights",filter);ns.Model.invalidate("photo-more",filter)},_invalidateImageModels:function(params){ns.Model.invalidate("photo-lite",function(m){return ph.utils.matchParams(params,m.params,["author-login","image-id"])})}}})();(function(){ph.controllers.slider={getPhotoNearContext:function(params){var promise=new no.Promise;params=params||ns.page.current.params;ph.actions.get("photo-near-context",params,{done:function(context){promise.resolve(context)},fail:function(context){promise.reject({context:context})}});return promise},getPhotoPosition:function(params){var promise=new no.Promise;params=params||ns.page.current.params;ph.actions.get("photo-position",params,{check:function(model){var data=model.getData();var position=no.jpath(".position",data);var albumId=no.jpath(".albumId",data);return typeof position!=="undefined"&&typeof albumId!=="undefined"},done:function(context){promise.resolve(context)},fail:function(context){promise.reject({context:context})}});return promise},getAlbumPage:function(params){var promise=new no.Promise;ph.actions.get("do-get-context-page",params,{check:function(model){return!model.error&&!!model.models},done:function(context){promise.resolve(context)},fail:function(context){promise.reject({context:context})}});return promise}}})();(function(){var isOk=ph.controllers.isOk;ph.controllers.comments={addComment:function(commentBody,captchaInfo,parentComment,preferences){var that=this;var promise=new no.Promise;var params=ns.page.current.params;var displayName=ns.Model.get("auth").get(".photo-profile.user.displayName");var parentCommentId=parentComment?parentComment.get(".id"):null;var parentLevel=parentComment?parentComment.get(".level"):-1;var captchaKey=captchaInfo?captchaInfo.key:null;var captchaReply=captchaInfo?captchaInfo.reply:null;var so=ns.Model.getValid("comment-add-so",params);var soValue=so?so.getData():null;ph.actions.do("do-comment-add",{"author-login":params["author-login"],"image-id":params["image-id"],content:commentBody,"parent-comment-id":parentCommentId,"cap-key":captchaKey,"cap-rep":captchaReply,"display-name":displayName,so:soValue},{check:function(model){return!!no.jpath(".models[0].data.id",model)},done:function(context){var comment=context.model.models[0];comment.set(".level",parentLevel+1);context.model=comment;if(so){so.invalidate()}that._invalidateCommentsAfterModify(params);preferences.invalidate();ph.controllers.user.getPreferences().always(function(){promise.resolve(context)})},fail:function(context){var comment=context.model.models[0];var error=context.model&&context.model.getError();if(error&&error.so){ns.Model.get("comment-add-so",params).setData(error.so)}context.model=null;if(comment){context.model=comment;context.error=context.error||comment.get(".error")}var errorName=no.jpath(".error.name",context);if(errorName==="spam"||errorName==="captcha-check-failed"){preferences.invalidate();ph.controllers.user.getPreferences().always(function(){promise.reject({context:context})})}else{promise.reject({context:context})}}});return promise},getCaptcha:function(){var promise=new no.Promise;ph.actions.do("do-captcha-get",{},{check:function(model){var data=model.getData();return no.jpath(".imageurl",data)&&no.jpath(".token",data)},done:function(context){promise.resolve(context)},fail:function(context){promise.reject({context:context})}});return promise},removeComment:function(commentModel){var that=this;var promise=new no.Promise;var params=ns.page.current.params;ph.actions.do("do-comment-delete",{"author-login":params["author-login"],"image-id":params["image-id"],"comment-id":commentModel.getData().id},{check:isOk,done:function(context){commentModel.set(".deleted",true);commentModel.set(".deleted-recently",true);that._invalidateCommentsAfterModify(params);promise.resolve(context)},fail:function(context){promise.reject({context:context})}});return promise},banCommentAuthor:function(commentModel){var that=this;var promise=new no.Promise;var params=ns.page.current.params;ph.actions.do("do-user-ban",{"user-ids":commentModel.get(".commenter.uid")},{check:isOk,done:function(context){commentModel.set(".commenterBanned",true);commentModel.set(".commenter-ban-in-progress",false);that._invalidateCommentsAfterModify(params);promise.resolve(context)},fail:function(context){commentModel.set(".commenter-ban-in-progress",false);promise.reject({context:context})}});return promise},loadComments:function(fromCommentId,count){var promise=new no.Promise;var pageParams=ns.page.current.params;ph.actions.get("comments-more",{"author-login":pageParams["author-login"],"image-id":pageParams["image-id"],"comment-id":fromCommentId,count:count},{check:function(model){return model&&model.models},done:function(context){promise.resolve(context)},fail:function(context){promise.reject({context:context})}});return promise},_invalidateCommentsAfterModify:function(params){var currentCommentId=ph.params.hiddenParams["comment-id"];ns.Model.invalidate("comments",function(m){var modelParams=m.getRequestParams();return ph.utils.matchParams(modelParams,params,["author-login","image-id"])&&modelParams["comment-id"]!=currentCommentId})}}})();(function(){var localPrefs;var cookieName="local_prefs";ph.controllers.user={getPreferences:function(){var promise=new no.Promise;ph.actions.get("preferences",{},{check:function(model){return!!no.jpath(".preferences",model.getData())},done:function(context){promise.resolve(context)},fail:function(context){promise.reject({context:context})}});return promise},setLocalPref:function(name,value){if(!localPrefs){localPrefs=JSON.parse($.cookie(cookieName)||"{}")}localPrefs[name]=value;$.cookie(cookieName,JSON.stringify(localPrefs),{expires:365,path:"/"});return no.Promise.resolved()},getLocalPref:function(name){if(!localPrefs){localPrefs=JSON.parse($.cookie(cookieName)||"{}")}return no.Promise.resolved(localPrefs[name])}}})();(function(){var toolsListCustom="enhance,effects,frames,stickers,crop,orientation,focus,brightness,contrast,saturation,warmth,sharpness,colorsplash,draw,text,redeye,whiten,blemish";var Editor=function(){};no.extend(Editor.prototype,no.Events);Editor.prototype.init=function(){var that=this;var promise=new no.Promise;this.editor=new Aviary.Feather({apiVersion:3,theme:"minimum",tools:toolsListCustom,enableCORS:true,language:"ru",onLoad:function(){promise.resolve(that);that.trigger("loaded")},onSaveButtonClicked:function(){that.actions=that.editor.getActionList();that.close();return false},onReady:function(){that.trigger("ready");that.initialActions=that.editor.getActionList()},onClose:function(isDirty){isDirty=isDirty&&that.actions!==that.initialActions;that.trigger("close",isDirty?that.actions:null);that.actions=null;that.initialActions=null},onError:function(error){that.trigger("error",(error||{}).message)}});return promise};Editor.prototype.load=function(imageId,imageUrl,origSize){var that=this;var fullyLoadedPromise=new no.Promise;var options={image:imageId};if(origSize){options.hiresWidth=origSize.width;options.hiresHeight=origSize.height}this._preloadImage(imageId,imageUrl,function(){that.editor.launch(options);fullyLoadedPromise.resolve()});return fullyLoadedPromise};Editor.prototype.close=function(){this.editor.close();this._cleanup()};Editor.prototype._preloadImage=function(imageId,imageUrl,callback){this._cleanup();this.$imagePlaceholder=$('<img id="'+imageId+'" src="'+imageUrl+'" class="image-proxy" />').appendTo(document.body);ph.utils.imgOnLoad(this.$imagePlaceholder,callback)};Editor.prototype._cleanup=function(){if(this.$imagePlaceholder){this.$imagePlaceholder.remove();this.$imagePlaceholder=null}};ph.Editor=Editor})();var requirejs,require,define;(function(Z){function H(b){return"[object Function]"===L.call(b)}function I(b){return"[object Array]"===L.call(b)}function y(b,c){if(b){var d;for(d=0;d<b.length&&(!b[d]||!c(b[d],d,b));d+=1);}}function M(b,c){if(b){var d;for(d=b.length-1;-1<d&&(!b[d]||!c(b[d],d,b));d-=1);}}function s(b,c){return ga.call(b,c)}function l(b,c){return s(b,c)&&b[c]}function F(b,c){for(var d in b)if(s(b,d)&&c(b[d],d))break}function Q(b,c,d,h){c&&F(c,function(c,j){if(d||!s(b,j))h&&"string"!==typeof c?(b[j]||(b[j]={}),Q(b[j],c,d,h)):b[j]=c});return b}function u(b,c){return function(){return c.apply(b,arguments)}}function aa(b){throw b}function ba(b){if(!b)return b;var c=Z;y(b.split("."),function(b){c=c[b]});return c}function A(b,c,d,h){c=Error(c+"\nhttp://requirejs.org/docs/errors.html#"+b);c.requireType=b;c.requireModules=h;d&&(c.originalError=d);return c}function ha(b){function c(a,f,b){var e,m,c,g,d,h,j,i=f&&f.split("/");e=i;var n=k.map,p=n&&n["*"];if(a&&"."===a.charAt(0))if(f){e=l(k.pkgs,f)?i=[f]:i.slice(0,i.length-1);f=a=e.concat(a.split("/"));for(e=0;f[e];e+=1)if(m=f[e],"."===m)f.splice(e,1),e-=1;else if(".."===m)if(1===e&&(".."===f[2]||".."===f[0]))break;else 0<e&&(f.splice(e-1,2),e-=2);e=l(k.pkgs,f=a[0]);a=a.join("/");e&&a===f+"/"+e.main&&(a=f)}else 0===a.indexOf("./")&&(a=a.substring(2));if(b&&n&&(i||p)){f=a.split("/");for(e=f.length;0<e;e-=1){c=f.slice(0,e).join("/");if(i)for(m=i.length;0<m;m-=1)if(b=l(n,i.slice(0,m).join("/")))if(b=l(b,c)){g=b;d=e;break}if(g)break;!h&&(p&&l(p,c))&&(h=l(p,c),j=e)}!g&&h&&(g=h,d=j);g&&(f.splice(0,d,g),a=f.join("/"))}return a}function d(a){z&&y(document.getElementsByTagName("script"),function(f){if(f.getAttribute("data-requiremodule")===a&&f.getAttribute("data-requirecontext")===i.contextName)return f.parentNode.removeChild(f),!0})}function h(a){var f=l(k.paths,a);if(f&&I(f)&&1<f.length)return d(a),f.shift(),i.require.undef(a),i.require([a]),!0}function $(a){var f,b=a?a.indexOf("!"):-1;-1<b&&(f=a.substring(0,b),a=a.substring(b+1,a.length));return[f,a]}function n(a,f,b,e){var m,B,g=null,d=f?f.name:null,h=a,j=!0,k="";a||(j=!1,a="_@r"+(L+=1));a=$(a);g=a[0];a=a[1];g&&(g=c(g,d,e),B=l(r,g));a&&(g?k=B&&B.normalize?B.normalize(a,function(a){return c(a,d,e)}):c(a,d,e):(k=c(a,d,e),a=$(k),g=a[0],k=a[1],b=!0,m=i.nameToUrl(k)));b=g&&!B&&!b?"_unnormalized"+(M+=1):"";return{prefix:g,name:k,parentMap:f,unnormalized:!!b,url:m,originalName:h,isDefine:j,id:(g?g+"!"+k:k)+b}}function q(a){var f=a.id,b=l(p,f);b||(b=p[f]=new i.Module(a));return b}function t(a,f,b){var e=a.id,m=l(p,e);if(s(r,e)&&(!m||m.defineEmitComplete))"defined"===f&&b(r[e]);else if(m=q(a),m.error&&"error"===f)b(m.error);else m.on(f,b)}function v(a,f){var b=a.requireModules,e=!1;if(f)f(a);else if(y(b,function(f){if(f=l(p,f))f.error=a,f.events.error&&(e=!0,f.emit("error",a))}),!e)j.onError(a)}function w(){R.length&&(ia.apply(G,[G.length-1,0].concat(R)),R=[])}function x(a){delete p[a];delete T[a]}function E(a,f,b){var e=a.map.id;a.error?a.emit("error",a.error):(f[e]=!0,y(a.depMaps,function(e,c){var g=e.id,d=l(p,g);d&&(!a.depMatched[c]&&!b[g])&&(l(f,g)?(a.defineDep(c,r[g]),a.check()):E(d,f,b))}),b[e]=!0)}function C(){var a,f,b,e,m=(b=1e3*k.waitSeconds)&&i.startTime+b<(new Date).getTime(),c=[],g=[],j=!1,l=!0;if(!U){U=!0;F(T,function(b){a=b.map;f=a.id;if(b.enabled&&(a.isDefine||g.push(b),!b.error))if(!b.inited&&m)h(f)?j=e=!0:(c.push(f),d(f));else if(!b.inited&&(b.fetched&&a.isDefine)&&(j=!0,!a.prefix))return l=!1});if(m&&c.length)return b=A("timeout","Load timeout for modules: "+c,null,c),b.contextName=i.contextName,v(b);l&&y(g,function(a){E(a,{},{})});if((!m||e)&&j)if((z||da)&&!V)V=setTimeout(function(){V=0;C()},50);U=!1}}function D(a){s(r,a[0])||q(n(a[0],null,!0)).init(a[1],a[2])}function J(a){var a=a.currentTarget||a.srcElement,b=i.onScriptLoad;a.detachEvent&&!W?a.detachEvent("onreadystatechange",b):a.removeEventListener("load",b,!1);b=i.onScriptError;(!a.detachEvent||W)&&a.removeEventListener("error",b,!1);return{node:a,id:a&&a.getAttribute("data-requiremodule")}}function K(){var a;for(w();G.length;){a=G.shift();if(null===a[0])return v(A("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));D(a)}}var U,X,i,N,V,k={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},p={},T={},Y={},G=[],r={},S={},L=1,M=1;N={require:function(a){return a.require?a.require:a.require=i.makeRequire(a.map)},exports:function(a){a.usingExports=!0;if(a.map.isDefine)return a.exports?a.exports:a.exports=r[a.map.id]={}},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){var b=l(k.pkgs,a.map.id);return(b?l(k.config,a.map.id+"/"+b.main):l(k.config,a.map.id))||{}},exports:r[a.map.id]}}};X=function(a){this.events=l(Y,a.id)||{};this.map=a;this.shim=l(k.shim,a.id);this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};X.prototype={init:function(a,b,c,e){e=e||{};if(!this.inited){this.factory=b;if(c)this.on("error",c);else this.events.error&&(c=u(this,function(a){this.emit("error",a)}));this.depMaps=a&&a.slice(0);this.errback=c;this.inited=!0;this.ignore=e.ignore;e.enabled||this.enabled?this.enable():this.check()}},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0;i.startTime=(new Date).getTime();var a=this.map;if(this.shim)i.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return a.prefix?this.callPlugin():this.load()}));else return a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;S[a]||(S[a]=!0,i.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id;b=this.depExports;var e=this.exports,m=this.factory;if(this.inited)if(this.error)this.emit("error",this.error);else{if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(H(m)){if(this.events.error&&this.map.isDefine||j.onError!==aa)try{e=i.execCb(c,m,b,e)}catch(d){a=d}else e=i.execCb(c,m,b,e);this.map.isDefine&&((b=this.module)&&void 0!==b.exports&&b.exports!==this.exports?e=b.exports:void 0===e&&this.usingExports&&(e=this.exports));if(a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",v(this.error=a)}else e=m;this.exports=e;if(this.map.isDefine&&!this.ignore&&(r[c]=e,j.onResourceLoad))j.onResourceLoad(i,this.map,this.depMaps);x(c);this.defined=!0}this.defining=!1;this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=n(a.prefix);this.depMaps.push(d);t(d,"defined",u(this,function(e){var m,d;d=this.map.name;var g=this.map.parentMap?this.map.parentMap.name:null,h=i.makeRequire(a.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){if(e.normalize&&(d=e.normalize(d,function(a){return c(a,g,!0)})||""),e=n(a.prefix+"!"+d,this.map.parentMap),t(e,"defined",u(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),d=l(p,e.id)){this.depMaps.push(e);if(this.events.error)d.on("error",u(this,function(a){this.emit("error",a)}));d.enable()}}else m=u(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),m.error=u(this,function(a){this.inited=!0;this.error=a;a.requireModules=[b];F(p,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&x(a.map.id)});v(a)}),m.fromText=u(this,function(e,c){var d=a.name,g=n(d),B=O;c&&(e=c);B&&(O=!1);q(g);s(k.config,b)&&(k.config[d]=k.config[b]);try{j.exec(e)}catch(ca){return v(A("fromtexteval","fromText eval for "+b+" failed: "+ca,ca,[b]))}B&&(O=!0);this.depMaps.push(g);i.completeLoad(d);h([d],m)}),e.load(a.name,h,m,k)}));i.enable(d,this);this.pluginMaps[d.id]=d},enable:function(){T[this.map.id]=this;this.enabling=this.enabled=!0;y(this.depMaps,u(this,function(a,b){var c,e;if("string"===typeof a){a=n(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap);this.depMaps[b]=a;if(c=l(N,a.id)){this.depExports[b]=c(this);return}this.depCount+=1;t(a,"defined",u(this,function(a){this.defineDep(b,a);this.check()}));this.errback&&t(a,"error",u(this,this.errback))}c=a.id;e=p[c];!s(N,c)&&(e&&!e.enabled)&&i.enable(a,this)}));F(this.pluginMaps,u(this,function(a){var b=l(p,a.id);b&&!b.enabled&&i.enable(a,this)}));this.enabling=!1;this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]);c.push(b)},emit:function(a,b){y(this.events[a],function(a){a(b)});"error"===a&&delete this.events[a]}};i={config:k,contextName:b,registry:p,defined:r,urlFetched:S,defQueue:G,Module:X,makeModuleMap:n,nextTick:j.nextTick,onError:v,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=k.pkgs,c=k.shim,e={paths:!0,config:!0,map:!0};F(a,function(a,b){e[b]?"map"===b?(k.map||(k.map={}),Q(k[b],a,!0,!0)):Q(k[b],a,!0):k[b]=a});a.shim&&(F(a.shim,function(a,b){I(a)&&(a={deps:a});if((a.exports||a.init)&&!a.exportsFn)a.exportsFn=i.makeShimExports(a);c[b]=a}),k.shim=c);a.packages&&(y(a.packages,function(a){a="string"===typeof a?{name:a}:a;b[a.name]={name:a.name,location:a.location||a.name,main:(a.main||"main").replace(ja,"").replace(ea,"")}}),k.pkgs=b);F(p,function(a,b){!a.inited&&!a.map.unnormalized&&(a.map=n(b))});if(a.deps||a.callback)i.require(a.deps||[],a.callback)},makeShimExports:function(a){return function(){var b;a.init&&(b=a.init.apply(Z,arguments));return b||a.exports&&ba(a.exports)}},makeRequire:function(a,f){function d(e,c,h){var g,k;f.enableBuildCallback&&(c&&H(c))&&(c.__requireJsBuild=!0);if("string"===typeof e){if(H(c))return v(A("requireargs","Invalid require call"),h);if(a&&s(N,e))return N[e](p[a.id]);if(j.get)return j.get(i,e,a,d);g=n(e,a,!1,!0);g=g.id;return!s(r,g)?v(A("notloaded",'Module name "'+g+'" has not been loaded yet for context: '+b+(a?"":". Use require([])"))):r[g]}K();i.nextTick(function(){K();k=q(n(null,a));k.skipMap=f.skipMap;k.init(e,c,h,{enabled:!0});C()});return d}f=f||{};Q(d,{isBrowser:z,toUrl:function(b){var d,f=b.lastIndexOf("."),g=b.split("/")[0];if(-1!==f&&(!("."===g||".."===g)||1<f))d=b.substring(f,b.length),b=b.substring(0,f);return i.nameToUrl(c(b,a&&a.id,!0),d,!0)},defined:function(b){return s(r,n(b,a,!1,!0).id)},specified:function(b){b=n(b,a,!1,!0).id;return s(r,b)||s(p,b)}});a||(d.undef=function(b){w();var c=n(b,a,!0),f=l(p,b);delete r[b];delete S[c.url];delete Y[b];f&&(f.events.defined&&(Y[b]=f.events),x(b))});return d},enable:function(a){l(p,a.id)&&q(a).enable()},completeLoad:function(a){var b,c,e=l(k.shim,a)||{},d=e.exports;for(w();G.length;){c=G.shift();if(null===c[0]){c[0]=a;if(b)break;b=!0}else c[0]===a&&(b=!0);D(c)}c=l(p,a);if(!b&&!s(r,a)&&c&&!c.inited){if(k.enforceDefine&&(!d||!ba(d)))return h(a)?void 0:v(A("nodefine","No define call for "+a,null,[a]));D([a,e.deps||[],e.exportsFn])}C()},nameToUrl:function(a,b,c){var e,d,h,g,i,n;if(j.jsExtRegExp.test(a))g=a+(b||"");else{e=k.paths;d=k.pkgs;g=a.split("/");for(i=g.length;0<i;i-=1)if(n=g.slice(0,i).join("/"),h=l(d,n),n=l(e,n)){I(n)&&(n=n[0]);g.splice(0,i,n);break}else if(h){a=a===h.name?h.location+"/"+h.main:h.location;g.splice(0,i,a);break}g=g.join("/");g+=b||(/\?/.test(g)||c?"":".js");g=("/"===g.charAt(0)||g.match(/^[\w\+\.\-]+:/)?"":k.baseUrl)+g}return k.urlArgs?g+((-1===g.indexOf("?")?"?":"&")+k.urlArgs):g},load:function(a,b){j.load(i,a,b)},execCb:function(a,b,c,e){return b.apply(e,c)},onScriptLoad:function(a){if("load"===a.type||ka.test((a.currentTarget||a.srcElement).readyState))P=null,a=J(a),i.completeLoad(a.id)},onScriptError:function(a){var b=J(a);if(!h(b.id))return v(A("scripterror","Script error for: "+b.id,a,[b.id]))}};i.require=i.makeRequire();return i}var j,w,x,C,J,D,P,K,q,fa,la=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,ma=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/\.js$/,ja=/^\.\//;w=Object.prototype;var L=w.toString,ga=w.hasOwnProperty,ia=Array.prototype.splice,z=!!("undefined"!==typeof window&&navigator&&window.document),da=!z&&"undefined"!==typeof importScripts,ka=z&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,W="undefined"!==typeof opera&&"[object Opera]"===opera.toString(),E={},t={},R=[],O=!1;if("undefined"===typeof define){if("undefined"!==typeof requirejs){if(H(requirejs))return;t=requirejs;requirejs=void 0}"undefined"!==typeof require&&!H(require)&&(t=require,require=void 0);j=requirejs=function(b,c,d,h){var q,n="_";!I(b)&&"string"!==typeof b&&(q=b,I(c)?(b=c,c=d,d=h):b=[]);q&&q.context&&(n=q.context);(h=l(E,n))||(h=E[n]=j.s.newContext(n));q&&h.configure(q);return h.require(b,c,d)};j.config=function(b){return j(b)};j.nextTick="undefined"!==typeof setTimeout?function(b){setTimeout(b,4)}:function(b){b()};require||(require=j);j.version="2.1.8";j.jsExtRegExp=/^\/|:|\?|\.js$/;j.isBrowser=z;w=j.s={contexts:E,newContext:ha};j({});y(["toUrl","undef","defined","specified"],function(b){j[b]=function(){var c=E._;return c.require[b].apply(c,arguments)}});if(z&&(x=w.head=document.getElementsByTagName("head")[0],C=document.getElementsByTagName("base")[0]))x=w.head=C.parentNode;j.onError=aa;j.createNode=function(b){var c=b.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");
c.type=b.scriptType||"text/javascript";c.charset="utf-8";c.async=!0;return c};j.load=function(b,c,d){var h=b&&b.config||{};if(z)return h=j.createNode(h,c,d),h.setAttribute("data-requirecontext",b.contextName),h.setAttribute("data-requiremodule",c),h.attachEvent&&!(h.attachEvent.toString&&0>h.attachEvent.toString().indexOf("[native code"))&&!W?(O=!0,h.attachEvent("onreadystatechange",b.onScriptLoad)):(h.addEventListener("load",b.onScriptLoad,!1),h.addEventListener("error",b.onScriptError,!1)),h.src=d,K=h,C?x.insertBefore(h,C):x.appendChild(h),K=null,h;if(da)try{importScripts(d),b.completeLoad(c)}catch(l){b.onError(A("importscripts","importScripts failed for "+c+" at "+d,l,[c]))}};z&&M(document.getElementsByTagName("script"),function(b){x||(x=b.parentNode);if(J=b.getAttribute("data-main"))return q=J,t.baseUrl||(D=q.split("/"),q=D.pop(),fa=D.length?D.join("/")+"/":"./",t.baseUrl=fa),q=q.replace(ea,""),j.jsExtRegExp.test(q)&&(q=J),t.deps=t.deps?t.deps.concat(q):[q],!0});define=function(b,c,d){var h,j;"string"!==typeof b&&(d=c,c=b,b=null);I(c)||(d=c,c=null);!c&&H(d)&&(c=[],d.length&&(d.toString().replace(la,"").replace(ma,function(b,d){c.push(d)}),c=(1===d.length?["require"]:["require","exports","module"]).concat(c)));if(O){if(!(h=K))P&&"interactive"===P.readyState||M(document.getElementsByTagName("script"),function(b){if("interactive"===b.readyState)return P=b}),h=P;h&&(b||(b=h.getAttribute("data-requiremodule")),j=E[h.getAttribute("data-requirecontext")])}(j?j.defQueue:R).push([b,c,d])};define.amd={jQuery:!0};j.exec=function(b){return eval(b)};j(t)}})(this);ns.router.baseDir="/next";ns.router.regexps["id"]="[A-Za-z_][A-Za-z0-9_.-]*";ns.router.regexps["string"]=".+";ns.router.regexps["view-mode"]="view|fullscreen";ns.router.regexps["context-type"]="calendar|top|search|contest|tag";var rewriteParams=function(params){var _params=no.extend({},params);ph.params.hiddenParams={};if(_params["author-login"]){_params["author-login"]=ph.utils.normalizeLogin(_params["author-login"])}if(_params["search-author"]){_params["search-author"]=ph.utils.normalizeLogin(_params["search-author"])}var commentId=_params["comment-id"];if(commentId){if(commentId.indexOf("child-")===0){commentId=commentId.substr(6)}ph.params.hiddenParams["comment-id"]=commentId;delete _params["comment-id"]}if(_params["comment-reply"]){ph.params.hiddenParams["comment-reply"]=_params["comment-reply"];delete _params["comment-reply"]}return _params};ns.router.routes={rewriteParams:{photo:rewriteParams},route:{"/{context==search:context-type}/{search-text:string}/users/{author-login}/album/{album-id:int}/{mode:view-mode}/{image-id:int}/":"photo","/{context==search:context-type}/{search-text:string}/users/{author-login}/{mode:view-mode}/{image-id:int}/":"photo","/{context==contest:context-type}/{contest-id:int}/users/{author-login}/album/{album-id:int}/{mode:view-mode}/{image-id:int}/":"photo","/{context==contest:context-type}/{contest-id:int}/users/{author-login}/{mode:view-mode}/{image-id:int}/":"photo","/users/{author-login}/{context==tag:context-type}/{tag:string}/album/{album-id:int}/{mode:view-mode}/{image-id:int}/":"photo","/users/{author-login}/{context==tag:context-type}/{tag:string}/{mode:view-mode}/{image-id:int}/":"photo","/{context:context-type}/users/{author-login}/album/{album-id:int}/{mode:view-mode}/{image-id:int}/":"photo","/{context:context-type}/users/{author-login}/{mode:view-mode}/{image-id:int}/":"photo","/users/{author-login}/album/{album-id:int}/{mode:view-mode}/{image-id:int}/":"photo","/users/{author-login}/{mode:view-mode}/{image-id:int}/":"photo","/404":"not-found"}};ph.init=function(){window.moment.lang("ru");ph.initModules();ph.initActions();ph.listenToResize();ph.listenToFullscreen();ph.listenToPageChange();ph.keyboard.init();ph.metrika.init();ph.statface.init();ns.init();ns.page.go(ns.page.currentUrl,"preserve")};ph.redirectToPassport=function(){var location=window.location;var passport_url="https://passport.yandex.ru/auth?clean=yes&msg=fotki&retpath="+location.href;location.href=passport_url};ph.redirectToOferta=function(){var ofertaUrl=ph.utils.generateUrl("oferta",{retpath:ph.utils.fullUrl(ns.page.currentUrl)});ns.page.go(ofertaUrl)};ph.noAuthRedirect=function(auth){if(!auth||!auth.isAuthValid()){ph.redirectToPassport();return true}return false};ph.listenToResize=function(){$(window).bind("resize",ph.utils.lazyCallback(100,function(){nb.trigger("ph-resize");ns.events.trigger("ph-resize")}))};ph.listenToFullscreen=function(){if(window.screenfull){$(document).on(window.screenfull.raw.fullscreenchange,function(){ns.events.trigger("ph-fullscreen-change",window.screenfull.isFullscreen)})}};ph.listenToPageChange=function(){var lastUrl=null;ns.events.on("ns-page-before-load",function(evt,pages,newUrl){if(newUrl===lastUrl){return}var newPageInfo=pages[1];if(newPageInfo.page==="photo"&&!newPageInfo.params["album-id"]){return}ns.events.trigger("ph-page-show",newPageInfo);var isPageChange=!!lastUrl;if(isPageChange){ns.events.trigger("ph-page-change")}lastUrl=newUrl})};ph.initClipboard=function(ZeroClipboard,promise){ZeroClipboard.setDefaults({moviePath:ns.router.url("/js/vendor/zeroclipboard.swf")});var clipboard=ph.clipboard=new ZeroClipboard;clipboard.on("load",function(){promise.resolve()});clipboard.on("noflash",function(){promise.reject()});clipboard.on("wrongflash",function(){promise.reject()});clipboard.on("complete",function(){var node=this;var block=nb.block(node);if(block){block.trigger("copied")}})};ph.allow18plus=function(uid){return $.cookie("fotki_adult")==="fotki_adult:"+(uid?uid:0)};ph.initActions=function(){ns.action.define("fix-url",function(actionName,params){if(params&&params.url){ns.history.replaceState(params.url)}});ns.action.define("metrika-count",function(){return true})};(function(){var photoBox={};var width=-1;var height=-1;photoBox.setSize=function(dimentions){width=dimentions.width;height=dimentions.height};photoBox.getDimentions=function(){return{width:width,height:height}};ph.photoBox=photoBox})();$(function(){ph.init()});